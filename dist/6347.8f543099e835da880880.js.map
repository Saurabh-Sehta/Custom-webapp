{"version":3,"file":"6347.8f543099e835da880880.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/widgets/icons/fa_back_icon.tsx","webpack://mattermost-webapp/./src/components/backstage/components/backstage_navbar.tsx","webpack://mattermost-webapp/./src/components/integrations/delete_integration_link/delete_integration_link.tsx","webpack://mattermost-webapp/./src/components/integrations/delete_integration_link/index.ts","webpack://mattermost-webapp/./src/components/emoji/emoji_list_item/delete_emoji_button.tsx","webpack://mattermost-webapp/./src/components/emoji/emoji_list_item/emoji_list_item.tsx","webpack://mattermost-webapp/./src/components/emoji/emoji_list_item/index.ts","webpack://mattermost-webapp/./src/components/emoji/emoji_list/emoji_list.tsx","webpack://mattermost-webapp/./src/components/emoji/emoji_list/index.ts","webpack://mattermost-webapp/./src/components/emoji/emoji_page.tsx","webpack://mattermost-webapp/./src/components/emoji/index.ts","webpack://mattermost-webapp/./src/components/backstage/components/backstage_header.tsx","webpack://mattermost-webapp/./src/components/emoji/add_emoji/add_emoji.tsx","webpack://mattermost-webapp/./src/components/emoji/add_emoji/index.ts","webpack://mattermost-webapp/./src/components/integrations/integration_option.tsx","webpack://mattermost-webapp/./src/components/integrations/integrations.tsx","webpack://mattermost-webapp/./src/components/integrations/index.ts","webpack://mattermost-webapp/./src/components/channel_select/channel_select.tsx","webpack://mattermost-webapp/./src/components/channel_select/index.ts","webpack://mattermost-webapp/./src/components/integrations/abstract_incoming_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/add_incoming_webhook/add_incoming_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/add_incoming_webhook/index.ts","webpack://mattermost-webapp/./src/components/integrations/abstract_oauth_app.tsx","webpack://mattermost-webapp/./src/components/integrations/add_oauth_app/add_oauth_app.tsx","webpack://mattermost-webapp/./src/components/integrations/add_oauth_app/index.ts","webpack://mattermost-webapp/./src/components/integrations/abstract_outgoing_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/add_outgoing_webhook/add_outgoing_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/add_outgoing_webhook/index.ts","webpack://mattermost-webapp/./src/packages/mattermost-redux/src/actions/bots.ts","webpack://mattermost-webapp/./src/components/backstage/components/backstage_list.tsx","webpack://mattermost-webapp/./src/components/integrations/bots/bot.tsx","webpack://mattermost-webapp/./src/components/integrations/bots/bots.tsx","webpack://mattermost-webapp/./src/components/integrations/bots/index.ts","webpack://mattermost-webapp/./src/components/integrations/bots/add_bot/add_bot.tsx","webpack://mattermost-webapp/./src/components/integrations/bots/add_bot/index.ts","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/oauth_connection_audience_input.tsx","webpack://mattermost-webapp/./src/components/integrations/abstract_command.tsx","webpack://mattermost-webapp/./src/components/integrations/add_command/add_command.tsx","webpack://mattermost-webapp/./src/components/integrations/add_command/index.ts","webpack://mattermost-webapp/./src/components/copy_text.tsx","webpack://mattermost-webapp/./src/components/integrations/confirm_integration/confirm_integration.tsx","webpack://mattermost-webapp/./src/components/integrations/confirm_integration/index.ts","webpack://mattermost-webapp/./src/components/integrations/edit_command/edit_command.tsx","webpack://mattermost-webapp/./src/components/integrations/edit_command/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_command.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_commands/installed_commands.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_commands/index.ts","webpack://mattermost-webapp/./src/components/integrations/commands_container/commands_container.tsx","webpack://mattermost-webapp/./src/components/integrations/commands_container/index.ts","webpack://mattermost-webapp/./src/components/integrations/edit_incoming_webhook/edit_incoming_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/edit_incoming_webhook/index.ts","webpack://mattermost-webapp/./src/components/integrations/edit_oauth_app/edit_oauth_app.tsx","webpack://mattermost-webapp/./src/components/integrations/edit_oauth_app/index.ts","webpack://mattermost-webapp/./src/components/integrations/edit_outgoing_webhook/edit_outgoing_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/edit_outgoing_webhook/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_incoming_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_incoming_webhooks/installed_incoming_webhooks.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_incoming_webhooks/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_oauth_app/installed_oauth_app.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_oauth_app/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_oauth_apps/installed_oauth_apps.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_oauth_apps/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_outgoing_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_outgoing_webhooks/installed_outgoing_webhooks.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_outgoing_webhooks/index.ts","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/abstract_outgoing_oauth_connection.tsx","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/add_outgoing_oauth_connection.tsx","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/edit_outgoing_oauth_connection.tsx","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/installed_outgoing_oauth_connection.tsx","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/installed_outgoing_oauth_connections.tsx","webpack://mattermost-webapp/./src/components/backstage/components/backstage_category.tsx","webpack://mattermost-webapp/./src/components/backstage/components/backstage_section.tsx","webpack://mattermost-webapp/./src/components/backstage/components/backstage_sidebar.tsx","webpack://mattermost-webapp/./src/components/backstage/backstage_controller.tsx","webpack://mattermost-webapp/./src/components/backstage/index.ts","webpack://mattermost-webapp/./src/components/form_error.tsx","webpack://mattermost-webapp/./src/components/localized_placeholder_input.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/fa_next_icon.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/fa_previous_icon.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/fa_search_icon.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/fa_warning_icon.tsx","webpack://mattermost-webapp/./src/packages/mattermost-redux/src/selectors/entities/bots.ts"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function BackIcon() {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <i\r\n            className='fa fa-angle-left'\r\n            title={formatMessage({id: 'generic_icons.back', defaultMessage: 'Back Icon'})}\r\n        />\r\n    );\r\n}\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport BlockableLink from 'components/admin_console/blockable_link';\r\nimport BackIcon from 'components/widgets/icons/fa_back_icon';\r\n\r\ntype Props = {\r\n    team?: Team;\r\n    siteName?: string;\r\n}\r\n\r\nconst BackstageNavbar = ({team, siteName}: Props) => {\r\n    const teamExists = team?.delete_at === 0;\r\n\r\n    return (\r\n        <div className='backstage-navbar'>\r\n            <BlockableLink\r\n                className='backstage-navbar__back'\r\n                to={`/${teamExists ? team?.name : ''}`}\r\n            >\r\n                <BackIcon/>\r\n                <span>\r\n                    {teamExists ? (\r\n                        <FormattedMessage\r\n                            id='backstage_navbar.backToMattermost'\r\n                            defaultMessage='Back to {siteName}'\r\n                            values={{siteName: siteName ?? team?.name}}\r\n                        />\r\n                    ) : (\r\n                        <FormattedMessage\r\n                            id='backstage_navbar.back'\r\n                            defaultMessage='Back'\r\n                        />\r\n                    )}\r\n                </span>\r\n            </BlockableLink>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BackstageNavbar;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {openModal as openModalAction} from 'actions/views/modals';\r\n\r\nimport ConfirmModalRedux from 'components/confirm_modal_redux';\r\nimport WarningIcon from 'components/widgets/icons/fa_warning_icon';\r\n\r\nconst ModalId = 'delete_integration_confirm';\r\n\r\ntype Props = {\r\n    confirmButtonText?: React.ReactNode;\r\n    linkText?: React.ReactNode;\r\n    subtitleText?: React.ReactNode;\r\n    modalMessage?: React.ReactNode;\r\n    modalTitle?: React.ReactNode;\r\n    onDelete: () => void;\r\n    openModal: typeof openModalAction;\r\n};\r\n\r\nexport default function DeleteIntegrationLink(props: Props) {\r\n    const {\r\n        confirmButtonText = (\r\n            <FormattedMessage\r\n                id='integrations.delete.confirm.button'\r\n                defaultMessage='Yes, delete it'\r\n            />\r\n        ),\r\n        linkText = (\r\n            <FormattedMessage\r\n                id='installed_integrations.delete'\r\n                defaultMessage='Delete'\r\n            />\r\n        ),\r\n        modalMessage,\r\n        modalTitle = (\r\n            <FormattedMessage\r\n                id='integrations.delete.confirm.title'\r\n                defaultMessage='Delete Integration'\r\n            />\r\n        ),\r\n        onDelete,\r\n        openModal,\r\n    } = props;\r\n\r\n    const onClick = useCallback(() => {\r\n        openModal({\r\n            modalId: ModalId,\r\n            dialogProps: {\r\n                confirmButtonText,\r\n                confirmButtonClass: 'btn btn-danger',\r\n                modalClass: 'integrations-backstage-modal',\r\n                message: (\r\n                    <>\r\n                        {props.subtitleText && (\r\n                            <p>\r\n                                {props.subtitleText}\r\n                            </p>\r\n                        )}\r\n                        <div className='alert alert-danger'>\r\n                            <WarningIcon additionalClassName='mr-1'/>\r\n                            <strong>\r\n                                {props.modalMessage}\r\n                            </strong>\r\n                        </div>\r\n                    </>\r\n                ),\r\n                onConfirm: onDelete,\r\n                title: modalTitle,\r\n            },\r\n            dialogType: ConfirmModalRedux,\r\n        });\r\n    }, [confirmButtonText, modalMessage, modalTitle, onDelete, openModal]);\r\n\r\n    return (\r\n        <button\r\n            className='color--link style--none'\r\n            onClick={onClick}\r\n        >\r\n            {linkText}\r\n        </button>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport DeleteIntegrationLink from './delete_integration_link';\r\n\r\nconst mapDispatchToProps = {\r\n    openModal,\r\n};\r\n\r\nexport default connect(null, mapDispatchToProps)(DeleteIntegrationLink);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport DeleteIntegrationLink from 'components/integrations/delete_integration_link';\r\n\r\ntype Props = {\r\n    onDelete: () => void;\r\n}\r\n\r\nexport default function DeleteEmojiButton(props: Props) {\r\n    return (\r\n        <DeleteIntegrationLink\r\n            confirmButtonText={\r\n                <FormattedMessage\r\n                    id='emoji_list.delete.confirm.button'\r\n                    defaultMessage='Delete'\r\n                />\r\n            }\r\n            linkText={\r\n                <FormattedMessage\r\n                    id='emoji_list.delete'\r\n                    defaultMessage='Delete'\r\n                />\r\n            }\r\n            modalMessage={\r\n                <FormattedMessage\r\n                    id='emoji_list.delete.confirm.msg'\r\n                    defaultMessage='This action permanently deletes the custom emoji. Are you sure you want to delete it?'\r\n                />\r\n            }\r\n            modalTitle={\r\n                <FormattedMessage\r\n                    id='emoji_list.delete.confirm.title'\r\n                    defaultMessage='Delete Custom Emoji'\r\n                />\r\n            }\r\n            onDelete={props.onDelete}\r\n        />\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useMemo} from 'react';\r\n\r\nimport type {CustomEmoji} from '@mattermost/types/emojis';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\n\r\nimport AnyTeamPermissionGate from 'components/permissions_gates/any_team_permission_gate';\r\n\r\nimport DeleteEmojiButton from './delete_emoji_button';\r\n\r\nexport type Props = {\r\n    emoji?: CustomEmoji;\r\n    emojiId?: string;\r\n    currentUserId?: string;\r\n    creatorDisplayName?: string;\r\n    creatorUsername?: string;\r\n    onDelete?: (emojiId: string) => void;\r\n    actions: {\r\n        deleteCustomEmoji: (emojiId: string) => void;\r\n    };\r\n};\r\n\r\nconst DELETE_PERMISSION = [Permissions.DELETE_EMOJIS];\r\nconst DELETE_OTHER_PERMISSION = [Permissions.DELETE_OTHERS_EMOJIS];\r\n\r\nconst EmojiListItem = ({\r\n    actions: {\r\n        deleteCustomEmoji,\r\n    },\r\n    onDelete,\r\n    emoji = {} as CustomEmoji,\r\n    creatorUsername,\r\n    currentUserId = '',\r\n    creatorDisplayName = '',\r\n}: Props) => {\r\n    const emoticonStyle = useMemo(() => {\r\n        return {backgroundImage: `url(${Client4.getCustomEmojiImageUrl(emoji.id)})`};\r\n    }, [emoji.id]);\r\n\r\n    const handleDelete = useCallback((): void => {\r\n        if (!emoji) {\r\n            return;\r\n        }\r\n        if (onDelete) {\r\n            onDelete(emoji.id);\r\n        }\r\n        deleteCustomEmoji(emoji.id);\r\n    }, [deleteCustomEmoji, emoji, onDelete]);\r\n\r\n    let displayName = creatorDisplayName;\r\n    if (creatorUsername && creatorUsername !== displayName) {\r\n        displayName += ' (@' + creatorUsername + ')';\r\n    }\r\n\r\n    let deleteButton = <DeleteEmojiButton onDelete={handleDelete}/>;\r\n\r\n    if (emoji.creator_id === currentUserId) {\r\n        deleteButton = (\r\n            <AnyTeamPermissionGate permissions={DELETE_PERMISSION}>\r\n                {deleteButton}\r\n            </AnyTeamPermissionGate>\r\n        );\r\n    } else {\r\n        deleteButton = (\r\n            <AnyTeamPermissionGate permissions={DELETE_PERMISSION}>\r\n                <AnyTeamPermissionGate permissions={DELETE_OTHER_PERMISSION}>\r\n                    {deleteButton}\r\n                </AnyTeamPermissionGate>\r\n            </AnyTeamPermissionGate>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <tr className='backstage-list__item'>\r\n            <td className='emoji-list__name'>{':' + emoji.name + ':'}</td>\r\n            <td className='emoji-list__image'>\r\n                <span\r\n                    className='emoticon'\r\n                    style={emoticonStyle}\r\n                />\r\n            </td>\r\n            <td className='emoji-list__creator'>{displayName}</td>\r\n            <td className='emoji-list-item_actions'>{deleteButton}</td>\r\n        </tr>\r\n    );\r\n};\r\n\r\nexport default React.memo(EmojiListItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {deleteCustomEmoji} from 'mattermost-redux/actions/emojis';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getUser, getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {getDisplayNameByUser} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport EmojiListItem from './emoji_list_item';\r\nimport type {Props} from './emoji_list_item';\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const emoji = state.entities.emojis.customEmoji[ownProps.emojiId!];\r\n    const creator = getUser(state, emoji.creator_id);\r\n\r\n    return {\r\n        emoji,\r\n        creatorDisplayName: getDisplayNameByUser(state, creator),\r\n        creatorUsername: creator ? creator.username : '',\r\n        currentUserId: getCurrentUserId(state),\r\n        currentTeam: getCurrentTeam(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            deleteCustomEmoji,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EmojiListItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent, ChangeEventHandler} from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\n\r\nimport type {CustomEmoji} from '@mattermost/types/emojis';\r\n\r\nimport {deleteCustomEmoji} from 'mattermost-redux/actions/emojis';\r\nimport {Emoji} from 'mattermost-redux/constants';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport EmojiListItem from 'components/emoji/emoji_list_item';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport LocalizedPlaceholderInput from 'components/localized_placeholder_input';\r\nimport SaveButton from 'components/save_button';\r\nimport NextIcon from 'components/widgets/icons/fa_next_icon';\r\nimport PreviousIcon from 'components/widgets/icons/fa_previous_icon';\r\nimport SearchIcon from 'components/widgets/icons/fa_search_icon';\r\n\r\nconst EMOJI_PER_PAGE = 50;\r\nconst EMOJI_SEARCH_DELAY_MILLISECONDS = 200;\r\n\r\nexport interface Props {\r\n\r\n    /**\r\n     * Custom emojis on the system.\r\n     */\r\n    emojiIds: string[];\r\n\r\n    /**\r\n     * Function to scroll list to top.\r\n     */\r\n    scrollToTop: () => void;\r\n    actions: {\r\n\r\n        /**\r\n         * Get pages of custom emojis.\r\n         */\r\n        getCustomEmojis: (page?: number, perPage?: number, sort?: string, loadUsers?: boolean) => Promise<ActionResult<CustomEmoji[]>>;\r\n\r\n        /**\r\n         * Search custom emojis.\r\n         */\r\n        searchCustomEmojis: (term: string, options: any, loadUsers: boolean) => Promise<ActionResult<CustomEmoji[]>>;\r\n    };\r\n\r\n}\r\n\r\ninterface State {\r\n    loading: boolean;\r\n    page: number;\r\n    nextLoading: boolean;\r\n    searchEmojis: string[] | null;\r\n    missingPages: boolean;\r\n}\r\n\r\nexport default class EmojiList extends React.PureComponent<Props, State> {\r\n    private searchTimeout: NodeJS.Timeout | null;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.searchTimeout = null;\r\n        this.state = {\r\n            loading: true,\r\n            page: 0,\r\n            nextLoading: false,\r\n            searchEmojis: null,\r\n            missingPages: true,\r\n        };\r\n    }\r\n\r\n    async componentDidMount(): Promise<void> {\r\n        this.props.actions.getCustomEmojis(0, EMOJI_PER_PAGE + 1, Emoji.SORT_BY_NAME, true).\r\n            then(({data}: ActionResult<CustomEmoji[]>) => {\r\n                this.setState({loading: false});\r\n                if (data && data.length < EMOJI_PER_PAGE) {\r\n                    this.setState({missingPages: false});\r\n                }\r\n            });\r\n    }\r\n\r\n    nextPage = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>): void => {\r\n        if (e) {\r\n            e.preventDefault();\r\n        }\r\n\r\n        const next = this.state.page + 1;\r\n        this.setState({nextLoading: true});\r\n        this.props.actions.getCustomEmojis(next, EMOJI_PER_PAGE, Emoji.SORT_BY_NAME, true).\r\n            then(({data}: ActionResult<CustomEmoji[]>) => {\r\n                this.setState({page: next, nextLoading: false});\r\n                if (data && data.length < EMOJI_PER_PAGE) {\r\n                    this.setState({missingPages: false});\r\n                }\r\n\r\n                this.props.scrollToTop();\r\n            });\r\n    };\r\n    previousPage = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>): void => {\r\n        if (e) {\r\n            e.preventDefault();\r\n        }\r\n\r\n        this.setState({\r\n            page: this.state.page - 1,\r\n            nextLoading: false,\r\n            missingPages: true,\r\n        });\r\n\r\n        this.props.scrollToTop();\r\n    };\r\n\r\n    onSearchChange: ChangeEventHandler = (e: ChangeEvent): void => {\r\n        if (!e || !e.target) {\r\n            return;\r\n        }\r\n\r\n        const term = (e.target as HTMLInputElement).value || '';\r\n\r\n        clearTimeout(this.searchTimeout!);\r\n\r\n        this.searchTimeout = setTimeout(async () => {\r\n            if (term.trim() === '') {\r\n                this.setState({searchEmojis: null, page: 0});\r\n                return;\r\n            }\r\n\r\n            this.setState({loading: true});\r\n\r\n            const {data} = await this.props.actions.searchCustomEmojis(\r\n                term,\r\n                {},\r\n                true,\r\n            );\r\n\r\n            if (data) {\r\n                this.setState({\r\n                    searchEmojis: data.map((em: CustomEmoji) => em.id),\r\n                    loading: false,\r\n                });\r\n            } else {\r\n                this.setState({searchEmojis: [], loading: false});\r\n            }\r\n        }, EMOJI_SEARCH_DELAY_MILLISECONDS);\r\n    };\r\n\r\n    deleteFromSearch = (emojiId: string): void => {\r\n        if (!this.state.searchEmojis) {\r\n            return;\r\n        }\r\n\r\n        const index = this.state.searchEmojis.indexOf(emojiId);\r\n\r\n        if (index < 0) {\r\n            return;\r\n        }\r\n\r\n        const newSearchEmojis = [...this.state.searchEmojis];\r\n        newSearchEmojis.splice(index, 1);\r\n        this.setState({searchEmojis: newSearchEmojis});\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        const searchEmojis = this.state.searchEmojis;\r\n        const emojis = [];\r\n        let nextButton;\r\n        let previousButton;\r\n\r\n        if (this.state.loading) {\r\n            emojis.push(\r\n                <tr\r\n                    key='loading'\r\n                    className='backstage-list__item backstage-list__empty'\r\n                >\r\n                    <td colSpan={4}>\r\n                        <LoadingScreen key='loading'/>\r\n                    </td>\r\n                </tr>,\r\n            );\r\n        } else if (\r\n            this.props.emojiIds.length === 0 ||\r\n            (searchEmojis && searchEmojis.length === 0)\r\n        ) {\r\n            emojis.push(\r\n                <tr\r\n                    key='empty'\r\n                    className='backstage-list__item backstage-list__empty'\r\n                >\r\n                    <td colSpan={4}>\r\n                        <FormattedMessage\r\n                            id='emoji_list.empty'\r\n                            defaultMessage='No custom emoji found'\r\n                        />\r\n                    </td>\r\n                </tr>,\r\n            );\r\n        } else if (searchEmojis) {\r\n            searchEmojis.forEach((emojiId: string) => {\r\n                emojis.push(\r\n                    <EmojiListItem\r\n                        key={'emoji_search_item' + emojiId}\r\n                        emojiId={emojiId}\r\n                        onDelete={this.deleteFromSearch}\r\n                        actions={{deleteCustomEmoji}}\r\n                    />,\r\n                );\r\n            });\r\n        } else {\r\n            const pageStart = this.state.page * EMOJI_PER_PAGE;\r\n            const pageEnd = pageStart + EMOJI_PER_PAGE;\r\n            const emojisToDisplay = this.props.emojiIds.slice(pageStart, pageEnd);\r\n\r\n            emojisToDisplay.forEach((emojiId: string) => {\r\n                emojis.push(\r\n                    <EmojiListItem\r\n                        key={'emoji_list_item' + emojiId}\r\n                        emojiId={emojiId}\r\n                        actions={{deleteCustomEmoji}}\r\n                    />,\r\n                );\r\n            });\r\n\r\n            if (this.state.missingPages) {\r\n                const buttonContents = (\r\n                    <span>\r\n                        <FormattedMessage\r\n                            id='filtered_user_list.next'\r\n                            defaultMessage='Next'\r\n                        />\r\n                        <NextIcon additionalClassName='ml-2'/>\r\n                    </span>\r\n                );\r\n\r\n                nextButton = (\r\n                    <SaveButton\r\n                        btnClass='btn-tertiary'\r\n                        extraClasses='pull-right'\r\n                        onClick={this.nextPage}\r\n                        saving={this.state.nextLoading}\r\n                        disabled={this.state.nextLoading}\r\n                        defaultMessage={buttonContents}\r\n                        savingMessage={buttonContents}\r\n                    />\r\n                );\r\n            }\r\n\r\n            if (this.state.page > 0) {\r\n                previousButton = (\r\n                    <button\r\n                        className='btn btn-tertiary'\r\n                        onClick={this.previousPage}\r\n                    >\r\n                        <PreviousIcon additionalClassName='mr-2'/>\r\n                        <FormattedMessage\r\n                            id='filtered_user_list.prev'\r\n                            defaultMessage='Previous'\r\n                        />\r\n                    </button>\r\n                );\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='backstage-filters'>\r\n                    <div className='backstage-filter__search'>\r\n                        <SearchIcon/>\r\n                        <LocalizedPlaceholderInput\r\n                            type='search'\r\n                            className='form-control'\r\n                            placeholder={defineMessage({id: 'emoji_list.search', defaultMessage: 'Search Custom Emoji'})}\r\n                            onChange={this.onSearchChange}\r\n                            style={style.search}\r\n                        />\r\n                    </div>\r\n                </div>\r\n                <span className='backstage-list__help'>\r\n                    <p>\r\n                        <FormattedMessage\r\n                            id='emoji_list.help'\r\n                            defaultMessage=\"Custom emoji are available to everyone on your server. Type ':' followed by two characters in a message box to bring up the emoji selection menu.\"\r\n                        />\r\n                    </p>\r\n                    <p>\r\n                        <FormattedMessage\r\n                            id='emoji_list.help2'\r\n                            defaultMessage=\"Tip: If you add #, ##, or ### as the first character on a new line containing emoji, you can use larger sized emoji. To try it out, send a message such as: '# :smile:'.\"\r\n                        />\r\n                    </p>\r\n                </span>\r\n                <div className='backstage-list'>\r\n                    <table className='emoji-list__table'>\r\n                        <thead>\r\n                            <tr className='backstage-list__item emoji-list__table-header'>\r\n                                <th className='emoji-list__name'>\r\n                                    <FormattedMessage\r\n                                        id='emoji_list.name'\r\n                                        defaultMessage='Name'\r\n                                    />\r\n                                </th>\r\n                                <th className='emoji-list__image'>\r\n                                    <FormattedMessage\r\n                                        id='emoji_list.image'\r\n                                        defaultMessage='Image'\r\n                                    />\r\n                                </th>\r\n                                <th className='emoji-list__creator'>\r\n                                    <FormattedMessage\r\n                                        id='emoji_list.creator'\r\n                                        defaultMessage='Creator'\r\n                                    />\r\n                                </th>\r\n                                <th className='emoji-list_actions'>\r\n                                    <FormattedMessage\r\n                                        id='emoji_list.actions'\r\n                                        defaultMessage='Actions'\r\n                                    />\r\n                                </th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>{emojis}</tbody>\r\n                    </table>\r\n                </div>\r\n                <div className='filter-controls pt-3'>\r\n                    {previousButton}\r\n                    {nextButton}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst style = {\r\n    search: {flexGrow: 0, flexShrink: 0},\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getCustomEmojis, searchCustomEmojis} from 'mattermost-redux/actions/emojis';\r\nimport {getCustomEmojiIdsSortedByName} from 'mattermost-redux/selectors/entities/emojis';\r\n\r\nimport EmojiList from './emoji_list';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        emojiIds: getCustomEmojiIdsSortedByName(state) || [],\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getCustomEmojis,\r\n            searchCustomEmojis,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EmojiList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport type {Theme} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport AnyTeamPermissionGate from 'components/permissions_gates/any_team_permission_gate';\r\n\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport EmojiList from './emoji_list';\r\n\r\ntype Props = {\r\n    teamName?: string;\r\n    teamDisplayName?: string;\r\n    siteName?: string;\r\n    scrollToTop(): void;\r\n    currentTheme: Theme;\r\n    actions: {\r\n        loadRolesIfNeeded(roles: Iterable<string>): void;\r\n    };\r\n}\r\n\r\nconst CREATE_EMOJIS_PERMISSIONS = [Permissions.CREATE_EMOJIS];\r\nconst ROLES = ['system_admin', 'team_admin', 'system_user', 'team_user'];\r\n\r\nexport default function EmojiPage({\r\n    teamDisplayName = '',\r\n    teamName = '',\r\n    siteName = '',\r\n    scrollToTop,\r\n    currentTheme,\r\n    actions,\r\n}: Props) {\r\n    const intl = useIntl();\r\n\r\n    useEffect(() => {\r\n        updateTitle();\r\n        actions.loadRolesIfNeeded(ROLES);\r\n        Utils.resetTheme();\r\n\r\n        return () => {\r\n            Utils.applyTheme(currentTheme);\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        updateTitle();\r\n    }, [siteName]);\r\n\r\n    const updateTitle = () => {\r\n        document.title = intl.formatMessage({id: 'custom_emoji.header', defaultMessage: 'Custom Emoji'}) + ' - ' + teamDisplayName + ' ' + siteName;\r\n    };\r\n\r\n    return (\r\n        <div className='backstage-content emoji-list'>\r\n            <div className='backstage-header'>\r\n                <h1>\r\n                    <FormattedMessage\r\n                        id='emoji_list.header'\r\n                        defaultMessage='Custom Emoji'\r\n                    />\r\n                </h1>\r\n                <AnyTeamPermissionGate permissions={CREATE_EMOJIS_PERMISSIONS}>\r\n                    <Link\r\n                        className='add-link'\r\n                        to={'/' + teamName + '/emoji/add'}\r\n                    >\r\n                        <button\r\n                            type='button'\r\n                            className='btn btn-primary'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='emoji_list.add'\r\n                                defaultMessage='Add Custom Emoji'\r\n                            />\r\n                        </button>\r\n                    </Link>\r\n                </AnyTeamPermissionGate>\r\n            </div>\r\n            <EmojiList scrollToTop={scrollToTop}/>\r\n        </div>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {loadRolesIfNeeded} from 'mattermost-redux/actions/roles';\r\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport EmojiPage from 'components/emoji/emoji_page';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const team = getCurrentTeam(state);\r\n\r\n    return {\r\n        teamName: team?.name,\r\n        teamDisplayName: team?.display_name,\r\n        siteName: state.entities.general.config.SiteName,\r\n        currentTheme: getTheme(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadRolesIfNeeded,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EmojiPage);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\ntype Props = {\r\n    children?: ReactNode;\r\n}\r\n\r\nconst BackstageHeader = ({children}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n    const childrenElements: ReactNode[] = [];\r\n\r\n    React.Children.forEach(children, (child, index) => {\r\n        if (index !== 0) {\r\n            childrenElements.push(\r\n                <span\r\n                    key={'divider' + index}\r\n                    className='backstage-header__divider'\r\n                >\r\n                    <i\r\n                        className='fa fa-angle-right'\r\n                        title={formatMessage({id: 'generic_icons.breadcrumb', defaultMessage: 'Breadcrumb Icon'})}\r\n                    />\r\n                </span>,\r\n            );\r\n        }\r\n\r\n        childrenElements.push(child);\r\n    });\r\n\r\n    return (\r\n        <div className='backstage-header'>\r\n            <h1>\r\n                {childrenElements}\r\n            </h1>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BackstageHeader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent, FormEvent, SyntheticEvent} from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {CustomEmoji} from '@mattermost/types/emojis';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport {Constants} from 'utils/constants';\r\nimport type EmojiMap from 'utils/emoji_map';\r\n\r\nexport interface AddEmojiProps {\r\n    actions: {\r\n        createCustomEmoji: (term: CustomEmoji, imageData: File) => Promise<ActionResult>;\r\n    };\r\n    emojiMap: EmojiMap;\r\n    user: UserProfile;\r\n    team: Team;\r\n}\r\n\r\ntype EmojiCreateArgs = {\r\n    creator_id: string;\r\n    name: string;\r\n};\r\n\r\ntype AddEmojiState = {\r\n    name: string;\r\n    image: File | null;\r\n    imageUrl: string | ArrayBuffer | null;\r\n    saving: boolean;\r\n    error: React.ReactNode;\r\n};\r\n\r\ninterface AddErrorResponse {\r\n    error: Error;\r\n}\r\n\r\ninterface AddEmojiResponse {\r\n    data: CustomEmoji;\r\n}\r\n\r\nexport default class AddEmoji extends React.PureComponent<AddEmojiProps, AddEmojiState> {\r\n    constructor(props: AddEmojiProps) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            name: '',\r\n            image: null,\r\n            imageUrl: '',\r\n            saving: false,\r\n            error: null,\r\n        };\r\n    }\r\n\r\n    handleFormSubmit = async (e: FormEvent<HTMLFormElement>): Promise<void> => {\r\n        return this.handleSubmit(e);\r\n    };\r\n\r\n    handleSaveButtonClick = async (e: React.MouseEvent<HTMLButtonElement, MouseEvent>): Promise<void> => {\r\n        return this.handleSubmit(e);\r\n    };\r\n\r\n    handleSubmit = async (e: SyntheticEvent<unknown>): Promise<void> => {\r\n        const {actions, emojiMap, user, team} = this.props;\r\n        const {image, name, saving} = this.state;\r\n\r\n        e.preventDefault();\r\n\r\n        if (saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            error: null,\r\n        });\r\n\r\n        const emoji: EmojiCreateArgs = {\r\n            creator_id: user.id,\r\n            name: name.trim().toLowerCase(),\r\n        };\r\n\r\n        // trim surrounding colons if the user accidentally included them in the name\r\n        if (emoji.name.startsWith(':') && emoji.name.endsWith(':')) {\r\n            emoji.name = emoji.name.substring(1, emoji.name.length - 1);\r\n        }\r\n\r\n        if (!emoji.name) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.nameRequired'\r\n                        defaultMessage='A name is required for the emoji'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if ((/[^a-z0-9+_-]/).test(emoji.name)) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.nameInvalid'\r\n                        defaultMessage=\"An emoji's name can only contain lowercase letters, numbers, and the symbols '-', '+' and '_'.\"\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (emojiMap.hasSystemEmoji(emoji.name)) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.nameTaken'\r\n                        defaultMessage='This name is already in use by a system emoji. Please choose another name.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (emojiMap.has(emoji.name)) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.customNameTaken'\r\n                        defaultMessage='This name is already in use by a custom emoji. Please choose another name.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (!image) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.imageRequired'\r\n                        defaultMessage='An image is required for the emoji'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const maxFileSizeBytes = 1024 * 1024;\r\n        if (image.size > maxFileSizeBytes) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.imageTooLarge'\r\n                        defaultMessage='Unable to create emoji. Image must be less than 1 MB in size.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const response = await actions.createCustomEmoji(emoji as CustomEmoji, image);\r\n\r\n        if ('data' in response) {\r\n            const savedEmoji = response as AddEmojiResponse;\r\n            if (savedEmoji && savedEmoji.data.name === emoji.name) {\r\n                getHistory().push('/' + team.name + '/emoji');\r\n                return;\r\n            }\r\n        }\r\n\r\n        if ('error' in response) {\r\n            const responseError = response as AddErrorResponse;\r\n            if (responseError) {\r\n                this.setState({\r\n                    saving: false,\r\n                    error: responseError.error.message,\r\n                });\r\n\r\n                return;\r\n            }\r\n        }\r\n\r\n        const genericError = (\r\n            <FormattedMessage\r\n                id='add_emoji.failedToAdd'\r\n                defaultMessage='Something went wrong when adding the custom emoji.'\r\n            />\r\n        );\r\n\r\n        this.setState({\r\n            saving: false,\r\n            error: (genericError),\r\n        });\r\n    };\r\n\r\n    updateName = (e: ChangeEvent<HTMLInputElement>): void => {\r\n        this.setState({\r\n            name: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateImage = (e: ChangeEvent<HTMLInputElement>): void => {\r\n        if (e.target.files == null || e.target.files.length === 0) {\r\n            this.setState({\r\n                image: null,\r\n                imageUrl: '',\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const image = e.target.files![0];\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = () => {\r\n            this.setState({\r\n                image,\r\n                imageUrl: reader.result,\r\n            });\r\n        };\r\n        reader.readAsDataURL(image);\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        let filename = null;\r\n        if (this.state.image) {\r\n            filename = (\r\n                <span className='add-emoji__filename'>\r\n                    {this.state.image.name}\r\n                </span>\r\n            );\r\n        }\r\n\r\n        let preview = null;\r\n        if (this.state.imageUrl) {\r\n            preview = (\r\n                <div className='form-group'>\r\n                    <label\r\n                        className='control-label col-sm-4'\r\n                        htmlFor='preview'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='add_emoji.preview'\r\n                            defaultMessage='Preview'\r\n                        />\r\n                    </label>\r\n                    <div className='col-md-5 col-sm-8 add-emoji__preview'>\r\n                        <FormattedMessage\r\n                            id='add_emoji.preview.sentence'\r\n                            defaultMessage='This is a sentence with {image} in it.'\r\n                            values={{\r\n                                image: (\r\n                                    <span\r\n                                        className='emoticon'\r\n                                        style={{backgroundImage: 'url(' + this.state.imageUrl + ')'}}\r\n                                    />\r\n                                ),\r\n                            }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-content row'>\r\n                <BackstageHeader>\r\n                    <Link to={'/' + this.props.team.name + '/emoji'}>\r\n                        <FormattedMessage\r\n                            id='emoji_list.header'\r\n                            defaultMessage='Custom Emoji'\r\n                        />\r\n                    </Link>\r\n                    <FormattedMessage\r\n                        id='add_emoji.header'\r\n                        defaultMessage='Add'\r\n                    />\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={this.handleFormSubmit}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='name'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_emoji.name'\r\n                                    defaultMessage='Name'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='name'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.name}\r\n                                    onChange={this.updateName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_emoji.name.help'\r\n                                        defaultMessage=\"Name your emoji. The name can be up to 64 characters, and can contain lowercase letters, numbers, and the symbols '-' and '_'.\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='image'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_emoji.image'\r\n                                    defaultMessage='Image'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <div>\r\n                                    <div className='add-emoji__upload'>\r\n                                        <button className='btn btn-primary'>\r\n                                            <FormattedMessage\r\n                                                id='add_emoji.image.button'\r\n                                                defaultMessage='Select'\r\n                                            />\r\n                                        </button>\r\n                                        <input\r\n                                            id='select-emoji'\r\n                                            type='file'\r\n                                            accept={Constants.ACCEPT_EMOJI_IMAGE}\r\n                                            multiple={false}\r\n                                            onChange={this.updateImage}\r\n                                        />\r\n                                    </div>\r\n                                    {filename}\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_emoji.image.help'\r\n                                            defaultMessage='Specify a .gif, .png, or .jpg file of up to 64 KB for your emoji. The dimensions can be up to 128 pixels by 128 pixels.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        {preview}\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                error={this.state.error}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={'/' + this.props.team.name + '/emoji'}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_emoji.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                data-testid='save-button'\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={defineMessage({id: 'add_emoji.saving', defaultMessage: 'Saving...'})}\r\n                                onClick={this.handleSaveButtonClick}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_emoji.save'\r\n                                    defaultMessage='Save'\r\n                                />\r\n                            </SpinnerButton>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {createCustomEmoji} from 'mattermost-redux/actions/emojis';\r\n\r\nimport {getEmojiMap} from 'selectors/emojis';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport AddEmoji from './add_emoji';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        emojiMap: getEmojiMap(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createCustomEmoji,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AddEmoji);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {Link} from 'react-router-dom';\r\n\r\ntype Props = {\r\n    image: string;\r\n    title: JSX.Element;\r\n    description: JSX.Element;\r\n    link: string;\r\n}\r\n\r\nconst IntegrationOption = ({image, title, description, link}: Props) => {\r\n    return (\r\n        <Link\r\n            to={link}\r\n            className='integration-option'\r\n        >\r\n            <img\r\n                alt={'integration image'}\r\n                className='integration-option__image'\r\n                src={image}\r\n            />\r\n            <div className='integration-option__title'>\r\n                {title}\r\n            </div>\r\n            <div className='integration-option__description'>\r\n                {description}\r\n            </div>\r\n        </Link>\r\n    );\r\n};\r\n\r\nexport default React.memo(IntegrationOption);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\n\r\nimport ExternalLink from 'components/external_link';\r\nimport SystemPermissionGate from 'components/permissions_gates/system_permission_gate';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\n\r\nimport BotAccountsIcon from 'images/bot_default_icon.png';\r\nimport IncomingWebhookIcon from 'images/incoming_webhook.jpg';\r\nimport OAuthIcon from 'images/oauth_icon.png';\r\nimport OutgoingOAuthConnectionsIcon from 'images/outgoing_oauth_connection.png';\r\nimport OutgoingWebhookIcon from 'images/outgoing_webhook.jpg';\r\nimport SlashCommandIcon from 'images/slash_command_icon.jpg';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport IntegrationOption from './integration_option';\r\n\r\ntype Props = {\r\n    siteName: string | undefined;\r\n    enableIncomingWebhooks: boolean;\r\n    enableOutgoingWebhooks: boolean;\r\n    enableCommands: boolean;\r\n    enableOAuthServiceProvider: boolean;\r\n    enableOutgoingOAuthConnections: boolean;\r\n    team: Team;\r\n}\r\n\r\nexport default class Integrations extends React.PureComponent <Props> {\r\n    componentDidMount() {\r\n        this.updateTitle();\r\n    }\r\n\r\n    updateTitle = () => {\r\n        const currentSiteName = this.props.siteName || '';\r\n        document.title = Utils.localizeMessage({id: 'admin.sidebar.integrations', defaultMessage: 'Integrations'}) + ' - ' + this.props.team.display_name + ' ' + currentSiteName;\r\n    };\r\n\r\n    render() {\r\n        const options = [];\r\n\r\n        if (this.props.enableIncomingWebhooks) {\r\n            options.push(\r\n                <TeamPermissionGate\r\n                    teamId={this.props.team.id}\r\n                    permissions={[Permissions.MANAGE_INCOMING_WEBHOOKS]}\r\n                    key='incomingWebhookPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='incomingWebhook'\r\n                        image={IncomingWebhookIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.incomingWebhook.title'\r\n                                defaultMessage='Incoming Webhooks'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.incomingWebhook.description'\r\n                                defaultMessage='Incoming webhooks allow external integrations to send messages'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/incoming_webhooks'}\r\n                    />\r\n                </TeamPermissionGate>,\r\n            );\r\n        }\r\n\r\n        if (this.props.enableOutgoingWebhooks) {\r\n            options.push(\r\n                <TeamPermissionGate\r\n                    teamId={this.props.team.id}\r\n                    permissions={[Permissions.MANAGE_OUTGOING_WEBHOOKS]}\r\n                    key='outgoingWebhookPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='outgoingWebhook'\r\n                        image={OutgoingWebhookIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.outgoingWebhook.title'\r\n                                defaultMessage='Outgoing Webhooks'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.outgoingWebhook.description'\r\n                                defaultMessage='Outgoing webhooks allow external integrations to receive and respond to messages'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/outgoing_webhooks'}\r\n                    />\r\n                </TeamPermissionGate>,\r\n            );\r\n        }\r\n\r\n        if (this.props.enableCommands) {\r\n            options.push(\r\n                <TeamPermissionGate\r\n                    teamId={this.props.team.id}\r\n                    permissions={[Permissions.MANAGE_SLASH_COMMANDS]}\r\n                    key='commandPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='command'\r\n                        image={SlashCommandIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.command.title'\r\n                                defaultMessage='Slash Commands'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.command.description'\r\n                                defaultMessage='Slash commands send events to an external integration'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/commands'}\r\n                    />\r\n                </TeamPermissionGate>,\r\n            );\r\n        }\r\n\r\n        if (this.props.enableOAuthServiceProvider) {\r\n            options.push(\r\n                <SystemPermissionGate\r\n                    permissions={[Permissions.MANAGE_OAUTH]}\r\n                    key='oauth2AppsPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='oauth2Apps'\r\n                        image={OAuthIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.oauthApps.title'\r\n                                defaultMessage='OAuth 2.0 Applications'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.oauthApps.description'\r\n                                defaultMessage='Auth 2.0 allows external applications to make authorized requests to the Mattermost API'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/oauth2-apps'}\r\n                    />\r\n                </SystemPermissionGate>,\r\n            );\r\n        }\r\n\r\n        if (this.props.enableOutgoingOAuthConnections) {\r\n            options.push(\r\n                <TeamPermissionGate\r\n                    teamId={this.props.team.id}\r\n                    permissions={[Permissions.MANAGE_OUTGOING_OAUTH_CONNECTIONS]}\r\n                    key='outgoingOAuthConnectionsPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='outgoingOAuthConnections'\r\n                        image={OutgoingOAuthConnectionsIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.outgoingOAuthConnections.title'\r\n                                defaultMessage='Outgoing OAuth Connections'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.outgoingOAuthConnections.description'\r\n                                defaultMessage='Outgoing OAuth Connections allow custom integrations to communicate to external systems'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/outgoing-oauth2-connections'}\r\n                    />\r\n                </TeamPermissionGate>,\r\n            );\r\n        }\r\n\r\n        options.push(\r\n            <SystemPermissionGate\r\n                permissions={['manage_bots']}\r\n                key='botsPermissions'\r\n            >\r\n                <IntegrationOption\r\n                    image={BotAccountsIcon}\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='bots.manage.header'\r\n                            defaultMessage='Bot Accounts'\r\n                        />\r\n                    }\r\n                    description={\r\n                        <FormattedMessage\r\n                            id='bots.manage.description'\r\n                            defaultMessage='Use bot accounts to integrate with Mattermost through plugins or the API'\r\n                        />\r\n                    }\r\n                    link={'/' + this.props.team.name + '/integrations/bots'}\r\n                />\r\n            </SystemPermissionGate>,\r\n        );\r\n\r\n        return (\r\n            <div className='backstage-content row'>\r\n                <div className='backstage-header'>\r\n                    <h1>\r\n                        <FormattedMessage\r\n                            id='integrations.header'\r\n                            defaultMessage='Integrations'\r\n                        />\r\n                    </h1>\r\n                </div>\r\n                <div className='backstage-list__help'>\r\n                    <FormattedMessage\r\n                        id='integrations.help'\r\n                        defaultMessage='Visit the {appDirectory} to find self-hosted, third-party apps and integrations for Mattermost.'\r\n                        values={{\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace'\r\n                                    location='integrations'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='integrations.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                </div>\r\n                <div className='integrations-list d-flex flex-wrap'>\r\n                    {options}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport Integrations from './integrations';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const siteName = config.SiteName;\r\n    const enableIncomingWebhooks = config.EnableIncomingWebhooks === 'true';\r\n    const enableOutgoingWebhooks = config.EnableOutgoingWebhooks === 'true';\r\n    const enableCommands = config.EnableCommands === 'true';\r\n    const enableOAuthServiceProvider = config.EnableOAuthServiceProvider === 'true';\r\n    const enableOutgoingOAuthConnections = config.EnableOutgoingOAuthConnections === 'true';\r\n\r\n    return {\r\n        siteName,\r\n        enableIncomingWebhooks,\r\n        enableOutgoingWebhooks,\r\n        enableCommands,\r\n        enableOAuthServiceProvider,\r\n        enableOutgoingOAuthConnections,\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(Integrations);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\nimport type {ChangeEventHandler} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    channels: Channel[];\r\n    onChange?: ChangeEventHandler<HTMLSelectElement>;\r\n    value?: string;\r\n    selectOpen: boolean;\r\n    selectPrivate: boolean;\r\n    selectDm: boolean;\r\n};\r\n\r\nconst ChannelSelect = ({\r\n    channels,\r\n    selectOpen,\r\n    selectPrivate,\r\n    selectDm,\r\n    value,\r\n    onChange,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    const options = [\r\n        <option\r\n            key=''\r\n            value=''\r\n        >\r\n            {intl.formatMessage({\r\n                id: 'channel_select.placeholder',\r\n                defaultMessage: '--- Select a channel ---',\r\n            })}\r\n        </option>,\r\n    ];\r\n\r\n    channels.forEach((channel: Channel) => {\r\n        const channelName = channel.display_name || channel.name;\r\n        if (channel.type === Constants.OPEN_CHANNEL && selectOpen) {\r\n            options.push(\r\n                <option\r\n                    key={channel.id}\r\n                    value={channel.id}\r\n                >\r\n                    {channelName}\r\n                </option>,\r\n            );\r\n        } else if (channel.type === Constants.PRIVATE_CHANNEL && selectPrivate) {\r\n            options.push(\r\n                <option\r\n                    key={channel.id}\r\n                    value={channel.id}\r\n                >\r\n                    {channelName}\r\n                </option>,\r\n            );\r\n        } else if (channel.type === Constants.DM_CHANNEL && selectDm) {\r\n            options.push(\r\n                <option\r\n                    key={channel.id}\r\n                    value={channel.id}\r\n                >\r\n                    {channelName}\r\n                </option>,\r\n            );\r\n        }\r\n    });\r\n\r\n    return (\r\n        <select\r\n            className='form-control'\r\n            value={value}\r\n            onChange={onChange}\r\n            id='channelSelect'\r\n        >\r\n            {options}\r\n        </select>\r\n    );\r\n};\r\n\r\nexport default memo(ChannelSelect);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getMyChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentUserLocale} from 'mattermost-redux/selectors/entities/i18n';\r\nimport {sortChannelsByTypeAndDisplayName} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport ChannelSelect from './channel_select';\r\n\r\nconst getMyChannelsSorted = createSelector(\r\n    'getMyChannelsSorted',\r\n    getMyChannels,\r\n    getCurrentUserLocale,\r\n    (channels, locale) => {\r\n        const activeChannels = channels.filter((channel) => channel.delete_at === 0);\r\n        return [...activeChannels].sort(sortChannelsByTypeAndDisplayName.bind(null, locale));\r\n    },\r\n);\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        channels: getMyChannelsSorted(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(ChannelSelect);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {PureComponent} from 'react';\r\nimport type {ChangeEventHandler, FormEvent, MouseEvent} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {IncomingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ChannelSelect from 'components/channel_select';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\ninterface State {\r\n    displayName: string;\r\n    description: string;\r\n    channelId: string;\r\n    channelLocked: boolean;\r\n    username: string;\r\n    iconURL: string;\r\n    saving: boolean;\r\n    serverError: string;\r\n    clientError: JSX.Element | null;\r\n}\r\n\r\ninterface Props {\r\n\r\n    /**\r\n    * The current team\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * The header text to render, has id and defaultMessage\r\n    */\r\n    header: MessageDescriptor;\r\n\r\n    /**\r\n    * The footer text to render, has id and defaultMessage\r\n    */\r\n    footer: MessageDescriptor;\r\n\r\n    /**\r\n    * The spinner loading text to render, has id and defaultMessage\r\n    */\r\n    loading: MessageDescriptor;\r\n\r\n    /**\r\n    * The server error text after a failed action\r\n    */\r\n    serverError: string;\r\n\r\n    /**\r\n    * The hook used to set the initial state\r\n    */\r\n    initialHook?: IncomingWebhook;\r\n\r\n    /**\r\n    * Whether to allow configuration of the default post username.\r\n    */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n    * Whether to allow configuration of the default post icon.\r\n    */\r\n    enablePostIconOverride: boolean;\r\n\r\n    /**\r\n    * The async function to run when the action button is pressed\r\n    */\r\n    action: (hook: IncomingWebhook) => Promise<void>;\r\n}\r\n\r\nexport default class AbstractIncomingWebhook extends PureComponent<Props, State> {\r\n    constructor(props: Props | Readonly<Props>) {\r\n        super(props);\r\n\r\n        this.state = this.getStateFromHook(this.props.initialHook);\r\n    }\r\n\r\n    getStateFromHook = (hook?: IncomingWebhook) => {\r\n        return {\r\n            displayName: hook?.display_name || '',\r\n            description: hook?.description || '',\r\n            channelId: hook?.channel_id || '',\r\n            channelLocked: hook?.channel_locked || false,\r\n            username: hook?.username || '',\r\n            iconURL: hook?.icon_url || '',\r\n            saving: false,\r\n            serverError: '',\r\n            clientError: null,\r\n        };\r\n    };\r\n\r\n    handleSubmit = (e: MouseEvent<HTMLElement> | FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            serverError: '',\r\n            clientError: null,\r\n        });\r\n\r\n        if (!this.state.channelId) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_incoming_webhook.channelRequired'\r\n                        defaultMessage='A valid channel is required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const hook = {\r\n            channel_id: this.state.channelId,\r\n            channel_locked: this.state.channelLocked,\r\n            display_name: this.state.displayName,\r\n            description: this.state.description,\r\n            username: this.state.username,\r\n            icon_url: this.state.iconURL,\r\n            id: this.props.initialHook?.id || '',\r\n            create_at: this.props.initialHook?.create_at || 0,\r\n            update_at: this.props.initialHook?.update_at || 0,\r\n            delete_at: this.props.initialHook?.delete_at || 0,\r\n            team_id: this.props.initialHook?.team_id || '',\r\n            user_id: this.props.initialHook?.user_id || '',\r\n        };\r\n\r\n        this.props.action(hook).then(() => this.setState({saving: false}));\r\n    };\r\n\r\n    updateDisplayName: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            displayName: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDescription: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateChannelId: ChangeEventHandler<HTMLSelectElement> = (e) => {\r\n        this.setState({\r\n            channelId: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateChannelLocked: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            channelLocked: e.target.checked,\r\n        });\r\n    };\r\n\r\n    updateUsername: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            username: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateIconURL: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            iconURL: e.target.value,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        const headerToRender = this.props.header;\r\n        const footerToRender = this.props.footer;\r\n\r\n        return (\r\n            <div className='backstage-content'>\r\n                <BackstageHeader>\r\n                    <Link to={`/${this.props.team.name}/integrations/incoming_webhooks`}>\r\n                        <FormattedMessage\r\n                            id='incoming_webhooks.header'\r\n                            defaultMessage='Incoming Webhooks'\r\n                        />\r\n                    </Link>\r\n                    <FormattedMessage\r\n                        id={headerToRender.id}\r\n                        defaultMessage={headerToRender.defaultMessage}\r\n                    />\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={(e) => this.handleSubmit(e)}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='displayName'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_incoming_webhook.displayName'\r\n                                    defaultMessage='Title'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='displayName'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.displayName}\r\n                                    onChange={this.updateDisplayName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.displayName.help'\r\n                                        defaultMessage='Specify a title, of up to 64 characters, for the webhook settings page.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_incoming_webhook.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={500}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.description.help'\r\n                                        defaultMessage='Describe your incoming webhook.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='channelId'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_incoming_webhook.channel'\r\n                                    defaultMessage='Channel'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <ChannelSelect\r\n                                    value={this.state.channelId}\r\n                                    onChange={this.updateChannelId}\r\n                                    selectOpen={true}\r\n                                    selectPrivate={true}\r\n                                    selectDm={false}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.channel.help'\r\n                                        defaultMessage='This is the default public or private channel that receives the webhook payloads. When setting up the webhook, you must belong to the private channel.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='channelLocked'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_incoming_webhook.channelLocked'\r\n                                    defaultMessage='Lock to this channel'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8 checkbox'>\r\n                                <input\r\n                                    id='channelLocked'\r\n                                    type='checkbox'\r\n                                    checked={this.state.channelLocked}\r\n                                    onChange={this.updateChannelLocked}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.channelLocked.help'\r\n                                        defaultMessage='If set, the incoming webhook can post only to the selected channel.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        { this.props.enablePostUsernameOverride &&\r\n                            <div className='form-group'>\r\n                                <label\r\n                                    className='control-label col-sm-4'\r\n                                    htmlFor='username'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.username'\r\n                                        defaultMessage='Username'\r\n                                    />\r\n                                </label>\r\n                                <div className='col-md-5 col-sm-8'>\r\n                                    <input\r\n                                        id='username'\r\n                                        type='text'\r\n                                        maxLength={22}\r\n                                        className='form-control'\r\n                                        value={this.state.username}\r\n                                        onChange={this.updateUsername}\r\n                                    />\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_incoming_webhook.username.help'\r\n                                            defaultMessage='Specify the username this integration will post as. Usernames can be up to 22 characters, and can contain lowercase letters, numbers and the symbols \\\"-\\\", \\\"_\\\", and \\\".\\\". If left blank, the name specified by the webhook creator is used.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        { this.props.enablePostIconOverride &&\r\n                            <div className='form-group'>\r\n                                <label\r\n                                    className='control-label col-sm-4'\r\n                                    htmlFor='iconURL'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.icon_url'\r\n                                        defaultMessage='Profile Picture'\r\n                                    />\r\n                                </label>\r\n                                <div className='col-md-5 col-sm-8'>\r\n                                    <input\r\n                                        id='iconURL'\r\n                                        type='text'\r\n                                        maxLength={1024}\r\n                                        className='form-control'\r\n                                        value={this.state.iconURL}\r\n                                        onChange={this.updateIconURL}\r\n                                    />\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_incoming_webhook.icon_url.help'\r\n                                            defaultMessage='Enter the URL of a .png or .jpg file for the profile picture of this integration when posting. The file should be at least 128 pixels by 128 pixels. If left blank, the profile picture specified by the webhook creator is used.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.props.serverError, this.state.clientError]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={`/${this.props.team.name}/integrations/incoming_webhooks`}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_incoming_webhook.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={this.props.loading}\r\n                                onClick={(e) => this.handleSubmit(e)}\r\n                                id='saveWebhook'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id={footerToRender.id}\r\n                                    defaultMessage={footerToRender.defaultMessage}\r\n                                />\r\n                            </SpinnerButton>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback, useState} from 'react';\r\nimport {defineMessages} from 'react-intl';\r\n\r\nimport type {IncomingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AbstractIncomingWebhook from 'components/integrations/abstract_incoming_webhook';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'add_incoming_webhook.save',\r\n        defaultMessage: 'Save',\r\n    },\r\n    header: {\r\n        id: 'integrations.add',\r\n        defaultMessage: 'Add',\r\n    },\r\n    loading: {\r\n        id: 'add_incoming_webhook.saving',\r\n        defaultMessage: 'Saving...',\r\n    },\r\n});\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    * The current team\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * Whether to allow configuration of the default post username.\r\n    */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n    * Whether to allow configuration of the default post icon.\r\n    */\r\n    enablePostIconOverride: boolean;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to add a new incoming webhook\r\n        */\r\n        createIncomingHook: (hook: IncomingWebhook) => Promise<ActionResult<IncomingWebhook>>;\r\n    };\r\n};\r\n\r\nconst AddIncomingWebhook = ({\r\n    team,\r\n    enablePostUsernameOverride,\r\n    enablePostIconOverride,\r\n    actions,\r\n}: Props) => {\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const addIncomingHook = useCallback(async (hook: IncomingWebhook) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = await actions.createIncomingHook(hook);\r\n        if (data) {\r\n            getHistory().push(`/${team.name}/integrations/confirm?type=incoming_webhooks&id=${data.id}`);\r\n            return;\r\n        }\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    }, [actions, team.name]);\r\n\r\n    return (\r\n        <AbstractIncomingWebhook\r\n            team={team}\r\n            header={messages.header}\r\n            footer={messages.footer}\r\n            loading={messages.loading}\r\n            enablePostUsernameOverride={enablePostUsernameOverride}\r\n            enablePostIconOverride={enablePostIconOverride}\r\n            action={addIncomingHook}\r\n            serverError={serverError}\r\n        />\r\n    );\r\n};\r\nexport default memo(AddIncomingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {createIncomingHook} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport AddIncomingWebhook from './add_incoming_webhook';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\r\n    const enablePostIconOverride = config.EnablePostIconOverride === 'true';\r\n\r\n    return {\r\n        enablePostUsernameOverride,\r\n        enablePostIconOverride,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createIncomingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AddIncomingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChangeEvent, FormEvent} from 'react';\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport FormError from 'components/form_error';\r\nimport SystemPermissionGate from 'components/permissions_gates/system_permission_gate';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n   * The current team\r\n   */\r\n    team: Team;\r\n\r\n    /**\r\n   * The header text to render, has id and defaultMessage\r\n   */\r\n    header: MessageDescriptor;\r\n\r\n    /**\r\n   * The footer text to render, has id and defaultMessage\r\n   */\r\n    footer: MessageDescriptor;\r\n\r\n    /**\r\n   * The spinner loading text to render, has id and defaultMessage\r\n   */\r\n    loading: MessageDescriptor;\r\n\r\n    /**\r\n   * Any extra component/node to render\r\n   */\r\n    renderExtra?: JSX.Element;\r\n\r\n    /**\r\n    * The server error text after a failed action\r\n    */\r\n    serverError: string;\r\n\r\n    /**\r\n   * The OAuthApp used to set the initial state\r\n   */\r\n    initialApp?: OAuthApp;\r\n\r\n    /**\r\n    * The async function to run when the action button is pressed\r\n    */\r\n    action: (app: OAuthApp) => Promise<void>;\r\n\r\n}\r\n\r\ntype State = {\r\n    name: string;\r\n    description: string;\r\n    homepage: string;\r\n    icon_url: string;\r\n    callbackUrls: string;\r\n    is_trusted: boolean;\r\n    has_icon: boolean;\r\n    saving: boolean;\r\n    clientError: JSX.Element | null | string;\r\n};\r\n\r\nexport default class AbstractOAuthApp extends React.PureComponent<Props, State> {\r\n    private image: HTMLImageElement;\r\n    private icon_url: React.RefObject<HTMLInputElement>;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.image = new Image();\r\n        this.image.onload = this.imageLoaded;\r\n        this.icon_url = React.createRef();\r\n        this.state = this.getStateFromApp(this.props.initialApp || {} as OAuthApp);\r\n    }\r\n\r\n    getStateFromApp = (app: OAuthApp) => {\r\n        return {\r\n            name: app.name || '',\r\n            description: app.description || '',\r\n            homepage: app.homepage || '',\r\n            icon_url: app.icon_url || '',\r\n            callbackUrls: app.callback_urls ? app.callback_urls.join('\\n') : '',\r\n            is_trusted: app.is_trusted || false,\r\n            has_icon: Boolean(app.icon_url),\r\n            saving: false,\r\n            clientError: null,\r\n        };\r\n    };\r\n\r\n    imageLoaded = () => {\r\n        if (this.icon_url.current?.value) {\r\n            this.setState({\r\n                has_icon: true,\r\n                icon_url: this.icon_url.current.value,\r\n            });\r\n        }\r\n    };\r\n\r\n    handleSubmit = (e: FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            clientError: '',\r\n        });\r\n\r\n        if (!this.state.name) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.nameRequired'\r\n                        defaultMessage='Name for the OAuth 2.0 application is required.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (!this.state.description) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.descriptionRequired'\r\n                        defaultMessage='Description for the OAuth 2.0 application is required.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (!this.state.homepage) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.homepageRequired'\r\n                        defaultMessage='Homepage for the OAuth 2.0 application is required.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const callbackUrls = [];\r\n        for (let callbackUrl of this.state.callbackUrls.split('\\n')) {\r\n            callbackUrl = callbackUrl.trim();\r\n\r\n            if (callbackUrl.length > 0) {\r\n                callbackUrls.push(callbackUrl);\r\n            }\r\n        }\r\n\r\n        if (callbackUrls.length === 0) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.callbackUrlsRequired'\r\n                        defaultMessage='One or more callback URLs are required.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const app = {\r\n            name: this.state.name,\r\n            callback_urls: callbackUrls,\r\n            homepage: this.state.homepage,\r\n            description: this.state.description,\r\n            is_trusted: this.state.is_trusted,\r\n            icon_url: this.state.icon_url,\r\n        } as OAuthApp;\r\n\r\n        this.props.action(app).then(() => this.setState({saving: false}));\r\n    };\r\n\r\n    updateName = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            name: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateTrusted = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            is_trusted: e.target.value === 'true',\r\n        });\r\n    };\r\n\r\n    updateDescription = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateHomepage = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            homepage: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateIconUrl = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            has_icon: false,\r\n            icon_url: e.target.value,\r\n        });\r\n        this.image.src = e.target.value;\r\n    };\r\n\r\n    updateCallbackUrls = (e: ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.setState({\r\n            callbackUrls: e.target.value,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        const headerToRender = this.props.header;\r\n        const footerToRender = this.props.footer;\r\n        const renderExtra = this.props.renderExtra;\r\n\r\n        let icon;\r\n        if (this.state.has_icon) {\r\n            icon = (\r\n                <div className='integration__icon'>\r\n                    <img\r\n                        alt={'integration icon'}\r\n                        src={this.state.icon_url}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const trusted = (\r\n            <SystemPermissionGate permissions={[Permissions.MANAGE_SYSTEM]}>\r\n                <div className='form-group'>\r\n                    <label\r\n                        className='control-label col-sm-4'\r\n                        htmlFor='is_trusted'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='installed_oauth_apps.trusted'\r\n                            defaultMessage='Is Trusted'\r\n                        />\r\n                    </label>\r\n                    <div className='col-md-5 col-sm-8'>\r\n                        <label className='radio-inline'>\r\n                            <input\r\n                                type='radio'\r\n                                value='true'\r\n                                name='is_trusted'\r\n                                checked={this.state.is_trusted}\r\n                                onChange={this.updateTrusted}\r\n                            />\r\n                            <FormattedMessage\r\n                                id='installed_oauth_apps.trusted.yes'\r\n                                defaultMessage='Yes'\r\n                            />\r\n                        </label>\r\n                        <label className='radio-inline'>\r\n                            <input\r\n                                type='radio'\r\n                                value='false'\r\n                                name='is_trusted'\r\n                                checked={!this.state.is_trusted}\r\n                                onChange={this.updateTrusted}\r\n                            />\r\n                            <FormattedMessage\r\n                                id='installed_oauth_apps.trusted.no'\r\n                                defaultMessage='No'\r\n                            />\r\n                        </label>\r\n                        <div className='form__help'>\r\n                            <FormattedMessage\r\n                                id='add_oauth_app.trusted.help'\r\n                                defaultMessage='If true, the OAuth 2.0 application is considered trusted by the Mattermost server and does not require the user to accept authorization. If false, a window opens to ask the user to accept or deny the authorization.'\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </SystemPermissionGate>\r\n        );\r\n\r\n        return (\r\n            <div className='backstage-content'>\r\n                <BackstageHeader>\r\n                    <Link to={`/${this.props.team.name}/integrations/oauth2-apps`}>\r\n                        <FormattedMessage\r\n                            id='installed_oauth_apps.header'\r\n                            defaultMessage='Installed OAuth2 Apps'\r\n                        />\r\n                    </Link>\r\n                    <FormattedMessage\r\n                        id={headerToRender.id}\r\n                        defaultMessage={headerToRender.defaultMessage}\r\n                    />\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    {icon}\r\n                    <form className='form-horizontal'>\r\n                        {trusted}\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='name'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.name'\r\n                                    defaultMessage='Display Name'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='name'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.name}\r\n                                    onChange={this.updateName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.name.help'\r\n                                        defaultMessage='Specify the display name, of up to 64 characters, for your OAuth 2.0 application.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={512}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.description.help'\r\n                                        defaultMessage='Describe your OAuth 2.0 application.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='homepage'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.homepage'\r\n                                    defaultMessage='Homepage'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='homepage'\r\n                                    type='url'\r\n                                    maxLength={256}\r\n                                    className='form-control'\r\n                                    value={this.state.homepage}\r\n                                    onChange={this.updateHomepage}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.homepage.help'\r\n                                        defaultMessage='This is the URL for the homepage of the OAuth 2.0 application. Depending on your server configuration, use HTTP or HTTPS in the URL.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='icon_url'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.iconUrl'\r\n                                    defaultMessage='Icon URL'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='icon_url'\r\n                                    ref={this.icon_url}\r\n                                    type='url'\r\n                                    maxLength={512}\r\n                                    className='form-control'\r\n                                    value={this.state.icon_url}\r\n                                    onChange={this.updateIconUrl}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.icon.help'\r\n                                        defaultMessage='(Optional) The URL of the image used for your OAuth 2.0 application. Make sure you use HTTP or HTTPS in your URL.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='callbackUrls'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.callbackUrls'\r\n                                    defaultMessage='Callback URLs (One Per Line)'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <textarea\r\n                                    id='callbackUrls'\r\n                                    rows={3}\r\n                                    maxLength={1024}\r\n                                    className='form-control'\r\n                                    value={this.state.callbackUrls}\r\n                                    onChange={this.updateCallbackUrls}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.callbackUrls.help'\r\n                                        defaultMessage='The redirect URIs to which the service will redirect users after accepting or denying authorization of your application, and which will handle authorization codes or access tokens. Must be a valid URL and start with http:// or https://.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.props.serverError, this.state.clientError]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={`/${this.props.team.name}/integrations/oauth2-apps`}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={this.props.loading}\r\n                                onClick={this.handleSubmit}\r\n                                id='saveOauthApp'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id={footerToRender.id}\r\n                                    defaultMessage={footerToRender.defaultMessage}\r\n                                />\r\n                            </SpinnerButton>\r\n                            {renderExtra}\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport {defineMessages} from 'react-intl';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions.js';\r\n\r\nimport AbstractOAuthApp from '../abstract_oauth_app';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'installed_oauth_apps.save',\r\n        defaultMessage: 'Save',\r\n    },\r\n    header: {\r\n        id: 'add_oauth_app.header',\r\n        defaultMessage: 'Add',\r\n    },\r\n    loading: {\r\n        id: 'installed_oauth_apps.saving',\r\n        defaultMessage: 'Saving...',\r\n    },\r\n});\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n    * The team data\r\n    */\r\n    team: Team;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to add new OAuthApp\r\n        */\r\n        addOAuthApp: (app: OAuthApp) => Promise<ActionResult<OAuthApp>>;\r\n    };\r\n};\r\n\r\nconst AddOAuthApp = ({team, actions}: Props): JSX.Element => {\r\n    const history = useHistory();\r\n\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const addOAuthApp = async (app: OAuthApp) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = await actions.addOAuthApp(app);\r\n        if (data) {\r\n            history.push(`/${team.name}/integrations/confirm?type=oauth2-apps&id=${data.id}`);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AbstractOAuthApp\r\n            team={team}\r\n            header={messages.header}\r\n            footer={messages.footer}\r\n            loading={messages.loading}\r\n            action={addOAuthApp}\r\n            serverError={serverError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default AddOAuthApp;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {addOAuthApp} from 'mattermost-redux/actions/integrations';\r\n\r\nimport AddOAuthApp from './add_oauth_app';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            addOAuthApp,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(AddOAuthApp);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEventHandler, FormEvent, MouseEvent} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ChannelSelect from 'components/channel_select';\r\nimport ExternalLink from 'components/external_link';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\nimport {DocLinks} from 'utils/constants';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\ninterface State {\r\n    callbackUrls: string;\r\n    channelId: string;\r\n    clientError: JSX.Element | null;\r\n    contentType: string;\r\n    description: string;\r\n    displayName: string;\r\n    iconURL: string;\r\n    saving: boolean;\r\n    triggerWhen: number;\r\n    triggerWords: string;\r\n    username: string;\r\n}\r\n\r\ninterface Props {\r\n\r\n    /**\r\n     * The current team\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     * The header text to render, has id and defaultMessage\r\n     */\r\n    header: MessageDescriptor;\r\n\r\n    /**\r\n     * The footer text to render, has id and defaultMessage\r\n     */\r\n    footer: MessageDescriptor;\r\n\r\n    /**\r\n    * The spinner loading text to render, has id and defaultMessage\r\n    */\r\n    loading: MessageDescriptor;\r\n\r\n    /**\r\n     * Any extra component/node to render\r\n     */\r\n    renderExtra: React.ReactNode;\r\n\r\n    /**\r\n     * The server error text after a failed action\r\n     */\r\n    serverError: string;\r\n\r\n    /**\r\n     * The hook used to set the initial state\r\n     */\r\n    initialHook?: OutgoingWebhook;\r\n\r\n    /**\r\n     * The async function to run when the action button is pressed\r\n     */\r\n    action: (hook: OutgoingWebhook) => Promise<void>;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post username.\r\n     */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post icon.\r\n     */\r\n    enablePostIconOverride: boolean;\r\n}\r\n\r\nexport default class AbstractOutgoingWebhook extends React.PureComponent<Props, State> {\r\n    constructor(props: Props | Readonly<Props>) {\r\n        super(props);\r\n\r\n        this.state = this.getStateFromHook(this.props.initialHook);\r\n    }\r\n\r\n    getStateFromHook = (hook?: OutgoingWebhook) => {\r\n        let triggerWords = '';\r\n        if (hook?.trigger_words) {\r\n            let i = 0;\r\n            for (i = 0; i < hook.trigger_words.length; i++) {\r\n                triggerWords += hook.trigger_words[i] + '\\n';\r\n            }\r\n        }\r\n\r\n        let callbackUrls = '';\r\n        if (hook?.callback_urls) {\r\n            let i = 0;\r\n            for (i = 0; i < hook.callback_urls.length; i++) {\r\n                callbackUrls += hook.callback_urls[i] + '\\n';\r\n            }\r\n        }\r\n\r\n        return {\r\n            displayName: hook?.display_name || '',\r\n            description: hook?.description || '',\r\n            contentType: hook?.content_type || 'application/x-www-form-urlencoded',\r\n            channelId: hook?.channel_id || '',\r\n            triggerWords,\r\n            triggerWhen: hook?.trigger_when || 0,\r\n            callbackUrls,\r\n            saving: false,\r\n            clientError: null,\r\n            username: hook?.username || '',\r\n            iconURL: hook?.icon_url || '',\r\n        };\r\n    };\r\n\r\n    handleSubmit = (e: MouseEvent<HTMLElement> | FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            clientError: null,\r\n        });\r\n\r\n        const triggerWords = [];\r\n        if (this.state.triggerWords) {\r\n            for (let triggerWord of this.state.triggerWords.split('\\n')) {\r\n                triggerWord = triggerWord.trim();\r\n\r\n                if (triggerWord.length > 0) {\r\n                    triggerWords.push(triggerWord);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!this.state.channelId && triggerWords.length === 0) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_outgoing_webhook.triggerWordsOrChannelRequired'\r\n                        defaultMessage='A valid channel or a list of trigger words is required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const callbackUrls = [];\r\n        for (let callbackUrl of this.state.callbackUrls.split('\\n')) {\r\n            callbackUrl = callbackUrl.trim();\r\n\r\n            if (callbackUrl.length > 0) {\r\n                callbackUrls.push(callbackUrl);\r\n            }\r\n        }\r\n\r\n        if (callbackUrls.length === 0) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_outgoing_webhook.callbackUrlsRequired'\r\n                        defaultMessage='One or more callback URLs are required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const hook = {\r\n            team_id: this.props.team.id,\r\n            channel_id: this.state.channelId,\r\n            trigger_words: triggerWords,\r\n            trigger_when: this.state.triggerWhen,\r\n            callback_urls: callbackUrls,\r\n            display_name: this.state.displayName,\r\n            content_type: this.state.contentType,\r\n            description: this.state.description,\r\n            username: this.state.username,\r\n            icon_url: this.state.iconURL,\r\n            id: this.props.initialHook?.id || '',\r\n            create_at: this.props.initialHook?.create_at || 0,\r\n            update_at: this.props.initialHook?.update_at || 0,\r\n            delete_at: this.props.initialHook?.delete_at || 0,\r\n            creator_id: this.props.initialHook?.creator_id || '',\r\n            token: this.props.initialHook?.token || '',\r\n        };\r\n\r\n        this.props.action(hook).then(() => this.setState({saving: false}));\r\n    };\r\n\r\n    updateDisplayName: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            displayName: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDescription: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateContentType: ChangeEventHandler<HTMLSelectElement> = (e) => {\r\n        this.setState({\r\n            contentType: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateChannelId: ChangeEventHandler<HTMLSelectElement> = (e) => {\r\n        this.setState({\r\n            channelId: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateTriggerWords: ChangeEventHandler<HTMLTextAreaElement> = (e) => {\r\n        this.setState({\r\n            triggerWords: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateTriggerWhen: ChangeEventHandler<HTMLSelectElement> = (e) => {\r\n        this.setState({\r\n            triggerWhen: parseInt(e.target.value, 10),\r\n        });\r\n    };\r\n\r\n    updateCallbackUrls: ChangeEventHandler<HTMLTextAreaElement> = (e) => {\r\n        this.setState({\r\n            callbackUrls: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateUsername: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            username: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateIconURL: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            iconURL: e.target.value,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        const contentTypeOption1 = 'application/x-www-form-urlencoded';\r\n        const contentTypeOption2 = 'application/json';\r\n\r\n        const headerToRender = this.props.header;\r\n        const footerToRender = this.props.footer;\r\n        const renderExtra = this.props.renderExtra;\r\n\r\n        return (\r\n            <div className='backstage-content'>\r\n                <BackstageHeader>\r\n                    <Link to={`/${this.props.team.name}/integrations/outgoing_webhooks`}>\r\n                        <FormattedMessage\r\n                            id='add_outgoing_webhook.header'\r\n                            defaultMessage='Outgoing Webhooks'\r\n                        />\r\n                    </Link>\r\n                    <FormattedMessage\r\n                        id={headerToRender.id}\r\n                        defaultMessage={headerToRender.defaultMessage}\r\n                    />\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={this.handleSubmit}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='displayName'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.displayName'\r\n                                    defaultMessage='Title'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='displayName'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.displayName}\r\n                                    onChange={this.updateDisplayName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.displayName.help'\r\n                                        defaultMessage='Specify a title, of up to 64 characters, for the webhook settings page.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={500}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.description.help'\r\n                                        defaultMessage='Describe your outgoing webhook.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='contentType'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.content_Type'\r\n                                    defaultMessage='Content Type'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <select\r\n                                    className='form-control'\r\n                                    value={this.state.contentType}\r\n                                    onChange={this.updateContentType}\r\n                                >\r\n                                    <option\r\n                                        value={contentTypeOption1}\r\n                                    >\r\n                                        {contentTypeOption1}\r\n                                    </option>\r\n                                    <option\r\n                                        value={contentTypeOption2}\r\n                                    >\r\n                                        {contentTypeOption2}\r\n                                    </option>\r\n                                </select>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.contentType.help1'\r\n                                        defaultMessage='Specify the content type by which to send the request.'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.contentType.help2'\r\n                                        defaultMessage='For the server to encode the parameters in a URL format in the request body, select application/x-www-form-urlencoded.'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.contentType.help3'\r\n                                        defaultMessage='For the server to format the request body as JSON, select application/json.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='channelId'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.channel'\r\n                                    defaultMessage='Channel'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <ChannelSelect\r\n                                    value={this.state.channelId}\r\n                                    onChange={this.updateChannelId}\r\n                                    selectOpen={true}\r\n                                    selectPrivate={false}\r\n                                    selectDm={false}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.channel.help'\r\n                                        defaultMessage='This field is optional if you specify at least one trigger word. Specify the public channel that delivers the payload to the webhook.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='triggerWords'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.triggerWords'\r\n                                    defaultMessage='Trigger Words (One Per Line)'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <textarea\r\n                                    id='triggerWords'\r\n                                    rows={3}\r\n                                    maxLength={1000}\r\n                                    className='form-control'\r\n                                    value={this.state.triggerWords}\r\n                                    onChange={this.updateTriggerWords}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.triggerWords.help'\r\n                                        defaultMessage='Specify the trigger words that send an HTTP POST request to your application. The trigger can be for the channel, the outgoing webhook, or both. If you select only Channel, trigger words are optional. If you select both, the message must match both values.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='triggerWords'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.triggerWordsTriggerWhen'\r\n                                    defaultMessage='Trigger When'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <select\r\n                                    id='triggerWhen'\r\n                                    className='form-control'\r\n                                    value={this.state.triggerWhen}\r\n                                    onChange={this.updateTriggerWhen}\r\n                                >\r\n                                    <option\r\n                                        value='0'\r\n                                    >\r\n                                        {localizeMessage({id: 'add_outgoing_webhook.triggerWordsTriggerWhenFullWord', defaultMessage: 'First word matches a trigger word exactly'})}\r\n                                    </option>\r\n                                    <option\r\n                                        value='1'\r\n                                    >\r\n                                        {localizeMessage({id: 'add_outgoing_webhook.triggerWordsTriggerWhenStartsWith', defaultMessage: 'First word starts with a trigger word'})}\r\n                                    </option>\r\n                                </select>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.triggerWordsTriggerWhen.help'\r\n                                        defaultMessage='Specify when to trigger the outgoing webhook.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='callbackUrls'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.callbackUrls'\r\n                                    defaultMessage='Callback URLs (One Per Line)'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <textarea\r\n                                    id='callbackUrls'\r\n                                    rows={3}\r\n                                    maxLength={1000}\r\n                                    className='form-control'\r\n                                    value={this.state.callbackUrls}\r\n                                    onChange={this.updateCallbackUrls}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.callbackUrls.help'\r\n                                        defaultMessage='Specify the URL that the messages will be sent to. If the URL is private, add it as a {link}.'\r\n                                        values={{\r\n                                            link: (\r\n                                                <ExternalLink\r\n                                                    href={DocLinks.TRUSTED_CONNECTION}\r\n                                                    location='abstract_outgoing_webhook'\r\n                                                >\r\n                                                    <FormattedMessage\r\n                                                        id='add_outgoing_webhook.callbackUrls.helpLinkText'\r\n                                                        defaultMessage='trusted internal connection'\r\n                                                    />\r\n                                                </ExternalLink>\r\n                                            ),\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        {this.props.enablePostUsernameOverride &&\r\n                            <div className='form-group'>\r\n                                <label\r\n                                    className='control-label col-sm-4'\r\n                                    htmlFor='username'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.username'\r\n                                        defaultMessage='Username'\r\n                                    />\r\n                                </label>\r\n                                <div className='col-md-5 col-sm-8'>\r\n                                    <input\r\n                                        id='username'\r\n                                        type='text'\r\n                                        maxLength={22}\r\n                                        className='form-control'\r\n                                        value={this.state.username}\r\n                                        onChange={this.updateUsername}\r\n                                    />\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_outgoing_webhook.username.help'\r\n                                            defaultMessage='Specify the username this integration will post as. Usernames can be up to 22 characters, and contain lowercase letters, numbers and the symbols \\\"-\\\", \\\"_\\\", and \\\".\\\". If left blank, the name specified by the webhook creator is used.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        {this.props.enablePostIconOverride &&\r\n                            <div className='form-group'>\r\n                                <label\r\n                                    className='control-label col-sm-4'\r\n                                    htmlFor='iconURL'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.icon_url'\r\n                                        defaultMessage='Profile Picture'\r\n                                    />\r\n                                </label>\r\n                                <div className='col-md-5 col-sm-8'>\r\n                                    <input\r\n                                        id='iconURL'\r\n                                        type='text'\r\n                                        maxLength={1024}\r\n                                        className='form-control'\r\n                                        value={this.state.iconURL}\r\n                                        onChange={this.updateIconURL}\r\n                                    />\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_outgoing_webhook.icon_url.help'\r\n                                            defaultMessage='Enter the URL of a .png or .jpg file for this integration to use as the profile picture when posting. The file should be at least 128 pixels by 128 pixels. If left blank, the profile picture specified by the webhook creator is used.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.props.serverError, this.state.clientError]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={`/${this.props.team.name}/integrations/outgoing_webhooks`}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={this.props.loading}\r\n                                onClick={this.handleSubmit}\r\n                                id='saveWebhook'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id={footerToRender.id}\r\n                                    defaultMessage={footerToRender.defaultMessage}\r\n                                />\r\n                            </SpinnerButton>\r\n                            {renderExtra}\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport {defineMessages} from 'react-intl';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AbstractOutgoingWebhook from 'components/integrations/abstract_outgoing_webhook';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'add_outgoing_webhook.save',\r\n        defaultMessage: 'Save',\r\n    },\r\n    header: {\r\n        id: 'integrations.add',\r\n        defaultMessage: 'Add',\r\n    },\r\n    loading: {\r\n        id: 'add_outgoing_webhook.saving',\r\n        defaultMessage: 'Saving...',\r\n    },\r\n});\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n     * The current team\r\n     */\r\n    team: Team;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to add a new outgoing webhook\r\n        */\r\n        createOutgoingHook: (hook: OutgoingWebhook) => Promise<ActionResult<OutgoingWebhook>>;\r\n    };\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post username.\r\n     */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post icon.\r\n     */\r\n    enablePostIconOverride: boolean;\r\n};\r\n\r\nconst AddOutgoingWebhook = ({team, actions, enablePostUsernameOverride, enablePostIconOverride}: Props): JSX.Element => {\r\n    const history = useHistory();\r\n\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const addOutgoingHook = async (hook: OutgoingWebhook) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = await actions.createOutgoingHook(hook);\r\n        if (data) {\r\n            history.push(`/${team.name}/integrations/confirm?type=outgoing_webhooks&id=${data.id}`);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AbstractOutgoingWebhook\r\n            team={team}\r\n            header={messages.header}\r\n            footer={messages.footer}\r\n            loading={messages.loading}\r\n            renderExtra={''}\r\n            action={addOutgoingHook}\r\n            serverError={serverError}\r\n            enablePostUsernameOverride={enablePostUsernameOverride}\r\n            enablePostIconOverride={enablePostIconOverride}\r\n        />\r\n    );\r\n};\r\n\r\nexport default AddOutgoingWebhook;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {createOutgoingHook} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport AddOutgoingWebhook from './add_outgoing_webhook';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\r\n    const enablePostIconOverride = config.EnablePostIconOverride === 'true';\r\n    return {\r\n        enablePostUsernameOverride,\r\n        enablePostIconOverride,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createOutgoingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AddOutgoingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {Bot, BotPatch} from '@mattermost/types/bots';\r\n\r\nimport {BotTypes} from 'mattermost-redux/action_types';\r\nimport {Client4} from 'mattermost-redux/client';\r\n\r\nimport {bindClientFunc} from './helpers';\r\n\r\nconst BOTS_PER_PAGE_DEFAULT = 20;\r\n\r\nexport function createBot(bot: Partial<Bot>) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.createBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            bot,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function patchBot(botUserId: string, botPatch: Partial<BotPatch>) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.patchBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n            botPatch,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function loadBot(botUserId: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.getBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function loadBots(page = 0, perPage = BOTS_PER_PAGE_DEFAULT) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.getBotsIncludeDeleted,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNTS,\r\n        params: [\r\n            page,\r\n            perPage,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function disableBot(botUserId: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.disableBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function enableBot(botUserId: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.enableBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function assignBot(botUserId: string, newOwnerId: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.assignBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n            newOwnerId,\r\n        ],\r\n    });\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport type {ChangeEvent, ReactNode} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport NextIcon from 'components/widgets/icons/fa_next_icon';\r\nimport PreviousIcon from 'components/widgets/icons/fa_previous_icon';\r\nimport SearchIcon from 'components/widgets/icons/fa_search_icon';\r\n\r\nimport './backstage_list.scss';\r\n\r\ntype Props = {\r\n    children?: JSX.Element[] | ((filter: string) => [JSX.Element[], boolean]);\r\n    header: ReactNode;\r\n    addLink?: string;\r\n    addText?: ReactNode;\r\n    addButtonId?: string;\r\n    emptyText?: ReactNode;\r\n    emptyTextSearch?: JSX.Element;\r\n    helpText?: ReactNode;\r\n    loading: boolean;\r\n    searchPlaceholder?: string;\r\n    nextPage?: () => void;\r\n    previousPage?: () => void;\r\n    page?: number;\r\n    pageSize?: number;\r\n    total?: number;\r\n};\r\n\r\nconst getPaging = (remainingProps: Props, childCount: number, hasFilter: boolean) => {\r\n    const page = (hasFilter || !remainingProps.page) ? 0 : remainingProps.page;\r\n    const pageSize = (hasFilter || !remainingProps.pageSize) ? childCount : remainingProps.pageSize;\r\n    const total = (hasFilter || !remainingProps.total) ? childCount : remainingProps.total;\r\n\r\n    let startCount = (page * pageSize) + 1;\r\n    let endCount = (page + 1) * pageSize;\r\n    endCount = endCount > total ? total : endCount;\r\n    if (endCount === 0) {\r\n        startCount = 0;\r\n    }\r\n\r\n    const isFirstPage = startCount <= 1;\r\n    const isLastPage = endCount >= total;\r\n\r\n    return {startCount, endCount, total, isFirstPage, isLastPage};\r\n};\r\n\r\nconst BackstageList = (remainingProps: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const [filter, setFilter] = useState('');\r\n    const updateFilter = (e: ChangeEvent<HTMLInputElement>) => setFilter(e.target.value);\r\n    const filterLowered = filter.toLowerCase();\r\n\r\n    let searchPlaceholder;\r\n    if (remainingProps.searchPlaceholder) {\r\n        searchPlaceholder = remainingProps.searchPlaceholder;\r\n    } else {\r\n        searchPlaceholder = formatMessage({id: 'backstage_list.search', defaultMessage: 'Search'});\r\n    }\r\n\r\n    let children = [];\r\n    let childCount = 0;\r\n    if (remainingProps.loading) {\r\n        children = [\r\n            <LoadingScreen\r\n                key='loading'\r\n            />,\r\n        ];\r\n    } else {\r\n        let hasChildren = true;\r\n        if (typeof remainingProps.children === 'function') {\r\n            [children, hasChildren] = remainingProps.children(filterLowered);\r\n        } else {\r\n            children = remainingProps.children as JSX.Element[];\r\n        }\r\n        children = React.Children.map(children, (child) => {\r\n            return React.cloneElement(child, {filterLowered});\r\n        });\r\n        if (children.length === 0 || !hasChildren) {\r\n            if (!filterLowered) {\r\n                if (remainingProps.emptyText) {\r\n                    children = [(\r\n                        <div\r\n                            className='backstage-list__item backstage-list__empty'\r\n                            key='emptyText'\r\n                        >\r\n                            {remainingProps.emptyText}\r\n                        </div>\r\n                    )];\r\n                }\r\n            } else if (remainingProps.emptyTextSearch) {\r\n                children = [(\r\n                    <div\r\n                        className='backstage-list__item backstage-list__empty'\r\n                        id='emptySearchResultsMessage'\r\n                        key='emptyTextSearch'\r\n                    >\r\n                        {React.cloneElement(remainingProps.emptyTextSearch, {values: {...remainingProps.emptyTextSearch.props.values, searchTerm: filterLowered}})}\r\n                    </div>\r\n                )];\r\n            }\r\n        } else {\r\n            childCount = children.length;\r\n        }\r\n    }\r\n\r\n    let addLink = null;\r\n\r\n    if (remainingProps.addLink && remainingProps.addText) {\r\n        addLink = (\r\n            <Link\r\n                className='add-link'\r\n                to={remainingProps.addLink}\r\n            >\r\n                <button\r\n                    type='button'\r\n                    className='btn btn-primary'\r\n                    id={remainingProps.addButtonId}\r\n                >\r\n                    <span>\r\n                        {remainingProps.addText}\r\n                    </span>\r\n                </button>\r\n            </Link>\r\n        );\r\n    }\r\n\r\n    const hasFilter = filter.length > 0;\r\n    const {startCount, endCount, total, isFirstPage, isLastPage} = getPaging(remainingProps, childCount, hasFilter);\r\n    const childrenToDisplay = childCount > 0 ? children.slice(startCount - 1, endCount) : children;\r\n\r\n    let previousPageFn = remainingProps.previousPage;\r\n    let nextPageFn = remainingProps.nextPage;\r\n    if (isFirstPage) {\r\n        previousPageFn = () => {};\r\n    }\r\n    if (isLastPage) {\r\n        nextPageFn = () => {};\r\n    }\r\n\r\n    return (\r\n        <div className='backstage-content'>\r\n            <div className='backstage-header'>\r\n                <h1>\r\n                    {remainingProps.header}\r\n                </h1>\r\n                {addLink}\r\n            </div>\r\n            <div className='backstage-filters'>\r\n                <div className='backstage-filter__search'>\r\n                    <SearchIcon/>\r\n                    <input\r\n                        type='search'\r\n                        className='form-control'\r\n                        placeholder={searchPlaceholder}\r\n                        value={filter}\r\n                        onChange={updateFilter}\r\n                        id='searchInput'\r\n                    />\r\n                </div>\r\n            </div>\r\n            <span className='backstage-list__help'>\r\n                {remainingProps.helpText}\r\n            </span>\r\n            <div className='backstage-list'>\r\n                {childrenToDisplay}\r\n            </div>\r\n            <div className='backstage-footer'>\r\n                <div className='backstage-footer__cell'>\r\n                    <FormattedMessage\r\n                        id='backstage_list.paginatorCount'\r\n                        defaultMessage='{startCount, number} - {endCount, number} of {total, number}'\r\n                        values={{\r\n                            startCount,\r\n                            endCount,\r\n                            total,\r\n                        }}\r\n                    />\r\n                    <button\r\n                        type='button'\r\n                        className={'btn btn-quaternary btn-icon btn-sm ml-2 prev ' + (isFirstPage ? 'disabled' : '')}\r\n                        onClick={previousPageFn}\r\n                        aria-label={formatMessage({id: 'backstage_list.previousButton.ariaLabel', defaultMessage: 'Previous'})}\r\n                    >\r\n                        <PreviousIcon/>\r\n                    </button>\r\n                    <button\r\n                        type='button'\r\n                        className={'btn btn-quaternary btn-icon btn-sm next ' + (isLastPage ? 'disabled' : '')}\r\n                        onClick={nextPageFn}\r\n                        aria-label={formatMessage({id: 'backstage_list.nextButton.ariaLabel', defaultMessage: 'Next'})}\r\n                    >\r\n                        <NextIcon/>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BackstageList;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent, SyntheticEvent, ReactNode} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Bot as BotType} from '@mattermost/types/bots';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile, UserAccessToken} from '@mattermost/types/users';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport Markdown from 'components/markdown';\r\nimport SaveButton from 'components/save_button';\r\nimport WarningIcon from 'components/widgets/icons/fa_warning_icon';\r\n\r\nimport * as Utils from 'utils/utils';\r\n\r\nexport function matchesFilter(bot: BotType, filter?: string, owner?: UserProfile): boolean {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n    const username = bot.username || '';\r\n    const description = bot.description || '';\r\n    const displayName = bot.display_name || '';\r\n\r\n    let ownerUsername = 'plugin';\r\n    if (owner && owner.username) {\r\n        ownerUsername = owner.username;\r\n    }\r\n    return !(username.toLowerCase().indexOf(filter) === -1 &&\r\n        displayName.toLowerCase().indexOf(filter) === -1 &&\r\n        description.toLowerCase().indexOf(filter) === -1 &&\r\n        ownerUsername.toLowerCase().indexOf(filter) === -1);\r\n}\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    *  Bot that we are displaying\r\n    */\r\n    bot: BotType;\r\n\r\n    /**\r\n    * Owner of the bot we are displaying\r\n    */\r\n    owner?: UserProfile;\r\n\r\n    /**\r\n    * User of the bot we are displaying\r\n    */\r\n    user: UserProfile;\r\n\r\n    /**\r\n    * The access tokens of the bot user\r\n    */\r\n    accessTokens: Record<string, UserAccessToken>;\r\n\r\n    /**\r\n    * String used for filtering bot items\r\n    */\r\n    filter?: string;\r\n\r\n    /**\r\n     * Determine whether this bot is managed by the app framework\r\n     */\r\n    fromApp: boolean;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * Disable a bot\r\n        */\r\n        disableBot: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * Enable a bot\r\n        */\r\n        enableBot: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * Access token managment\r\n        */\r\n        createUserAccessToken: (userId: string, description: string) => Promise<ActionResult<UserAccessToken>>;\r\n\r\n        revokeUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n        enableUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n        disableUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n    *  Only used for routing since backstage is team based.\r\n    */\r\n    team: Team;\r\n}\r\n\r\ntype State = {\r\n    confirmingId: string;\r\n    creatingTokenState: string;\r\n    token: UserAccessToken | Record<string, any>;\r\n    error: ReactNode;\r\n}\r\n\r\nexport default class Bot extends React.PureComponent<Props, State> {\r\n    public constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            confirmingId: '',\r\n            creatingTokenState: 'CLOSED',\r\n            token: {},\r\n            error: '',\r\n        };\r\n    }\r\n\r\n    enableBot = (): void => {\r\n        this.props.actions.enableBot(this.props.bot.user_id);\r\n    };\r\n\r\n    disableBot = (): void => {\r\n        this.props.actions.disableBot(this.props.bot.user_id);\r\n    };\r\n\r\n    enableUserAccessToken = (id: string): void => {\r\n        this.props.actions.enableUserAccessToken(id);\r\n    };\r\n\r\n    disableUserAccessToken = (id: string): void => {\r\n        this.props.actions.disableUserAccessToken(id);\r\n    };\r\n\r\n    confirmRevokeToken = (id: string): void => {\r\n        this.setState({confirmingId: id});\r\n    };\r\n\r\n    revokeTokenConfirmed = (): void => {\r\n        this.props.actions.revokeUserAccessToken(this.state.confirmingId);\r\n        this.closeConfirm();\r\n    };\r\n\r\n    closeConfirm = (): void => {\r\n        this.setState({confirmingId: ''});\r\n    };\r\n\r\n    openCreateToken = (): void => {\r\n        this.setState({\r\n            creatingTokenState: 'OPEN',\r\n            token: {\r\n                description: '',\r\n            },\r\n        });\r\n    };\r\n\r\n    closeCreateToken = (): void => {\r\n        this.setState({\r\n            creatingTokenState: 'CLOSED',\r\n            token: {\r\n                description: '',\r\n            },\r\n        });\r\n    };\r\n\r\n    handleUpdateDescription = (e: ChangeEvent<HTMLInputElement>): void => {\r\n        const target = e.target as HTMLInputElement;\r\n        this.setState({\r\n            token: Object.assign({}, this.state.token, {description: target.value}),\r\n        });\r\n    };\r\n\r\n    handleCreateToken = async (e: SyntheticEvent): Promise<void> => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.token.description === '') {\r\n            this.setState({error: (\r\n                <FormattedMessage\r\n                    id='bot.token.error.description'\r\n                    defaultMessage='Please enter a description.'\r\n                />\r\n            )});\r\n            return;\r\n        }\r\n\r\n        const {data, error} = await this.props.actions.createUserAccessToken(this.props.bot.user_id, this.state.token.description);\r\n        if (data) {\r\n            this.setState({creatingTokenState: 'CREATED', token: data});\r\n        } else if (error) {\r\n            this.setState({error: error.message});\r\n        }\r\n    };\r\n\r\n    public render(): JSX.Element | null {\r\n        const username = this.props.bot.username || '';\r\n        const description = this.props.bot.description || '';\r\n        const displayName = this.props.bot.display_name || '';\r\n\r\n        let ownerUsername = 'plugin';\r\n        if (this.props.fromApp) {\r\n            ownerUsername = 'Apps Framework';\r\n        } else if (this.props.owner && this.props.owner.username) {\r\n            ownerUsername = this.props.owner.username;\r\n        }\r\n        const filter = this.props.filter ? this.props.filter.toLowerCase() : '';\r\n        if (!matchesFilter(this.props.bot, filter, this.props.owner)) {\r\n            return null;\r\n        }\r\n\r\n        const tokenList = [];\r\n        Object.values(this.props.accessTokens).forEach((token) => {\r\n            let activeLink;\r\n            let disableClass = '';\r\n            let disabledText;\r\n\r\n            if (token.is_active) {\r\n                activeLink = (\r\n                    <a\r\n                        id={token.id + '_deactivate'}\r\n                        href='#'\r\n                        onClick={(e) => {\r\n                            e.preventDefault();\r\n                            this.disableUserAccessToken(token.id);\r\n                        }}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.deactivate'\r\n                            defaultMessage='Disable'\r\n                        />\r\n                    </a>);\r\n            } else {\r\n                disableClass = 'light';\r\n                disabledText = (\r\n                    <span className='mr-2 light'>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.deactivatedWarning'\r\n                            defaultMessage='(Disabled)'\r\n                        />\r\n                    </span>\r\n                );\r\n                activeLink = (\r\n                    <a\r\n                        id={token.id + '_activate'}\r\n                        href='#'\r\n                        onClick={(e) => {\r\n                            e.preventDefault();\r\n                            this.enableUserAccessToken(token.id);\r\n                        }}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.activate'\r\n                            defaultMessage='Enable'\r\n                        />\r\n                    </a>\r\n                );\r\n            }\r\n\r\n            tokenList.push(\r\n                <div\r\n                    key={token.id}\r\n                    className='bot-list__item'\r\n                >\r\n                    <div className='item-details__row d-flex justify-content-between'>\r\n                        <div className={disableClass}>\r\n                            <div className='whitespace--nowrap overflow--ellipsis'>\r\n                                <b>\r\n                                    <FormattedMessage\r\n                                        id='user.settings.tokens.tokenDesc'\r\n                                        defaultMessage='Token Description: '\r\n                                    />\r\n                                </b>\r\n                                {token.description}\r\n                            </div>\r\n                            <div className='setting-box__token-id whitespace--nowrap overflow--ellipsis'>\r\n                                <b>\r\n                                    <FormattedMessage\r\n                                        id='user.settings.tokens.tokenId'\r\n                                        defaultMessage='Token ID: '\r\n                                    />\r\n                                </b>\r\n                                {token.id}\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            {disabledText}\r\n                            {activeLink}\r\n                            {' - '}\r\n                            <a\r\n                                id={token.id + '_delete'}\r\n                                href='#'\r\n                                onClick={(e) => {\r\n                                    e.preventDefault();\r\n                                    this.confirmRevokeToken(token.id);\r\n                                }}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='user.settings.tokens.delete'\r\n                                    defaultMessage='Delete'\r\n                                />\r\n                            </a>\r\n                        </div>\r\n                    </div>\r\n                </div>,\r\n            );\r\n        });\r\n\r\n        let options;\r\n        if (ownerUsername !== 'plugin') {\r\n            options = (\r\n                <div className='item-actions'>\r\n                    <button\r\n                        id='createToken'\r\n                        className='style--none color--link'\r\n                        onClick={this.openCreateToken}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='bot.manage.create_token'\r\n                            defaultMessage='Create New Token'\r\n                        />\r\n                    </button>\r\n                    {' - '}\r\n                    <Link to={`/${this.props.team.name}/integrations/bots/edit?id=${this.props.bot.user_id}`}>\r\n                        <FormattedMessage\r\n                            id='bots.manage.edit'\r\n                            defaultMessage='Edit'\r\n                        />\r\n                    </Link>\r\n                    {' - '}\r\n                    <button\r\n                        className='style--none color--link'\r\n                        onClick={this.disableBot}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='bot.manage.disable'\r\n                            defaultMessage='Disable'\r\n                        />\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n        if (this.props.bot.delete_at !== 0) {\r\n            options = (\r\n                <div className='item-actions'>\r\n                    <button\r\n                        className='style--none color--link'\r\n                        onClick={this.enableBot}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='bot.manage.enable'\r\n                            defaultMessage='Enable'\r\n                        />\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (this.state.creatingTokenState === 'OPEN') {\r\n            tokenList.push(\r\n                <div\r\n                    key={'create'}\r\n                    className='bot-list__item'\r\n                >\r\n                    <div key={'create'}>\r\n                        <form\r\n                            className='form-horizontal'\r\n                            onSubmit={this.handleCreateToken}\r\n                        >\r\n                            <div className='row'>\r\n                                <label\r\n                                    className='col-sm-auto control-label'\r\n                                    htmlFor='botToken'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='user.settings.tokens.name'\r\n                                        defaultMessage='Token Description: '\r\n                                    />\r\n                                </label>\r\n                                <div className='col-sm-4'>\r\n                                    <input\r\n                                        id='botToken'\r\n                                        autoFocus={true}\r\n                                        className='form-control form-sm'\r\n                                        type='text'\r\n                                        maxLength={64}\r\n                                        value={this.state.token.description}\r\n                                        onChange={this.handleUpdateDescription}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            <div>\r\n                                <div className='pt-2 pb-2'>\r\n                                    <FormattedMessage\r\n                                        id='user.settings.tokens.nameHelp'\r\n                                        defaultMessage='Enter a description for your token to remember what it does.'\r\n                                    />\r\n                                </div>\r\n                                <label\r\n                                    id='clientError'\r\n                                    className='has-error is-empty'\r\n                                >\r\n                                    {this.state.error}\r\n                                </label>\r\n                                <div className='mt-2'>\r\n                                    <SaveButton\r\n                                        btnClass='btn-sm btn-primary'\r\n                                        savingMessage={\r\n                                            <FormattedMessage\r\n                                                id='user.settings.tokens.save'\r\n                                                defaultMessage='Save'\r\n                                            />\r\n                                        }\r\n                                        saving={false}\r\n                                    />\r\n                                    <button\r\n                                        className='btn btn-sm btn-tertiary'\r\n                                        onClick={this.closeCreateToken}\r\n                                    >\r\n                                        <FormattedMessage\r\n                                            id='user.settings.tokens.cancel'\r\n                                            defaultMessage='Cancel'\r\n                                        />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>,\r\n            );\r\n        } else if (this.state.creatingTokenState === 'CREATED') {\r\n            tokenList.push(\r\n                <div\r\n                    key={'created'}\r\n                    className='bot-list__item alert alert-warning'\r\n                >\r\n                    <div className='mb-2'>\r\n                        <WarningIcon additionalClassName='mr-2'/>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.copy'\r\n                            defaultMessage=\"Please copy the access token below. You won't be able to see it again!\"\r\n                        />\r\n                    </div>\r\n                    <div className='whitespace--nowrap overflow--ellipsis'>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.name'\r\n                            defaultMessage='Token Description: '\r\n                        />\r\n                        {this.state.token.description}\r\n                    </div>\r\n                    <div className='whitespace--nowrap overflow--ellipsis'>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.id'\r\n                            defaultMessage='Token ID: '\r\n                        />\r\n                        {this.state.token.id}\r\n                    </div>\r\n                    <strong className='word-break--all'>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.token'\r\n                            defaultMessage='Access Token: '\r\n                        />\r\n                        {this.state.token.token}\r\n                    </strong>\r\n                    <div className='mt-2'>\r\n                        <button\r\n                            className='btn btn-sm btn-primary'\r\n                            onClick={this.closeCreateToken}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='bot.create_token.close'\r\n                                defaultMessage='Close'\r\n                            />\r\n                        </button>\r\n                    </div>\r\n                </div>,\r\n            );\r\n        }\r\n\r\n        const imageURL = Utils.imageURLForUser(this.props.user.id, this.props.user.last_picture_update);\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                <div className={'bot-list-img-container'}>\r\n                    <img\r\n                        className={'bot-list-img'}\r\n                        alt={'bot image'}\r\n                        src={imageURL}\r\n                    />\r\n                </div>\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <strong className='item-details__name'>\r\n                            {displayName + ' (@' + username + ')'}\r\n                        </strong>\r\n                        {options}\r\n                    </div>\r\n                    <div className='bot-details__description'>\r\n                        <Markdown message={description}/>\r\n                    </div>\r\n                    <div className='light small'>\r\n                        <FormattedMessage\r\n                            id='bots.managed_by'\r\n                            defaultMessage='Managed by '\r\n                        />\r\n                        {ownerUsername}\r\n                    </div>\r\n                    <div className='bot-list is-empty'>\r\n                        {tokenList}\r\n                    </div>\r\n                </div>\r\n                <ConfirmModal\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='bots.token.delete'\r\n                            defaultMessage='Delete Token'\r\n                        />\r\n                    }\r\n                    message={\r\n                        <FormattedMessage\r\n                            id='bots.token.confirm_text'\r\n                            defaultMessage='Are you sure you want to delete the token?'\r\n                        />\r\n                    }\r\n                    confirmButtonText={\r\n                        <FormattedMessage\r\n                            id='bots.token.confirm'\r\n                            defaultMessage='Delete'\r\n                        />\r\n                    }\r\n                    modalClass='integrations-backstage-modal'\r\n                    show={this.state.confirmingId !== ''}\r\n                    onConfirm={this.revokeTokenConfirmed}\r\n                    onCancel={this.closeConfirm}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Bot as BotType} from '@mattermost/types/bots';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile, UserAccessToken} from '@mattermost/types/users';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport Bot, {matchesFilter} from './bot';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    *  Map from botUserId to bot.\r\n    */\r\n    bots: Record<string, BotType>;\r\n\r\n    /**\r\n     * List of bot IDs managed by the app framework\r\n     */\r\n    appsBotIDs: string[];\r\n\r\n    /**\r\n     * Whether apps framework is enabled\r\n     */\r\n    appsEnabled: boolean;\r\n\r\n    /**\r\n    *  Map from botUserId to accessTokens.\r\n    */\r\n    accessTokens?: RelationOneToOne<UserProfile, Record<string, UserAccessToken>>;\r\n\r\n    /**\r\n    *  Map from botUserId to owner.\r\n    */\r\n    owners: Record<string, UserProfile>;\r\n\r\n    /**\r\n    *  Map from botUserId to user.\r\n    */\r\n    users: Record<string, UserProfile>;\r\n    createBots?: boolean;\r\n\r\n    actions: {\r\n\r\n        /**\r\n         * Ensure we have bot accounts\r\n         */\r\n        loadBots: (page?: number, perPage?: number) => Promise<ActionResult<BotType[]>>;\r\n\r\n        /**\r\n        * Load access tokens for bot accounts\r\n        */\r\n        getUserAccessTokensForUser: (userId: string, page?: number, perPage?: number) => void;\r\n\r\n        /**\r\n        * Access token managment\r\n        */\r\n        createUserAccessToken: (userId: string, description: string) => Promise<ActionResult<UserAccessToken>>;\r\n\r\n        revokeUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n        enableUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n        disableUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * Load owner of bot account\r\n        */\r\n        getUser: (userId: string) => void;\r\n\r\n        /**\r\n        * Disable a bot\r\n        */\r\n        disableBot: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * Enable a bot\r\n        */\r\n        enableBot: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n         * Load bot IDs managed by the apps\r\n         */\r\n        fetchAppsBotIDs: () => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n    *  Only used for routing since backstage is team based.\r\n    */\r\n    team: Team;\r\n}\r\n\r\ntype State = {\r\n    loading: boolean;\r\n}\r\n\r\nexport default class Bots extends React.PureComponent<Props, State> {\r\n    public constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    public componentDidMount(): void {\r\n        this.props.actions.loadBots(\r\n            Constants.Integrations.START_PAGE_NUM,\r\n            Constants.Integrations.PAGE_SIZE,\r\n        ).then(\r\n            (result) => {\r\n                if (result.data) {\r\n                    const promises = [];\r\n\r\n                    for (const bot of result.data) {\r\n                        // We don't need to wait for this and we need to accept failure in the case where bot.owner_id is a plugin id\r\n                        this.props.actions.getUser(bot.owner_id);\r\n\r\n                        // We want to wait for these.\r\n                        promises.push(this.props.actions.getUser(bot.user_id));\r\n                        promises.push(this.props.actions.getUserAccessTokensForUser(bot.user_id));\r\n                    }\r\n\r\n                    Promise.all(promises).then(() => {\r\n                        this.setState({loading: false});\r\n                    });\r\n                }\r\n            },\r\n        );\r\n        if (this.props.appsEnabled) {\r\n            this.props.actions.fetchAppsBotIDs();\r\n        }\r\n    }\r\n\r\n    DisabledSection(props: {hasDisabled: boolean; disabledBots: JSX.Element[]; filter?: string}): JSX.Element | null {\r\n        if (!props.hasDisabled) {\r\n            return null;\r\n        }\r\n        const botsToDisplay = React.Children.map(props.disabledBots, (child) => {\r\n            return React.cloneElement(child, {filter: props.filter});\r\n        });\r\n        return (\r\n            <>\r\n                <div className='bot-disabled'>\r\n                    <FormattedMessage\r\n                        id='bots.disabled'\r\n                        defaultMessage='Disabled'\r\n                    />\r\n                </div>\r\n                <div className='bot-list__disabled'>\r\n                    {botsToDisplay}\r\n                </div>\r\n            </>\r\n        );\r\n    }\r\n\r\n    EnabledSection(props: {enabledBots: JSX.Element[]; filter?: string}): JSX.Element {\r\n        const botsToDisplay = React.Children.map(props.enabledBots, (child) => {\r\n            return React.cloneElement(child, {filter: props.filter});\r\n        });\r\n        return (\r\n            <div>\r\n                {botsToDisplay}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    botToJSX = (bot: BotType): JSX.Element => {\r\n        return (\r\n            <Bot\r\n                key={bot.user_id}\r\n                bot={bot}\r\n                owner={this.props.owners[bot.user_id]}\r\n                user={this.props.users[bot.user_id]}\r\n                accessTokens={(this.props.accessTokens && this.props.accessTokens[bot.user_id]) || {}}\r\n                actions={this.props.actions}\r\n                team={this.props.team}\r\n                fromApp={this.props.appsBotIDs.includes(bot.user_id)}\r\n            />\r\n        );\r\n    };\r\n\r\n    bots = (filter?: string): [JSX.Element[], boolean] => {\r\n        const bots = Object.values(this.props.bots).sort((a, b) => a.username.localeCompare(b.username));\r\n        const match = (bot: BotType) => matchesFilter(bot, filter, this.props.owners[bot.user_id]);\r\n        const enabledBots = bots.filter((bot) => bot.delete_at === 0).filter(match).map(this.botToJSX);\r\n        const disabledBots = bots.filter((bot) => bot.delete_at > 0).filter(match).map(this.botToJSX);\r\n        const sections = [(\r\n            <div key='sections'>\r\n                <this.EnabledSection\r\n                    enabledBots={enabledBots}\r\n                />\r\n                <this.DisabledSection\r\n                    hasDisabled={disabledBots.length > 0}\r\n                    disabledBots={disabledBots}\r\n                />\r\n            </div>\r\n        )];\r\n\r\n        return [sections, enabledBots.length > 0 || disabledBots.length > 0];\r\n    };\r\n\r\n    public render(): JSX.Element {\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='bots.manage.header'\r\n                        defaultMessage='Bot Accounts'\r\n                    />\r\n                }\r\n                addText={this.props.createBots &&\r\n                    <FormattedMessage\r\n                        id='bots.manage.add'\r\n                        defaultMessage='Add Bot Account'\r\n                    />\r\n                }\r\n                addLink={'/' + this.props.team.name + '/integrations/bots/add'}\r\n                addButtonId='addBotAccount'\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='bots.manage.empty'\r\n                        defaultMessage='No bot accounts found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='bots.emptySearch'\r\n                        defaultMessage='No bot accounts match <b>{searchTerm}</b>'\r\n                        values={{\r\n                            b: (chunks: string) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                }\r\n                helpText={\r\n                    <>\r\n                        <FormattedMessage\r\n                            id='bots.manage.help1'\r\n                            defaultMessage='Use {botAccounts} to integrate with Mattermost through plugins or the API. Bot accounts are available to everyone on your server. '\r\n                            values={{\r\n                                botAccounts: (\r\n                                    <ExternalLink\r\n                                        href='https://mattermost.com/pl/default-bot-accounts'\r\n                                        location='bots'\r\n                                    >\r\n                                        <FormattedMessage\r\n                                            id='bots.manage.bot_accounts'\r\n                                            defaultMessage='Bot Accounts'\r\n                                        />\r\n                                    </ExternalLink>\r\n                                ),\r\n                            }}\r\n                        />\r\n                        <FormattedMessage\r\n                            id='bots.help2'\r\n                            defaultMessage={'Enable bot account creation in the <a>System Console</a>.'}\r\n                            values={{\r\n                                a: (chunks: string) => <Link to='/admin_console/integrations/bot_accounts'>{chunks}</Link>,\r\n                            }}\r\n                        />\r\n                    </>\r\n                }\r\n                searchPlaceholder={Utils.localizeMessage({id: 'bots.manage.search', defaultMessage: 'Search Bot Accounts'})}\r\n                loading={this.state.loading}\r\n            >\r\n                {this.bots}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Bot as BotType} from '@mattermost/types/bots';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {loadBots, disableBot, enableBot} from 'mattermost-redux/actions/bots';\r\nimport {getAppsBotIDs as fetchAppsBotIDs} from 'mattermost-redux/actions/integrations';\r\nimport {createUserAccessToken, revokeUserAccessToken, enableUserAccessToken, disableUserAccessToken, getUserAccessTokensForUser, getUser} from 'mattermost-redux/actions/users';\r\nimport {appsEnabled} from 'mattermost-redux/selectors/entities/apps';\r\nimport {getExternalBotAccounts} from 'mattermost-redux/selectors/entities/bots';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getAppsBotIDs} from 'mattermost-redux/selectors/entities/integrations';\r\nimport * as UserSelectors from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport Bots from './bots';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const createBots = config.EnableBotAccountCreation === 'true';\r\n    const bots = getExternalBotAccounts(state);\r\n    const botValues = Object.values(bots);\r\n    const owners = botValues.\r\n        reduce((result: Record<string, UserProfile>, bot: BotType) => {\r\n            result[bot.user_id] = UserSelectors.getUser(state, bot.owner_id);\r\n            return result;\r\n        }, {});\r\n    const users = botValues.\r\n        reduce((result: Record<string, UserProfile>, bot: BotType) => {\r\n            result[bot.user_id] = UserSelectors.getUser(state, bot.user_id);\r\n            return result;\r\n        }, {});\r\n\r\n    return {\r\n        createBots,\r\n        bots,\r\n        accessTokens: state.entities.admin.userAccessTokensByUser,\r\n        owners,\r\n        users,\r\n        appsBotIDs: getAppsBotIDs(state),\r\n        appsEnabled: appsEnabled(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            fetchAppsBotIDs,\r\n            loadBots,\r\n            getUserAccessTokensForUser,\r\n            createUserAccessToken,\r\n            revokeUserAccessToken,\r\n            enableUserAccessToken,\r\n            disableUserAccessToken,\r\n            getUser,\r\n            disableBot,\r\n            enableBot,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Bots);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent, FormEvent} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Bot, BotPatch} from '@mattermost/types/bots';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserAccessToken, UserProfile} from '@mattermost/types/users';\r\n\r\nimport {General} from 'mattermost-redux/constants';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\nimport * as UserUtils from 'mattermost-redux/utils/user_utils';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ExternalLink from 'components/external_link';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport BotDefaultIcon from 'images/bot_default_icon.png';\r\nimport {getHistory} from 'utils/browser_history';\r\nimport {AcceptedProfileImageTypes, Constants, DeveloperLinks, ValidationErrors} from 'utils/constants';\r\nimport * as FileUtils from 'utils/file_utils';\r\nimport * as Utils from 'utils/utils';\r\n\r\nconst roleOptionSystemAdmin = 'System Admin';\r\nconst roleOptionMember = 'Member';\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n     *  Only used for routing since backstage is team based.\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     *  Bot to edit (if editing)\r\n     */\r\n    bot?: Bot;\r\n\r\n    /**\r\n     *  Bot user\r\n     */\r\n    user?: UserProfile;\r\n\r\n    /**\r\n     *  Roles of the bot to edit (if editing)\r\n     */\r\n    roles?: string;\r\n\r\n    /**\r\n     * Maximum upload file size (for bot account profile picture)\r\n     */\r\n    maxFileSize: number;\r\n\r\n    /**\r\n     * Editing user has the MANAGE_SYSTEM permission\r\n     */\r\n    editingUserHasManageSystem: boolean;\r\n\r\n    /**\r\n     * Bot to edit\r\n     */\r\n    actions: {\r\n\r\n        /**\r\n         * Creates a new bot account.\r\n         */\r\n        createBot: (bot: Partial<Bot>) => Promise<ActionResult<Bot>>;\r\n\r\n        /**\r\n         * Patches an existing bot account.\r\n         */\r\n        patchBot: (botUserId: string, botPatch: Partial<BotPatch>) => Promise<ActionResult<Bot>>;\r\n\r\n        /**\r\n         * Uploads a user profile image\r\n         */\r\n        uploadProfileImage: (userId: string, image: File | string) => Promise<ActionResult>;\r\n\r\n        /**\r\n         * Set profile image to default\r\n         */\r\n        setDefaultProfileImage: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n         * For creating default access token\r\n         */\r\n        createUserAccessToken: (userId: string, description: string) => Promise<ActionResult<UserAccessToken>>;\r\n\r\n        /**\r\n         * For creating setting bot to system admin or special posting permissions\r\n         */\r\n        updateUserRoles: (userId: string, roles: string) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\nexport type State = {\r\n    username: string;\r\n    displayName: string | undefined;\r\n    description: string | undefined;\r\n    role: string;\r\n    postAll: boolean;\r\n    postChannels: boolean;\r\n    error: JSX.Element | string;\r\n    adding: boolean;\r\n    image: string;\r\n    orientationStyles: { transform: string; transformOrigin: string };\r\n    pictureFile: File | null | string;\r\n};\r\n\r\nexport default class AddBot extends React.PureComponent<Props, State> {\r\n    previewBlob: string | null = null;\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            error: '',\r\n            username: this.props.bot ? this.props.bot.username : '',\r\n            displayName: this.props.bot ? this.props.bot.display_name : '',\r\n            description: this.props.bot ? this.props.bot.description : '',\r\n            adding: false,\r\n            image: BotDefaultIcon,\r\n            role: UserUtils.isSystemAdmin(this.props.roles || '') ? roleOptionSystemAdmin : roleOptionMember,\r\n            postAll: this.props.bot ? UserUtils.hasPostAllRole(this.props.roles || '') : false,\r\n            postChannels: this.props.bot ? UserUtils.hasPostAllPublicRole(this.props.roles || '') : false,\r\n            orientationStyles: {transform: '', transformOrigin: ''},\r\n            pictureFile: null,\r\n        };\r\n    }\r\n\r\n    updateUsername = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            username: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDisplayName = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            displayName: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDescription = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateRole = (e: ChangeEvent<HTMLSelectElement>) => {\r\n        this.setState({\r\n            role: e.target.value,\r\n        });\r\n    };\r\n\r\n    updatePostAll = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            postAll: e.target.checked,\r\n        });\r\n    };\r\n\r\n    updatePostChannels = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            postChannels: e.target.checked,\r\n        });\r\n    };\r\n\r\n    updatePicture = (e: ChangeEvent<HTMLInputElement>) => {\r\n        if (e.target.files && e.target.files[0]) {\r\n            const pictureFile = e.target.files[0];\r\n            this.previewBlob = URL.createObjectURL(pictureFile);\r\n\r\n            const reader = new FileReader();\r\n            reader.onload = (e2) => {\r\n                const orientation = FileUtils.getExifOrientation(e2.target?.result as ArrayBuffer);\r\n                const orientationStyles = FileUtils.getOrientationStyles(orientation);\r\n\r\n                this.setState({\r\n                    image: this.previewBlob || '',\r\n                    orientationStyles,\r\n                });\r\n            };\r\n            reader.readAsArrayBuffer(pictureFile);\r\n            e.target.value = '';\r\n            this.setState({pictureFile});\r\n        } else {\r\n            this.setState({pictureFile: null, image: ''});\r\n        }\r\n    };\r\n\r\n    setDefault = () => {\r\n        this.setState({pictureFile: 'default', image: BotDefaultIcon});\r\n    };\r\n\r\n    isFile(file: File | string): file is File {\r\n        return (file as File).size !== undefined;\r\n    }\r\n\r\n    updateRoles = async (data: Bot) => {\r\n        let roles = General.SYSTEM_USER_ROLE;\r\n\r\n        if (this.state.role === roleOptionSystemAdmin) {\r\n            roles += ' ' + General.SYSTEM_ADMIN_ROLE;\r\n        } else if (this.state.postAll) {\r\n            roles += ' ' + General.SYSTEM_POST_ALL_ROLE;\r\n        } else if (this.state.postChannels) {\r\n            roles += ' ' + General.SYSTEM_POST_ALL_PUBLIC_ROLE;\r\n        }\r\n\r\n        const rolesResult = await this.props.actions.updateUserRoles(data.user_id, roles);\r\n        if (rolesResult) {\r\n            return rolesResult.error;\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    handleSubmit = async (e: FormEvent<HTMLButtonElement | HTMLFormElement>) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.adding) {\r\n            return;\r\n        }\r\n\r\n        if (!this.state.username || this.state.username.length < 3) {\r\n            this.setState({\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='bots.manage.add.invalid_username'\r\n                        defaultMessage='Usernames have to begin with a lowercase letter and be 3-22 characters long. You can use lowercase letters, numbers, periods, dashes, and underscores.'\r\n                    />\r\n                ),\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (this.state.pictureFile && this.isFile(this.state.pictureFile)) {\r\n            if (!AcceptedProfileImageTypes.includes(this.state.pictureFile.type)) {\r\n                this.setState({\r\n                    error: (\r\n                        <FormattedMessage\r\n                            id='user.settings.general.validImage'\r\n                            defaultMessage='Only BMP, JPG or PNG images may be used for profile pictures'\r\n                        />\r\n                    ),\r\n                });\r\n                return;\r\n            } else if (this.state.pictureFile.size > this.props.maxFileSize) {\r\n                this.setState({\r\n                    error: (\r\n                        <FormattedMessage\r\n                            id='user.settings.general.imageTooLarge'\r\n                            defaultMessage='Unable to upload profile image. File is too large.'\r\n                        />\r\n                    ),\r\n                });\r\n                return;\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            adding: true,\r\n            error: '',\r\n        });\r\n\r\n        const bot = {\r\n            username: this.state.username.toLowerCase().trim(),\r\n            display_name: this.state.displayName,\r\n            description: this.state.description,\r\n        };\r\n\r\n        let data: Bot | undefined;\r\n        let error;\r\n        if (this.props.bot) {\r\n            const result = await this.props.actions.patchBot(this.props.bot.user_id, bot);\r\n            if (result) {\r\n                data = result.data;\r\n                error = result.error;\r\n            } else {\r\n                error = Utils.localizeMessage({id: 'bot.edit_failed', defaultMessage: 'Failed to edit bot'});\r\n            }\r\n\r\n            if (!error && data) {\r\n                if (this.state.pictureFile && this.state.pictureFile !== 'default') {\r\n                    const imageResult = await this.props.actions.uploadProfileImage(data.user_id, this.state.pictureFile);\r\n                    error = imageResult.error;\r\n                } else if (this.state.pictureFile && this.state.pictureFile === 'default') {\r\n                    await this.props.actions.setDefaultProfileImage(data.user_id);\r\n                }\r\n            }\r\n\r\n            if (!error && data) {\r\n                error = this.updateRoles(data);\r\n            }\r\n\r\n            if (data) {\r\n                getHistory().push(`/${this.props.team.name}/integrations/bots`);\r\n                return;\r\n            }\r\n        } else {\r\n            const usernameError = Utils.isValidBotUsername(bot.username);\r\n            if (usernameError) {\r\n                let errObj;\r\n                if (usernameError.id === ValidationErrors.INVALID_LAST_CHARACTER) {\r\n                    errObj = {\r\n                        adding: false,\r\n                        error: (\r\n                            <FormattedMessage\r\n                                id='bots.manage.add.invalid_last_char'\r\n                                defaultMessage='Bot usernames cannot have a period as the last character'\r\n                            />\r\n                        ),\r\n                    };\r\n                } else {\r\n                    errObj = {\r\n                        adding: false,\r\n                        error: (\r\n                            <FormattedMessage\r\n                                id='bots.manage.add.invalid_username'\r\n                                defaultMessage='Usernames have to begin with a lowercase letter and be 3-22 characters long. You can use lowercase letters, numbers, periods, dashes, and underscores.'\r\n                            />\r\n                        ),\r\n                    };\r\n                }\r\n                this.setState(errObj);\r\n                return;\r\n            }\r\n\r\n            const result = await this.props.actions.createBot(bot);\r\n            if (result) {\r\n                data = result.data;\r\n                error = result.error;\r\n            } else {\r\n                error = Utils.localizeMessage({id: 'bot.create_failed', defaultMessage: 'Failed to create bot'});\r\n            }\r\n\r\n            let token = '';\r\n            if (!error && data) {\r\n                if (this.state.pictureFile && this.state.pictureFile !== 'default') {\r\n                    await this.props.actions.uploadProfileImage(data.user_id, this.state.pictureFile);\r\n                } else {\r\n                    await this.props.actions.setDefaultProfileImage(data.user_id);\r\n                }\r\n                const tokenResult = await this.props.actions.createUserAccessToken(data.user_id,\r\n                    Utils.localizeMessage({id: 'bot.token.default.description', defaultMessage: 'Default Token'}),\r\n                );\r\n\r\n                // On error just skip the confirmation because we have a bot without a token.\r\n                if (!tokenResult || tokenResult.error) {\r\n                    getHistory().push(`/${this.props.team.name}/integrations/bots`);\r\n                    return;\r\n                }\r\n\r\n                token = tokenResult.data!.token!;\r\n            }\r\n\r\n            if (!error && data) {\r\n                error = this.updateRoles(data);\r\n            }\r\n\r\n            if (data) {\r\n                getHistory().push(`/${this.props.team.name}/integrations/confirm?type=bots&id=${data.user_id}&token=${token}`);\r\n                return;\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            adding: false,\r\n        });\r\n\r\n        if (error) {\r\n            this.setState({\r\n                error: error.message,\r\n            });\r\n        }\r\n    };\r\n\r\n    render() {\r\n        let subtitle = (\r\n            <FormattedMessage\r\n                id='bots.manage.add.add'\r\n                defaultMessage='Add'\r\n            />\r\n        );\r\n        let buttonText = (\r\n            <FormattedMessage\r\n                id='bots.manage.add.create'\r\n                defaultMessage='Create Bot Account'\r\n            />\r\n        );\r\n        let buttonActiveText = (\r\n            <FormattedMessage\r\n                id='bots.manage.add.creating'\r\n                defaultMessage='Creating...'\r\n            />\r\n        );\r\n\r\n        // If we are editing\r\n        if (this.props.bot) {\r\n            subtitle = (\r\n                <FormattedMessage\r\n                    id='bots.manage.edit'\r\n                    defaultMessage='Edit'\r\n                />\r\n            );\r\n            buttonText = (\r\n                <FormattedMessage\r\n                    id='bots.manage.edit.title'\r\n                    defaultMessage='Update'\r\n                />\r\n            );\r\n            buttonActiveText = (\r\n                <FormattedMessage\r\n                    id='bots.manage.edit.editing'\r\n                    defaultMessage='Updating...'\r\n                />\r\n            );\r\n        }\r\n\r\n        let imageURL = '';\r\n        let removeImageIcon: JSX.Element | null = (\r\n            <WithTooltip\r\n                title={\r\n                    <FormattedMessage\r\n                        id='bot.remove_profile_picture'\r\n                        defaultMessage='Remove Bot Icon'\r\n                    />\r\n                }\r\n            >\r\n                <a\r\n                    className={'bot-profile__remove'}\r\n                    onClick={this.setDefault}\r\n                >\r\n                    <span>{''}</span>\r\n                </a>\r\n            </WithTooltip>\r\n        );\r\n        let imageStyles;\r\n        if (this.props.bot && !this.state.pictureFile) {\r\n            if (this.props.user) {\r\n                imageURL = Utils.imageURLForUser(this.props.user.id, this.props.user.last_picture_update);\r\n            } else {\r\n                imageURL = Utils.imageURLForUser(this.props.bot.user_id);\r\n            }\r\n        } else {\r\n            imageURL = this.state.image;\r\n            imageStyles = this.state.orientationStyles;\r\n            if (this.state.image === BotDefaultIcon) {\r\n                removeImageIcon = null;\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-content'>\r\n                <BackstageHeader>\r\n                    <Link to={`/${this.props.team.name}/integrations/bots`}>\r\n                        <FormattedMessage\r\n                            id='bots.manage.header'\r\n                            defaultMessage='Bot Accounts'\r\n                        />\r\n                    </Link>\r\n                    {subtitle}\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={this.handleSubmit}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='username'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bots.add.username'\r\n                                    defaultMessage='Username'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='username'\r\n                                    type='text'\r\n                                    maxLength={22}\r\n                                    className='form-control'\r\n                                    value={this.state.username}\r\n                                    onChange={this.updateUsername}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.username.help'\r\n                                        defaultMessage='You can use lowercase letters, numbers, periods, dashes, and underscores.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='boticon'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bots.add.icon'\r\n                                    defaultMessage='Bot Icon'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <div className={'bot-img-container'}>\r\n                                    <img\r\n                                        className={'bot-img'}\r\n                                        alt={'bot image'}\r\n                                        src={imageURL}\r\n                                        style={imageStyles}\r\n                                    />\r\n                                    {removeImageIcon}\r\n                                </div>\r\n                                <div\r\n                                    className='btn btn-primary btn-file'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='bots.image.upload'\r\n                                        defaultMessage='Upload Image'\r\n                                    />\r\n                                    <input\r\n                                        className='btn-file__input'\r\n                                        accept={Constants.ACCEPT_STATIC_IMAGE}\r\n                                        type='file'\r\n                                        onChange={this.updatePicture}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='displayName'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bots.add.displayName'\r\n                                    defaultMessage='Display Name'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='displayName'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.displayName}\r\n                                    onChange={this.updateDisplayName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.display_name.help'\r\n                                        defaultMessage={'(Optional) You can choose to display your bot\\'s full name rather than its username.'}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bot.add.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={1024}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.description.help'\r\n                                        defaultMessage='(Optional) Let others know what this bot does.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='role'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bot.add.role'\r\n                                    defaultMessage='Role'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <select\r\n                                    className='form-control'\r\n                                    value={this.state.role}\r\n                                    disabled={!this.props.editingUserHasManageSystem}\r\n                                    onChange={this.updateRole}\r\n                                >\r\n                                    <option\r\n                                        value={roleOptionMember}\r\n                                    >\r\n                                        {Utils.localizeMessage({id: 'bot.add.role.member', defaultMessage: 'Member'})}\r\n                                    </option>\r\n                                    <option\r\n                                        value={roleOptionSystemAdmin}\r\n                                    >\r\n                                        {Utils.localizeMessage({id: 'bot.add.role.admin', defaultMessage: 'System Admin'})}\r\n                                    </option>\r\n                                </select>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.role.help'\r\n                                        defaultMessage='Choose what role the bot should have.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='row bot-profile__section'>\r\n                            <div className='col-md-5 col-sm-8 col-sm-offset-4'>\r\n                                <FormattedMessage\r\n                                    id='admin.manage_roles.botAdditionalRoles'\r\n                                    defaultMessage='Select additional permissions for the account. <link>Read more about roles and permissions</link>.'\r\n                                    values={{\r\n                                        link: (msg: React.ReactNode) => (\r\n                                            <ExternalLink\r\n                                                href={DeveloperLinks.PERSONAL_ACCESS_TOKENS}\r\n                                                location='add_bot'\r\n                                            >\r\n                                                {msg}\r\n                                            </ExternalLink>\r\n                                        ),\r\n                                    }}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='postAll'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bot.add.post_all'\r\n                                    defaultMessage='post:all'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8 checkbox'>\r\n                                <div className='checkbox no-padding'>\r\n                                    <label htmlFor='postAll'>\r\n                                        <input\r\n                                            id='postAll'\r\n                                            type='checkbox'\r\n                                            checked={this.state.postAll || this.state.role === roleOptionSystemAdmin}\r\n                                            onChange={this.updatePostAll}\r\n                                            disabled={!this.props.editingUserHasManageSystem || this.state.role === roleOptionSystemAdmin}\r\n                                        />\r\n                                        <FormattedMessage\r\n                                            id='bot.add.post_all.enabled'\r\n                                            defaultMessage='Enabled'\r\n                                        />\r\n                                    </label>\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.post_all.help'\r\n                                        defaultMessage='Bot will have access to post to all Mattermost channels including direct messages.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='postChannels'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bot.add.post_channels'\r\n                                    defaultMessage='post:channels'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8 checkbox'>\r\n                                <div className='checkbox no-padding'>\r\n                                    <label htmlFor='postChannels'>\r\n                                        <input\r\n                                            id='postChannels'\r\n                                            type='checkbox'\r\n                                            checked={this.state.postChannels || this.state.role === roleOptionSystemAdmin || this.state.postAll}\r\n                                            onChange={this.updatePostChannels}\r\n                                            disabled={!this.props.editingUserHasManageSystem || this.state.role === roleOptionSystemAdmin || this.state.postAll}\r\n                                        />\r\n                                        <FormattedMessage\r\n                                            id='bot.add.post_channels.enabled'\r\n                                            defaultMessage='Enabled'\r\n                                        />\r\n                                    </label>\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.post_channels.help'\r\n                                        defaultMessage='Bot will have access to post to all Mattermost public channels.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.state.error]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={`/${this.props.team.name}/integrations/bots`}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bots.manage.add.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.adding}\r\n                                spinningText={buttonActiveText}\r\n                                onClick={this.handleSubmit}\r\n                                id='saveBot'\r\n                            >\r\n                                {buttonText}\r\n                            </SpinnerButton>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {createBot, patchBot} from 'mattermost-redux/actions/bots';\r\nimport {updateUserRoles, uploadProfileImage, setDefaultProfileImage, createUserAccessToken} from 'mattermost-redux/actions/users';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getBotAccounts} from 'mattermost-redux/selectors/entities/bots';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport AddBot from './add_bot';\r\n\r\ntype OwnProps = {\r\n\r\n    /**\r\n     * Search query for the bot\r\n     */\r\n    location: RouteComponentProps['location'];\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const config = getConfig(state);\r\n    const botId = (new URLSearchParams(ownProps.location.search)).get('id');\r\n    const bots = getBotAccounts(state);\r\n    const bot = (bots && botId) ? bots[botId] : undefined;\r\n    const user = bot ? getUser(state, bot.user_id) : undefined;\r\n    const roles = user ? user.roles : undefined;\r\n    return {\r\n        maxFileSize: parseInt(config.MaxFileSize!, 10),\r\n        bot,\r\n        roles,\r\n        editingUserHasManageSystem: haveISystemPermission(state, {permission: Permissions.MANAGE_SYSTEM}),\r\n        user,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createBot,\r\n            patchBot,\r\n            uploadProfileImage,\r\n            setDefaultProfileImage,\r\n            createUserAccessToken,\r\n            updateUserRoles,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AddBot);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport debounce from 'lodash/debounce';\r\nimport React, {useCallback, useEffect, useMemo, useRef, useState} from 'react';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {OauthIcon, InformationOutlineIcon} from '@mattermost/compass-icons/components';\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\n\r\nimport {\r\n    getOutgoingOAuthConnectionsForAudience as fetchOutgoingOAuthConnectionsForAudience,\r\n    getOutgoingOAuthConnections as fetchOutgoingOAuthConnections,\r\n} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getOutgoingOAuthConnections} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport LocalizedPlaceholderInput from 'components/localized_placeholder_input';\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\ntype Props = {\r\n    value: string;\r\n    onChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n    placeholder: MessageDescriptor;\r\n}\r\n\r\nconst OAuthConnectionAudienceInput = (props: Props) => {\r\n    const mounted = useRef(false);\r\n    const [matchedConnection, setMatchingOAuthConnection] = useState<OutgoingOAuthConnection | null>(null);\r\n    const [loadingAudienceMatch, setLoadingAudienceMatch] = useState(false);\r\n\r\n    const oauthConnections = useSelector(getOutgoingOAuthConnections);\r\n    const oauthConnectionsEnabled = useSelector(getConfig).EnableOutgoingOAuthConnections === 'true';\r\n    const teamId = useSelector(getCurrentTeamId);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const matchConnectionsOnInput = useCallback(async (inputValue: string) => {\r\n        const res = await dispatch(fetchOutgoingOAuthConnectionsForAudience(teamId, inputValue));\r\n        setLoadingAudienceMatch(false);\r\n\r\n        if (res.data && res.data.length) {\r\n            setMatchingOAuthConnection(res.data[0]);\r\n        } else {\r\n            setMatchingOAuthConnection(null);\r\n        }\r\n    }, [dispatch, teamId]);\r\n\r\n    const debouncedMatchConnections = useMemo(() => {\r\n        return debounce((inputValue: string) => matchConnectionsOnInput(inputValue), 1000);\r\n    }, [matchConnectionsOnInput]);\r\n\r\n    useEffect(() => {\r\n        if (mounted.current) {\r\n            return;\r\n        }\r\n        mounted.current = true;\r\n\r\n        if (oauthConnectionsEnabled) {\r\n            dispatch(fetchOutgoingOAuthConnections(teamId));\r\n            if (props.value) {\r\n                setLoadingAudienceMatch(true);\r\n                matchConnectionsOnInput(props.value);\r\n            }\r\n        }\r\n    }, [oauthConnectionsEnabled, props.value, teamId, matchConnectionsOnInput, dispatch, mounted]);\r\n\r\n    const onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        props.onChange(e);\r\n\r\n        if (oauthConnectionsEnabled) {\r\n            setLoadingAudienceMatch(true);\r\n            debouncedMatchConnections(e.target.value);\r\n        }\r\n    };\r\n\r\n    const connections = Object.values(oauthConnections);\r\n\r\n    const input = (\r\n        <LocalizedPlaceholderInput\r\n            autoComplete='off'\r\n            id='url'\r\n            maxLength={1024}\r\n            className='form-control'\r\n            value={props.value}\r\n            onChange={onChange}\r\n            placeholder={props.placeholder}\r\n        />\r\n    );\r\n\r\n    if (!connections.length) {\r\n        return input;\r\n    }\r\n\r\n    let oauthMessage: React.ReactNode;\r\n\r\n    if (loadingAudienceMatch) {\r\n        oauthMessage = (\r\n            <span>\r\n                <LoadingSpinner/>\r\n            </span>\r\n        );\r\n    } else if (matchedConnection) {\r\n        oauthMessage = (\r\n            <>\r\n                <span>\r\n                    <OauthIcon\r\n                        size={20}\r\n                    />\r\n                </span>\r\n                <span className='outgoing-oauth-audience-match-message'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.connected'\r\n                        defaultMessage='Connected to \"{connectionName}\"'\r\n                        values={{\r\n                            connectionName: matchedConnection.name,\r\n                        }}\r\n                    />\r\n                </span>\r\n            </>\r\n        );\r\n    } else {\r\n        oauthMessage = (\r\n            <>\r\n                <span>\r\n                    <InformationOutlineIcon\r\n                        size={20}\r\n                    />\r\n                </span>\r\n                <span className='outgoing-oauth-audience-match-message'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.not_connected'\r\n                        defaultMessage='Not linked to an OAuth connection'\r\n                    />\r\n                </span>\r\n            </>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {input}\r\n            <div className='outgoing-oauth-audience-match-message-container'>\r\n                {oauthMessage}\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default OAuthConnectionAudienceInput;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent} from 'react';\r\nimport {defineMessage, FormattedMessage, type MessageDescriptor} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ExternalLink from 'components/external_link';\r\nimport FormError from 'components/form_error';\r\nimport LocalizedPlaceholderInput from 'components/localized_placeholder_input';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\nimport {Constants, DeveloperLinks} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport OAuthConnectionAudienceInput from './outgoing_oauth_connections/oauth_connection_audience_input';\r\n\r\nconst REQUEST_POST = 'P';\r\nconst REQUEST_GET = 'G';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    * The current team\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * The header text to render, has id and defaultMessage\r\n    */\r\n    header: MessageDescriptor | string;\r\n\r\n    /**\r\n    * The footer text to render, has id and defaultMessage\r\n    */\r\n    footer: MessageDescriptor | string;\r\n\r\n    /**\r\n    * The spinner loading text to render, has id and defaultMessage\r\n    */\r\n    loading: MessageDescriptor | string;\r\n\r\n    /**\r\n    * Any extra component/node to render\r\n    */\r\n    renderExtra?: JSX.Element;\r\n\r\n    /**\r\n    * The server error text after a failed action\r\n    */\r\n    serverError: string;\r\n\r\n    /**\r\n    * The Command used to set the initial state\r\n    */\r\n    initialCommand?: Partial<Command>;\r\n\r\n    /**\r\n    * The async function to run when the action button is pressed\r\n    */\r\n    action: (command: Command) => Promise<void>;\r\n}\r\n\r\ntype State = {\r\n    saving: boolean;\r\n    clientError: null | JSX.Element | string;\r\n    trigger: string;\r\n    displayName: string;\r\n    description: string;\r\n    url: string;\r\n    method: 'P' | 'G' | '';\r\n    username: string;\r\n    iconUrl: string;\r\n    autocomplete: boolean;\r\n    autocompleteHint: string;\r\n    autocompleteDescription: string;\r\n}\r\n\r\nexport default class AbstractCommand extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = this.getStateFromCommand(this.props.initialCommand || {});\r\n    }\r\n\r\n    getStateFromCommand = (command: Props['initialCommand']): State => {\r\n        return {\r\n            displayName: command?.display_name ?? '',\r\n            description: command?.description ?? '',\r\n            trigger: command?.trigger ?? '',\r\n            url: command?.url ?? '',\r\n            method: command?.method ?? REQUEST_POST,\r\n            username: command?.username ?? '',\r\n            iconUrl: command?.icon_url ?? '',\r\n            autocomplete: command?.auto_complete ?? false,\r\n            autocompleteHint: command?.auto_complete_hint ?? '',\r\n            autocompleteDescription: command?.auto_complete_desc ?? '',\r\n            saving: false,\r\n            clientError: null,\r\n        };\r\n    };\r\n\r\n    getBackstageHeader = () => {\r\n        if (typeof this.props.header === 'string') {\r\n            return <span>{this.props.header}</span>;\r\n        }\r\n\r\n        return (\r\n            <FormattedMessage\r\n                id={this.props.header.id}\r\n                defaultMessage={this.props.header.defaultMessage}\r\n            />\r\n        );\r\n    };\r\n\r\n    getBackstageFooter = () => {\r\n        if (typeof this.props.footer === 'string') {\r\n            return <span>{this.props.footer}</span>;\r\n        }\r\n\r\n        return (\r\n            <FormattedMessage\r\n                id={this.props.footer.id}\r\n                defaultMessage={this.props.footer.defaultMessage}\r\n            />\r\n        );\r\n    };\r\n\r\n    handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            clientError: '',\r\n        });\r\n\r\n        let triggerWord = this.state.trigger.trim().toLowerCase();\r\n        if (triggerWord.indexOf('/') === 0) {\r\n            triggerWord = triggerWord.substr(1);\r\n        }\r\n\r\n        const command = {\r\n            display_name: this.state.displayName,\r\n            description: this.state.description,\r\n            trigger: triggerWord,\r\n            url: this.state.url.trim(),\r\n            method: this.state.method,\r\n            username: this.state.username,\r\n            icon_url: this.state.iconUrl,\r\n            auto_complete: this.state.autocomplete,\r\n            team_id: this.props.team.id,\r\n            auto_complete_desc: '',\r\n            auto_complete_hint: '',\r\n            token: '',\r\n            create_at: 0,\r\n            update_at: 0,\r\n            delete_at: 0,\r\n            id: '',\r\n            creator_id: '',\r\n        };\r\n\r\n        if (command.auto_complete) {\r\n            command.auto_complete_desc = this.state.autocompleteDescription ?? '';\r\n            command.auto_complete_hint = this.state.autocompleteHint ?? '';\r\n        }\r\n\r\n        if (!command.trigger) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.triggerRequired'\r\n                        defaultMessage='A trigger word is required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (command.trigger.indexOf('/') === 0) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.triggerInvalidSlash'\r\n                        defaultMessage='A trigger word cannot begin with a /'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (command.trigger.indexOf(' ') !== -1) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.triggerInvalidSpace'\r\n                        defaultMessage='A trigger word must not contain spaces'\r\n                    />\r\n                ),\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (command.trigger.length < Constants.MIN_TRIGGER_LENGTH ||\r\n            command.trigger.length > Constants.MAX_TRIGGER_LENGTH) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.triggerInvalidLength'\r\n                        defaultMessage='A trigger word must contain between {min} and {max} characters'\r\n                        values={{\r\n                            min: Constants.MIN_TRIGGER_LENGTH,\r\n                            max: Constants.MAX_TRIGGER_LENGTH,\r\n                        }}\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (!command.url) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.urlRequired'\r\n                        defaultMessage='A request URL is required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        this.props.action(command).then(() => this.setState({saving: false}));\r\n    };\r\n\r\n    updateDisplayName = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            displayName: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDescription = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateTrigger = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            trigger: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateUrl = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            url: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateMethod = (e: ChangeEvent<HTMLSelectElement>) => {\r\n        const methodValue = e.target.value;\r\n        if (methodValue === 'P' || methodValue === 'G' || methodValue === '') {\r\n            this.setState({\r\n                method: methodValue,\r\n            });\r\n        }\r\n    };\r\n\r\n    updateUsername = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            username: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateIconUrl = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            iconUrl: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateAutocomplete = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            autocomplete: e.target.checked,\r\n        });\r\n    };\r\n\r\n    updateAutocompleteHint = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            autocompleteHint: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateAutocompleteDescription = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            autocompleteDescription: e.target.value,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        let autocompleteHint = null;\r\n        let autocompleteDescription = null;\r\n\r\n        if (this.state.autocomplete) {\r\n            autocompleteHint = (\r\n                <div className='form-group'>\r\n                    <label\r\n                        className='control-label col-sm-4'\r\n                        htmlFor='autocompleteHint'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='add_command.autocompleteHint'\r\n                            defaultMessage='Autocomplete Hint'\r\n                        />\r\n                    </label>\r\n                    <div className='col-md-5 col-sm-8'>\r\n                        <LocalizedPlaceholderInput\r\n                            id='autocompleteHint'\r\n                            type='text'\r\n                            maxLength={1024}\r\n                            className='form-control'\r\n                            value={this.state.autocompleteHint}\r\n                            onChange={this.updateAutocompleteHint}\r\n                            placeholder={defineMessage({\r\n                                id: 'add_command.autocompleteHint.placeholder',\r\n                                defaultMessage: 'Example: [Patient Name]',\r\n                            })}\r\n                        />\r\n                        <div className='form__help'>\r\n                            <FormattedMessage\r\n                                id='add_command.autocompleteHint.help'\r\n                                defaultMessage='(Optional) Specify the arguments associated with your slash command. These are displayed as help on the autocomplete list.'\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n            autocompleteDescription = (\r\n                <div className='form-group'>\r\n                    <label\r\n                        className='control-label col-sm-4'\r\n                        htmlFor='autocompleteDescription'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='add_command.autocompleteDescription'\r\n                            defaultMessage='Autocomplete Description'\r\n                        />\r\n                    </label>\r\n                    <div className='col-md-5 col-sm-8'>\r\n                        <LocalizedPlaceholderInput\r\n                            id='description'\r\n                            type='text'\r\n                            maxLength={128}\r\n                            className='form-control'\r\n                            value={this.state.autocompleteDescription}\r\n                            onChange={this.updateAutocompleteDescription}\r\n                            placeholder={defineMessage({\r\n                                id: 'add_command.autocompleteDescription.placeholder',\r\n                                defaultMessage: 'Example: \"Returns search results for patient records\"',\r\n                            })}\r\n                        />\r\n                        <div className='form__help'>\r\n                            <FormattedMessage\r\n                                id='add_command.autocompleteDescription.help'\r\n                                defaultMessage='(Optional) Describe your slash command for the autocomplete list.'\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-content row'>\r\n                <BackstageHeader>\r\n                    <Link to={'/' + this.props.team.name + '/integrations/commands'}>\r\n                        <FormattedMessage\r\n                            id='installed_command.header'\r\n                            defaultMessage='Slash Commands'\r\n                        />\r\n                    </Link>\r\n                    {this.getBackstageHeader()}\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={this.handleSubmit}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='displayName'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.displayName'\r\n                                    defaultMessage='Title'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='displayName'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.displayName}\r\n                                    onChange={this.updateDisplayName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.displayName.help'\r\n                                        defaultMessage='Specify a title, of up to 64 characters, for the slash command settings page.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={128}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.description.help'\r\n                                        defaultMessage='Describe your slash command.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='trigger'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.trigger'\r\n                                    defaultMessage='Command Trigger Word'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <LocalizedPlaceholderInput\r\n                                    id='trigger'\r\n                                    type='text'\r\n                                    maxLength={Constants.MAX_TRIGGER_LENGTH}\r\n                                    className='form-control'\r\n                                    value={this.state.trigger}\r\n                                    onChange={this.updateTrigger}\r\n                                    placeholder={defineMessage({\r\n                                        id: 'add_command.trigger.placeholder',\r\n                                        defaultMessage: 'Command trigger e.g. \"hello\" not including the slash',\r\n                                    })}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.trigger.help'\r\n                                        defaultMessage='Specify a trigger word that is not a built-in command, does not contain spaces, and does not begin with the slash character.'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.trigger.helpExamples'\r\n                                        defaultMessage='Examples: client, employee, patient, weather'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.trigger.helpReserved'\r\n                                        defaultMessage='Reserved: {link}'\r\n                                        values={{\r\n                                            link: (\r\n                                                <ExternalLink\r\n                                                    href={DeveloperLinks.CUSTOM_SLASH_COMMANDS}\r\n                                                    location='abstract_command'\r\n                                                >\r\n                                                    <FormattedMessage\r\n                                                        id='add_command.trigger.helpReservedLinkText'\r\n                                                        defaultMessage='See built-in slash commands'\r\n                                                    />\r\n                                                </ExternalLink>\r\n                                            ),\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='url'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.url'\r\n                                    defaultMessage='Request URL'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <OAuthConnectionAudienceInput\r\n                                    value={this.state.url}\r\n                                    onChange={this.updateUrl}\r\n                                    placeholder={defineMessage({\r\n                                        id: 'add_command.url.placeholder',\r\n                                        defaultMessage: 'Must start with http:// or https://',\r\n                                    })}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.url.help'\r\n                                        defaultMessage='Specify the callback URL to receive the HTTP POST or GET event request when the slash command is run.'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id={'add_command.outgoing_oauth_connections.help_text'}\r\n                                        defaultMessage={'You can connect commands to <link>outgoing OAuth connections</link>.'}\r\n                                        values={{\r\n                                            link: (text: string) => (\r\n                                                <a href='https://mattermost.com/pl/outgoing-oauth-connections'>{text}</a>\r\n                                            ),\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='method'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.method'\r\n                                    defaultMessage='Request Method'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <select\r\n                                    id='method'\r\n                                    className='form-control'\r\n                                    value={this.state.method}\r\n                                    onChange={this.updateMethod}\r\n                                >\r\n                                    <option value={REQUEST_POST}>\r\n                                        {Utils.localizeMessage({id: 'add_command.method.post', defaultMessage: 'POST'})}\r\n                                    </option>\r\n                                    <option value={REQUEST_GET}>\r\n                                        {Utils.localizeMessage({id: 'add_command.method.get', defaultMessage: 'GET'})}\r\n                                    </option>\r\n                                </select>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.method.help'\r\n                                        defaultMessage='Specify the type of request, either POST or GET, sent to the endpoint that Mattermost hits to reach your application.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='username'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.username'\r\n                                    defaultMessage='Response Username'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <LocalizedPlaceholderInput\r\n                                    id='username'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.username}\r\n                                    onChange={this.updateUsername}\r\n                                    placeholder={defineMessage({\r\n                                        id: 'add_command.username.placeholder',\r\n                                        defaultMessage: 'Username',\r\n                                    })}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.username.help'\r\n                                        defaultMessage='(Optional) Specify the name to use when posting responses for this slash command. Usernames can be up to 22 characters, and contain lowercase letters, numbers, and the symbols \\\"-\\\", \\\"_\\\", and \\\".\\\". If left blank, your Mattermost username is used.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='iconUrl'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.iconUrl'\r\n                                    defaultMessage='Response Icon'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <LocalizedPlaceholderInput\r\n                                    id='iconUrl'\r\n                                    type='text'\r\n                                    maxLength={1024}\r\n                                    className='form-control'\r\n                                    value={this.state.iconUrl}\r\n                                    onChange={this.updateIconUrl}\r\n                                    placeholder={defineMessage({\r\n                                        id: 'add_command.iconUrl.placeholder',\r\n                                        defaultMessage: 'https://www.example.com/myicon.png',\r\n                                    })}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.iconUrl.help'\r\n                                        defaultMessage='(Optional) Enter the URL of a .png or .jpg file to use as the icon when posting responses to this slash command. The file must be at least 128 pixels by 128 pixels. If left blank, your profile picture is used.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='autocomplete'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.autocomplete'\r\n                                    defaultMessage='Autocomplete'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8 checkbox'>\r\n                                <input\r\n                                    id='autocomplete'\r\n                                    type='checkbox'\r\n                                    checked={this.state.autocomplete}\r\n                                    onChange={this.updateAutocomplete}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.autocomplete.help'\r\n                                        defaultMessage='(Optional) Show your slash command on the autocomplete list when someone types \"/\" in the input box.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        {autocompleteHint}\r\n                        {autocompleteDescription}\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.props.serverError, this.state.clientError]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={'/' + this.props.team.name + '/integrations/commands'}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={this.props.loading}\r\n                                onClick={this.handleSubmit}\r\n                                id='saveCommand'\r\n                            >\r\n                                {this.getBackstageFooter()}\r\n                            </SpinnerButton>\r\n                            {this.props.renderExtra}\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions.js';\r\n\r\nimport AbstractCommand from '../abstract_command';\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n    * The team data\r\n    */\r\n    team: Team;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to add new command\r\n        */\r\n        addCommand: (command: Command) => Promise<ActionResult<Command>>;\r\n    };\r\n};\r\n\r\nconst AddCommand = ({team, actions}: Props) => {\r\n    const history = useHistory();\r\n    const {formatMessage} = useIntl();\r\n    const headerMessage = formatMessage({id: ('integrations.add'), defaultMessage: 'Add'}) as MessageDescriptor;\r\n    const footerMessage = formatMessage({id: ('add_command.save'), defaultMessage: 'Save'}) as MessageDescriptor;\r\n    const loadingMessage = formatMessage({id: ('add_command.saving'), defaultMessage: 'Saving...'}) as MessageDescriptor;\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const addCommand = async (command: Command) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = await actions.addCommand(command);\r\n        if (data) {\r\n            history.push(`/${team.name}/integrations/commands/confirm?type=commands&id=${data.id}`);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AbstractCommand\r\n            team={team}\r\n            header={headerMessage}\r\n            footer={footerMessage}\r\n            loading={loadingMessage}\r\n            action={addCommand}\r\n            serverError={serverError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default AddCommand;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {addCommand} from 'mattermost-redux/actions/integrations';\r\n\r\nimport AddCommand from './add_command';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            addCommand,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(AddCommand);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {copyToClipboard} from 'utils/utils';\r\n\r\ntype Props = {\r\n    label: MessageDescriptor;\r\n    value: string;\r\n};\r\n\r\nconst CopyText = ({\r\n    label,\r\n    value,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    const copyText = useCallback((e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        copyToClipboard(value);\r\n    }, [value]);\r\n\r\n    if (!document.queryCommandSupported('copy')) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <WithTooltip title={label}>\r\n            <button\r\n                data-testid='copyText'\r\n                className='btn btn-link icon-content-copy ml-2'\r\n                aria-label={intl.formatMessage(label)}\r\n                onClick={copyText}\r\n            />\r\n        </WithTooltip>\r\n    );\r\n};\r\n\r\nexport default React.memo(CopyText);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect} from 'react';\r\nimport {defineMessages, FormattedMessage} from 'react-intl';\r\nimport {Link, useHistory} from 'react-router-dom';\r\n\r\nimport type {Bot} from '@mattermost/types/bots';\r\nimport type {Command, IncomingWebhook, OAuthApp, OutgoingOAuthConnection, OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {IDMappedObjects} from '@mattermost/types/utilities';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport CopyText from 'components/copy_text';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport {Constants, DeveloperLinks, ErrorPageTypes} from 'utils/constants';\r\nimport {getSiteURL} from 'utils/url';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    location: {search: string};\r\n    commands: IDMappedObjects<Command>;\r\n    oauthApps: IDMappedObjects<OAuthApp>;\r\n    incomingHooks: IDMappedObjects<IncomingWebhook>;\r\n    outgoingHooks: IDMappedObjects<OutgoingWebhook>;\r\n    bots: Record<string, Bot>;\r\n    outgoingOAuthConnections: Record<string, OutgoingOAuthConnection>;\r\n}\r\n\r\nconst ConfirmIntegration = ({team, location, commands, oauthApps, incomingHooks, outgoingHooks, bots, outgoingOAuthConnections}: Props): JSX.Element | null => {\r\n    const history = useHistory();\r\n\r\n    const type = (new URLSearchParams(location.search)).get('type') || '';\r\n    const id = (new URLSearchParams(location.search)).get('id') || '';\r\n\r\n    useEffect(() => {\r\n        window.addEventListener('keypress', handleKeyPress);\r\n\r\n        return () => {\r\n            window.removeEventListener('keypress', handleKeyPress);\r\n        };\r\n    });\r\n\r\n    const handleKeyPress = (e: KeyboardEvent) => {\r\n        if (e.key === 'Enter') {\r\n            history.push('/' + team.name + '/integrations/' + type);\r\n        }\r\n    };\r\n\r\n    let headerText: JSX.Element;\r\n    let helpText: JSX.Element | JSX.Element[];\r\n    let tokenText: JSX.Element;\r\n\r\n    const command = commands[id];\r\n    const incomingHook = incomingHooks[id];\r\n    const outgoingHook = outgoingHooks[id];\r\n    const oauthApp = oauthApps[id];\r\n    const outgoingOAuthConnection = outgoingOAuthConnections[id];\r\n    const bot = bots[id];\r\n\r\n    if (type === Constants.Integrations.COMMAND && command) {\r\n        const commandToken = command.token;\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id='slash_commands.header'\r\n                defaultMessage='Slash Commands'\r\n            />\r\n        );\r\n        helpText = (\r\n            <p>\r\n                <FormattedMessage\r\n                    id='add_command.doneHelp'\r\n                    defaultMessage='Your slash command is set up. The following token will be sent in the outgoing payload. Please use it to verify the request came from your Mattermost team (details at <link>Slash Commands</link>).'\r\n                    values={{\r\n                        link: (msg: string) => (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_CUSTOM_SLASH_COMMANDS}\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_command.token'\r\n                    defaultMessage='<b>Token</b>: {token}'\r\n                    values={{\r\n                        token: <code>{commandToken}</code>,\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyToken}\r\n                    value={commandToken}\r\n                />\r\n            </p>\r\n        );\r\n    } else if (type === Constants.Integrations.INCOMING_WEBHOOK && incomingHook) {\r\n        const incomingHookToken = getSiteURL() + '/hooks/' + incomingHook.id;\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id={'incoming_webhooks.header'}\r\n                defaultMessage='Incoming Webhooks'\r\n            />\r\n        );\r\n        helpText = (\r\n            <p>\r\n                <FormattedMessage\r\n                    id='add_incoming_webhook.doneHelp'\r\n                    defaultMessage='Your incoming webhook is set up. Please send data to the following URL (details at <link>Incoming Webhooks</link>).'\r\n                    values={{\r\n                        link: (msg: string) => (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_INCOMING_WEBHOOKS}\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_incoming_webhook.url'\r\n                    defaultMessage='<b>URL</b>: {url}'\r\n                    values={{\r\n                        url: <code>{incomingHookToken}</code>,\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyToken}\r\n                    value={incomingHookToken}\r\n                />\r\n            </p>\r\n        );\r\n    } else if (type === Constants.Integrations.OUTGOING_WEBHOOK && outgoingHook) {\r\n        const outgoingHookToken = outgoingHook.token;\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id={'add_outgoing_webhook.header'}\r\n                defaultMessage='Outgoing Webhooks'\r\n            />\r\n        );\r\n        helpText = (\r\n            <p>\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.doneHelp'\r\n                    defaultMessage='Your outgoing webhook is set up. The following token will be sent in the outgoing payload. Please use it to verify that the request came from your Mattermost team (details at <link>Outgoing Webhooks</link>).'\r\n                    values={{\r\n                        link: (msg: string) => (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_OUTGOING_WEBHOOKS}\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.token'\r\n                    defaultMessage='<b>Token</b>: {token}'\r\n                    values={{\r\n                        token: <code>{outgoingHookToken}</code>,\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyToken}\r\n                    value={outgoingHookToken}\r\n                />\r\n            </p>\r\n        );\r\n    } else if (type === Constants.Integrations.OAUTH_APP && oauthApp) {\r\n        const oauthAppToken = oauthApp.id;\r\n        const oauthAppSecret = oauthApp.client_secret;\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id={'installed_oauth2_apps.header'}\r\n                defaultMessage='OAuth 2.0 Applications'\r\n            />\r\n        );\r\n\r\n        helpText = [];\r\n        helpText.push(\r\n            <p key='add_oauth_app.doneHelp'>\r\n                <FormattedMessage\r\n                    id='add_oauth_app.doneHelp'\r\n                    defaultMessage='Your OAuth 2.0 application is set up. Please use the following Client ID and Client Secret when requesting authorization for your application (details at <link>oAuth 2 Applications</link>).'\r\n                    values={{\r\n                        link: (msg: string) => (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_OAUTH2}\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>,\r\n        );\r\n        helpText.push(\r\n            <p key='add_oauth_app.clientId'>\r\n                <FormattedMessage\r\n                    id='add_oauth_app.clientId'\r\n                    defaultMessage='<b>Client ID</b>: {id}'\r\n                    values={{\r\n                        id: <code>{oauthAppToken}</code>,\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyClientId}\r\n                    value={oauthAppToken}\r\n                />\r\n                <br/>\r\n                <FormattedMessage\r\n                    id='add_oauth_app.clientSecret'\r\n                    defaultMessage='<b>Client Secret</b>: {secret}'\r\n                    values={{\r\n                        secret: <code>{oauthAppSecret}</code>,\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyClientSecret}\r\n                    value={oauthAppSecret}\r\n                />\r\n            </p>,\r\n        );\r\n\r\n        helpText.push(\r\n            <p key='add_oauth_app.doneUrlHelp'>\r\n                <FormattedMessage\r\n                    id='add_oauth_app.doneUrlHelp'\r\n                    defaultMessage='Here are your authorized redirect URLs.'\r\n                />\r\n            </p>,\r\n        );\r\n\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_oauth_app.url'\r\n                    defaultMessage='<b>URL(s)</b>: {url}'\r\n                    values={{\r\n                        url: oauthApp.callback_urls.join(', '),\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n    } else if (type === Constants.Integrations.OUTGOING_OAUTH_CONNECTIONS && outgoingOAuthConnection) {\r\n        const clientId = outgoingOAuthConnection.client_id;\r\n        const clientSecret = outgoingOAuthConnection.client_secret;\r\n        const username = outgoingOAuthConnection.credentials_username;\r\n        const password = outgoingOAuthConnection.credentials_password;\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id='installed_outgoing_oauth_connections.header'\r\n                defaultMessage='Outgoing OAuth 2.0 Connections'\r\n            />\r\n        );\r\n\r\n        helpText = [];\r\n        helpText.push(\r\n            <p key='add_outgoing_oauth_connection.doneHelp'>\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.doneHelp'\r\n                    defaultMessage='Your Outgoing OAuth 2.0 Connection is set up. When a request is sent to one of the following Audience URLs, the Client ID and Client Secret will now be used to retrieve a token from the Token URL, before sending the integration request (details at <link>Outgoing OAuth 2.0 Connections</link>).'\r\n                    values={{\r\n                        link: (msg: string) => (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_OAUTH2} // TODO: dev docs for outgoing oauth connections feature\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>,\r\n        );\r\n        helpText.push(\r\n            <p key='add_outgoing_oauth_connection.clientId'>\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.clientId'\r\n                    defaultMessage='<b>Client ID</b>: {id}'\r\n                    values={{\r\n                        id: <code>{clientId}</code>,\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <br/>\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.clientSecret'\r\n                    defaultMessage='<b>Client Secret</b>: \\*\\*\\*\\*\\*\\*\\*\\*'\r\n                    values={{\r\n                        secret: clientSecret,\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n            </p>,\r\n        );\r\n\r\n        if (outgoingOAuthConnection.grant_type === 'password') {\r\n            helpText.push(\r\n                <p key='add_outgoing_oauth_connection.username'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.username'\r\n                        defaultMessage='<b>Username</b>: {username}'\r\n                        values={{\r\n                            username,\r\n                            b: (chunks: string) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                    <CopyText\r\n                        label={messages.copyUsername}\r\n                        value={username || ''}\r\n                    />\r\n                    <br/>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.password'\r\n                        defaultMessage='<b>Password</b>: {password}'\r\n                        values={{\r\n                            password,\r\n                            b: (chunks: string) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                </p>,\r\n            );\r\n        }\r\n\r\n        tokenText = (\r\n            <>\r\n                <p className='word-break--all'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.token_url'\r\n                        defaultMessage='<b>Token URL</b>: {url}'\r\n                        values={{\r\n                            url: <code>{outgoingOAuthConnection.oauth_token_url}</code>,\r\n                            b: (chunks: string) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                </p>\r\n                <p className='word-break--all'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.audience_urls'\r\n                        defaultMessage='<b>Audience URL(s)</b>: {url}'\r\n                        values={{\r\n                            url: <code>{outgoingOAuthConnection.audiences.join(', ')}</code>,\r\n                            b: (chunks: string) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                </p>\r\n            </>\r\n        );\r\n    } else if (type === Constants.Integrations.BOT && bot) {\r\n        const botToken = (new URLSearchParams(location.search)).get('token') || '';\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id='bots.manage.header'\r\n                defaultMessage='Bot Accounts'\r\n            />\r\n        );\r\n        helpText = (\r\n            <p>\r\n                <FormattedMessage\r\n                    id='bots.manage.created.text'\r\n                    defaultMessage='Your bot account **{botname}** has been created successfully. Please use the following access token to connect to the bot (see [documentation](https://mattermost.com/pl/default-bot-accounts) for further details).'\r\n                    values={{\r\n                        botname: bot.display_name || bot.username,\r\n                        b: (msg: string) => <b>{msg}</b>,\r\n                        link: (msg: string) => (\r\n                            <ExternalLink\r\n                                href='https://mattermost.com/pl/default-bot-accounts'\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.token'\r\n                    defaultMessage='<b>Token</b>: {token}'\r\n                    values={{\r\n                        token: <code>{botToken}</code>,\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyToken}\r\n                    value={botToken}\r\n                />\r\n                <br/>\r\n                <br/>\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.token.message'\r\n                    defaultMessage='Make sure to add this bot account to teams and channels you want it to interact in. See <link>documentation</link> to learn more.'\r\n                    values={{\r\n                        link: (msg: string) => (\r\n                            <ExternalLink\r\n                                href='https://mattermost.com/pl/default-bot-accounts'\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n    } else {\r\n        history.replace(`/error?type=${ErrorPageTypes.PAGE_NOT_FOUND}`);\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className='backstage-content row'>\r\n            <BackstageHeader>\r\n                <Link to={'/' + team.name + '/integrations/' + type}>\r\n                    {headerText}\r\n                </Link>\r\n                <FormattedMessage\r\n                    id='integrations.add'\r\n                    defaultMessage='Add'\r\n                />\r\n            </BackstageHeader>\r\n            <div className='backstage-form backstage-form__confirmation'>\r\n                <h4\r\n                    className='backstage-form__title'\r\n                    id='formTitle'\r\n                >\r\n                    <FormattedMessage\r\n                        id='integrations.successful'\r\n                        defaultMessage='Setup Successful'\r\n                    />\r\n                </h4>\r\n                {helpText}\r\n                {tokenText}\r\n                <div className='backstage-form__footer'>\r\n                    <Link\r\n                        className='btn btn-primary'\r\n                        type='submit'\r\n                        to={'/' + team.name + '/integrations/' + type}\r\n                        id='doneButton'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='integrations.done'\r\n                            defaultMessage='Done'\r\n                        />\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst messages = defineMessages({\r\n    copyClientId: {\r\n        id: 'integrations.copy_client_id',\r\n        defaultMessage: 'Copy Client Id',\r\n    },\r\n    copyClientSecret: {\r\n        id: 'integrations.copy_client_secret',\r\n        defaultMessage: 'Copy Client Secret',\r\n    },\r\n    copyToken: {\r\n        id: 'integrations.copy_token',\r\n        defaultMessage: 'Copy Token',\r\n    },\r\n    copyUsername: {\r\n        id: 'integrations.copy_username',\r\n        defaultMessage: 'Copy Username',\r\n    },\r\n});\r\n\r\nexport default ConfirmIntegration;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getBotAccounts} from 'mattermost-redux/selectors/entities/bots';\r\nimport {getCommands, getOAuthApps, getIncomingHooks, getOutgoingHooks, getOutgoingOAuthConnections} from 'mattermost-redux/selectors/entities/integrations';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ConfirmIntegration from './confirm_integration';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        commands: getCommands(state),\r\n        oauthApps: getOAuthApps(state),\r\n        incomingHooks: getIncomingHooks(state),\r\n        outgoingHooks: getOutgoingHooks(state),\r\n        bots: getBotAccounts(state),\r\n        outgoingOAuthConnections: getOutgoingOAuthConnections(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(ConfirmIntegration);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, defineMessages} from 'react-intl';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nimport AbstractCommand from '../abstract_command';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'edit_command.update',\r\n        defaultMessage: 'Update',\r\n    },\r\n    header: {\r\n        id: 'integrations.edit',\r\n        defaultMessage: 'Edit',\r\n    },\r\n    loading: {\r\n        id: 'edit_command.updating',\r\n        defaultMessage: 'Updating...',\r\n    },\r\n});\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    * The current team\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * The id of the command to edit\r\n    */\r\n    commandId: string | null;\r\n\r\n    /**\r\n    * Installed slash commands to display\r\n    */\r\n    commands: RelationOneToOne<Command, Command>;\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to fetch team commands\r\n        */\r\n        getCustomTeamCommands: (teamId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call to edit command\r\n        */\r\n        editCommand: (command: Command) => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n    * Whether or not commands are enabled.\r\n    */\r\n    enableCommands: boolean;\r\n}\r\n\r\ntype State = {\r\n    originalCommand: Command | null;\r\n    showConfirmModal: boolean;\r\n    serverError: string;\r\n}\r\n\r\nexport default class EditCommand extends React.PureComponent<Props, State> {\r\n    private newCommand?: Command;\r\n\r\n    public constructor(props: Props) {\r\n        super(props);\r\n        this.newCommand = undefined;\r\n\r\n        this.state = {\r\n            originalCommand: null,\r\n            showConfirmModal: false,\r\n            serverError: '',\r\n        };\r\n    }\r\n\r\n    public componentDidMount(): void {\r\n        if (this.props.enableCommands) {\r\n            this.props.actions.getCustomTeamCommands(this.props.team.id).then(\r\n                () => {\r\n                    this.setState({\r\n                        originalCommand: Object.values(this.props.commands).filter((command) => command.id === this.props.commandId)[0],\r\n                    });\r\n                },\r\n            );\r\n        }\r\n    }\r\n\r\n    public editCommand = async (command: Command): Promise<void> => {\r\n        this.newCommand = command;\r\n\r\n        if (this.state.originalCommand?.id) {\r\n            command.id = this.state.originalCommand.id;\r\n        }\r\n\r\n        if (this.state.originalCommand?.url !== this.newCommand.url ||\r\n            this.state.originalCommand?.trigger !== this.newCommand.trigger ||\r\n            this.state.originalCommand?.method !== this.newCommand.method) {\r\n            this.handleConfirmModal();\r\n        } else {\r\n            await this.submitCommand();\r\n        }\r\n    };\r\n\r\n    public handleConfirmModal = (): void => {\r\n        this.setState({showConfirmModal: true});\r\n    };\r\n\r\n    public confirmModalDismissed = (): void => {\r\n        this.setState({showConfirmModal: false});\r\n    };\r\n\r\n    public submitCommand = async (): Promise<void> => {\r\n        this.setState({serverError: ''});\r\n\r\n        const {data, error} = await this.props.actions.editCommand(this.newCommand!);\r\n\r\n        if (data) {\r\n            getHistory().push(`/${this.props.team.name}/integrations/commands`);\r\n            return;\r\n        }\r\n\r\n        this.setState({showConfirmModal: false});\r\n\r\n        if (error) {\r\n            this.setState({serverError: error.message});\r\n        }\r\n    };\r\n\r\n    public renderExtra = (): JSX.Element => {\r\n        const confirmButton = (\r\n            <FormattedMessage\r\n                id='update_command.update'\r\n                defaultMessage='Update'\r\n            />\r\n        );\r\n\r\n        const confirmTitle = (\r\n            <FormattedMessage\r\n                id='update_command.confirm'\r\n                defaultMessage='Edit Slash Command'\r\n            />\r\n        );\r\n\r\n        const confirmMessage = (\r\n            <FormattedMessage\r\n                id='update_command.question'\r\n                defaultMessage='Your changes may break the existing slash command. Are you sure you would like to update it?'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <ConfirmModal\r\n                title={confirmTitle}\r\n                message={confirmMessage}\r\n                confirmButtonText={confirmButton}\r\n                modalClass='integrations-backstage-modal'\r\n                show={this.state.showConfirmModal}\r\n                onConfirm={this.submitCommand}\r\n                onCancel={this.confirmModalDismissed}\r\n            />\r\n        );\r\n    };\r\n\r\n    public render(): JSX.Element {\r\n        if (!this.state.originalCommand) {\r\n            return <LoadingScreen/>;\r\n        }\r\n\r\n        return (\r\n            <AbstractCommand\r\n                team={this.props.team}\r\n                header={messages.header}\r\n                footer={messages.footer}\r\n                loading={messages.loading}\r\n                renderExtra={this.renderExtra()}\r\n                action={this.editCommand}\r\n                serverError={this.state.serverError}\r\n                initialCommand={this.state.originalCommand}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {editCommand, getCustomTeamCommands} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCommands} from 'mattermost-redux/selectors/entities/integrations';\r\n\r\nimport EditCommand from './edit_command';\r\n\r\ntype Props = {\r\n    location: Location;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const config = getConfig(state);\r\n    const commandId = (new URLSearchParams(ownProps.location.search)).get('id');\r\n    const enableCommands = config.EnableCommands === 'true';\r\n\r\n    return {\r\n        commandId,\r\n        commands: getCommands(state),\r\n        enableCommands,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getCustomTeamCommands,\r\n            editCommand,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditCommand);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport CopyText from 'components/copy_text';\r\n\r\nimport DeleteIntegrationLink from './delete_integration_link';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * The team data\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     * Installed slash command to display\r\n     */\r\n    command: Command;\r\n\r\n    /**\r\n     * The function to call when Regenerate Token link is clicked\r\n     */\r\n    onRegenToken: (command: Command) => void ;\r\n\r\n    /**\r\n     * The function to call when Delete link is clicked\r\n     */\r\n    onDelete: (command: Command) => void ;\r\n\r\n    /**\r\n     * Set to filter command, comes from BackstageList\r\n     */\r\n    filter?: string;\r\n\r\n    /**\r\n     * The creator user data\r\n     */\r\n    creator: UserProfile;\r\n\r\n    /**\r\n     * Set to show edit link\r\n     */\r\n    canChange: boolean;\r\n}\r\n\r\nexport function matchesFilter(command: Command, filter?: string) {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    return command.display_name.toLowerCase().indexOf(filter) !== -1 ||\r\n        command.description.toLowerCase().indexOf(filter) !== -1 ||\r\n        command.trigger.toLowerCase().indexOf(filter) !== -1;\r\n}\r\n\r\nexport default class InstalledCommand extends React.PureComponent<Props> {\r\n    handleRegenToken = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n\r\n        this.props.onRegenToken(this.props.command);\r\n    };\r\n\r\n    handleDelete = () => {\r\n        this.props.onDelete(this.props.command);\r\n    };\r\n\r\n    render() {\r\n        const command = this.props.command;\r\n        const filter = this.props.filter ? this.props.filter.toLowerCase() : '';\r\n\r\n        if (!matchesFilter(command, filter)) {\r\n            return null;\r\n        }\r\n\r\n        let name;\r\n\r\n        if (command.display_name) {\r\n            name = command.display_name;\r\n        } else {\r\n            name = (\r\n                <FormattedMessage\r\n                    id='installed_commands.unnamed_command'\r\n                    defaultMessage='Unnamed Slash Command'\r\n                />\r\n            );\r\n        }\r\n\r\n        let description = null;\r\n        if (command.description) {\r\n            description = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__description'>\r\n                        {command.description}\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let trigger = '- /' + command.trigger;\r\n        if (command.auto_complete && command.auto_complete_hint) {\r\n            trigger += ' ' + command.auto_complete_hint;\r\n        }\r\n\r\n        let actions = null;\r\n        if (this.props.canChange) {\r\n            actions = (\r\n                <div className='item-actions'>\r\n                    <button\r\n                        className='style--none color--link'\r\n                        onClick={this.handleRegenToken}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='installed_integrations.regenToken'\r\n                            defaultMessage='Regenerate Token'\r\n                        />\r\n                    </button>\r\n                    {' - '}\r\n                    <Link to={`/${this.props.team.name}/integrations/commands/edit?id=${command.id}`}>\r\n                        <FormattedMessage\r\n                            id='installed_integrations.edit'\r\n                            defaultMessage='Edit'\r\n                        />\r\n                    </Link>\r\n                    {' - '}\r\n                    <DeleteIntegrationLink\r\n                        modalMessage={\r\n                            <FormattedMessage\r\n                                id='installed_commands.delete.confirm'\r\n                                defaultMessage='This action permanently deletes the slash command and breaks any integrations using it. Are you sure you want to delete it?'\r\n                            />\r\n                        }\r\n                        onDelete={this.handleDelete}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const commandToken = command.token;\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <div className='item-details__name'>\r\n                            <strong>\r\n                                {name}\r\n                            </strong>\r\n                        </div>\r\n                        <span className='item-details__trigger'>\r\n                            {trigger}\r\n                        </span>\r\n                        {actions}\r\n                    </div>\r\n                    {description}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.token'\r\n                                defaultMessage='Token: {token}'\r\n                                values={{\r\n                                    token: <code>{commandToken}</code>,\r\n                                }}\r\n                            />\r\n                            <CopyText\r\n                                label={defineMessage({\r\n                                    id: 'integrations.copy_token',\r\n                                    defaultMessage: 'Copy Token',\r\n                                })}\r\n                                value={commandToken}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__creation'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.creation'\r\n                                defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                                values={{\r\n                                    creator: this.props.creator.username,\r\n                                    createAt: command.create_at,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport {DeveloperLinks} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport InstalledCommand, {matchesFilter} from '../installed_command';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    user: UserProfile;\r\n    users: RelationOneToOne<UserProfile, UserProfile>;\r\n\r\n    // Installed slash commands to display\r\n    commands: Command[];\r\n    loading: boolean;\r\n\r\n    // Set to allow changes to installed slash commands\r\n    canManageOthersSlashCommands: boolean;\r\n    actions: {\r\n\r\n        // The function to call when Regenerate Token link is clicked\r\n        regenCommandToken: (id: string) => Promise<ActionResult>;\r\n\r\n        // The function to call when Delete link is clicked\r\n        deleteCommand: (id: string) => Promise<ActionResult>;\r\n    };\r\n}\r\n\r\nexport default class InstalledCommands extends React.PureComponent<Props> {\r\n    public regenCommandToken = (command: Command): void => {\r\n        this.props.actions.regenCommandToken(command.id);\r\n    };\r\n\r\n    public deleteCommand = (command: Command): void => {\r\n        this.props.actions.deleteCommand(command.id);\r\n    };\r\n\r\n    private commandCompare(a: Command, b: Command) {\r\n        let nameA = a.display_name;\r\n        if (!nameA) {\r\n            nameA = Utils.localizeMessage({id: 'installed_commands.unnamed_command', defaultMessage: 'Unnamed Slash Command'});\r\n        }\r\n\r\n        let nameB = b.display_name;\r\n        if (!nameB) {\r\n            nameB = Utils.localizeMessage({id: 'installed_commands.unnamed_command', defaultMessage: 'Unnamed Slash Command'});\r\n        }\r\n\r\n        return nameA.localeCompare(nameB);\r\n    }\r\n\r\n    public render(): JSX.Element {\r\n        const commands = (filter: string) => this.props.commands.\r\n            filter((command) => command.team_id === this.props.team.id).\r\n            filter((command) => matchesFilter(command, filter)).\r\n            sort(this.commandCompare).map((command) => {\r\n                const canChange = this.props.canManageOthersSlashCommands || this.props.user.id === command.creator_id;\r\n\r\n                return (\r\n                    <InstalledCommand\r\n                        key={command.id}\r\n                        team={this.props.team}\r\n                        command={command}\r\n                        onRegenToken={this.regenCommandToken}\r\n                        onDelete={this.deleteCommand}\r\n                        creator={this.props.users[command.creator_id] || {}}\r\n                        canChange={canChange}\r\n                    />\r\n                );\r\n            });\r\n\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='installed_commands.header'\r\n                        defaultMessage='Installed Slash Commands'\r\n                    />\r\n                }\r\n                addText={\r\n                    <FormattedMessage\r\n                        id='installed_commands.add'\r\n                        defaultMessage='Add Slash Command'\r\n                    />\r\n                }\r\n                addLink={'/' + this.props.team.name + '/integrations/commands/add'}\r\n                addButtonId='addSlashCommand'\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='installed_commands.empty'\r\n                        defaultMessage='No slash commands found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='installed_commands.search.empty'\r\n                        defaultMessage='No slash commands match <b>{searchTerm}</b>'\r\n                        values={{\r\n                            b: (chunks: string) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                }\r\n                helpText={\r\n                    <FormattedMessage\r\n                        id='installed_commands.help'\r\n                        defaultMessage='Use slash commands to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.'\r\n                        values={{\r\n                            buildYourOwn: (\r\n                                <ExternalLink\r\n                                    href={DeveloperLinks.SETUP_CUSTOM_SLASH_COMMANDS}\r\n                                    location='installed_commands'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_commands.help.buildYourOwn'\r\n                                        defaultMessage='Build Your Own'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace'\r\n                                    location='installed_commands'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_commands.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                searchPlaceholder={Utils.localizeMessage({id: 'installed_commands.search', defaultMessage: 'Search Slash Commands'})}\r\n                loading={this.props.loading}\r\n            >\r\n                {(filter: string) => {\r\n                    const children = commands(filter);\r\n                    return [children, children.length > 0];\r\n                }}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {deleteCommand, regenCommandToken} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\n\r\nimport InstalledCommands from './installed_commands';\r\n\r\ntype Props = {\r\n    team: {\r\n        id: string;\r\n    };\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const canManageOthersSlashCommands = haveITeamPermission(state, ownProps.team.id, Permissions.MANAGE_OTHERS_SLASH_COMMANDS);\r\n\r\n    return {\r\n        canManageOthersSlashCommands,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            regenCommandToken,\r\n            deleteCommand,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InstalledCommands);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {Route, Switch, Redirect} from 'react-router-dom';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AddCommand from 'components/integrations/add_command';\r\nimport ConfirmIntegration from 'components/integrations/confirm_integration';\r\nimport EditCommand from 'components/integrations/edit_command';\r\nimport InstalledCommands from 'components/integrations/installed_commands';\r\n\r\ninterface IProps {\r\n    component: any;\r\n    extraProps: {\r\n        loading: boolean;\r\n        commands: Command[];\r\n        users?: RelationOneToOne<UserProfile, UserProfile>;\r\n        team?: Team;\r\n        user?: UserProfile;\r\n    };\r\n    path: string;\r\n}\r\n\r\nconst CommandRoute = ({component: Component, extraProps, ...rest}: IProps) => (\r\n    <Route\r\n        {...rest}\r\n        render={(props) => (\r\n            <Component\r\n                {...extraProps}\r\n                {...props}\r\n            />\r\n        )}\r\n    />\r\n);\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * The team data needed to pass into child components\r\n     */\r\n    team?: Team;\r\n\r\n    /**\r\n     * The user data needed to pass into child components\r\n     */\r\n    user?: UserProfile;\r\n\r\n    /**\r\n     * The users collection\r\n     */\r\n    users?: RelationOneToOne<UserProfile, UserProfile>;\r\n\r\n    /**\r\n     * Installed slash commands to display\r\n     */\r\n    commands: Command[];\r\n\r\n    /**\r\n     * Object from react-router\r\n     */\r\n    match: {\r\n        url: string;\r\n    };\r\n\r\n    actions: {\r\n\r\n        /**\r\n         * The function to call to fetch team commands\r\n         */\r\n        loadCommandsAndProfilesForTeam: (teamId: string) => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n     * Whether or not commands are enabled.\r\n     */\r\n    enableCommands?: boolean;\r\n};\r\n\r\ntype State = {\r\n    loading: boolean;\r\n};\r\n\r\nexport default class CommandsContainer extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.enableCommands) {\r\n            this.props.actions.loadCommandsAndProfilesForTeam(this.props.team?.id || '').then(\r\n                () => this.setState({loading: false}),\r\n            );\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const extraProps = {\r\n            loading: this.state.loading,\r\n            commands: this.props.commands || [],\r\n            users: this.props.users,\r\n            team: this.props.team,\r\n            user: this.props.user,\r\n        };\r\n        return (\r\n            <div>\r\n                <Switch>\r\n                    <Route\r\n                        exact={true}\r\n                        path={`${this.props.match.url}/`}\r\n                        render={() => (<Redirect to={`${this.props.match.url}/installed`}/>)}\r\n                    />\r\n                    <CommandRoute\r\n                        extraProps={extraProps}\r\n                        path={`${this.props.match.url}/installed`}\r\n                        component={InstalledCommands}\r\n                    />\r\n                    <CommandRoute\r\n                        extraProps={extraProps}\r\n                        path={`${this.props.match.url}/add`}\r\n                        component={AddCommand}\r\n                    />\r\n                    <CommandRoute\r\n                        extraProps={extraProps}\r\n                        path={`${this.props.match.url}/edit`}\r\n                        component={EditCommand}\r\n                    />\r\n                    <CommandRoute\r\n                        extraProps={extraProps}\r\n                        path={`${this.props.match.url}/confirm`}\r\n                        component={ConfirmIntegration}\r\n                    />\r\n                </Switch>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {AnyAction, Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCommands} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {getUsers} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadCommandsAndProfilesForTeam} from 'actions/integration_actions';\r\n\r\nimport CommandsContainer from './commands_container';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enableCommands = config.EnableCommands === 'true';\r\n\r\n    return {\r\n        commands: Object.values(getCommands(state)),\r\n        users: getUsers(state),\r\n        enableCommands,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<AnyAction>) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadCommandsAndProfilesForTeam,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CommandsContainer);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessages} from 'react-intl';\r\n\r\nimport type {IncomingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AbstractIncomingWebhook from 'components/integrations/abstract_incoming_webhook';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'update_incoming_webhook.update',\r\n        defaultMessage: 'Update',\r\n    },\r\n    header: {\r\n        id: 'integrations.edit',\r\n        defaultMessage: 'Edit',\r\n    },\r\n    loading: {\r\n        id: 'update_incoming_webhook.updating',\r\n        defaultMessage: 'Updating...',\r\n    },\r\n});\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * The current team\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     * The incoming webhook to edit\r\n     */\r\n    hook?: IncomingWebhook;\r\n\r\n    /**\r\n     * The id of the incoming webhook to edit\r\n     */\r\n    hookId: string;\r\n\r\n    /**\r\n     * Whether or not incoming webhooks are enabled.\r\n     */\r\n    enableIncomingWebhooks: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post username.\r\n     */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post icon.\r\n     */\r\n    enablePostIconOverride: boolean;\r\n\r\n    actions: {\r\n\r\n        /**\r\n         * The function to call to update an incoming webhook\r\n         */\r\n        updateIncomingHook: (hook: IncomingWebhook) => Promise<ActionResult>;\r\n\r\n        /**\r\n         * The function to call to get an incoming webhook\r\n         */\r\n        getIncomingHook: (hookId: string) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    serverError: string;\r\n};\r\n\r\nexport default class EditIncomingWebhook extends React.PureComponent<Props, State> {\r\n    private newHook?: IncomingWebhook;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            serverError: '',\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.enableIncomingWebhooks) {\r\n            this.props.actions.getIncomingHook(this.props.hookId);\r\n        }\r\n    }\r\n\r\n    editIncomingHook = async (hook: IncomingWebhook) => {\r\n        this.newHook = hook;\r\n\r\n        if (this.props.hook?.id) {\r\n            hook.id = this.props.hook.id;\r\n        }\r\n\r\n        await this.submitHook();\r\n    };\r\n\r\n    submitHook = async () => {\r\n        this.setState({serverError: ''});\r\n\r\n        if (!this.newHook) {\r\n            return;\r\n        }\r\n\r\n        const result = await this.props.actions.updateIncomingHook(this.newHook);\r\n\r\n        if ('data' in result) {\r\n            getHistory().push(`/${this.props.team.name}/integrations/incoming_webhooks`);\r\n            return;\r\n        }\r\n\r\n        if ('error' in result) {\r\n            const {error} = result;\r\n            this.setState({serverError: error.message});\r\n        }\r\n    };\r\n\r\n    render() {\r\n        if (!this.props.hook) {\r\n            return <LoadingScreen/>;\r\n        }\r\n\r\n        return (\r\n            <AbstractIncomingWebhook\r\n                team={this.props.team}\r\n                header={messages.header}\r\n                footer={messages.footer}\r\n                loading={messages.loading}\r\n                enablePostUsernameOverride={this.props.enablePostUsernameOverride}\r\n                enablePostIconOverride={this.props.enablePostIconOverride}\r\n                action={this.editIncomingHook}\r\n                serverError={this.state.serverError}\r\n                initialHook={this.props.hook}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getIncomingHook, updateIncomingHook} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport EditIncomingWebhook from './edit_incoming_webhook';\r\n\r\ntype Props = {\r\n    location: Location;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const config = getConfig(state);\r\n    const enableIncomingWebhooks = config.EnableIncomingWebhooks === 'true';\r\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\r\n    const enablePostIconOverride = config.EnablePostIconOverride === 'true';\r\n    const hookId = (new URLSearchParams(ownProps.location.search)).get('id') || '';\r\n\r\n    return {\r\n        hookId,\r\n        hook: state.entities.integrations.incomingHooks[hookId],\r\n        enableIncomingWebhooks,\r\n        enablePostUsernameOverride,\r\n        enablePostIconOverride,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            updateIncomingHook,\r\n            getIncomingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditIncomingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nimport AbstractOAuthApp from '../abstract_oauth_app';\r\n\r\nconst HEADER = {id: 'integrations.edit', defaultMessage: 'Edit'};\r\nconst FOOTER = {id: 'update_incoming_webhook.update', defaultMessage: 'Update'};\r\nconst LOADING = {id: 'update_incoming_webhook.updating', defaultMessage: 'Updating...'};\r\n\r\ntype Actions = {\r\n    getOAuthApp: (id: string) => void;\r\n    editOAuthApp: (app: OAuthApp) => Promise<ActionResult>;\r\n};\r\n\r\ntype Props = {\r\n    team: Team;\r\n    oauthAppId: string;\r\n    oauthApp: OAuthApp;\r\n    actions: Actions;\r\n    enableOAuthServiceProvider: boolean;\r\n};\r\n\r\ntype State = {\r\n    showConfirmModal: boolean;\r\n    serverError: string;\r\n};\r\n\r\nexport default class EditOAuthApp extends React.PureComponent<Props, State> {\r\n    newApp: OAuthApp;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            showConfirmModal: false,\r\n            serverError: '',\r\n        };\r\n        this.newApp = this.props.oauthApp;\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.enableOAuthServiceProvider) {\r\n            this.props.actions.getOAuthApp(this.props.oauthAppId);\r\n        }\r\n    }\r\n\r\n    editOAuthApp = async (app: OAuthApp) => {\r\n        this.newApp = app;\r\n\r\n        if (this.props.oauthApp.id) {\r\n            app.id = this.props.oauthApp.id;\r\n        }\r\n\r\n        const callbackUrlsSame = (this.props.oauthApp.callback_urls.length === app.callback_urls.length) &&\r\n            this.props.oauthApp.callback_urls.every((v, i) => v === app.callback_urls[i]);\r\n\r\n        if (callbackUrlsSame === false) {\r\n            this.handleConfirmModal();\r\n        } else {\r\n            await this.submitOAuthApp();\r\n        }\r\n    };\r\n\r\n    handleConfirmModal = () => {\r\n        this.setState({showConfirmModal: true});\r\n    };\r\n\r\n    confirmModalDismissed = () => {\r\n        this.setState({showConfirmModal: false});\r\n    };\r\n\r\n    submitOAuthApp = async () => {\r\n        this.setState({serverError: ''});\r\n\r\n        const res = await this.props.actions.editOAuthApp(this.newApp);\r\n\r\n        if ('data' in res && res.data) {\r\n            getHistory().push(`/${this.props.team.name}/integrations/oauth2-apps`);\r\n            return;\r\n        }\r\n\r\n        this.setState({showConfirmModal: false});\r\n\r\n        if ('error' in res) {\r\n            const {error: err} = res;\r\n            this.setState({serverError: err.message});\r\n        }\r\n    };\r\n\r\n    renderExtra = () => {\r\n        const confirmButton = (\r\n            <FormattedMessage\r\n                id='update_command.update'\r\n                defaultMessage='Update'\r\n            />\r\n        );\r\n\r\n        const confirmTitle = (\r\n            <FormattedMessage\r\n                id='update_oauth_app.confirm'\r\n                defaultMessage='Edit OAuth 2.0 application'\r\n            />\r\n        );\r\n\r\n        const confirmMessage = (\r\n            <FormattedMessage\r\n                id='update_oauth_app.question'\r\n                defaultMessage='Your changes may break the existing OAuth 2.0 application. Are you sure you would like to update it?'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <ConfirmModal\r\n                title={confirmTitle}\r\n                message={confirmMessage}\r\n                confirmButtonText={confirmButton}\r\n                modalClass='integrations-backstage-modal'\r\n                show={this.state.showConfirmModal}\r\n                onConfirm={this.submitOAuthApp}\r\n                onCancel={this.confirmModalDismissed}\r\n            />\r\n        );\r\n    };\r\n\r\n    render() {\r\n        if (!this.props.oauthApp) {\r\n            return <LoadingScreen/>;\r\n        }\r\n\r\n        return (\r\n            <AbstractOAuthApp\r\n                team={this.props.team}\r\n                header={HEADER}\r\n                footer={FOOTER}\r\n                loading={LOADING}\r\n                renderExtra={this.renderExtra()}\r\n                action={this.editOAuthApp}\r\n                serverError={this.state.serverError}\r\n                initialApp={this.props.oauthApp}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\n// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getOAuthApp, editOAuthApp} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport EditOAuthApp from './edit_oauth_app';\r\n\r\ntype Props = {\r\n    location: Location;\r\n};\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const config = getConfig(state);\r\n    const oauthAppId: string = (new URLSearchParams(ownProps.location.search)).get('id') || '';\r\n    const enableOAuthServiceProvider = config.EnableOAuthServiceProvider === 'true';\r\n\r\n    return {\r\n        oauthAppId,\r\n        oauthApp: state.entities.integrations.oauthApps[oauthAppId],\r\n        enableOAuthServiceProvider,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getOAuthApp,\r\n            editOAuthApp,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditOAuthApp);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport AbstractOutgoingWebhook from 'components/integrations/abstract_outgoing_webhook';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nconst HEADER = {id: 'integrations.edit', defaultMessage: 'Edit'};\r\nconst FOOTER = {id: 'update_outgoing_webhook.update', defaultMessage: 'Update'};\r\nconst LOADING = {id: 'update_outgoing_webhook.updating', defaultMessage: 'Updating...'};\r\n\r\nexport interface Props {\r\n\r\n    /**\r\n     * The current team\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     * The outgoing webhook to edit\r\n     */\r\n    hook?: OutgoingWebhook;\r\n\r\n    /**\r\n     * The id of the outgoing webhook to edit\r\n     */\r\n    hookId: string;\r\n    actions: {\r\n\r\n        /**\r\n         * The function to call to update an outgoing webhook\r\n         */\r\n        updateOutgoingHook: (hook: OutgoingWebhook) => Promise<ActionResult<OutgoingWebhook>>;\r\n\r\n        /**\r\n         * The function to call to get an outgoing webhook\r\n         */\r\n        getOutgoingHook: (hookId: string) => Promise<ActionResult<OutgoingWebhook>>;\r\n    };\r\n\r\n    /**\r\n     * Whether or not outgoing webhooks are enabled.\r\n     */\r\n    enableOutgoingWebhooks?: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post username.\r\n     */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post icon.\r\n     */\r\n    enablePostIconOverride: boolean;\r\n}\r\n\r\ninterface State {\r\n    showConfirmModal: boolean;\r\n    serverError: string;\r\n}\r\n\r\nexport default class EditOutgoingWebhook extends React.PureComponent<Props, State> {\r\n    private newHook: OutgoingWebhook | undefined;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            showConfirmModal: false,\r\n            serverError: '',\r\n        };\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        if (this.props.enableOutgoingWebhooks) {\r\n            this.props.actions.getOutgoingHook(this.props.hookId);\r\n        }\r\n    }\r\n\r\n    editOutgoingHook = async (hook: OutgoingWebhook): Promise<void> => {\r\n        this.newHook = hook;\r\n\r\n        if (this.props.hook!.id) {\r\n            hook.id = this.props.hook!.id;\r\n        }\r\n\r\n        if (this.props.hook!.token) {\r\n            hook.token = this.props.hook!.token;\r\n        }\r\n\r\n        const triggerWordsSame = (this.props.hook!.trigger_words.length === hook!.trigger_words.length) &&\r\n            this.props.hook!.trigger_words.every((v, i) => v === hook.trigger_words[i]);\r\n\r\n        const callbackUrlsSame = (this.props.hook!.callback_urls.length === hook!.callback_urls.length) &&\r\n            this.props.hook!.callback_urls.every((v, i) => v === hook.callback_urls[i]);\r\n\r\n        if (this.props.hook!.content_type !== hook.content_type ||\r\n            !triggerWordsSame || !callbackUrlsSame) {\r\n            this.handleConfirmModal();\r\n        } else {\r\n            await this.submitHook();\r\n        }\r\n    };\r\n\r\n    handleConfirmModal = (): void => {\r\n        this.setState({showConfirmModal: true});\r\n    };\r\n\r\n    confirmModalDismissed = (): void => {\r\n        this.setState({showConfirmModal: false});\r\n    };\r\n\r\n    submitHook = async (): Promise<void> => {\r\n        this.setState({serverError: ''});\r\n\r\n        const {data, error} = await this.props.actions.updateOutgoingHook(this.newHook!);\r\n\r\n        if (data) {\r\n            getHistory().push(`/${this.props.team.name}/integrations/outgoing_webhooks`);\r\n            return;\r\n        }\r\n\r\n        this.setState({showConfirmModal: false});\r\n\r\n        if (error) {\r\n            this.setState({serverError: error.message});\r\n        }\r\n    };\r\n\r\n    renderExtra = (): JSX.Element => {\r\n        const confirmButton = (\r\n            <FormattedMessage\r\n                id='update_outgoing_webhook.update'\r\n                defaultMessage='Update'\r\n            />\r\n        );\r\n\r\n        const confirmTitle = (\r\n            <FormattedMessage\r\n                id='update_outgoing_webhook.confirm'\r\n                defaultMessage='Edit Outgoing Webhook'\r\n            />\r\n        );\r\n\r\n        const confirmMessage = (\r\n            <FormattedMessage\r\n                id='update_outgoing_webhook.question'\r\n                defaultMessage='Your changes may break the existing outgoing webhook. Are you sure you would like to update it?'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <ConfirmModal\r\n                title={confirmTitle}\r\n                message={confirmMessage}\r\n                confirmButtonText={confirmButton}\r\n                modalClass='integrations-backstage-modal'\r\n                show={this.state.showConfirmModal}\r\n                onConfirm={this.submitHook}\r\n                onCancel={this.confirmModalDismissed}\r\n            />\r\n        );\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        if (!this.props.hook) {\r\n            return <LoadingScreen/>;\r\n        }\r\n\r\n        return (\r\n            <AbstractOutgoingWebhook\r\n                team={this.props.team}\r\n                header={HEADER}\r\n                footer={FOOTER}\r\n                loading={LOADING}\r\n                renderExtra={this.renderExtra()}\r\n                action={this.editOutgoingHook}\r\n                serverError={this.state.serverError}\r\n                initialHook={this.props.hook}\r\n                enablePostUsernameOverride={this.props.enablePostUsernameOverride}\r\n                enablePostIconOverride={this.props.enablePostIconOverride}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getOutgoingHook, updateOutgoingHook} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport EditOutgoingWebhook from './edit_outgoing_webhook';\r\n\r\ntype OwnProps = {\r\n    location: {\r\n        search: string | string[][] | Record<string, string> | URLSearchParams | undefined;\r\n    };\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const config = getConfig(state);\r\n    const hookId = (new URLSearchParams(ownProps.location.search)).get('id');\r\n    const enableOutgoingWebhooks = config.EnableOutgoingWebhooks === 'true';\r\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\r\n    const enablePostIconOverride = config.EnablePostIconOverride === 'true';\r\n\r\n    return {\r\n        hookId: hookId!,\r\n        hook: state.entities.integrations.outgoingHooks[hookId!],\r\n        enableOutgoingWebhooks,\r\n        enablePostUsernameOverride,\r\n        enablePostIconOverride,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            updateOutgoingHook,\r\n            getOutgoingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditOutgoingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {IncomingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport CopyText from 'components/copy_text';\r\n\r\nimport {getSiteURL} from 'utils/url';\r\n\r\nimport DeleteIntegrationLink from './delete_integration_link';\r\n\r\nexport function matchesFilter(incomingWebhook: IncomingWebhook, channel: Channel, filter: string) {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    if (incomingWebhook.display_name.toLowerCase().indexOf(filter) !== -1 ||\r\n        incomingWebhook.description.toLowerCase().indexOf(filter) !== -1) {\r\n        return true;\r\n    }\r\n\r\n    if (incomingWebhook.channel_id) {\r\n        if (channel && channel.name.toLowerCase().indexOf(filter) !== -1) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * Data used for showing webhook details\r\n     */\r\n    incomingWebhook: IncomingWebhook;\r\n\r\n    /**\r\n     * Function to call when webhook delete button is pressed\r\n     */\r\n    onDelete: (incomingWebhook: IncomingWebhook) => void;\r\n\r\n    /**\r\n     * String used for filtering webhook item\r\n     */\r\n    filter?: string;\r\n\r\n    /**\r\n     * Data used for showing created by details\r\n     */\r\n    creator: {\r\n        username: string;\r\n    };\r\n\r\n    /**\r\n     *  Set to show available actions on webhook\r\n     */\r\n    canChange: boolean;\r\n\r\n    /**\r\n     *  Data used in routing of webhook for modifications\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     *  Data used for filtering of webhook based on filter prop\r\n     */\r\n    channel: Channel;\r\n}\r\n\r\nexport default class InstalledIncomingWebhook extends React.PureComponent<Props> {\r\n    handleDelete = () => {\r\n        this.props.onDelete(this.props.incomingWebhook);\r\n    };\r\n\r\n    render() {\r\n        const incomingWebhook = this.props.incomingWebhook;\r\n        const channel = this.props.channel;\r\n        const filter = this.props.filter ? this.props.filter.toLowerCase() : '';\r\n\r\n        if (!matchesFilter(incomingWebhook, channel, filter)) {\r\n            return null;\r\n        }\r\n\r\n        let displayName;\r\n        if (incomingWebhook.display_name) {\r\n            displayName = incomingWebhook.display_name;\r\n        } else if (channel) {\r\n            displayName = channel.display_name;\r\n        } else {\r\n            displayName = (\r\n                <FormattedMessage\r\n                    id='installed_incoming_webhooks.unknown_channel'\r\n                    defaultMessage='A Private Webhook'\r\n                />\r\n            );\r\n        }\r\n\r\n        let description = null;\r\n        if (incomingWebhook.description) {\r\n            description = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__description'>\r\n                        {incomingWebhook.description}\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let actions = null;\r\n        if (this.props.canChange) {\r\n            actions = (\r\n                <div className='item-actions'>\r\n                    <Link to={`/${this.props.team.name}/integrations/incoming_webhooks/edit?id=${incomingWebhook.id}`}>\r\n                        <FormattedMessage\r\n                            id='installed_integrations.edit'\r\n                            defaultMessage='Edit'\r\n                        />\r\n                    </Link>\r\n                    {' - '}\r\n                    <DeleteIntegrationLink\r\n                        modalMessage={\r\n                            <FormattedMessage\r\n                                id='installed_incoming_webhooks.delete.confirm'\r\n                                defaultMessage='This action permanently deletes the incoming webhook and breaks any integrations using it. Are you sure you want to delete it?'\r\n                            />\r\n                        }\r\n                        onDelete={this.handleDelete}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const incomingWebhookId = getSiteURL() + '/hooks/' + incomingWebhook.id;\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <strong className='item-details__name'>\r\n                            {displayName}\r\n                        </strong>\r\n                        {actions}\r\n                    </div>\r\n                    {description}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__url word-break--all'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.url'\r\n                                defaultMessage='URL: {url}'\r\n                                values={{\r\n                                    url: <code>{incomingWebhookId}</code>,\r\n                                }}\r\n                            />\r\n                            <span>\r\n                                <CopyText\r\n                                    label={defineMessage({\r\n                                        id: 'integrations.copy_url',\r\n                                        defaultMessage: 'Copy URL',\r\n                                    })}\r\n                                    value={incomingWebhookId}\r\n                                />\r\n                            </span>\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__creation'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.creation'\r\n                                defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                                values={{\r\n                                    creator: this.props.creator.username,\r\n                                    createAt: incomingWebhook.create_at,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {IncomingWebhook, IncomingWebhooksWithCount} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\nimport type {IDMappedObjects} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\nimport InstalledIncomingWebhook, {matchesFilter} from 'components/integrations/installed_incoming_webhook';\r\n\r\nimport {DeveloperLinks} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nconst PAGE_SIZE = 200;\r\n\r\ntype Props = {\r\n    team: Team;\r\n    user: UserProfile;\r\n    incomingHooks: IncomingWebhook[];\r\n    incomingHooksTotalCount: number;\r\n    channels: IDMappedObjects<Channel>;\r\n    users: IDMappedObjects<UserProfile>;\r\n    canManageOthersWebhooks: boolean;\r\n    enableIncomingWebhooks: boolean;\r\n    actions: {\r\n        removeIncomingHook: (hookId: string) => Promise<ActionResult>;\r\n        loadIncomingHooksAndProfilesForTeam: (teamId: string, startPageNumber: number,\r\n            pageSize: number, includeTotalCount: boolean) => Promise<ActionResult<IncomingWebhook[] | IncomingWebhooksWithCount>>;\r\n    };\r\n}\r\n\r\ntype State = {\r\n    page: number;\r\n    loading: boolean;\r\n}\r\n\r\nexport default class InstalledIncomingWebhooks extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            page: 0,\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.loadPage(0);\r\n    }\r\n\r\n    deleteIncomingWebhook = (incomingWebhook: IncomingWebhook) => {\r\n        this.props.actions.removeIncomingHook(incomingWebhook.id);\r\n    };\r\n\r\n    loadPage = async (pageToLoad: number) => {\r\n        if (this.props.enableIncomingWebhooks) {\r\n            this.setState({loading: true},\r\n                async () => {\r\n                    await this.props.actions.loadIncomingHooksAndProfilesForTeam(\r\n                        this.props.team.id,\r\n                        pageToLoad,\r\n                        PAGE_SIZE,\r\n                        true,\r\n                    );\r\n                    this.setState({page: pageToLoad, loading: false});\r\n                },\r\n            );\r\n        }\r\n    };\r\n\r\n    nextPage = () => {\r\n        this.loadPage(this.state.page + 1);\r\n    };\r\n\r\n    previousPage = () => {\r\n        this.loadPage(this.state.page - 1);\r\n    };\r\n\r\n    incomingWebhookCompare = (a: IncomingWebhook, b: IncomingWebhook) => {\r\n        let displayNameA = a.display_name;\r\n        if (!displayNameA) {\r\n            const channelA = this.props.channels[a.channel_id];\r\n            if (channelA) {\r\n                displayNameA = channelA.display_name;\r\n            } else {\r\n                displayNameA = Utils.localizeMessage({id: 'installed_incoming_webhooks.unknown_channel', defaultMessage: 'A Private Webhook'});\r\n            }\r\n        }\r\n\r\n        const displayNameB = b.display_name;\r\n        return displayNameA.localeCompare(displayNameB);\r\n    };\r\n\r\n    incomingWebhooks = (filter: string) => this.props.incomingHooks.\r\n        sort(this.incomingWebhookCompare).\r\n        filter((incomingWebhook: IncomingWebhook) => matchesFilter(incomingWebhook, this.props.channels[incomingWebhook.channel_id], filter)).\r\n        map((incomingWebhook: IncomingWebhook) => {\r\n            const canChange = this.props.canManageOthersWebhooks || this.props.user.id === incomingWebhook.user_id;\r\n            const channel = this.props.channels[incomingWebhook.channel_id];\r\n            return (\r\n                <InstalledIncomingWebhook\r\n                    key={incomingWebhook.id}\r\n                    incomingWebhook={incomingWebhook}\r\n                    onDelete={this.deleteIncomingWebhook}\r\n                    creator={this.props.users[incomingWebhook.user_id] || {}}\r\n                    canChange={canChange}\r\n                    team={this.props.team}\r\n                    channel={channel}\r\n                />\r\n            );\r\n        });\r\n\r\n    render() {\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.header'\r\n                        defaultMessage='Installed Incoming Webhooks'\r\n                    />\r\n                }\r\n                addText={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.add'\r\n                        defaultMessage='Add Incoming Webhook'\r\n                    />\r\n                }\r\n                addLink={'/' + this.props.team.name + '/integrations/incoming_webhooks/add'}\r\n                addButtonId='addIncomingWebhook'\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.empty'\r\n                        defaultMessage='No incoming webhooks found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.emptySearch'\r\n                        defaultMessage='No incoming webhooks match {searchTerm}'\r\n                    />\r\n                }\r\n                helpText={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.help'\r\n                        defaultMessage='Use incoming webhooks to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.'\r\n                        values={{\r\n                            buildYourOwn: (\r\n                                <ExternalLink\r\n                                    location='installed_incoming_webhooks'\r\n                                    href={DeveloperLinks.SETUP_INCOMING_WEBHOOKS}\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_incoming_webhooks.help.buildYourOwn'\r\n                                        defaultMessage='Build Your Own'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace'\r\n                                    location='installed_incoming_webhooks'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_incoming_webhooks.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                searchPlaceholder={Utils.localizeMessage({id: 'installed_incoming_webhooks.search', defaultMessage: 'Search Incoming Webhooks'})}\r\n                loading={this.state.loading}\r\n                nextPage={this.nextPage}\r\n                previousPage={this.previousPage}\r\n                page={this.state.page}\r\n                pageSize={PAGE_SIZE}\r\n                total={this.props.incomingHooksTotalCount}\r\n            >\r\n                {(filter: string) => {\r\n                    const children = this.incomingWebhooks(filter);\r\n                    return [children, children.length > 0];\r\n                }}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {removeIncomingHook} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getAllChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getFilteredIncomingHooks, getIncomingHooksTotalCount} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getUsers} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadIncomingHooksAndProfilesForTeam} from 'actions/integration_actions';\r\n\r\nimport InstalledIncomingWebhooks from './installed_incoming_webhooks';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const teamId = getCurrentTeamId(state);\r\n    const incomingHooks = getFilteredIncomingHooks(state);\r\n    const incomingHooksTotalCount = getIncomingHooksTotalCount(state);\r\n    const config = getConfig(state);\r\n    const canManageOthersWebhooks = haveITeamPermission(state, teamId, Permissions.MANAGE_OTHERS_INCOMING_WEBHOOKS);\r\n    const enableIncomingWebhooks = config.EnableIncomingWebhooks === 'true';\r\n\r\n    return {\r\n        incomingHooks,\r\n        incomingHooksTotalCount,\r\n        channels: getAllChannels(state),\r\n        users: getUsers(state),\r\n        canManageOthersWebhooks,\r\n        enableIncomingWebhooks,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadIncomingHooksAndProfilesForTeam,\r\n            removeIncomingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InstalledIncomingWebhooks);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessages, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport CopyText from 'components/copy_text';\r\nimport FormError from 'components/form_error';\r\n\r\nimport DeleteIntegrationLink from '../delete_integration_link';\r\n\r\nconst FAKE_SECRET = '***************';\r\n\r\nexport function matchesFilter(oauthApp: OAuthApp, filter?: string | null): boolean {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    return oauthApp.name.toLowerCase().includes(filter);\r\n}\r\n\r\nexport type InstalledOAuthAppProps = {\r\n\r\n    /**\r\n     * The team data\r\n     */\r\n    team?: Team;\r\n\r\n    /**\r\n     * The oauthApp data\r\n     */\r\n    oauthApp: OAuthApp;\r\n\r\n    /**\r\n     * Whether the oauth app is created by an App\r\n     */\r\n    fromApp: boolean;\r\n\r\n    creatorName: string;\r\n\r\n    /**\r\n     * The function to call when Regenerate Secret link is clicked\r\n     */\r\n    onRegenerateSecret: (oauthAppId: string) => Promise<{ error?: { message: string } }>;\r\n\r\n    /**\r\n     * The function to call when Delete link is clicked\r\n     */\r\n    onDelete: (oauthApp: OAuthApp) => void;\r\n\r\n    /**\r\n     * Set to filter OAuthApp\r\n     */\r\n    filter?: string | null;\r\n}\r\n\r\nexport type InstalleOAuthAppState = {\r\n    clientSecret: string;\r\n    error?: string | null;\r\n}\r\n\r\nexport default class InstalledOAuthApp extends React.PureComponent<InstalledOAuthAppProps, InstalleOAuthAppState> {\r\n    constructor(props: InstalledOAuthAppProps) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            clientSecret: FAKE_SECRET,\r\n        };\r\n    }\r\n\r\n    handleShowClientSecret = (e?: React.MouseEvent): void => {\r\n        if (e && e.preventDefault) {\r\n            e.preventDefault();\r\n        }\r\n        this.setState({clientSecret: this.props.oauthApp.client_secret});\r\n    };\r\n\r\n    handleHideClientSecret = (e: React.MouseEvent): void => {\r\n        e.preventDefault();\r\n        this.setState({clientSecret: FAKE_SECRET});\r\n    };\r\n\r\n    handleRegenerate = (e: React.MouseEvent): void => {\r\n        e.preventDefault();\r\n        this.props.onRegenerateSecret(this.props.oauthApp.id).then(\r\n            ({error}) => {\r\n                if (error) {\r\n                    this.setState({error: error.message});\r\n                } else {\r\n                    this.setState({error: null});\r\n                    this.handleShowClientSecret();\r\n                }\r\n            },\r\n        );\r\n    };\r\n\r\n    handleDelete = (): void => {\r\n        this.props.onDelete(this.props.oauthApp);\r\n    };\r\n\r\n    render(): React.ReactNode {\r\n        const {oauthApp, creatorName} = this.props;\r\n        let error;\r\n\r\n        if (this.state.error) {\r\n            error = (\r\n                <FormError\r\n                    error={this.state.error}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (!matchesFilter(oauthApp, this.props.filter)) {\r\n            return null;\r\n        }\r\n\r\n        let name;\r\n        if (oauthApp.name) {\r\n            name = oauthApp.name;\r\n        } else {\r\n            name = (\r\n                <FormattedMessage\r\n                    id='installed_integrations.unnamed_oauth_app'\r\n                    defaultMessage='Unnamed OAuth 2.0 Application'\r\n                />\r\n            );\r\n        }\r\n\r\n        let description;\r\n        if (oauthApp.description) {\r\n            description = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__description'>\r\n                        {oauthApp.description}\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const urls = (\r\n            <div className='item-details__row'>\r\n                <span className='item-details__url word-break--all'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.callback_urls'\r\n                        defaultMessage='Callback URLs: {urls}'\r\n                        values={{\r\n                            urls: oauthApp.callback_urls.join(', '),\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n        );\r\n\r\n        let isTrusted;\r\n        if (oauthApp.is_trusted) {\r\n            isTrusted = (\r\n                <FormattedMessage\r\n                    id='installed_oauth_apps.trusted.yes'\r\n                    defaultMessage='Yes'\r\n                />\r\n            );\r\n        } else {\r\n            isTrusted = (\r\n                <FormattedMessage\r\n                    id='installed_oauth_apps.trusted.no'\r\n                    defaultMessage='No'\r\n                />\r\n            );\r\n        }\r\n\r\n        let showHide;\r\n        let clientSecret;\r\n        if (this.state.clientSecret === FAKE_SECRET) {\r\n            showHide = (\r\n                <button\r\n                    id='showSecretButton'\r\n                    className='style--none color--link'\r\n                    onClick={this.handleShowClientSecret}\r\n                >\r\n                    <FormattedMessage\r\n                        id='installed_integrations.showSecret'\r\n                        defaultMessage='Show Secret'\r\n                    />\r\n                </button>\r\n            );\r\n            clientSecret = (\r\n                <span className='item-details__token'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.client_secret'\r\n                        defaultMessage='Client Secret: '\r\n                    />\r\n                    <strong>{this.state.clientSecret}</strong>\r\n                </span>\r\n            );\r\n        } else {\r\n            showHide = (\r\n                <button\r\n                    id='hideSecretButton'\r\n                    className='style--none color--link'\r\n                    onClick={this.handleHideClientSecret}\r\n                >\r\n                    <FormattedMessage\r\n                        id='installed_integrations.hideSecret'\r\n                        defaultMessage='Hide Secret'\r\n                    />\r\n                </button>\r\n            );\r\n            clientSecret = (\r\n                <span className='item-details__token'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.client_secret'\r\n                        defaultMessage='Client Secret: '\r\n                    />\r\n                    <strong>{this.state.clientSecret}</strong>\r\n                    <CopyText\r\n                        label={messages.copyClientSecret}\r\n                        value={this.state.clientSecret}\r\n                    />\r\n                </span>\r\n            );\r\n        }\r\n\r\n        const regen = (\r\n            <button\r\n                id='regenerateSecretButton'\r\n                className='style--none color--link'\r\n                onClick={this.handleRegenerate}\r\n            >\r\n                <FormattedMessage\r\n                    id='installed_integrations.regenSecret'\r\n                    defaultMessage='Regenerate Secret'\r\n                />\r\n            </button>\r\n        );\r\n\r\n        let icon;\r\n        if (oauthApp.icon_url) {\r\n            icon = (\r\n                <div className='integration__icon integration-list__icon'>\r\n                    <img\r\n                        alt={'get app screenshot'}\r\n                        src={oauthApp.icon_url}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let actions;\r\n        if (!this.props.fromApp) {\r\n            actions = (\r\n                <div className='item-actions'>\r\n                    {showHide}\r\n                    {' - '}\r\n                    {regen}\r\n                    {' - '}\r\n                    <Link to={`/${this.props.team?.name}/integrations/oauth2-apps/edit?id=${oauthApp.id}`}>\r\n                        <FormattedMessage\r\n                            id='installed_integrations.edit'\r\n                            defaultMessage='Edit'\r\n                        />\r\n                    </Link>\r\n                    {' - '}\r\n                    <DeleteIntegrationLink\r\n                        modalMessage={\r\n                            <FormattedMessage\r\n                                id='installed_oauth_apps.delete.confirm'\r\n                                defaultMessage='This action permanently deletes the OAuth 2.0 application and breaks any integrations using it. Are you sure you want to delete it?'\r\n                            />\r\n                        }\r\n                        onDelete={this.handleDelete}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let appInfo = (\r\n            <div className='item-details__row'>\r\n                <span className='item-details__creation'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.fromApp'\r\n                        defaultMessage='Managed by Apps Framework'\r\n                    />\r\n                </span>\r\n            </div>\r\n        );\r\n        if (!this.props.fromApp) {\r\n            appInfo = (\r\n                <>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__url word-break--all'>\r\n                            <FormattedMessage\r\n                                id='installed_oauth_apps.is_trusted'\r\n                                defaultMessage='Is Trusted: '\r\n                            />\r\n                            <strong>{isTrusted}</strong>\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.client_id'\r\n                                defaultMessage='Client ID: '\r\n                            />\r\n                            <strong>{oauthApp.id}</strong>\r\n                            <CopyText\r\n                                label={messages.copyClientId}\r\n                                value={oauthApp.id}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        {clientSecret}\r\n                    </div>\r\n                    {urls}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__creation'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.creation'\r\n                                defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                                values={{\r\n                                    creator: creatorName,\r\n                                    createAt: oauthApp.create_at,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                {icon}\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <strong className='item-details__name'>\r\n                            {name}\r\n                        </strong>\r\n                        {actions}\r\n                    </div>\r\n                    {error}\r\n                    {description}\r\n                    {appInfo}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst messages = defineMessages({\r\n    copyClientId: {\r\n        id: 'integrations.copy_client_id',\r\n        defaultMessage: 'Copy Client Id',\r\n    },\r\n    copyClientSecret: {\r\n        id: 'integrations.copy_client_secret',\r\n        defaultMessage: 'Copy Client Secret',\r\n    },\r\n});\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {getDisplayNameByUser} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport InstalledOAuthApp from './installed_oauth_app';\r\nimport type {InstalledOAuthAppProps} from './installed_oauth_app';\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: InstalledOAuthAppProps) {\r\n    const oauthApp = ownProps.oauthApp || {};\r\n    return {\r\n        creatorName: getDisplayNameByUser(state, getUser(state, oauthApp.creator_id)),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(InstalledOAuthApp);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport {DeveloperLinks} from 'utils/constants';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nimport InstalledOAuthApp from '../installed_oauth_app';\r\nimport {matchesFilter} from '../installed_oauth_app/installed_oauth_app';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    * The team data\r\n    */\r\n    team?: Team;\r\n\r\n    /**\r\n    * The oauthApps data\r\n    */\r\n    oauthApps: {\r\n        [key: string]: OAuthApp;\r\n    };\r\n\r\n    /**\r\n     * List of IDs for apps managed by the App Framwork\r\n     */\r\n    appsOAuthAppIDs: string[];\r\n\r\n    /**\r\n    * Set if user can manage oath\r\n    */\r\n    canManageOauth: boolean;\r\n\r\n    /**\r\n    * Whether or not OAuth applications are enabled.\r\n    */\r\n    enableOAuthServiceProvider: boolean;\r\n\r\n    actions: ({\r\n\r\n        /**\r\n        * The function to call to fetch OAuth apps\r\n        */\r\n        loadOAuthAppsAndProfiles: (page?: number, perPage?: number) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call when Regenerate Secret link is clicked\r\n        */\r\n        regenOAuthAppSecret: (appId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call when Delete link is clicked\r\n        */\r\n        deleteOAuthApp: (appId: string) => Promise<ActionResult>;\r\n    });\r\n};\r\n\r\ntype State = {\r\n    loading: boolean;\r\n};\r\n\r\nexport default class InstalledOAuthApps extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        if (this.props.enableOAuthServiceProvider) {\r\n            this.props.actions.loadOAuthAppsAndProfiles().then(\r\n                () => this.setState({loading: false}),\r\n            );\r\n        }\r\n    }\r\n\r\n    deleteOAuthApp = (app: OAuthApp): void => {\r\n        if (app && app.id) {\r\n            this.props.actions.deleteOAuthApp(app.id);\r\n        }\r\n    };\r\n\r\n    oauthAppCompare(a: OAuthApp, b: OAuthApp): number {\r\n        let nameA = a.name.toString();\r\n        if (!nameA) {\r\n            nameA = localizeMessage({id: 'installed_integrations.unnamed_oauth_app', defaultMessage: 'Unnamed OAuth 2.0 Application'});\r\n        }\r\n\r\n        let nameB = b.name.toString();\r\n        if (!nameB) {\r\n            nameB = localizeMessage({id: 'installed_integrations.unnamed_oauth_app', defaultMessage: 'Unnamed OAuth 2.0 Application'});\r\n        }\r\n\r\n        return nameA.localeCompare(nameB);\r\n    }\r\n\r\n    oauthApps = (filter?: string) => Object.values(this.props.oauthApps).\r\n        filter((app) => matchesFilter(app, filter)).\r\n        sort(this.oauthAppCompare).\r\n        map((app) => {\r\n            return (\r\n                <InstalledOAuthApp\r\n                    key={app.id}\r\n                    oauthApp={app}\r\n                    onRegenerateSecret={this.props.actions.regenOAuthAppSecret}\r\n                    onDelete={this.deleteOAuthApp}\r\n                    team={this.props.team}\r\n                    creatorName=''\r\n                    fromApp={this.props.appsOAuthAppIDs.includes(app.id)}\r\n                />\r\n            );\r\n        });\r\n\r\n    render() {\r\n        if (!this.props.team) {\r\n            return null;\r\n        }\r\n        const integrationsEnabled = this.props.enableOAuthServiceProvider && this.props.canManageOauth;\r\n        let props;\r\n        if (integrationsEnabled) {\r\n            props = {\r\n                addLink: '/' + this.props.team.name + '/integrations/oauth2-apps/add',\r\n                addText: localizeMessage({id: 'installed_oauth_apps.add', defaultMessage: 'Add OAuth 2.0 Application'}),\r\n                addButtonId: 'addOauthApp',\r\n            };\r\n        }\r\n\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='installed_oauth2_apps.header'\r\n                        defaultMessage='OAuth 2.0 Applications'\r\n                    />\r\n                }\r\n                helpText={\r\n                    <FormattedMessage\r\n                        id='installed_oauth_apps.help'\r\n                        defaultMessage='Create {oauthApplications} to securely integrate bots and third-party apps with Mattermost. Visit the {appDirectory} to find available self-hosted apps.'\r\n                        values={{\r\n                            oauthApplications: (\r\n                                <ExternalLink\r\n                                    href={DeveloperLinks.SETUP_OAUTH2}\r\n                                    location='installed_oauth_apps'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_oauth_apps.help.oauthApplications'\r\n                                        defaultMessage='OAuth 2.0 applications'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace/'\r\n                                    location='installed_oauth_apps'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_oauth_apps.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='installed_oauth_apps.empty'\r\n                        defaultMessage='No OAuth 2.0 Applications found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='installed_oauth_apps.emptySearch'\r\n                        defaultMessage='No OAuth 2.0 Applications match {searchTerm}'\r\n                    />\r\n                }\r\n                searchPlaceholder={localizeMessage({id: 'installed_oauth_apps.search', defaultMessage: 'Search OAuth 2.0 Applications'})}\r\n                loading={this.state.loading}\r\n                {...props}\r\n            >\r\n                {(filter: string) => {\r\n                    const children = this.oauthApps(filter);\r\n                    return [children, children.length > 0];\r\n                }}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {regenOAuthAppSecret, deleteOAuthApp} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getAppsOAuthAppIDs, getOAuthApps} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {loadOAuthAppsAndProfiles} from 'actions/integration_actions';\r\n\r\nimport InstalledOAuthApps from './installed_oauth_apps';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enableOAuthServiceProvider = config.EnableOAuthServiceProvider === 'true';\r\n\r\n    return {\r\n        canManageOauth: haveISystemPermission(state, {permission: Permissions.MANAGE_OAUTH}),\r\n        oauthApps: getOAuthApps(state),\r\n        appsOAuthAppIDs: getAppsOAuthAppIDs(state),\r\n        enableOAuthServiceProvider,\r\n        team: getCurrentTeam(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadOAuthAppsAndProfiles,\r\n            regenOAuthAppSecret,\r\n            deleteOAuthApp,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InstalledOAuthApps);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport CopyText from 'components/copy_text';\r\n\r\nimport DeleteIntegrationLink from './delete_integration_link';\r\n\r\nexport function matchesFilter(outgoingWebhook: OutgoingWebhook, channel: Channel, filter: string) {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    const {\r\n        display_name: displayName,\r\n        description,\r\n        trigger_words: triggerWords,\r\n    } = outgoingWebhook;\r\n\r\n    if (\r\n        (displayName && displayName.toLowerCase().indexOf(filter) !== -1) ||\r\n        (description && description.toLowerCase().indexOf(filter) !== -1)\r\n    ) {\r\n        return true;\r\n    }\r\n\r\n    if (triggerWords) {\r\n        for (const triggerWord of triggerWords) {\r\n            if (triggerWord.toLowerCase().indexOf(filter) !== -1) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (channel && channel.name) {\r\n        if (channel.name.toLowerCase().indexOf(filter) !== -1) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\ntype Props = {\r\n    outgoingWebhook: OutgoingWebhook;\r\n    onRegenToken: (outgoingWebhook: OutgoingWebhook) => void;\r\n    onDelete: (outgoingWebhook: OutgoingWebhook) => void;\r\n    team: Team;\r\n    creator: UserProfile;\r\n    channel: Channel;\r\n    canChange: boolean;\r\n    filter?: string;\r\n}\r\n\r\nexport default class InstalledOutgoingWebhook extends React.PureComponent<Props> {\r\n    handleRegenToken = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n        e.preventDefault();\r\n\r\n        this.props.onRegenToken(this.props.outgoingWebhook);\r\n    };\r\n\r\n    handleDelete = () => {\r\n        this.props.onDelete(this.props.outgoingWebhook);\r\n    };\r\n\r\n    makeDisplayName(outgoingWebhook: OutgoingWebhook, channel: Channel) {\r\n        if (outgoingWebhook.display_name) {\r\n            return outgoingWebhook.display_name;\r\n        } else if (channel) {\r\n            return channel.display_name;\r\n        }\r\n        return (\r\n            <FormattedMessage\r\n                id='installed_outgoing_webhooks.unknown_channel'\r\n                defaultMessage='A Private Webhook'\r\n            />\r\n        );\r\n    }\r\n\r\n    render() {\r\n        const outgoingWebhook = this.props.outgoingWebhook;\r\n        const channel = this.props.channel;\r\n        const filter = this.props.filter ? this.props.filter.toLowerCase() : '';\r\n        const triggerWordsFull = 0;\r\n        const triggerWordsStartsWith = 1;\r\n\r\n        if (outgoingWebhook && !matchesFilter(outgoingWebhook, channel, filter)) {\r\n            return null;\r\n        }\r\n\r\n        const displayName = this.makeDisplayName(outgoingWebhook, channel);\r\n\r\n        let description = null;\r\n        if (outgoingWebhook.description) {\r\n            description = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__description'>\r\n                        {outgoingWebhook.description}\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let triggerWords = null;\r\n        if (outgoingWebhook.trigger_words && outgoingWebhook.trigger_words.length > 0) {\r\n            triggerWords = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__trigger-words'>\r\n                        <FormattedMessage\r\n                            id='installed_integrations.triggerWords'\r\n                            defaultMessage='Trigger Words: {triggerWords}'\r\n                            values={{\r\n                                triggerWords: outgoingWebhook.trigger_words.join(', '),\r\n                            }}\r\n                        />\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const urls = (\r\n            <div className='item-details__row'>\r\n                <span className='item-details__url word-break--all'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.callback_urls'\r\n                        defaultMessage='Callback URLs: {urls}'\r\n                        values={{\r\n                            urls: outgoingWebhook.callback_urls.join(', '),\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n        );\r\n\r\n        let triggerWhen;\r\n        if (outgoingWebhook.trigger_when === triggerWordsFull) {\r\n            triggerWhen = (\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.triggerWordsTriggerWhenFullWord'\r\n                    defaultMessage='First word matches a trigger word exactly'\r\n                />\r\n            );\r\n        } else if (outgoingWebhook.trigger_when === triggerWordsStartsWith) {\r\n            triggerWhen = (\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.triggerWordsTriggerWhenStartsWith'\r\n                    defaultMessage='First word starts with a trigger word'\r\n                />\r\n            );\r\n        }\r\n\r\n        let actions = null;\r\n        if (this.props.canChange) {\r\n            actions = (\r\n                <div className='item-actions'>\r\n                    <button\r\n                        className='style--none color--link'\r\n                        onClick={this.handleRegenToken}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='installed_integrations.regenToken'\r\n                            defaultMessage='Regenerate Token'\r\n                        />\r\n                    </button>\r\n                    {' - '}\r\n                    <Link to={`/${this.props.team.name}/integrations/outgoing_webhooks/edit?id=${outgoingWebhook.id}`}>\r\n                        <FormattedMessage\r\n                            id='installed_integrations.edit'\r\n                            defaultMessage='Edit'\r\n                        />\r\n                    </Link>\r\n                    {' - '}\r\n                    <DeleteIntegrationLink\r\n                        modalMessage={\r\n                            <FormattedMessage\r\n                                id='installed_outgoing_webhooks.delete.confirm'\r\n                                defaultMessage='This action permanently deletes the outgoing webhook and breaks any integrations using it. Are you sure you want to delete it?'\r\n                            />\r\n                        }\r\n                        onDelete={this.handleDelete}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <strong className='item-details__name'>\r\n                            {displayName}\r\n                        </strong>\r\n                        {actions}\r\n                    </div>\r\n                    {description}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__content_type'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.content_type'\r\n                                defaultMessage='Content-Type: {contentType}'\r\n                                values={{\r\n                                    contentType: outgoingWebhook.content_type || 'application/x-www-form-urlencoded',\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    {triggerWords}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__trigger-when'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.triggerWhen'\r\n                                defaultMessage='Trigger When: {triggerWhen}'\r\n                                values={{\r\n                                    triggerWhen,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.token'\r\n                                defaultMessage='Token: {token}'\r\n                                values={{\r\n                                    token: <code>{outgoingWebhook.token}</code>,\r\n                                }}\r\n                            />\r\n                            <CopyText\r\n                                label={defineMessage({\r\n                                    id: 'integrations.copy_token',\r\n                                    defaultMessage: 'Copy Token',\r\n                                })}\r\n                                value={outgoingWebhook.token}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__creation'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.creation'\r\n                                defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                                values={{\r\n                                    creator: this.props.creator.username,\r\n                                    createAt: outgoingWebhook.create_at,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    {urls}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\nimport type {IDMappedObjects} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\nimport InstalledOutgoingWebhook, {matchesFilter} from 'components/integrations/installed_outgoing_webhook';\r\n\r\nimport {Constants, DeveloperLinks} from 'utils/constants';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n    *  Data used in passing down as props for webhook modifications\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * Data used for checking if webhook is created by current user\r\n    */\r\n    user: UserProfile;\r\n\r\n    /**\r\n    *  Data used for checking modification privileges\r\n    */\r\n    canManageOthersWebhooks: boolean;\r\n\r\n    /**\r\n    * Data used in passing down as props for showing webhook details\r\n    */\r\n    outgoingWebhooks: OutgoingWebhook[];\r\n\r\n    /**\r\n    * Data used in sorting for displaying list and as props channel details\r\n    */\r\n    channels: IDMappedObjects<Channel>;\r\n\r\n    /**\r\n    *  Data used in passing down as props for webhook -created by label\r\n    */\r\n    users: IDMappedObjects<UserProfile>;\r\n\r\n    /**\r\n    *  Data used in passing as argument for loading webhooks\r\n    */\r\n    teamId: string;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call for removing outgoingWebhook\r\n        */\r\n        removeOutgoingHook: (hookId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call for outgoingWebhook List and for the status of api\r\n        */\r\n        loadOutgoingHooksAndProfilesForTeam: (teamId: string, page: number, perPage: number) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call for regeneration of webhook token\r\n        */\r\n        regenOutgoingHookToken: (hookId: string) => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n    * Whether or not outgoing webhooks are enabled.\r\n    */\r\n    enableOutgoingWebhooks: boolean;\r\n}\r\n\r\ntype State = {\r\n    loading: boolean;\r\n};\r\n\r\nexport default class InstalledOutgoingWebhooks extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.enableOutgoingWebhooks) {\r\n            this.props.actions.loadOutgoingHooksAndProfilesForTeam(\r\n                this.props.teamId,\r\n                Constants.Integrations.START_PAGE_NUM,\r\n                Constants.Integrations.PAGE_SIZE,\r\n            ).then(\r\n                () => this.setState({loading: false}),\r\n            );\r\n        }\r\n    }\r\n\r\n    regenOutgoingWebhookToken = (outgoingWebhook: OutgoingWebhook) => {\r\n        this.props.actions.regenOutgoingHookToken(outgoingWebhook.id);\r\n    };\r\n\r\n    removeOutgoingHook = (outgoingWebhook: OutgoingWebhook) => {\r\n        this.props.actions.removeOutgoingHook(outgoingWebhook.id);\r\n    };\r\n\r\n    outgoingWebhookCompare = (a: OutgoingWebhook, b: OutgoingWebhook) => {\r\n        let displayNameA = a.display_name;\r\n        if (!displayNameA) {\r\n            const channelA = this.props.channels[a.channel_id];\r\n            if (channelA) {\r\n                displayNameA = channelA.display_name;\r\n            } else {\r\n                displayNameA = localizeMessage({id: 'installed_outgoing_webhooks.unknown_channel', defaultMessage: 'A Private Webhook'});\r\n            }\r\n        }\r\n\r\n        let displayNameB = b.display_name;\r\n        if (!displayNameB) {\r\n            const channelB = this.props.channels[b.channel_id];\r\n            if (channelB) {\r\n                displayNameB = channelB.display_name;\r\n            } else {\r\n                displayNameB = localizeMessage({id: 'installed_outgoing_webhooks.unknown_channel', defaultMessage: 'A Private Webhook'});\r\n            }\r\n        }\r\n        return displayNameA.localeCompare(displayNameB);\r\n    };\r\n\r\n    outgoingWebhooks = (filter: string) => this.props.outgoingWebhooks.\r\n        sort(this.outgoingWebhookCompare).\r\n        filter((outgoingWebhook) => matchesFilter(outgoingWebhook, this.props.channels[outgoingWebhook.channel_id], filter)).\r\n        map((outgoingWebhook) => {\r\n            const canChange = this.props.canManageOthersWebhooks || this.props.user.id === outgoingWebhook.creator_id;\r\n            const channel = this.props.channels[outgoingWebhook.channel_id];\r\n            return (\r\n                <InstalledOutgoingWebhook\r\n                    key={outgoingWebhook.id}\r\n                    outgoingWebhook={outgoingWebhook}\r\n                    onRegenToken={this.regenOutgoingWebhookToken}\r\n                    onDelete={this.removeOutgoingHook}\r\n                    creator={this.props.users[outgoingWebhook.creator_id] || {}}\r\n                    canChange={canChange}\r\n                    team={this.props.team}\r\n                    channel={channel}\r\n                />\r\n            );\r\n        });\r\n\r\n    render() {\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.header'\r\n                        defaultMessage='Installed Outgoing Webhooks'\r\n                    />\r\n                }\r\n                addText={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.add'\r\n                        defaultMessage='Add Outgoing Webhook'\r\n                    />\r\n                }\r\n                addLink={\r\n                    '/' +\r\n                    this.props.team.name +\r\n                    '/integrations/outgoing_webhooks/add'\r\n                }\r\n                addButtonId='addOutgoingWebhook'\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.empty'\r\n                        defaultMessage='No outgoing webhooks found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.search.empty'\r\n                        defaultMessage='No outgoing webhooks match <b>{searchTerm}</b>'\r\n                        values={{\r\n                            b: (chunks: string) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                }\r\n                helpText={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.help'\r\n                        defaultMessage='Use outgoing webhooks to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.'\r\n                        values={{\r\n                            buildYourOwn: (\r\n                                <ExternalLink\r\n                                    href={DeveloperLinks.SETUP_OUTGOING_WEBHOOKS}\r\n                                    location='installed_outgoing_webhooks'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_outgoing_webhooks.help.buildYourOwn'\r\n                                        defaultMessage='Build your own'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace'\r\n                                    location='installed_outgoing_webhooks'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_outgoing_webhooks.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                searchPlaceholder={localizeMessage({\r\n                    id: 'installed_outgoing_webhooks.search',\r\n                    defaultMessage: 'Search Outgoing Webhooks',\r\n                })}\r\n                loading={this.state.loading}\r\n            >\r\n                {(filter: string) => {\r\n                    const children = this.outgoingWebhooks(filter);\r\n                    return [children, children.length > 0];\r\n                }}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport * as Actions from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getAllChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getOutgoingHooks} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getUsers} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadOutgoingHooksAndProfilesForTeam} from 'actions/integration_actions';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport InstalledOutgoingWebhook from './installed_outgoing_webhooks';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const teamId = getCurrentTeamId(state);\r\n    const canManageOthersWebhooks = haveITeamPermission(state, teamId, Permissions.MANAGE_OTHERS_OUTGOING_WEBHOOKS);\r\n    const outgoingHooks = getOutgoingHooks(state);\r\n    const outgoingWebhooks = Object.keys(outgoingHooks).\r\n        map((key) => outgoingHooks[key]).\r\n        filter((outgoingWebhook) => outgoingWebhook.team_id === teamId);\r\n    const enableOutgoingWebhooks = config.EnableOutgoingWebhooks === 'true';\r\n\r\n    return {\r\n        outgoingWebhooks,\r\n        channels: getAllChannels(state),\r\n        users: getUsers(state),\r\n        teamId,\r\n        canManageOthersWebhooks,\r\n        enableOutgoingWebhooks,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadOutgoingHooksAndProfilesForTeam,\r\n            removeOutgoingHook: Actions.removeOutgoingHook,\r\n            regenOutgoingHookToken: Actions.regenOutgoingHookToken,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InstalledOutgoingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChangeEvent, FormEvent} from 'react';\r\nimport React, {useMemo, useState} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport {AlertOutlineIcon, CheckCircleOutlineIcon} from '@mattermost/compass-icons/components';\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {validateOutgoingOAuthConnection} from 'mattermost-redux/actions/integrations';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    header: MessageDescriptor;\r\n    footer: MessageDescriptor;\r\n    loading: MessageDescriptor;\r\n    renderExtra?: JSX.Element;\r\n    serverError: string;\r\n\r\n    initialConnection?: OutgoingOAuthConnection;\r\n\r\n    submitAction: (connection: OutgoingOAuthConnection) => Promise<void>;\r\n}\r\n\r\ntype State = {\r\n    name: string;\r\n    oauthTokenUrl: string;\r\n    grantType: OutgoingOAuthConnection['grant_type'];\r\n    clientId: string;\r\n    clientSecret: string;\r\n    audienceUrls: string;\r\n};\r\n\r\nenum ValidationStatus {\r\n    INITIAL = 'initial',\r\n    DIRTY = 'dirty',\r\n    VALIDATING = 'validating',\r\n    VALIDATED = 'validated',\r\n    ERROR = 'error',\r\n}\r\n\r\nconst useOutgoingOAuthForm = (connection: OutgoingOAuthConnection): [State, (state: Partial<State>) => void] => {\r\n    const initialState: State = {\r\n        name: connection.name || '',\r\n        audienceUrls: connection.audiences ? connection.audiences.join('\\n') : '',\r\n        oauthTokenUrl: connection.oauth_token_url || '',\r\n        clientId: connection.client_id || '',\r\n        clientSecret: connection.client_secret || '',\r\n        grantType: 'client_credentials',\r\n    };\r\n\r\n    const [state, setState] = useState(initialState);\r\n\r\n    return useMemo(() => [state, (newState: Partial<State>) => {\r\n        setState((oldState) => ({...oldState, ...newState}));\r\n    }], [state]);\r\n};\r\n\r\nconst initialState: OutgoingOAuthConnection = {\r\n    id: '',\r\n    name: '',\r\n    creator_id: '',\r\n    create_at: 0,\r\n    update_at: 0,\r\n    client_id: '',\r\n    client_secret: '',\r\n    oauth_token_url: '',\r\n    grant_type: 'client_credentials',\r\n    audiences: [],\r\n};\r\n\r\nexport default function AbstractOutgoingOAuthConnection(props: Props) {\r\n    const [formState, setFormState] = useOutgoingOAuthForm(props.initialConnection || initialState);\r\n\r\n    const [storedError, setError] = useState<React.ReactNode>('');\r\n    const [validationError, setValidationError] = useState<string>('');\r\n\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [validationStatus, setValidationStatus] = useState<ValidationStatus>(ValidationStatus.INITIAL);\r\n    const [isEditingSecret, setIsEditingSecret] = useState(false);\r\n\r\n    const [isValidationModalOpen, setIsValidationModalOpen] = useState(false);\r\n\r\n    const intl = useIntl();\r\n    const dispatch = useDispatch();\r\n\r\n    const isNewConnection = !props.initialConnection;\r\n\r\n    const parseForm = (requireAudienceUrl: boolean): OutgoingOAuthConnection | undefined => {\r\n        if (!formState.name) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.name.required'\r\n                    defaultMessage='Name for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        if (!formState.clientId) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.client_id.required'\r\n                    defaultMessage='Client Id for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        if ((isNewConnection || isEditingSecret) && !formState.clientSecret) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.client_secret.required'\r\n                    defaultMessage='Client Secret for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        if (!formState.grantType) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.grant_type.required'\r\n                    defaultMessage='Grant Type for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        if (!formState.oauthTokenUrl) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.oauth_token_url.required'\r\n                    defaultMessage='OAuth Token URL for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        const audienceUrls = [];\r\n        for (let audienceUrl of formState.audienceUrls.split('\\n')) {\r\n            audienceUrl = audienceUrl.trim();\r\n\r\n            if (audienceUrl.length > 0) {\r\n                audienceUrls.push(audienceUrl);\r\n            }\r\n        }\r\n\r\n        if (requireAudienceUrl && audienceUrls.length === 0) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.audienceUrls.required'\r\n                    defaultMessage='One or more audience URLs are required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        const connection = {\r\n            name: formState.name,\r\n            audiences: audienceUrls,\r\n            client_id: formState.clientId,\r\n            client_secret: formState.clientSecret,\r\n            grant_type: formState.grantType,\r\n            oauth_token_url: formState.oauthTokenUrl,\r\n        } as OutgoingOAuthConnection;\r\n\r\n        return connection;\r\n    };\r\n\r\n    const showSkipValidateModal = () => {\r\n        setIsValidationModalOpen(true);\r\n    };\r\n\r\n    const hideSkipValidateModal = () => {\r\n        setIsValidationModalOpen(false);\r\n    };\r\n\r\n    const handleSubmitFromButton = (e: FormEvent) => {\r\n        e.preventDefault();\r\n        handleSubmit();\r\n    };\r\n\r\n    const handleSubmit = () => {\r\n        if (isSubmitting) {\r\n            return;\r\n        }\r\n\r\n        const connection = parseForm(true);\r\n        if (!connection) {\r\n            return;\r\n        }\r\n\r\n        setError('');\r\n\r\n        if (validationStatus !== ValidationStatus.VALIDATED && !(!isNewConnection && validationStatus === ValidationStatus.INITIAL)) {\r\n            if (!isValidationModalOpen) {\r\n                showSkipValidateModal();\r\n                return;\r\n            }\r\n        }\r\n\r\n        setIsSubmitting(true);\r\n\r\n        const res = props.submitAction(connection);\r\n        res.then(() => setIsSubmitting(false));\r\n    };\r\n\r\n    const handleValidate = async (e: FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (validationStatus === ValidationStatus.VALIDATING) {\r\n            return;\r\n        }\r\n\r\n        setError('');\r\n        setValidationStatus(ValidationStatus.VALIDATING);\r\n\r\n        const connection = parseForm(false);\r\n        if (!connection) {\r\n            // Defer to the form validation error\r\n            setValidationStatus(ValidationStatus.INITIAL);\r\n            return;\r\n        }\r\n\r\n        if (props.initialConnection?.id) {\r\n            connection.id = props.initialConnection.id;\r\n        }\r\n\r\n        const {error} = await dispatch(validateOutgoingOAuthConnection(props.team.id, connection));\r\n\r\n        if (error) {\r\n            setValidationStatus(ValidationStatus.ERROR);\r\n            setValidationError(error.message);\r\n        } else {\r\n            setValidationStatus(ValidationStatus.VALIDATED);\r\n        }\r\n    };\r\n\r\n    const setUnvalidated = (e?: React.FormEvent) => {\r\n        e?.preventDefault();\r\n\r\n        if (validationStatus !== ValidationStatus.DIRTY) {\r\n            setValidationStatus(ValidationStatus.DIRTY);\r\n        }\r\n\r\n        if (validationError) {\r\n            setValidationError('');\r\n        }\r\n    };\r\n\r\n    const updateName = (e: ChangeEvent<HTMLInputElement>) => {\r\n        setFormState({\r\n            name: e.target.value,\r\n        });\r\n    };\r\n\r\n    const updateClientId = (e: ChangeEvent<HTMLInputElement>) => {\r\n        setUnvalidated();\r\n\r\n        setFormState({\r\n            clientId: e.target.value,\r\n        });\r\n    };\r\n\r\n    const updateClientSecret = (e: ChangeEvent<HTMLInputElement>) => {\r\n        setUnvalidated();\r\n\r\n        setFormState({\r\n            clientSecret: e.target.value,\r\n        });\r\n    };\r\n\r\n    const updateOAuthTokenURL = (e: ChangeEvent<HTMLInputElement>) => {\r\n        setUnvalidated();\r\n\r\n        setFormState({\r\n            oauthTokenUrl: e.target.value,\r\n        });\r\n    };\r\n\r\n    const updateAudienceUrls = (e: ChangeEvent<HTMLTextAreaElement>) => {\r\n        setFormState({\r\n            audienceUrls: e.target.value,\r\n        });\r\n    };\r\n\r\n    const startEditingClientSecret = () => {\r\n        setIsEditingSecret(true);\r\n    };\r\n\r\n    const headerToRender = props.header;\r\n    const footerToRender = props.footer;\r\n\r\n    let clientSecretSection = (\r\n        <input\r\n            id='client_secret'\r\n            type='text'\r\n            autoComplete='off'\r\n            className='form-control'\r\n            value={formState.clientSecret}\r\n            onChange={updateClientSecret}\r\n        />\r\n    );\r\n\r\n    if (!isNewConnection && !isEditingSecret) {\r\n        clientSecretSection = (\r\n            <>\r\n                <input\r\n                    id='client_secret'\r\n                    disabled={true}\r\n                    autoComplete='off'\r\n                    type='text'\r\n                    className='form-control disabled'\r\n                    value={''.repeat(40)}\r\n                />\r\n                <span\r\n                    onClick={startEditingClientSecret}\r\n                    className='outgoing-oauth-connections-edit-secret'\r\n                >\r\n                    <i className='icon icon-pencil-outline'/>\r\n                </span>\r\n            </>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className='backstage-content'>\r\n            <BackstageHeader>\r\n                <Link to={`/${props.team.name}/integrations/outgoing-oauth2-connections`}>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.header'\r\n                        defaultMessage='Outgoing OAuth Connections'\r\n                    />\r\n                </Link>\r\n                <FormattedMessage\r\n                    id={headerToRender.id}\r\n                    defaultMessage={headerToRender.defaultMessage}\r\n                />\r\n            </BackstageHeader>\r\n            <div className='backstage-form'>\r\n                <form className='form-horizontal'>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='name'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.name.label'\r\n                                defaultMessage='Name'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            <input\r\n                                id='name'\r\n                                type='text'\r\n                                className='form-control'\r\n                                value={formState.name}\r\n                                onChange={updateName}\r\n                            />\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.name.help'\r\n                                    defaultMessage='Specify the name for your OAuth connection.'\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='client_id'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.client_id.label'\r\n                                defaultMessage='Client ID'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            <input\r\n                                id='client_id'\r\n                                type='text'\r\n                                autoComplete='off'\r\n                                className='form-control'\r\n                                value={formState.clientId}\r\n                                onChange={updateClientId}\r\n                            />\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.client_id.help'\r\n                                    defaultMessage='Specify the Client ID for your OAuth connection.'\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='client_secret'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.client_secret.label'\r\n                                defaultMessage='Client Secret'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            {clientSecretSection}\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.client_secret.help'\r\n                                    defaultMessage='Specify the Client Secret for your OAuth connection.'\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='oauth_token_url'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.oauth_token_url.label'\r\n                                defaultMessage='OAuth Token URL'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            <input\r\n                                id='token_url'\r\n                                type='text'\r\n                                className='form-control'\r\n                                value={formState.oauthTokenUrl}\r\n                                onChange={updateOAuthTokenURL}\r\n                            />\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.oauth_token_url.help'\r\n                                    defaultMessage='Specify the OAuth Token URL for your OAuth connection.'\r\n                                />\r\n                            </div>\r\n                            <div className='outgoing-oauth-connection-validate-button-container'>\r\n                                <ValidateButton\r\n                                    onClick={handleValidate}\r\n                                    setUnvalidated={setUnvalidated}\r\n                                    status={validationStatus}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='audienceUrls'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.audienceUrls.label'\r\n                                defaultMessage='Audience URLs (One Per Line)'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            <textarea\r\n                                id='audienceUrls'\r\n                                rows={3}\r\n                                className='form-control'\r\n                                value={formState.audienceUrls}\r\n                                onChange={updateAudienceUrls}\r\n                            />\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.audienceUrls.help'\r\n                                    defaultMessage='The URLs which will receive requests with the OAuth token, e.g. your custom slash command handler endpoint. Must be a valid URL and start with http:// or https://.'\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='backstage-form__footer'>\r\n                        <FormError\r\n                            type='backstage'\r\n                            errors={[props.serverError, storedError]}\r\n                        />\r\n                        <Link\r\n                            className='btn btn-tertiary'\r\n                            to={`/${props.team.name}/integrations/outgoing-oauth2-connections`}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.cancel'\r\n                                defaultMessage='Cancel'\r\n                            />\r\n                        </Link>\r\n                        <SpinnerButton\r\n                            className='btn btn-primary'\r\n                            type='submit'\r\n                            spinning={isSubmitting}\r\n                            spinningText={intl.formatMessage(props.loading)}\r\n                            onClick={handleSubmitFromButton}\r\n                            id='saveConnection'\r\n                        >\r\n                            <FormattedMessage\r\n                                id={footerToRender.id}\r\n                                defaultMessage={footerToRender.defaultMessage}\r\n                            />\r\n                        </SpinnerButton>\r\n                        {props.renderExtra}\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            <div className='outgoing-oauth-connections-docs-link'>\r\n                <FormattedMessage\r\n                    id={'add_outgoing_oauth_connection.documentation_link'}\r\n                    defaultMessage={'Get help with <link>configuring outgoing OAuth connections</link>.'}\r\n                    values={{\r\n                        link: (text: string) => (\r\n                            <a href='https://mattermost.com/pl/outgoing-oauth-connections'>{text}</a>\r\n                        ),\r\n                    }}\r\n                />\r\n            </div>\r\n            <ConfirmModal\r\n                show={isValidationModalOpen}\r\n                message={intl.formatMessage({\r\n                    id: 'add_outgoing_oauth_connection.save_without_validation_warning',\r\n                    defaultMessage: 'This connection has not been validated, Do you want to save anyway?',\r\n                })}\r\n                title={intl.formatMessage({\r\n                    id: 'add_outgoing_oauth_connection.confirm_save',\r\n                    defaultMessage: 'Save Outgoing OAuth Connection',\r\n                })}\r\n                confirmButtonText={intl.formatMessage({\r\n                    id: 'add_outgoing_oauth_connection.save_anyway',\r\n                    defaultMessage: 'Save anyway',\r\n                })}\r\n                onExited={hideSkipValidateModal}\r\n                onCancel={hideSkipValidateModal}\r\n                onConfirm={handleSubmit}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\ntype ValidateButtonProps = {\r\n    status: ValidationStatus;\r\n    onClick: (e: FormEvent) => void;\r\n    setUnvalidated: (e: FormEvent) => void;\r\n}\r\n\r\nconst ValidateButton = ({status, onClick, setUnvalidated}: ValidateButtonProps) => {\r\n    if (status === ValidationStatus.ERROR) {\r\n        return (\r\n            <span\r\n                className='outgoing-oauth-connection-validation-message validation-error'\r\n            >\r\n                <AlertOutlineIcon size={20}/>\r\n                <FormattedMessage\r\n                    id={'add_outgoing_oauth_connection.validation_error'}\r\n                    defaultMessage={'Connection not validated. Please check the server logs for details or <link>try again</link>.'}\r\n                    values={{\r\n                        link: (text: string) => <a onClick={setUnvalidated}>{text}</a>,\r\n                    }}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    if (status === ValidationStatus.VALIDATED) {\r\n        return (\r\n            <span\r\n                className='outgoing-oauth-connection-validation-message validation-success'\r\n            >\r\n                <CheckCircleOutlineIcon size={20}/>\r\n                <FormattedMessage\r\n                    id={'add_outgoing_oauth_connection.validated_connection'}\r\n                    defaultMessage={'Validated connection'}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    if (status === ValidationStatus.VALIDATING) {\r\n        return (\r\n            <span\r\n                className='outgoing-oauth-connection-validation-message'\r\n            >\r\n                <LoadingSpinner\r\n                    text={(\r\n                        <FormattedMessage\r\n                            id={'add_outgoing_oauth_connection.validating'}\r\n                            defaultMessage={'Validating...'}\r\n                        />\r\n                    )}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    const validateButton = (\r\n        <button\r\n            className='btn btn-tertiary btn-sm'\r\n            type='button'\r\n            onClick={onClick}\r\n            id='validateConnection'\r\n        >\r\n            <FormattedMessage\r\n                id={'add_outgoing_oauth_connection.validate'}\r\n                defaultMessage={'Validate Connection'}\r\n            />\r\n        </button>\r\n    );\r\n\r\n    return validateButton;\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport {defineMessage} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {addOutgoingOAuthConnection} from 'mattermost-redux/actions/integrations';\r\n\r\nimport AbstractOutgoingOAuthConnection from './abstract_outgoing_oauth_connection';\r\n\r\nconst HEADER = defineMessage({id: 'add_outgoing_oauth_connection.add', defaultMessage: 'Add'});\r\nconst FOOTER = defineMessage({id: 'add_outgoing_oauth_connection.save', defaultMessage: 'Save'});\r\nconst LOADING = defineMessage({id: 'add_outgoing_oauth_connection.saving', defaultMessage: 'Saving...'});\r\n\r\nexport type Props = {\r\n    team: Team;\r\n};\r\n\r\nconst AddOutgoingOAuthConnection = ({team}: Props): JSX.Element => {\r\n    const dispatch = useDispatch();\r\n\r\n    const history = useHistory();\r\n\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const submit = async (connection: OutgoingOAuthConnection) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = (await dispatch(addOutgoingOAuthConnection(team.id, connection))) as unknown as {data: OutgoingOAuthConnection; error: Error};\r\n        if (data) {\r\n            history.push(`/${team.name}/integrations/confirm?type=outgoing-oauth2-connections&id=${data.id}`);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AbstractOutgoingOAuthConnection\r\n            team={team}\r\n            header={HEADER}\r\n            footer={FOOTER}\r\n            loading={LOADING}\r\n            submitAction={submit}\r\n            serverError={serverError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default AddOutgoingOAuthConnection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState} from 'react';\r\nimport {FormattedMessage, defineMessage} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {editOutgoingOAuthConnection, getOutgoingOAuthConnection} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getOutgoingOAuthConnections} from 'mattermost-redux/selectors/entities/integrations';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nimport AbstractOutgoingOAuthConnection from './abstract_outgoing_oauth_connection';\r\n\r\nconst HEADER = defineMessage({id: 'integrations.edit', defaultMessage: 'Edit'});\r\nconst FOOTER = defineMessage({id: 'edit_outgoing_oauth_connection.update', defaultMessage: 'Update'});\r\nconst LOADING = defineMessage({id: 'edit_outgoing_oauth_connection.updating', defaultMessage: 'Updating...'});\r\n\r\ntype Props = {\r\n    team: Team;\r\n    location: Location;\r\n};\r\n\r\nconst getConnectionIdFromSearch = (search: string): string => {\r\n    return (new URLSearchParams(search)).get('id') || '';\r\n};\r\n\r\nconst EditOutgoingOAuthConnection = (props: Props) => {\r\n    const connectionId = getConnectionIdFromSearch(props.location.search);\r\n    const connections = useSelector(getOutgoingOAuthConnections);\r\n    const existingConnection = connections[connectionId];\r\n\r\n    const [newConnection, setNewConnection] = useState(existingConnection);\r\n    const [showConfirmModal, setShowConfirmModal] = useState(false);\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const enableOAuthServiceProvider = useSelector(getConfig).EnableOAuthServiceProvider;\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        if (enableOAuthServiceProvider) {\r\n            dispatch(getOutgoingOAuthConnection(props.team.id, connectionId));\r\n        }\r\n    }, [connectionId, enableOAuthServiceProvider, props.team, dispatch]);\r\n\r\n    const handleInitialSubmit = async (connection: OutgoingOAuthConnection) => {\r\n        setNewConnection(connection);\r\n\r\n        if (existingConnection.id) {\r\n            connection.id = existingConnection.id;\r\n        }\r\n\r\n        const audienceUrlsSame = (existingConnection.audiences.length === connection.audiences.length) &&\r\n            existingConnection.audiences.every((v, i) => v === connection.audiences[i]);\r\n\r\n        if (audienceUrlsSame) {\r\n            await createOutgoingOAuthConnection(connection);\r\n        } else {\r\n            handleConfirmModal();\r\n        }\r\n    };\r\n\r\n    const handleConfirmModal = () => {\r\n        setShowConfirmModal(true);\r\n    };\r\n\r\n    const confirmModalDismissed = () => {\r\n        setShowConfirmModal(false);\r\n    };\r\n\r\n    const createOutgoingOAuthConnection = async (connection: OutgoingOAuthConnection) => {\r\n        setServerError('');\r\n\r\n        const res = await dispatch(editOutgoingOAuthConnection(props.team.id, connection));\r\n\r\n        if ('data' in res && res.data) {\r\n            getHistory().push(`/${props.team.name}/integrations/outgoing-oauth2-connections`);\r\n            return;\r\n        }\r\n\r\n        confirmModalDismissed();\r\n\r\n        if ('error' in res) {\r\n            const {error: err} = res as {error: Error};\r\n            setServerError(err.message);\r\n        }\r\n    };\r\n\r\n    const renderExtra = () => {\r\n        const confirmButton = (\r\n            <FormattedMessage\r\n                id='update_command.update'\r\n                defaultMessage='Update'\r\n            />\r\n        );\r\n\r\n        const confirmTitle = (\r\n            <FormattedMessage\r\n                id='update_outgoing_oauth_connection.confirm'\r\n                defaultMessage='Edit Outgoing OAuth Connection'\r\n            />\r\n        );\r\n\r\n        const confirmMessage = (\r\n            <FormattedMessage\r\n                id='update_outgoing_oauth_connection.question'\r\n                defaultMessage='Your changes may break any existing integrations using this connection. Are you sure you would like to update it?'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <ConfirmModal\r\n                title={confirmTitle}\r\n                message={confirmMessage}\r\n                confirmButtonText={confirmButton}\r\n                modalClass='integrations-backstage-modal'\r\n                show={showConfirmModal}\r\n                onConfirm={() => createOutgoingOAuthConnection(newConnection)}\r\n                onCancel={confirmModalDismissed}\r\n            />\r\n        );\r\n    };\r\n\r\n    if (!existingConnection) {\r\n        return <LoadingScreen/>;\r\n    }\r\n\r\n    return (\r\n        <AbstractOutgoingOAuthConnection\r\n            team={props.team}\r\n            header={HEADER}\r\n            footer={FOOTER}\r\n            loading={LOADING}\r\n            renderExtra={renderExtra()}\r\n            submitAction={handleInitialSubmit}\r\n            serverError={serverError}\r\n            initialConnection={existingConnection}\r\n        />\r\n    );\r\n};\r\n\r\nexport default EditOutgoingOAuthConnection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport DeleteIntegrationLink from '../delete_integration_link';\r\n\r\nexport function matchesFilter(outgoingOAuthConnection: OutgoingOAuthConnection, filter?: string | null): boolean {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    return outgoingOAuthConnection.name.toLowerCase().includes(filter);\r\n}\r\n\r\nexport type InstalledOutgoingOAuthConnectionProps = {\r\n    team: Partial<Team>;\r\n    outgoingOAuthConnection: OutgoingOAuthConnection;\r\n    creatorName: string;\r\n    filter?: string | null;\r\n\r\n    onDelete: (outgoingOAuthConnection: OutgoingOAuthConnection) => void;\r\n}\r\n\r\nexport type InstalledOutgoingOAuthConnectionState = {\r\n    clientSecret: string;\r\n    error?: string | null;\r\n}\r\n\r\nconst InstalledOutgoingOAuthConnection = (props: InstalledOutgoingOAuthConnectionProps) => {\r\n    const handleDelete = (): void => {\r\n        props.onDelete(props.outgoingOAuthConnection);\r\n    };\r\n\r\n    const {outgoingOAuthConnection, creatorName} = props;\r\n\r\n    if (!matchesFilter(outgoingOAuthConnection, props.filter)) {\r\n        return null;\r\n    }\r\n\r\n    let name;\r\n    if (outgoingOAuthConnection.name) {\r\n        name = outgoingOAuthConnection.name;\r\n    } else {\r\n        name = (\r\n            <FormattedMessage\r\n                id='installed_integrations.unnamed_outgoing_oauth_connection'\r\n                defaultMessage='Unnamed Outgoing OAuth Connection'\r\n            />\r\n        );\r\n    }\r\n\r\n    const urls = (\r\n        <>\r\n            <div className='item-details__row'>\r\n                <span className='item-details__url word-break--all'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.audience_urls'\r\n                        defaultMessage='Audience URLs: {urls}'\r\n                        values={{\r\n                            urls: <code>{outgoingOAuthConnection.audiences.join(', ')}</code>,\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n            <div className='item-details__row'>\r\n                <span className='item-details__url word-break--all'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.token_url'\r\n                        defaultMessage='Token URL: {url}'\r\n                        values={{\r\n                            url: <code>{outgoingOAuthConnection.oauth_token_url}</code>,\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n        </>\r\n    );\r\n\r\n    const actions = (\r\n        <div className='item-actions'>\r\n            <Link to={`/${props.team.name}/integrations/outgoing-oauth2-connections/edit?id=${outgoingOAuthConnection.id}`}>\r\n                <FormattedMessage\r\n                    id='installed_integrations.edit'\r\n                    defaultMessage='Edit'\r\n                />\r\n            </Link>\r\n            {' - '}\r\n            <DeleteIntegrationLink\r\n                subtitleText={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_oauth_connections.delete.confirm'\r\n                        defaultMessage='Are you sure you want to delete {connectionName}?'\r\n                        values={{\r\n                            connectionName: (\r\n                                <strong>\r\n                                    {props.outgoingOAuthConnection.name}\r\n                                </strong>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                modalMessage={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_oauth_connections.delete.wanring'\r\n                        defaultMessage='Deleting this connection will break any integrations using it'\r\n                    />\r\n                }\r\n                onDelete={handleDelete}\r\n            />\r\n        </div>\r\n    );\r\n\r\n    const connectionInfo = (\r\n        <>\r\n            <div className='item-details__row'>\r\n                <span className='item-details__token'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.client_id'\r\n                        defaultMessage='Client ID: '\r\n                    />\r\n                    <strong><code>{outgoingOAuthConnection.client_id}</code></strong>\r\n                </span>\r\n            </div>\r\n            <div className='item-details__row'>\r\n                <span className='item-details__token'>\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_oauth_connections.client_secret'\r\n                        defaultMessage='Client Secret: ********'\r\n                    />\r\n                </span>\r\n            </div>\r\n            {outgoingOAuthConnection.grant_type === 'password' && (\r\n                <>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_outgoing_oauth_connections.username'\r\n                                defaultMessage='Username: '\r\n                            />\r\n                            <strong>{outgoingOAuthConnection.credentials_username}</strong>\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_outgoing_oauth_connections.password'\r\n                                defaultMessage='Password: ********'\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </>\r\n            )}\r\n\r\n            {urls}\r\n            <div className='item-details__row'>\r\n                <span className='item-details__creation'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.creation'\r\n                        defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                        values={{\r\n                            creator: creatorName,\r\n                            createAt: outgoingOAuthConnection.create_at,\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n        </>\r\n    );\r\n\r\n    return (\r\n        <div className='backstage-list__item' >\r\n            <div className='item-details' >\r\n                <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                    <strong className='item-details__name'>\r\n                        {name}\r\n                    </strong>\r\n                    {actions}\r\n                </div>\r\n                {connectionInfo}\r\n            </div>\r\n        </div >\r\n    );\r\n};\r\n\r\nexport default InstalledOutgoingOAuthConnection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {deleteOutgoingOAuthConnection} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getOutgoingOAuthConnections} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\n\r\nimport {loadOutgoingOAuthConnectionsAndProfiles} from 'actions/integration_actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport {DeveloperLinks} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport InstalledOutgoingOAuthConnection, {matchesFilter} from './installed_outgoing_oauth_connection';\r\n\r\ntype Props = {\r\n    team: Team;\r\n};\r\n\r\nconst InstalledOutgoingOAuthConnections = (props: Props) => {\r\n    const [loading, setLoading] = useState(true);\r\n    const canManageOutgoingOAuthConnections = useSelector((state: GlobalState) => haveITeamPermission(state, props.team.id, Permissions.MANAGE_OUTGOING_OAUTH_CONNECTIONS));\r\n    const enableOutgoingOAuthConnections = (useSelector(getConfig).EnableOutgoingOAuthConnections === 'true');\r\n    const connections = useSelector(getOutgoingOAuthConnections);\r\n\r\n    const dispatch = useDispatch();\r\n    const intl = useIntl();\r\n\r\n    useEffect(() => {\r\n        if (canManageOutgoingOAuthConnections) {\r\n            (dispatch(loadOutgoingOAuthConnectionsAndProfiles(props.team.id)) as unknown as Promise<void>).then(\r\n                () => setLoading(false),\r\n            );\r\n        }\r\n    }, [canManageOutgoingOAuthConnections, props.team, dispatch]);\r\n\r\n    const deleteOutgoingOAuthConnectionLocal = (connection: OutgoingOAuthConnection): void => {\r\n        if (connection && connection.id) {\r\n            dispatch(deleteOutgoingOAuthConnection(connection.id));\r\n        }\r\n    };\r\n\r\n    const outgoingOauthConnectionCompare = (a: OutgoingOAuthConnection, b: OutgoingOAuthConnection): number => {\r\n        let nameA = a.name.toString();\r\n        if (!nameA) {\r\n            nameA = intl.formatMessage({id: 'installed_integrations.unnamed_outgoing_oauth_connection', defaultMessage: 'Unnamed Outgoing OAuth Connection'});\r\n        }\r\n\r\n        let nameB = b.name.toString();\r\n        if (!nameB) {\r\n            nameB = intl.formatMessage({id: 'installed_integrations.unnamed_outgoing_oauth_connection', defaultMessage: 'Unnamed Outgoing OAuth Connection'});\r\n        }\r\n\r\n        return nameA.localeCompare(nameB);\r\n    };\r\n\r\n    const outgoingOauthConnections = (filter?: string) => {\r\n        const values = Object.values(connections);\r\n        const filtered = values.filter((connection) => matchesFilter(connection, filter));\r\n        const sorted = filtered.sort(outgoingOauthConnectionCompare);\r\n        const mapped = sorted.map((connection) => {\r\n            return (\r\n                <InstalledOutgoingOAuthConnection\r\n                    key={connection.id}\r\n                    outgoingOAuthConnection={connection}\r\n                    onDelete={deleteOutgoingOAuthConnectionLocal}\r\n                    team={props.team}\r\n                    creatorName=''\r\n                />\r\n            );\r\n        });\r\n\r\n        return mapped;\r\n    };\r\n\r\n    const integrationsEnabled = enableOutgoingOAuthConnections && canManageOutgoingOAuthConnections;\r\n    let childProps;\r\n    if (integrationsEnabled) {\r\n        childProps = {\r\n            addLink: '/' + props.team.name + '/integrations/outgoing-oauth2-connections/add',\r\n            addText: intl.formatMessage({id: 'installed_outgoing_oauth_connections.add', defaultMessage: 'Add Outgoing OAuth Connection'}),\r\n            addButtonId: 'addOutgoingOauthConnection',\r\n        };\r\n    }\r\n\r\n    return (\r\n        <BackstageList\r\n            header={\r\n                <FormattedMessage\r\n                    id='installed_outgoing_oauth_connections.header'\r\n                    defaultMessage='Outgoing OAuth Connections'\r\n                />\r\n            }\r\n            helpText={\r\n                <FormattedMessage\r\n                    id='installed_outgoing_oauth_connections.help'\r\n                    defaultMessage='Create {outgoingOauthConnections} to securely integrate bots and third-party apps with Mattermost.'\r\n                    values={{\r\n                        outgoingOauthConnections: (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_OAUTH2}\r\n                                location='installed_outgoing_oauth_connections'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_outgoing_oauth_connections.help.outgoingOauthConnections'\r\n                                    defaultMessage='Outgoing OAuth Connections'\r\n                                />\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            }\r\n            emptyText={\r\n                <FormattedMessage\r\n                    id='installed_outgoing_oauth_connections.empty'\r\n                    defaultMessage='No Outgoing OAuth Connections found'\r\n                />\r\n            }\r\n            emptyTextSearch={\r\n                <FormattedMessage\r\n                    id='installed_outgoing_oauth_connections.emptySearch'\r\n                    defaultMessage='No Outgoing OAuth Connections match {searchTerm}'\r\n                />\r\n            }\r\n            searchPlaceholder={intl.formatMessage({id: 'installed_outgoing_oauth_connections.search', defaultMessage: 'Search Outgoing OAuth Connections'})}\r\n            loading={loading}\r\n            {...childProps}\r\n        >\r\n            {(filter: string) => {\r\n                const children = outgoingOauthConnections(filter);\r\n                return [children, children.length > 0];\r\n            }}\r\n        </BackstageList>\r\n    );\r\n};\r\n\r\nexport default InstalledOutgoingOAuthConnections;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {Route, NavLink} from 'react-router-dom';\r\n\r\ntype Props = {\r\n    name: string;\r\n    title: ReactNode;\r\n    icon: string;\r\n    parentLink?: string;\r\n    children?: ReactNode[];\r\n}\r\n\r\nconst BackstageCategory = ({name, title, icon, parentLink, children = []}: Props) => {\r\n    const link = parentLink + '/' + name;\r\n\r\n    return (\r\n        <li className='backstage-sidebar__category'>\r\n            <NavLink\r\n                to={link}\r\n                className='category-title'\r\n                activeClassName='category-title--active'\r\n            >\r\n                <i className={classNames('fa ', icon)}/>\r\n                <span className='category-title__text'>\r\n                    {title}\r\n                </span>\r\n            </NavLink>\r\n            {\r\n                children && children.length > 0 &&\r\n                    <Route\r\n                        path={link}\r\n                        render={() => (\r\n                            <ul className='sections'>\r\n                                {\r\n                                    React.Children.map(children, (child) => {\r\n                                        if (!child) {\r\n                                            return child;\r\n                                        }\r\n\r\n                                        return React.cloneElement(child as JSX.Element, {\r\n                                            parentLink: link,\r\n                                        });\r\n                                    })\r\n                                }\r\n                            </ul>\r\n                        )}\r\n                    />\r\n            }\r\n        </li>\r\n    );\r\n};\r\n\r\nexport default BackstageCategory;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {NavLink} from 'react-router-dom';\r\n\r\ntype Props = {\r\n    name: string;\r\n    title: ReactNode;\r\n    subsection?: boolean;\r\n    parentLink?: string;\r\n    children?: JSX.Element[];\r\n    id?: string;\r\n}\r\n\r\nconst BackstageSection = ({name, title, subsection = false, parentLink = '', children = [], id}: Props) => {\r\n    const link = parentLink + '/' + name;\r\n\r\n    let clonedChildren = null;\r\n    if (children.length > 0) {\r\n        clonedChildren = (\r\n            <ul className='subsections'>\r\n                {\r\n                    React.Children.map(children, (child) => {\r\n                        return React.cloneElement(child, {\r\n                            parentLink: link,\r\n                            subsection: true,\r\n                        });\r\n                    })\r\n                }\r\n            </ul>\r\n        );\r\n    }\r\n\r\n    const className = subsection ? 'subsection' : 'section';\r\n\r\n    return (\r\n        <li\r\n            className={className}\r\n            id={id}\r\n        >\r\n            <NavLink\r\n                className={`${className}-title`}\r\n                activeClassName={`${className}-title--active`}\r\n                to={link}\r\n            >\r\n                <span className={`${className}-title__text`}>\r\n                    {title}\r\n                </span>\r\n            </NavLink>\r\n            {clonedChildren}\r\n        </li>\r\n    );\r\n};\r\n\r\nexport default BackstageSection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\n\r\nimport SystemPermissionGate from 'components/permissions_gates/system_permission_gate';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\n\r\nimport BackstageCategory from './backstage_category';\r\nimport BackstageSection from './backstage_section';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    enableCustomEmoji: boolean;\r\n    enableIncomingWebhooks: boolean;\r\n    enableOutgoingWebhooks: boolean;\r\n    enableCommands: boolean;\r\n    enableOAuthServiceProvider: boolean;\r\n    enableOutgoingOAuthConnections: boolean;\r\n    canCreateOrDeleteCustomEmoji: boolean;\r\n    canManageIntegrations: boolean;\r\n}\r\n\r\nexport default class BackstageSidebar extends React.PureComponent<Props> {\r\n    renderCustomEmoji() {\r\n        if (!this.props.enableCustomEmoji || !this.props.canCreateOrDeleteCustomEmoji) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <BackstageCategory\r\n                name='emoji'\r\n                parentLink={'/' + this.props.team.name}\r\n                icon='fa-smile-o'\r\n                title={\r\n                    <FormattedMessage\r\n                        id='backstage_sidebar.emoji'\r\n                        defaultMessage='Custom Emoji'\r\n                    />\r\n                }\r\n            />\r\n        );\r\n    }\r\n\r\n    renderIntegrations() {\r\n        if (!this.props.canManageIntegrations) {\r\n            return null;\r\n        }\r\n\r\n        let incomingWebhooks;\r\n        if (this.props.enableIncomingWebhooks) {\r\n            incomingWebhooks = (\r\n                <TeamPermissionGate\r\n                    permissions={[Permissions.MANAGE_INCOMING_WEBHOOKS]}\r\n                    teamId={this.props.team.id}\r\n                >\r\n                    <BackstageSection\r\n                        name='incoming_webhooks'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={(\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.incoming_webhooks'\r\n                                defaultMessage='Incoming Webhooks'\r\n                            />\r\n                        )}\r\n                        id='incomingWebhooks'\r\n                    />\r\n                </TeamPermissionGate>\r\n            );\r\n        }\r\n\r\n        let outgoingWebhooks: JSX.Element | null = null;\r\n        if (this.props.enableOutgoingWebhooks) {\r\n            outgoingWebhooks = (\r\n                <TeamPermissionGate\r\n                    permissions={[Permissions.MANAGE_OUTGOING_WEBHOOKS]}\r\n                    teamId={this.props.team.id}\r\n                >\r\n                    <BackstageSection\r\n                        name='outgoing_webhooks'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={(\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.outgoing_webhooks'\r\n                                defaultMessage='Outgoing Webhooks'\r\n                            />\r\n                        )}\r\n                        id='outgoingWebhooks'\r\n                    />\r\n                </TeamPermissionGate>\r\n            );\r\n        }\r\n\r\n        let commands: JSX.Element | null = null;\r\n        if (this.props.enableCommands) {\r\n            commands = (\r\n                <TeamPermissionGate\r\n                    permissions={[Permissions.MANAGE_SLASH_COMMANDS]}\r\n                    teamId={this.props.team.id}\r\n                >\r\n                    <BackstageSection\r\n                        name='commands'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={(\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.commands'\r\n                                defaultMessage='Slash Commands'\r\n                            />\r\n                        )}\r\n                        id='slashCommands'\r\n                    />\r\n                </TeamPermissionGate>\r\n            );\r\n        }\r\n\r\n        let oauthApps: JSX.Element | null = null;\r\n        if (this.props.enableOAuthServiceProvider) {\r\n            oauthApps = (\r\n                <SystemPermissionGate permissions={[Permissions.MANAGE_OAUTH]}>\r\n                    <BackstageSection\r\n                        name='oauth2-apps'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.oauthApps'\r\n                                defaultMessage='OAuth 2.0 Applications'\r\n                            />\r\n                        }\r\n                        id='oauthApps'\r\n                    />\r\n                </SystemPermissionGate>\r\n            );\r\n        }\r\n\r\n        // Note that we allow managing bot accounts even if bot account creation is disabled: only\r\n        // a permissions check is required.\r\n        const botAccounts = (\r\n            <SystemPermissionGate permissions={['manage_bots', 'manage_others_bots']}>\r\n                <BackstageSection\r\n                    name='bots'\r\n                    parentLink={'/' + this.props.team.name + '/integrations'}\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='backstage_sidebar.bots'\r\n                            defaultMessage='Bot Accounts'\r\n                        />\r\n                    }\r\n                    id='botAccounts'\r\n                />\r\n            </SystemPermissionGate>\r\n        );\r\n\r\n        let outgoingOAuthConnections: JSX.Element | null = null;\r\n        if (this.props.enableOutgoingOAuthConnections) {\r\n            outgoingOAuthConnections = (\r\n                <TeamPermissionGate\r\n                    permissions={[Permissions.MANAGE_OUTGOING_OAUTH_CONNECTIONS]}\r\n                    teamId={this.props.team.id}\r\n                >\r\n                    <BackstageSection\r\n                        name='outgoing-oauth2-connections'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.outgoingOauthConnections'\r\n                                defaultMessage='Outgoing OAuth 2.0 Connections'\r\n                            />\r\n                        }\r\n                        id='outgoingOauthConnections'\r\n                    />\r\n                </TeamPermissionGate>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <BackstageCategory\r\n                name='integrations'\r\n                icon='fa-link'\r\n                parentLink={'/' + this.props.team.name}\r\n                title={\r\n                    <FormattedMessage\r\n                        id='backstage_sidebar.integrations'\r\n                        defaultMessage='Integrations'\r\n                    />\r\n                }\r\n            >\r\n                {incomingWebhooks}\r\n                {outgoingWebhooks}\r\n                {commands}\r\n                {oauthApps}\r\n                {botAccounts}\r\n                {outgoingOAuthConnections}\r\n            </BackstageCategory>\r\n        );\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='backstage-sidebar'>\r\n                <ul>\r\n                    {this.renderCustomEmoji()}\r\n                    {this.renderIntegrations()}\r\n                </ul>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useRef} from 'react';\r\nimport type {ComponentType} from 'react';\r\nimport {Route, Switch} from 'react-router-dom';\r\nimport type {match} from 'react-router-dom';\r\nimport {createGlobalStyle} from 'styled-components';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport Emoji from 'components/emoji';\r\nimport AddEmoji from 'components/emoji/add_emoji';\r\nimport Integrations from 'components/integrations';\r\nimport AddIncomingWehook from 'components/integrations/add_incoming_webhook';\r\nimport AddOauthApp from 'components/integrations/add_oauth_app';\r\nimport AddOutgoingWebhook from 'components/integrations/add_outgoing_webhook';\r\nimport Bots from 'components/integrations/bots';\r\nimport AddBot from 'components/integrations/bots/add_bot';\r\nimport CommandsContainer from 'components/integrations/commands_container';\r\nimport ConfirmIntegration from 'components/integrations/confirm_integration';\r\nimport EditIncomingWebhook from 'components/integrations/edit_incoming_webhook';\r\nimport EditOauthApp from 'components/integrations/edit_oauth_app';\r\nimport EditOutgoingWebhook from 'components/integrations/edit_outgoing_webhook';\r\nimport InstalledIncomingWebhooks from 'components/integrations/installed_incoming_webhooks';\r\nimport InstalledOauthApps from 'components/integrations/installed_oauth_apps';\r\nimport InstalledOutgoingWebhooks from 'components/integrations/installed_outgoing_webhooks';\r\nimport AddOutgoingOAuthConnection from 'components/integrations/outgoing_oauth_connections/add_outgoing_oauth_connection';\r\nimport EditOutgoingOAuthConnection from 'components/integrations/outgoing_oauth_connections/edit_outgoing_oauth_connection';\r\nimport InstalledOutgoingOAuthConnections from 'components/integrations/outgoing_oauth_connections/installed_outgoing_oauth_connections';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\n\r\nimport BackstageNavbar from './components/backstage_navbar';\r\nimport BackstageSidebar from './components/backstage_sidebar';\r\n\r\ntype ExtraProps = Pick<Props, 'user' | 'team'> & {scrollToTop: () => void}\r\n\r\ntype BackstageRouteProps = {\r\n    component: ComponentType<any>;\r\n    extraProps: ExtraProps;\r\n    path: string;\r\n    exact?: boolean;\r\n}\r\n\r\nconst BackstageRoute = ({component: Component, extraProps, ...rest}: BackstageRouteProps) => (\r\n    <Route\r\n        {...rest}\r\n        render={(props) => (\r\n            <Component\r\n                {...extraProps}\r\n                {...props}\r\n            />\r\n        )}\r\n    />\r\n);\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * Current user.\r\n     */\r\n    user: UserProfile;\r\n\r\n    /**\r\n     * Current team.\r\n     */\r\n    team?: Team;\r\n\r\n    /**\r\n     * Object from react-router\r\n     */\r\n    match: match<{url: string}>;\r\n\r\n    siteName?: string;\r\n    enableCustomEmoji: boolean;\r\n    enableIncomingWebhooks: boolean;\r\n    enableOutgoingWebhooks: boolean;\r\n    enableCommands: boolean;\r\n    enableOAuthServiceProvider: boolean;\r\n    enableOutgoingOAuthConnections: boolean;\r\n    canCreateOrDeleteCustomEmoji: boolean;\r\n    canManageIntegrations: boolean;\r\n}\r\n\r\nconst BackstageController = (props: Props) => {\r\n    const listRef = useRef<HTMLDivElement>(null);\r\n\r\n    const scrollToTop = () => {\r\n        if (listRef.current) {\r\n            listRef.current.scrollTop = 0;\r\n        }\r\n    };\r\n\r\n    if (!props.team || !props.user) {\r\n        return null;\r\n    }\r\n    const extraProps = {\r\n        team: props.team,\r\n        user: props.user,\r\n        scrollToTop,\r\n    };\r\n    return (\r\n        <>\r\n            <BackstageNavbar\r\n                team={props.team}\r\n                siteName={props.siteName}\r\n            />\r\n            <div\r\n                className='backstage-body'\r\n                ref={listRef}\r\n            >\r\n                <Pluggable pluggableName='Root'/>\r\n                <BackstageSidebar\r\n                    team={props.team}\r\n                    enableCustomEmoji={props.enableCustomEmoji}\r\n                    enableIncomingWebhooks={props.enableIncomingWebhooks}\r\n                    enableOutgoingWebhooks={props.enableOutgoingWebhooks}\r\n                    enableCommands={props.enableCommands}\r\n                    enableOAuthServiceProvider={props.enableOAuthServiceProvider}\r\n                    enableOutgoingOAuthConnections={props.enableOutgoingOAuthConnections}\r\n                    canCreateOrDeleteCustomEmoji={props.canCreateOrDeleteCustomEmoji}\r\n                    canManageIntegrations={props.canManageIntegrations}\r\n                />\r\n                <Switch>\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={'/:team/integrations'}\r\n                        component={Integrations}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/incoming_webhooks`}\r\n                        component={InstalledIncomingWebhooks}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/incoming_webhooks/add`}\r\n                        component={AddIncomingWehook}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/incoming_webhooks/edit`}\r\n                        component={EditIncomingWebhook}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/outgoing_webhooks`}\r\n                        component={InstalledOutgoingWebhooks}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/outgoing_webhooks/add`}\r\n                        component={AddOutgoingWebhook}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/outgoing_webhooks/edit`}\r\n                        component={EditOutgoingWebhook}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/commands`}\r\n                        component={CommandsContainer}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/oauth2-apps`}\r\n                        component={InstalledOauthApps}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/oauth2-apps/add`}\r\n                        component={AddOauthApp}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/oauth2-apps/edit`}\r\n                        component={EditOauthApp}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/outgoing-oauth2-connections`}\r\n                        component={InstalledOutgoingOAuthConnections}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/outgoing-oauth2-connections/add`}\r\n                        component={AddOutgoingOAuthConnection}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/outgoing-oauth2-connections/edit`}\r\n                        component={EditOutgoingOAuthConnection}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/confirm`}\r\n                        component={ConfirmIntegration}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={'/:team/emoji'}\r\n                        component={Emoji}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/add`}\r\n                        component={AddEmoji}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/bots/add`}\r\n                        component={AddBot}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/bots/edit`}\r\n                        component={AddBot}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/bots`}\r\n                        component={Bots}\r\n                    />\r\n                </Switch>\r\n            </div>\r\n            <BackstageGlobalStyle/>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default BackstageController;\r\n\r\nconst BackstageGlobalStyle = createGlobalStyle`\r\n    #root {\r\n        > #global-header,\r\n        > .team-sidebar,\r\n        > .main-wrapper .sidebar--right,\r\n        > .app-bar {\r\n            display: none;\r\n        }\r\n    }\r\n`;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveITeamPermission, haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getMyTeams, getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport BackstageController from './backstage_controller';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const user = getCurrentUser(state);\r\n    const team = getCurrentTeam(state);\r\n\r\n    const config = getConfig(state);\r\n\r\n    const siteName = config.SiteName;\r\n    const enableCustomEmoji = config.EnableCustomEmoji === 'true';\r\n    const enableIncomingWebhooks = config.EnableIncomingWebhooks === 'true';\r\n    const enableOutgoingWebhooks = config.EnableOutgoingWebhooks === 'true';\r\n    const enableCommands = config.EnableCommands === 'true';\r\n    const enableOAuthServiceProvider = config.EnableOAuthServiceProvider === 'true';\r\n    const enableOutgoingOAuthConnections = config.EnableOutgoingOAuthConnections === 'true';\r\n\r\n    let canCreateOrDeleteCustomEmoji = (haveISystemPermission(state, {permission: Permissions.CREATE_EMOJIS}) || haveISystemPermission(state, {permission: Permissions.DELETE_EMOJIS}));\r\n    if (!canCreateOrDeleteCustomEmoji) {\r\n        for (const t of getMyTeams(state)) {\r\n            if (haveITeamPermission(state, t.id, Permissions.CREATE_EMOJIS) || haveITeamPermission(state, t.id, Permissions.DELETE_EMOJIS)) {\r\n                canCreateOrDeleteCustomEmoji = true;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    const canManageTeamIntegrations = (haveITeamPermission(state, team?.id, Permissions.MANAGE_SLASH_COMMANDS) || haveITeamPermission(state, team?.id, Permissions.MANAGE_OAUTH) || haveITeamPermission(state, team?.id, Permissions.MANAGE_INCOMING_WEBHOOKS) || haveITeamPermission(state, team?.id, Permissions.MANAGE_OUTGOING_WEBHOOKS));\r\n    const canManageSystemBots = (haveISystemPermission(state, {permission: Permissions.MANAGE_BOTS}) || haveISystemPermission(state, {permission: Permissions.MANAGE_OTHERS_BOTS}));\r\n    const canManageIntegrations = canManageTeamIntegrations || canManageSystemBots;\r\n\r\n    return {\r\n        user,\r\n        team,\r\n        siteName,\r\n        enableCustomEmoji,\r\n        enableIncomingWebhooks,\r\n        enableOutgoingWebhooks,\r\n        enableCommands,\r\n        enableOAuthServiceProvider,\r\n        enableOutgoingOAuthConnections,\r\n        canCreateOrDeleteCustomEmoji,\r\n        canManageIntegrations,\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps)(BackstageController));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nexport const TYPE_MODAL = 'modal';\r\nexport const TYPE_BACKSTAGE = 'backstage';\r\n\r\n// accepts either a single error or an array of errors\r\ntype Props = {\r\n    type?: React.ReactNode;\r\n    error?: React.ReactNode;\r\n    textClassName?: string;\r\n    iconClassName?: string;\r\n    margin?: boolean;\r\n    errors?: React.ReactNode[];\r\n};\r\n\r\nconst EMPTY_ERROR_LIST: React.ReactNode[] = [];\r\n\r\nconst FormError: React.FC<Props> = ({\r\n    error = null,\r\n    errors = EMPTY_ERROR_LIST,\r\n    iconClassName,\r\n    margin,\r\n    textClassName,\r\n    type,\r\n}) => {\r\n    if (!error && errors.length === 0) {\r\n        return null;\r\n    }\r\n\r\n    // look for the first truthy error to display\r\n    let message = error;\r\n\r\n    if (!message) {\r\n        for (const err of errors) {\r\n            if (err) {\r\n                message = err;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (!message) {\r\n        return null;\r\n    }\r\n\r\n    if (type === TYPE_MODAL) {\r\n        return (\r\n            <div className='form-group'>\r\n                <label className='col-sm-12 has-error'>{message}</label>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (type === TYPE_BACKSTAGE) {\r\n        return (\r\n            <div className='pull-left has-error'>\r\n                <label className='control-label'>{message}</label>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (margin) {\r\n        return (\r\n            <div className='form-group has-error'>\r\n                <label className='control-label'>{message}</label>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={`col-sm-12 ${textClassName || 'has-error'}`}>\r\n            <label className='control-label'>\r\n                <i\r\n                    className={`fa ${iconClassName || 'fa-exclamation-circle'}`}\r\n                />{' '}\r\n                {message}\r\n            </label>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(FormError);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl, type MessageDescriptor} from 'react-intl';\r\n\r\ntype Props = {\r\n    placeholder: MessageDescriptor;\r\n} & Omit<React.InputHTMLAttributes<HTMLInputElement>, 'placeholder'>;\r\n\r\nconst LocalizedPlaceholderInput = React.forwardRef<HTMLInputElement, Props>(({placeholder, ...otherProps}, ref) => {\r\n    const intl = useIntl();\r\n\r\n    return (\r\n        <input\r\n            ref={ref}\r\n            placeholder={intl.formatMessage(placeholder)}\r\n            {...otherProps}\r\n        />\r\n    );\r\n});\r\n\r\nLocalizedPlaceholderInput.displayName = 'LocalizedPlaceholderInput';\r\n\r\nexport default LocalizedPlaceholderInput;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\ntype Props = {\r\n    additionalClassName?: string;\r\n}\r\n\r\nconst NextIcon = ({additionalClassName}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <i\r\n            className={classNames('icon icon-chevron-right', additionalClassName)}\r\n            title={formatMessage({\r\n                id: 'generic_icons.next',\r\n                defaultMessage: 'Next Icon',\r\n            })}\r\n        />\r\n    );\r\n};\r\n\r\nexport default React.memo(NextIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\ntype Props = {\r\n    additionalClassName?: string;\r\n}\r\n\r\nconst PreviousIcon = ({additionalClassName}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <i\r\n            className={classNames('icon icon-chevron-left', additionalClassName)}\r\n            title={formatMessage({id: 'generic_icons.previous', defaultMessage: 'Previous Icon'})}\r\n        />\r\n    );\r\n};\r\n\r\nexport default React.memo(PreviousIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function SearchIcon() {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <i\r\n            className='fa fa-search'\r\n            title={formatMessage({id: 'generic_icons.search', defaultMessage: 'Search Icon'})}\r\n        />\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\ntype Props = {\r\n    additionalClassName?: string;\r\n}\r\n\r\nconst WarningIcon = ({additionalClassName}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <i\r\n            className={classNames('fa fa-warning', additionalClassName)}\r\n            title={formatMessage({id: 'generic_icons.warning', defaultMessage: 'Warning Icon'})}\r\n        />\r\n    );\r\n};\r\n\r\nexport default React.memo(WarningIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {Bot} from '@mattermost/types/bots';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getUsers} from 'mattermost-redux/selectors/entities/common';\r\n\r\nexport const ExternalBotAccountNames: string[] = ['mattermost-advisor'];\r\n\r\nexport function getBotAccounts(state: GlobalState) {\r\n    return state.entities.bots.accounts;\r\n}\r\n\r\nexport const getExternalBotAccounts: (state: GlobalState) => Record<string, Bot> = createSelector(\r\n    'getExternalBotAccounts',\r\n    getBotAccounts,\r\n    getUsers,\r\n    (botAccounts, userProfiles) => {\r\n        const nextState: Record<string, Bot> = {};\r\n        Object.values(botAccounts).forEach((botAccount) => {\r\n            const botUser = userProfiles[botAccount.user_id];\r\n            if (botUser && !ExternalBotAccountNames.includes(botUser.username)) {\r\n                nextState[botAccount.user_id] = botAccount;\r\n            }\r\n        });\r\n\r\n        return nextState;\r\n    },\r\n);\r\n"],"names":["BackIcon","formatMessage","useIntl","React","className","title","id","defaultMessage","BackstageNavbar","_ref","team","siteName","teamExists","delete_at","BlockableLink","to","concat","name","FormattedMessage","values","propTypes","_pt","DeleteIntegrationLink","props","confirmButtonText","linkText","modalMessage","modalTitle","onDelete","openModal","onClick","useCallback","modalId","dialogProps","confirmButtonClass","modalClass","message","subtitleText","WarningIcon","additionalClassName","onConfirm","dialogType","ConfirmModalRedux","isRequired","mapDispatchToProps","connect","DeleteEmojiButton","DELETE_PERMISSION","Permissions","DELETE_EMOJIS","DELETE_OTHER_PERMISSION","DELETE_OTHERS_EMOJIS","EmojiListItem","actions","deleteCustomEmoji","emoji","creatorUsername","currentUserId","creatorDisplayName","emoticonStyle","useMemo","backgroundImage","Client4","getCustomEmojiImageUrl","handleDelete","displayName","deleteButton","creator_id","AnyTeamPermissionGate","permissions","style","emojiId","state","ownProps","entities","emojis","customEmoji","creator","getUser","getDisplayNameByUser","username","getCurrentUserId","currentTeam","getCurrentTeam","dispatch","bindActionCreators","EmojiList","constructor","super","_defineProperty","e","preventDefault","next","this","page","setState","nextLoading","getCustomEmojis","Emoji","SORT_BY_NAME","then","data","length","missingPages","scrollToTop","target","term","value","clearTimeout","searchTimeout","setTimeout","async","trim","searchEmojis","loading","searchCustomEmojis","map","em","index","indexOf","newSearchEmojis","splice","componentDidMount","EMOJI_PER_PAGE","_ref2","render","nextButton","previousButton","push","key","colSpan","LoadingScreen","emojiIds","forEach","deleteFromSearch","pageStart","pageEnd","slice","buttonContents","NextIcon","SaveButton","btnClass","extraClasses","nextPage","saving","disabled","savingMessage","previousPage","PreviousIcon","SearchIcon","LocalizedPlaceholderInput","type","placeholder","defineMessage","onChange","onSearchChange","search","flexGrow","flexShrink","getCustomEmojiIdsSortedByName","CREATE_EMOJIS_PERMISSIONS","CREATE_EMOJIS","ROLES","EmojiPage","teamDisplayName","teamName","currentTheme","intl","useEffect","updateTitle","loadRolesIfNeeded","Utils","document","Link","display_name","general","config","SiteName","getTheme","children","childrenElements","child","AddEmoji","handleSubmit","emojiMap","user","image","error","toLowerCase","startsWith","endsWith","substring","test","hasSystemEmoji","has","size","response","createCustomEmoji","getHistory","responseError","genericError","files","imageUrl","reader","FileReader","onload","result","readAsDataURL","filename","preview","htmlFor","BackstageHeader","onSubmit","handleFormSubmit","maxLength","updateName","accept","Constants","ACCEPT_EMOJI_IMAGE","multiple","updateImage","FormError","SpinnerButton","spinning","spinningText","handleSaveButtonClick","getEmojiMap","IntegrationOption","description","link","alt","src","Integrations","arguments","currentSiteName","options","enableIncomingWebhooks","TeamPermissionGate","teamId","MANAGE_INCOMING_WEBHOOKS","IncomingWebhookIcon","enableOutgoingWebhooks","MANAGE_OUTGOING_WEBHOOKS","OutgoingWebhookIcon","enableCommands","MANAGE_SLASH_COMMANDS","SlashCommandIcon","enableOAuthServiceProvider","SystemPermissionGate","MANAGE_OAUTH","OAuthIcon","enableOutgoingOAuthConnections","MANAGE_OUTGOING_OAUTH_CONNECTIONS","OutgoingOAuthConnectionsIcon","BotAccountsIcon","appDirectory","ExternalLink","href","location","getConfig","EnableIncomingWebhooks","EnableOutgoingWebhooks","EnableCommands","EnableOAuthServiceProvider","EnableOutgoingOAuthConnections","ChannelSelect","channels","selectOpen","selectPrivate","selectDm","channel","channelName","OPEN_CHANNEL","PRIVATE_CHANNEL","DM_CHANNEL","memo","getMyChannelsSorted","createSelector","getMyChannels","getCurrentUserLocale","locale","filter","sort","sortChannelsByTypeAndDisplayName","bind","AbstractIncomingWebhook","PureComponent","hook","channelId","channel_id","channelLocked","channel_locked","iconURL","icon_url","serverError","clientError","_this$props$initialHo","_this$props$initialHo2","_this$props$initialHo3","_this$props$initialHo4","_this$props$initialHo5","_this$props$initialHo6","initialHook","create_at","update_at","team_id","user_id","action","checked","getStateFromHook","headerToRender","header","footerToRender","footer","updateDisplayName","updateDescription","updateChannelId","updateChannelLocked","enablePostUsernameOverride","updateUsername","enablePostIconOverride","updateIconURL","errors","messages","defineMessages","AddIncomingWebhook","setServerError","useState","addIncomingHook","createIncomingHook","EnablePostUsernameOverride","EnablePostIconOverride","r","t","i","Symbol","toPrimitive","call","TypeError","String","_toPrimitive","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","AbstractOAuthApp","app","homepage","callbackUrls","callback_urls","join","is_trusted","has_icon","Boolean","_this$icon_url$curren","current","callbackUrl","split","Image","imageLoaded","getStateFromApp","initialApp","renderExtra","icon","trusted","MANAGE_SYSTEM","updateTrusted","updateHomepage","ref","updateIconUrl","rows","updateCallbackUrls","AddOAuthApp","history","useHistory","addOAuthApp","AbstractOutgoingWebhook","triggerWords","trigger_words","contentType","content_type","triggerWhen","trigger_when","triggerWord","token","parseInt","contentTypeOption1","contentTypeOption2","updateContentType","updateTriggerWords","updateTriggerWhen","localizeMessage","DocLinks","TRUSTED_CONNECTION","AddOutgoingWebhook","createOutgoingHook","createBot","bot","bindClientFunc","clientFunc","onSuccess","BotTypes","RECEIVED_BOT_ACCOUNT","params","patchBot","botUserId","botPatch","loadBots","undefined","perPage","getBotsIncludeDeleted","RECEIVED_BOT_ACCOUNTS","disableBot","enableBot","remainingProps","setFilter","filterLowered","searchPlaceholder","childCount","hasChildren","emptyTextSearch","_objectSpread","searchTerm","emptyText","addLink","addText","addButtonId","hasFilter","startCount","endCount","total","isFirstPage","isLastPage","getPaging","pageSize","childrenToDisplay","previousPageFn","nextPageFn","helpText","matchesFilter","owner","ownerUsername","Bot","enableUserAccessToken","disableUserAccessToken","confirmingId","revokeUserAccessToken","closeConfirm","creatingTokenState","assign","createUserAccessToken","fromApp","tokenList","accessTokens","activeLink","disabledText","disableClass","is_active","confirmRevokeToken","openCreateToken","handleCreateToken","autoFocus","handleUpdateDescription","closeCreateToken","imageURL","last_picture_update","Markdown","ConfirmModal","show","revokeTokenConfirmed","onCancel","Bots","owners","users","appsBotIDs","includes","bots","a","b","localeCompare","match","enabledBots","botToJSX","disabledBots","EnabledSection","DisabledSection","hasDisabled","START_PAGE_NUM","PAGE_SIZE","promises","owner_id","getUserAccessTokensForUser","Promise","all","appsEnabled","fetchAppsBotIDs","botsToDisplay","BackstageList","createBots","chunks","botAccounts","EnableBotAccountCreation","getExternalBotAccounts","botValues","reduce","UserSelectors","admin","userAccessTokensByUser","getAppsBotIDs","roleOptionSystemAdmin","roleOptionMember","AddBot","role","postAll","postChannels","pictureFile","previewBlob","URL","createObjectURL","e2","_e2$target","orientation","FileUtils","orientationStyles","readAsArrayBuffer","BotDefaultIcon","roles","General","SYSTEM_USER_ROLE","SYSTEM_ADMIN_ROLE","SYSTEM_POST_ALL_ROLE","SYSTEM_POST_ALL_PUBLIC_ROLE","rolesResult","updateUserRoles","adding","isFile","AcceptedProfileImageTypes","maxFileSize","uploadProfileImage","setDefaultProfileImage","updateRoles","usernameError","errObj","ValidationErrors","INVALID_LAST_CHARACTER","tokenResult","UserUtils","transform","transformOrigin","file","subtitle","buttonText","buttonActiveText","imageStyles","removeImageIcon","WithTooltip","setDefault","ACCEPT_STATIC_IMAGE","updatePicture","editingUserHasManageSystem","updateRole","msg","DeveloperLinks","PERSONAL_ACCESS_TOKENS","updatePostAll","updatePostChannels","botId","URLSearchParams","get","getBotAccounts","MaxFileSize","haveISystemPermission","permission","OAuthConnectionAudienceInput","mounted","useRef","matchedConnection","setMatchingOAuthConnection","loadingAudienceMatch","setLoadingAudienceMatch","oauthConnections","useSelector","getOutgoingOAuthConnections","oauthConnectionsEnabled","getCurrentTeamId","useDispatch","matchConnectionsOnInput","res","fetchOutgoingOAuthConnectionsForAudience","inputValue","debouncedMatchConnections","debounce","fetchOutgoingOAuthConnections","connections","input","autoComplete","oauthMessage","LoadingSpinner","OauthIcon","connectionName","InformationOutlineIcon","AbstractCommand","command","_command$display_name","_command$description","_command$trigger","_command$url","_command$method","_command$username","_command$icon_url","_command$auto_complet","_command$auto_complet2","_command$auto_complet3","trigger","url","method","iconUrl","autocomplete","auto_complete","autocompleteHint","auto_complete_hint","autocompleteDescription","auto_complete_desc","substr","_this$state$autocompl","_this$state$autocompl2","MIN_TRIGGER_LENGTH","MAX_TRIGGER_LENGTH","min","max","methodValue","getStateFromCommand","initialCommand","updateAutocompleteHint","updateAutocompleteDescription","getBackstageHeader","updateTrigger","CUSTOM_SLASH_COMMANDS","updateUrl","text","updateMethod","updateAutocomplete","getBackstageFooter","AddCommand","headerMessage","footerMessage","loadingMessage","addCommand","CopyText","label","copyText","copyToClipboard","queryCommandSupported","ConfirmIntegration","commands","oauthApps","incomingHooks","outgoingHooks","outgoingOAuthConnections","window","addEventListener","handleKeyPress","removeEventListener","headerText","tokenText","incomingHook","outgoingHook","oauthApp","outgoingOAuthConnection","COMMAND","commandToken","SETUP_CUSTOM_SLASH_COMMANDS","copyToken","INCOMING_WEBHOOK","incomingHookToken","getSiteURL","SETUP_INCOMING_WEBHOOKS","OUTGOING_WEBHOOK","outgoingHookToken","SETUP_OUTGOING_WEBHOOKS","OAUTH_APP","oauthAppToken","oauthAppSecret","client_secret","SETUP_OAUTH2","copyClientId","secret","copyClientSecret","OUTGOING_OAUTH_CONNECTIONS","clientId","client_id","clientSecret","credentials_username","password","credentials_password","grant_type","copyUsername","oauth_token_url","audiences","BOT","replace","ErrorPageTypes","PAGE_NOT_FOUND","botToken","botname","getCommands","getOAuthApps","getIncomingHooks","getOutgoingHooks","EditCommand","_this$state$originalC","_this$state$originalC2","_this$state$originalC3","_this$state$originalC4","newCommand","originalCommand","handleConfirmModal","submitCommand","showConfirmModal","editCommand","confirmButton","confirmTitle","confirmMessage","confirmModalDismissed","getCustomTeamCommands","commandId","InstalledCommand","onRegenToken","canChange","handleRegenToken","createAt","InstalledCommands","regenCommandToken","deleteCommand","commandCompare","nameA","nameB","canManageOthersSlashCommands","buildYourOwn","haveITeamPermission","MANAGE_OTHERS_SLASH_COMMANDS","CommandRoute","component","Component","extraProps","rest","_objectWithoutProperties","_excluded","Route","path","CommandsContainer","_this$props$team","loadCommandsAndProfilesForTeam","Switch","exact","Redirect","getUsers","EditIncomingWebhook","_this$props$hook","newHook","submitHook","updateIncomingHook","getIncomingHook","hookId","editIncomingHook","integrations","HEADER","FOOTER","LOADING","EditOAuthApp","newApp","every","v","submitOAuthApp","editOAuthApp","err","getOAuthApp","oauthAppId","EditOutgoingWebhook","triggerWordsSame","callbackUrlsSame","updateOutgoingHook","getOutgoingHook","editOutgoingHook","incomingWebhook","InstalledIncomingWebhook","incomingWebhookId","InstalledIncomingWebhooks","removeIncomingHook","loadIncomingHooksAndProfilesForTeam","pageToLoad","loadPage","displayNameA","channelA","displayNameB","incomingWebhookCompare","canManageOthersWebhooks","deleteIncomingWebhook","incomingHooksTotalCount","incomingWebhooks","getFilteredIncomingHooks","getIncomingHooksTotalCount","MANAGE_OTHERS_INCOMING_WEBHOOKS","getAllChannels","FAKE_SECRET","InstalledOAuthApp","onRegenerateSecret","handleShowClientSecret","creatorName","urls","isTrusted","showHide","handleHideClientSecret","regen","handleRegenerate","appInfo","InstalledOAuthApps","deleteOAuthApp","oauthAppCompare","regenOAuthAppSecret","appsOAuthAppIDs","loadOAuthAppsAndProfiles","toString","canManageOauth","oauthApplications","getAppsOAuthAppIDs","outgoingWebhook","InstalledOutgoingWebhook","makeDisplayName","InstalledOutgoingWebhooks","regenOutgoingHookToken","removeOutgoingHook","channelB","outgoingWebhooks","outgoingWebhookCompare","regenOutgoingWebhookToken","loadOutgoingHooksAndProfilesForTeam","MANAGE_OTHERS_OUTGOING_WEBHOOKS","keys","Actions","ownKeys","getOwnPropertySymbols","o","getOwnPropertyDescriptor","apply","getOwnPropertyDescriptors","defineProperties","ValidationStatus","initialState","AbstractOutgoingOAuthConnection","formState","setFormState","connection","audienceUrls","oauthTokenUrl","grantType","newState","oldState","useOutgoingOAuthForm","initialConnection","storedError","setError","validationError","setValidationError","isSubmitting","setIsSubmitting","validationStatus","setValidationStatus","INITIAL","isEditingSecret","setIsEditingSecret","isValidationModalOpen","setIsValidationModalOpen","isNewConnection","parseForm","requireAudienceUrl","audienceUrl","hideSkipValidateModal","VALIDATED","submitAction","setUnvalidated","DIRTY","clientSecretSection","repeat","startEditingClientSecret","ValidateButton","_props$initialConnect","VALIDATING","validateOutgoingOAuthConnection","ERROR","status","onExited","AlertOutlineIcon","CheckCircleOutlineIcon","addOutgoingOAuthConnection","connectionId","existingConnection","newConnection","setNewConnection","setShowConfirmModal","getOutgoingOAuthConnection","createOutgoingOAuthConnection","editOutgoingOAuthConnection","InstalledOutgoingOAuthConnection","connectionInfo","setLoading","canManageOutgoingOAuthConnections","loadOutgoingOAuthConnectionsAndProfiles","deleteOutgoingOAuthConnectionLocal","deleteOutgoingOAuthConnection","outgoingOauthConnectionCompare","childProps","outgoingOauthConnections","parentLink","NavLink","activeClassName","classNames","subsection","clonedChildren","BackstageSidebar","renderCustomEmoji","enableCustomEmoji","canCreateOrDeleteCustomEmoji","BackstageCategory","renderIntegrations","canManageIntegrations","BackstageSection","BackstageRoute","BackstageGlobalStyle","createGlobalStyle","withRouter","getCurrentUser","EnableCustomEmoji","getMyTeams","canManageTeamIntegrations","canManageSystemBots","MANAGE_BOTS","MANAGE_OTHERS_BOTS","listRef","scrollTop","Pluggable","pluggableName","AddIncomingWehook","InstalledOauthApps","AddOauthApp","EditOauthApp","InstalledOutgoingOAuthConnections","AddOutgoingOAuthConnection","EditOutgoingOAuthConnection","TYPE_BACKSTAGE","EMPTY_ERROR_LIST","iconClassName","margin","textClassName","otherProps","ExternalBotAccountNames","accounts","userProfiles","nextState","botAccount","botUser"],"sourceRoot":""}