{"version":3,"file":"9949.426cc3f8bd4dc6f48c91.js","mappings":"wPAUO,IAAKA,EAAW,SAAXA,GAAW,OAAXA,EAAW,YAAXA,EAAW,gBAAXA,EAAW,yBAAXA,EAAW,qBAAXA,EAAW,oBAAXA,EAAW,QAAXA,CAAW,MAUXC,EAAa,SAAbA,GAAa,OAAbA,EAAa,QAAbA,EAAa,gBAAbA,EAAa,0BAAbA,EAAa,sBAAbA,EAAa,oBAAbA,EAAa,QAAbA,CAAa,MAUlB,MAAMC,EAA0C,CACnD,CAACF,EAAYG,QAASF,EAAcG,GACpC,CAACJ,EAAYK,YAAaJ,EAAcK,OACxC,CAACN,EAAYO,aAAcN,EAAcM,YACzC,CAACP,EAAYQ,WAAYP,EAAcO,UACvC,CAACR,EAAYS,UAAWR,EAAcQ,SACtC,CAACT,EAAYU,IAAKT,EAAcS,IAMvBC,EAA4E,CACrF,CAACV,EAAcG,IAAK,CAACQ,KAAM,aAAcC,MAAOb,EAAYG,QAC5D,CAACF,EAAcK,QAAS,CAACM,KAAM,aAAcC,MAAOb,EAAYK,YAChE,CAACJ,EAAcM,aAAc,CAACK,KAAM,SAAUC,MAAOb,EAAYO,aACjE,CAACN,EAAcO,WAAY,CAACI,KAAM,SAAUC,MAAOb,EAAYQ,WAC/D,CAACP,EAAcQ,UAAW,CAACG,KAAM,SAAUC,MAAOb,EAAYS,UAC9D,CAACR,EAAcS,IAAK,CAACE,KAAM,OAAQC,MAAOb,EAAYU,KAkBnD,SAASI,EAAUC,GAAoD,IAAnD,QAACC,EAAO,SAAEC,GAA0BF,EAC3D,OACIG,IAAAA,cAAA,UACIC,UAAU,0BACVH,QAASA,EACTC,SAAUA,GAEVC,IAAAA,cAAA,KAAGC,UAAU,2BACbD,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,qDACHC,eAAe,qBAI/B,CAEO,SAASC,EAAkBC,GAA4D,IAA3D,QAACR,EAAO,SAAEC,GAAkCO,EAC3E,OACIN,IAAAA,cAAA,UACIC,UAAU,0BACVH,QAASA,EACTC,SAAUA,GAEVC,IAAAA,cAAA,KAAGC,UAAU,mBACbD,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,kDACHC,eAAe,kBAI/B,CAEO,SAASG,EAAQC,GAA0D,IAAzD,QAACC,EAAO,iBAAEC,GAAgCF,EAC/D,OACIR,IAAAA,cAAA,OAAKC,UAAU,qBACXD,IAAAA,cAACW,EAAAA,EAAQ,CACLF,QAASA,EACTG,QAAS,CAACC,kBAAkB,KAE/BH,GACGV,IAAAA,cAAA,KACIc,KAAK,IACLb,UAAU,qBACVH,QAASY,GAETV,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,8CACHC,eAAe,iEAMvC,CAvCCR,EAAAmB,UAAA,CA5BGjB,QAAOkB,IAAAA,KAAAC,WACPlB,SAAQiB,IAAAA,KAAAC,YA2CXZ,EAAAU,UAAA,CAvCGjB,QAAOkB,IAAAA,KAAAC,WACPlB,SAAQiB,IAAAA,KAAAC,YA6DXV,EAAAQ,UAAA,CAzDGN,QAAOO,IAAAA,OAAAC,WACPP,iBAAgBM,IAAAA,K,wOCnCdE,EAAiBC,IACnB,MAAM,UAACC,GAA2BD,EAAbE,E,6WAASC,CAAIH,EAAKI,GACvC,GAAIH,EAAW,KAAAI,EACX,MAAMC,EAA2B,QAAlBD,EAAGJ,EAAUM,aAAK,IAAAF,OAAA,EAAfA,EAAiBG,WACnC,GAAkB,UAAdF,EACA,OAAOzB,IAAAA,cAAC4B,EAAAA,iBAAqBP,GAEjC,GAAkB,QAAdI,EACA,OAAOzB,IAAAA,cAAC6B,EAAAA,gBAAoBR,GAEhC,GAAkB,UAAdI,EACA,OAAOzB,IAAAA,cAAC8B,EAAAA,UAAcT,GAI1B,OAAQD,EAAU1B,MAClB,IAAK,SACD,OAAOM,IAAAA,cAAC+B,EAAAA,6BAAiCV,GAC7C,IAAK,cACD,OAAOrB,IAAAA,cAACgC,EAAAA,uBAA2BX,GAEvC,QACI,OAAOrB,IAAAA,cAACiC,EAAAA,gBAAoBZ,GAEpC,CACA,OAAOrB,IAAAA,cAACiC,EAAAA,gBAAoBZ,EAAY,EAetCa,EAAwBrC,IAAwK,IAAvK,iBAACsC,EAAgB,oBAAEC,EAAmB,SAAErC,EAAQ,SAAEsC,EAAQ,OAAEC,EAAM,SAAEC,EAAQ,SAAEC,GAAW,EAAK,aAAEC,EAAY,4BAAEC,GAAoD7C,EAC7L,MAAM,cAAC8C,IAAiBC,EAAAA,EAAAA,YACjBC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,IAC/BC,GAAeC,EAAAA,EAAAA,SAAO,GAEtBC,GAAiBC,EAAAA,EAAAA,cAAaC,IAChCN,EAAUM,EAAEC,OAAOC,MAAM,GAC1B,IAEG1C,GAAU2C,EAAAA,EAAAA,UAAQ,IACbnB,EAAoBS,QAAQW,GACxBA,EAAKC,KAAKC,cAAcC,SAASd,EAAOa,kBAEpD,CAACtB,EAAqBS,IAEnBe,EAAwB5D,IAAAA,aAAmBoB,IAC7CiB,EAASjB,GACT0B,EAAU,GAAG,GACd,CAACT,IAEEwB,GAA0BN,EAAAA,EAAAA,UAAQ,IAC7BnB,EAAoB0B,MAAMN,GAASA,EAAKC,OAAStB,KACzD,CAACA,EAAkBC,IAatB,OAXA2B,EAAAA,EAAAA,YAAU,KACN,GAAIvB,IAAaQ,EAAagB,QAAS,CACnC,MAAMC,EAAgBC,SAASC,eAAe5B,GAC9C0B,SAAAA,EAAeG,QACX3B,GACAA,GAER,CACAO,EAAagB,QAAUxB,CAAQ,GAChC,CAACA,EAAUD,EAAUE,IAGpBzC,IAAAA,cAACqE,EAAAA,GAAc,CACXC,WAAY,CACRnE,GAAIoC,EACJgC,MAAOC,IAAW,iDAAkD,CAChEzE,aAEJ0E,SACIzE,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAACkB,EAAa,CAACE,UAAWyC,IACzB1B,GAAoBQ,EAAc,CAACxC,GAAI,8DAA+DC,eAAgB,sBAG/HsE,WAAY,8BACZ3E,YAEJ4E,KAAM,CACFxE,GAAImC,EACJ,aAAc,mBACdrC,UAAW,8BAGfD,IAAAA,cAACqE,EAAAA,GAAc,CACXO,IAAI,oBACJzE,GAAG,oBACHT,KAAK,OACLmF,YAAalC,EAAc,CAACxC,GAAI,+DAAgEC,eAAgB,yBAChHH,UAAU,4BACVqD,MAAOT,EACPR,SAAUa,IAEbtC,EAAQkE,KAAKC,IAAW,IAAAC,EAAAC,EAAAC,EACrB,MAAM,KAACzB,GAAQsB,EACTI,EAAY1B,EAAKE,SAAS,KAC1ByB,GAAuB,QAAZJ,EAAAD,EAAOrD,aAAK,IAAAsD,OAAA,EAAZA,EAAcK,QAAoB,QAAhBJ,EAAIF,EAAOrD,aAAK,IAAAuD,OAAA,EAAZA,EAAcK,MAC/CC,EAA2C,WAAd,QAAZL,EAAAH,EAAOrD,aAAK,IAAAwD,OAAA,EAAZA,EAAcM,SAC/BC,EAAUL,GAAYG,GAAkB7C,EAExCgD,EACF1F,IAAAA,cAACqE,EAAAA,GAAS,CACNlE,GAAE,aAAAwF,OAAelC,GACjBmB,IAAKnB,EACLmC,KAAK,gBACLC,oBAAoB,EACpB,eAAcpC,IAAStB,EACvBrC,QAASqF,OAAYW,EAAY,IAAMlC,EAAsBH,GAC7DsC,OAAQ/F,IAAAA,cAAA,YAAOyD,GACf1D,SAAUoF,IAAcM,EACxBO,eACIhG,IAAAA,cAACkB,EAAa,CACVE,UAAW2D,EACXkB,KAAM,KAGdC,iBACIlG,IAAAA,cAAAA,IAAAA,SAAA,KACKmF,GACGnF,IAAAA,cAACmG,EAAAA,uBAAsB,CACnBF,KAAM,MAGZR,IAAYL,GACVpF,IAAAA,cAACoG,EAAAA,uBAAsB,CACnBH,KAAM,GACNI,MAAM,+CAGbjB,GACGpF,IAAAA,cAACsG,EAAAA,SAAQ,CACLL,KAAM,GACNI,MAAM,+CAGb5C,IAAStB,GACNnC,IAAAA,cAACuG,EAAAA,UAAS,SAQ9B,IAAIC,EAAiB,KAmBrB,OAlBIrB,EACAqB,EAAiB7D,EAAc,CAC3BxC,GAAI,mEACJC,eAAgB,gEAEZqF,EAKDL,IACPoB,EAAiB7D,EAAc,CAC3BxC,GAAI,qDACJC,eAAgB,sDAPpBoG,EAAiB7D,EAAc,CAC3BxC,GAAI,oDACJC,eAAgB,2JAUpBoG,EAEIxG,IAAAA,cAACyG,EAAAA,EAAW,CACR7B,IAAKnB,EACLiD,MAAOF,GAEPxG,IAAAA,cAAA,OAAKC,UAAU,6BACVyF,IAMVA,CAAQ,IAEN,EAEvBxD,EAAAnB,UAAA,CApKEoB,iBAAgBnB,IAAAA,OAAAC,WAChBmB,oBAAmBpB,IAAAA,MAAAC,WACnBlB,SAAQiB,IAAAA,KAAAC,WACRoB,SAAQrB,IAAAA,KAAAC,WACRqB,OAAMtB,IAAAA,OAAAC,WACNsB,SAAQvB,IAAAA,OAAAC,WACRuB,SAAQxB,IAAAA,KACRyB,aAAYzB,IAAAA,KACZ0B,4BAA2B1B,IAAAA,KAAAC,YA8J/B,U,eCvMA,MAAM0F,EAAuB9G,IAAkE,IAAjE,gBAAC+G,EAAe,SAAE7G,EAAQ,SAAEsC,GAAgCxC,EACtF,MAAM,cAAC8C,IAAiBC,EAAAA,EAAAA,YACjBC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,IAE/B8D,EAAuB7G,IAAAA,aAAmB8G,IAC5CzE,EAASyE,EAAW3G,IACpB2C,EAAU,GAAG,GACd,CAACT,IAEE0E,GAA4BxD,EAAAA,EAAAA,UAAQ,IAC/ByD,EAAsBJ,IAC9B,CAACA,IAEEK,EAAsBF,EAA0BG,KAEhDhE,EAAiBlD,IAAAA,aAAmBoD,IACtCN,EAAUM,EAAEC,OAAOC,MAAM,GAC1B,IAEG6D,GAAoB5D,EAAAA,EAAAA,UAAQ,IACvB6D,OAAOC,OAAOC,GAAsBzE,QAAQ0E,GACjC5E,EAAc4E,EAAKC,OACpB9D,cAAcC,SAASd,EAAOa,kBAEhD,CAACb,EAAQF,IAEZ,OACI3C,IAAAA,cAACqE,EAAAA,GAAc,CACXC,WAAY,CACRnE,GAAI,2BACJoE,MAAOC,IAAW,iDAAkD,CAChEzE,aAEJ0E,SACIzE,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAACiH,EAAmB,CAChBhB,KAAM,GACNI,MAAM,gDAEVrG,IAAAA,cAACE,EAAAA,iBAAqB6G,EAA0BS,QAGxD9C,WAAY,6BACZ3E,YAEJ4E,KAAM,CACFxE,GAAI,yBACJ,aAAc,kBACdF,UAAW,6BAGfD,IAAAA,cAACqE,EAAAA,GAAc,CACXO,IAAI,mBACJzE,GAAG,mBACHT,KAAK,OACLmF,YAAalC,EAAc,CAACxC,GAAI,8DAA+DC,eAAgB,wBAC/GH,UAAU,4BACVqD,MAAOT,EACPR,SAAUa,IAEbiE,EAAkBrC,KAAKgC,IACpB,MAAM,GAAC3G,EAAI+G,KAAMO,EAAI,MAAED,GAASV,EAEhC,OACI9G,IAAAA,cAACqE,EAAAA,GAAS,CACNlE,GAAIA,EACJyE,IAAKzE,EACLyF,KAAK,gBACLC,oBAAoB,EACpB,eAAc1F,IAAO4G,EAA0B5G,GAC/CL,QAASA,IAAM+G,EAAqBC,GACpCf,OAAQ/F,IAAAA,cAACE,EAAAA,iBAAqBsH,GAC9BxB,eAAgBhG,IAAAA,cAACyH,EAAI,CAACxB,KAAM,KAC5BC,iBAAkB/F,IAAO4G,EAA0B5G,IAC/CH,IAAAA,cAACuG,EAAAA,UAAS,OAEhB,IAGG,EAEvBI,EAAA5F,UAAA,CAtFE6F,gBAAe5F,IAAAA,OAAAC,WACflB,SAAQiB,IAAAA,KAAAC,WACRoB,SAAQrB,IAAAA,KAAAC,YAsFZ,UAEM+F,EAAyBU,IAC3B,IAAK,MAAMZ,KAAcM,OAAOC,OAAOC,GACnC,GAAIR,EAAW3G,KAAOuH,EAClB,OAAOZ,EAIf,OAAOQ,EAAqBK,EAAE,EAS5BL,EAA4D,CAC9D,CAACvI,EAAAA,GAAcG,IAAK,CAChBiB,GAAIpB,EAAAA,GAAcG,GAClBgI,KAAMU,EAAAA,UACNJ,OAAOK,EAAAA,EAAAA,eAAc,CACjB1H,GAAI,gDACJC,eAAgB,QAGxB,CAACrB,EAAAA,GAAcK,QAAS,CACpBe,GAAIpB,EAAAA,GAAcK,OAClB8H,KAAMY,EAAAA,oBACNN,OAAOK,EAAAA,EAAAA,eAAc,CACjB1H,GAAI,oDACJC,eAAgB,YAGxB,CAACrB,EAAAA,GAAcS,IAAK,CAChBW,GAAIpB,EAAAA,GAAcS,GAClB0H,KAAMa,EAAAA,cACNP,OAAOK,EAAAA,EAAAA,eAAc,CACjB1H,GAAI,gDACJC,eAAgB,QAGxB,CAACrB,EAAAA,GAAcM,aAAc,CACzBc,GAAIpB,EAAAA,GAAcM,YAClB6H,KAAMc,EAAAA,aACNR,OAAOK,EAAAA,EAAAA,eAAc,CACjB1H,GAAI,yDACJC,eAAgB,iBAGxB,CAACrB,EAAAA,GAAcO,WAAY,CACvBa,GAAIpB,EAAAA,GAAcO,UAClB4H,KAAMc,EAAAA,aACNR,OAAOK,EAAAA,EAAAA,eAAc,CACjB1H,GAAI,uDACJC,eAAgB,eAGxB,CAACrB,EAAAA,GAAcQ,UAAW,CACtBY,GAAIpB,EAAAA,GAAcQ,SAClB2H,KAAMc,EAAAA,aACNR,OAAOK,EAAAA,EAAAA,eAAc,CACjB1H,GAAI,sDACJC,eAAgB,eC2C5B,EAvM2BP,IAcrB,IAdsB,OACxBwH,EAAM,SACNtH,EAAQ,aACRkI,EAAY,QACZrH,EAAU,GAAE,iBACZsH,GAAmB,EAAK,YACxBrD,GAQHhF,EACG,MAAM,cAAC8C,IAAiBC,EAAAA,EAAAA,YACjBC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,IAG/BoF,IADavH,EAAQwH,OAAS,IACUF,EAGxChF,GAAiBC,EAAAA,EAAAA,cAAaC,IAChCN,EAAUM,EAAEC,OAAOC,MAAM,GAC1B,IAEG+E,GAAkB9E,EAAAA,EAAAA,UAAQ,IACrB3C,EAAQiC,QAAQkC,IACNA,EAAOtB,MAAQ,IAChBC,cAAcC,SAASd,EAAOa,kBAE/C,CAAC9C,EAASiC,IAEPyF,EAA0B3F,EAAc,CAC1CxC,GAAI,yDACJC,eAAgB,qBAGdmI,EAA2B5F,EAAc,CAC3CxC,GAAI,8DACJC,eAAgB,yBAGdoI,GAAmBrF,EAAAA,EAAAA,cAAaM,IAClC,MAAMgF,EAAYpB,EAAO1D,SAASF,GAC9B4D,EAAOxE,QAAQ6F,GAAMA,IAAMjF,IAC3B,IAAI4D,EAAQ5D,GAChBwE,EAAaQ,EAAU,GACxB,CAACpB,EAAQY,IAENU,GAAoBxF,EAAAA,EAAAA,cAAayF,IACnC,MAAMC,EAAeD,EAAcE,OAC9BD,IAAgBxB,EAAO1D,SAASkF,KAGrCZ,EAAa,IAAIZ,EAAQwB,IACzB/F,EAAU,IAAG,GACd,CAACuE,EAAQY,IAENc,GAA4B5F,EAAAA,EAAAA,cAAaC,IAC7B,QAAVA,EAAEwB,KACFxB,EAAE4F,kBAGQ,UAAV5F,EAAEwB,KAAmBuD,GAA4BtF,EAAOiG,SACxD1F,EAAE6F,iBACFN,EAAkB9F,GACtB,GACD,CAACsF,EAA0BtF,EAAQ8F,IAEhCO,GAAoB/F,EAAAA,EAAAA,cAAY,CAACgG,EAA+EC,KAClHD,EAAMH,kBACN,MAAMP,EAAYpB,EAAOxE,QAAQ6F,GAAMA,IAAMU,IAC7CnB,EAAaQ,EAAU,GACxB,CAACpB,EAAQY,IAGNoB,GAAe9F,EAAAA,EAAAA,UAAQ,KACzB,GAAsB,IAAlB8D,EAAOe,OAAc,CACrB,IAAIkB,EAAwBhB,EACxBH,GAA+C,IAAnBvH,EAAQwH,SACpCkB,EAAwBf,GAE5B,MAAMgB,EAAsB1E,GAAeyE,EACrCE,EAAWD,IAAwBjB,GAA2BiB,IAAwBhB,EAE5F,OACIvI,IAAAA,cAAA,QAAMC,UAAWuE,IAAW,CAAC,0CAA2CgF,KACnED,EAGb,CAEA,OACIvJ,IAAAA,cAAA,OAAKC,UAAU,sDACVoH,EAAOvC,KAAKxB,GACTtD,IAAAA,cAAA,OACI4E,IAAKtB,EACLrD,UAAU,uBAEVD,IAAAA,cAAA,OAAKC,UAAU,8BAA8BqD,IAC3CvD,GACEC,IAAAA,cAAA,OACIC,UAAU,8BACVH,QAAUsD,GAAM8F,EAAkB9F,EAAGE,GACrCsC,KAAK,SACL6D,SAAU,EACVC,UAAYtG,IACM,UAAVA,EAAEwB,KAA6B,MAAVxB,EAAEwB,KACvBsE,EAAkB9F,EAAGE,EACzB,GAGJtD,IAAAA,cAAC2J,EAAAA,UAAS,CAAC1D,KAAM,SAK/B,GAEX,CAACoB,EAAQtH,IAEZ,OACIC,IAAAA,cAAA,OAAKC,UAAU,iBACXD,IAAAA,cAACqE,EAAAA,GAAc,CACXC,WAAY,CACRnE,GAAI,wBACJoE,MAAOC,IAAW,iDAAkD,CAChEzE,aAEJ0E,SACIzE,IAAAA,cAAA,QAAMC,UAAU,6CACXoJ,EACDrJ,IAAAA,cAAC4J,EAAAA,gBAAe,CACZ3D,KAAM,GACNI,MAAM,gDAIlB3B,WAAY,0BACZ3E,YAEJ4E,KAAM,CACFxE,GAAI,sBACJ,aAAc0E,GAAeyD,EAC7BrI,UAAW,0BAGfD,IAAAA,cAACqE,EAAAA,GAAc,CACXO,IAAI,gBACJzE,GAAG,gBACHT,KAAK,OACLmF,YAAalC,EAAc,CACvBxC,GAAI,8DACJC,eAAgB,8BAEpBH,UAAU,4BACVqD,MAAOT,EACPR,SAAUa,EACVwG,UAAWX,IAEdV,EAAgBvD,KAAKC,IAClB,MAAMtB,EAAOsB,EAAOtB,MAAQ,GACtBtD,EAAK4E,EAAO5E,IAAMsD,EAClBoG,EAAaxC,EAAO1D,SAASF,GAEnC,OACIzD,IAAAA,cAACqE,EAAAA,GAAS,CACNlE,GAAE,gBAAAwF,OAAkBxF,GACpByE,IAAKzE,EACLyF,KAAK,mBACLC,oBAAoB,EACpB,eAAcgE,EACd/J,QAASA,IAAM0I,EAAiB/E,GAChCsC,OAAQ/F,IAAAA,cAAA,YAAOyD,GACfyC,iBAAkB2D,GACd7J,IAAAA,cAACuG,EAAAA,UAAS,OAEhB,IAGT4B,GAA4BtF,EAAOiG,SAAWT,EAAgByB,MAAMC,GAAQA,EAAItG,OAASZ,EAAOiG,UAC7F9I,IAAAA,cAACqE,EAAAA,GAAS,CACNlE,GAAG,sBACHyE,IAAI,sBACJ9E,QAASA,IAAM6I,EAAkB9F,GACjCkD,OAAQ/F,IAAAA,cAAA,YACH2C,EAAc,CACXxC,GAAI,iDACJC,eAAgB,oBACjB,CAACkD,MAAOT,EAAOiG,aAKhC,E,eCjMd,MAiMA,EAjM4BjJ,IActB,IAduB,MACzByD,EAAK,SACLvD,EAAQ,YACRiK,EAAW,QACXpJ,EAAU,GAAE,iBACZsH,GAAmB,EAAK,YACxBrD,GAQHhF,EACG,MAAM,cAAC8C,IAAiBC,EAAAA,EAAAA,YACjBC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,KAC9BkH,EAAYC,IAAiBnH,EAAAA,EAAAA,UAAS,KACtCoH,EAAWC,IAAgBrH,EAAAA,EAAAA,WAAS,GAErCsH,EAAazJ,EAAQwH,OAAS,EAG9BkC,GAAmBnH,EAAAA,EAAAA,cAAY,KACjC,MAAM0F,EAAeoB,EAAWnB,OAC5BD,GACAmB,EAAYnB,GAEhBqB,EAAc,IACdE,GAAa,EAAM,GACpB,CAACH,EAAYD,IAEVO,GAA2BpH,EAAAA,EAAAA,cAAaC,IAC5B,UAAVA,EAAEwB,MACFxB,EAAE6F,iBACFqB,IACJ,GACD,CAACA,IAGEpH,GAAiBC,EAAAA,EAAAA,cAAaC,IAChCN,EAAUM,EAAEC,OAAOC,MAAM,GAC1B,IAEG+E,GAAkB9E,EAAAA,EAAAA,UAAQ,IACrB3C,EAAQiC,QAAQkC,IACNA,EAAOtB,MAAQ,IAChBC,cAAcC,SAASd,EAAOa,kBAE/C,CAAC9C,EAASiC,IAEP2H,EAAqB7H,EAAc,CACrCxC,GAAI,uDACJC,eAAgB,iBAGdoI,GAAmBrF,EAAAA,EAAAA,cAAaM,IAClCuG,EAAYvG,GACZX,EAAU,GAAG,GACd,CAACkH,IAEErB,GAAoBxF,EAAAA,EAAAA,cAAayF,IACnC,MAAMC,EAAeD,EAAcE,OAC/BD,GACAmB,EAAYnB,GAEhB/F,EAAU,GAAG,GACd,CAACkH,IAEEjB,GAA4B5F,EAAAA,EAAAA,cAAaC,IAC7B,QAAVA,EAAEwB,KACFxB,EAAE4F,kBAGQ,UAAV5F,EAAEwB,KAAmBsD,GAAoBrF,EAAOiG,SAChD1F,EAAE6F,iBACFN,EAAkB9F,GACtB,GACD,CAACqF,EAAkBrF,EAAQ8F,IAE9B,IAAK0B,EAED,OACIrK,IAAAA,cAAA,OAAKC,UAAU,iBACXD,IAAAA,cAAA,SACIN,KAAK,OACLO,UAAU,8BACVqD,MAAO6G,EAAYF,EAAa3G,EAChCjB,SAAWe,GAAM8G,EAAc9G,EAAEC,OAAOC,OACxCoG,UAAWa,EACXE,QAASA,KACLL,GAAa,GACT9G,GACA4G,EAAc5G,EAClB,EAEJoH,OAAQJ,EACRzF,YAAaA,GAAelC,EAAc,CACtCxC,GAAI,sDACJC,eAAgB,iBAEpBL,SAAUA,EACV4K,UAAWC,EAAAA,GAAUC,+BAOrC,MAAMtB,EAAsBjG,GAASuB,GAAe2F,EAC9ChB,EAAWD,IAAwBiB,EAEzC,OACIxK,IAAAA,cAAA,OAAKC,UAAU,iBACXD,IAAAA,cAACqE,EAAAA,GAAc,CACXC,WAAY,CACRnE,GAAI,wBACJoE,MAAOC,IAAW,iDAAkD,CAChEzE,aAEJ0E,SACIzE,IAAAA,cAAA,QAAMC,UAAU,6CACZD,IAAAA,cAAA,QACIC,UAAWuE,IAAW,CAAC,0CAA2CgF,KAEjED,GAELvJ,IAAAA,cAAC4J,EAAAA,gBAAe,CACZ3D,KAAM,GACNI,MAAM,gDAIlB3B,WAAY,0BACZ3E,YAEJ4E,KAAM,CACFxE,GAAI,sBACJ,aAAc0E,GAAe2F,EAC7BvK,UAAW,0BAGfD,IAAAA,cAACqE,EAAAA,GAAc,CACXO,IAAI,gBACJzE,GAAG,gBACHT,KAAK,OACLmF,YAAalC,EAAc,CACvBxC,GAAI,8DACJC,eAAgB,8BAEpBH,UAAU,4BACVqD,MAAOT,EACPR,SAAUa,EACVwG,UAAWX,IAEdV,EAAgBvD,KAAKC,IAClB,MAAMtB,EAAOsB,EAAOtB,MAAQ,GACtBtD,EAAK4E,EAAO5E,IAAMsD,EAClBoG,EAAavG,IAAUG,EAE7B,OACIzD,IAAAA,cAACqE,EAAAA,GAAS,CACNlE,GAAE,gBAAAwF,OAAkBxF,GACpByE,IAAKzE,EACLyF,KAAK,gBACLC,oBAAoB,EACpB,eAAcgE,EACd/J,QAASA,IAAM0I,EAAiB/E,GAChCsC,OAAQ/F,IAAAA,cAAA,YAAOyD,GACfyC,iBAAkB2D,GACd7J,IAAAA,cAACuG,EAAAA,UAAS,OAEhB,IAGT2B,GAAoBrF,EAAOiG,SAAWT,EAAgByB,MAAMC,GAAQA,EAAItG,OAASZ,EAAOiG,UACrF9I,IAAAA,cAACqE,EAAAA,GAAS,CACNlE,GAAG,sBACHyE,IAAI,sBACJ9E,QAASA,IAAM6I,EAAkB9F,GACjCkD,OAAQ/F,IAAAA,cAAA,YACH2C,EAAc,CACXxC,GAAI,iDACJC,eAAgB,oBACjB,CAACkD,MAAOT,EAAOiG,aAKhC,ECnLRgC,EAAoBjL,IAOI,IAPH,IACvBkL,EAAG,SACHhL,EAAQ,aACRkI,EAAY,QACZrH,EAAU,GAAE,iBACZsH,GAAmB,EAAK,YACxBrD,GACqBhF,EAGrB,MAFyC,OAAjBkL,EAAIC,SAIpBhL,IAAAA,cAACiL,EAAkB,CACf5D,OAAQ0D,EAAI1D,OACZtH,SAAUA,EACVkI,aAAcA,EACdrH,QAASA,EACTsH,iBAAkBA,EAClBrD,YAAaA,IAOrB7E,IAAAA,cAACkL,EAAmB,CAChB5H,MAAOyH,EAAI1D,OAAO,IAAM,GACxBtH,SAAUA,EACViK,YAAc1G,GAAU2E,EAAa,CAAC3E,IACtC1C,QAASA,EACTsH,iBAAkBA,EAClBrD,YAAaA,GACf,EAERiG,EAAA/J,UAAA,CA3CEgK,IAAG/J,IAAAA,MAAA,CAPHI,UAASJ,IAAAA,OAAAC,WACT+J,SAAQhK,IAAAA,OAAAC,WACRoG,OAAMrG,IAAAA,QAAAA,IAAAA,QAAAC,WACNkK,eAAcnK,IAAAA,OAAAC,aAAAA,WAKdlB,SAAQiB,IAAAA,KAAAC,WACRgH,aAAYjH,IAAAA,KAAAC,WACZL,QAAOI,IAAAA,MACPkH,iBAAgBlH,IAAAA,KAChB6D,YAAW7D,IAAAA,QAwCf,U,i/BCsCA,SAASoK,EAAWvL,GAUc,IAVb,MACjByD,EAAK,SACLjB,EAAQ,WACRgJ,EAAU,SACVtL,GAAW,EAAK,eAChBuL,EAAc,4BACd5I,EAA2B,aAC3B6I,EAAY,UACZC,EAAS,QACTC,GACe5L,EACf,MAAM,cAAC8C,IAAiBC,EAAAA,EAAAA,YAEjB8I,EAAMC,IAAW5I,EAAAA,EAAAA,UAAqB,KACtC6I,EAAiBC,IAAsB9I,EAAAA,EAAAA,WAAS,IAChD+I,EAAeC,IAAoBhJ,EAAAA,EAAAA,WAAS,IAC5CiJ,EAA6BC,IAAkClJ,EAAAA,EAAAA,UAAwB,OAI9FgB,EAAAA,EAAAA,YAAU,KAEDT,GAA0B,KAAjBA,EAAMwF,OAKpB2C,EAAQS,aAAa5I,GAAO6I,MAAMC,IACZ,IAAAC,EAAAC,EAAlB,GAAIF,EAAOG,MAOP,OANAZ,EAAQ,SAGiB,QAArBU,EAACD,EAAOG,MAAM9L,eAAO,IAAA4L,GAApBA,EAAsB1I,SAAS,QAA+B,QAArB2I,EAACF,EAAOG,MAAM9L,eAAO,IAAA6L,GAApBA,EAAsB3I,SAAS,cAC1E4H,EAAaa,EAAOG,MAAM9L,UAKlCkL,EApFoBa,KAC5B,MAAMC,EAAwB,GAE9B,IAAKD,EACD,OAAOC,EAGX,IAAK,MAAMC,KAAQF,EAAUG,WAAY,CACrC,IAAInJ,EAGJ,IAAIkJ,EAAKtL,UAAUwL,WAAW,oBAG1B,MAAM,IAAIC,MAAM,sBAADlH,OAAuB+G,EAAKtL,YAF3CoC,EAAOkJ,EAAKtL,UAAU0L,MAAM,IAKhC,IAMIzF,EANA0F,EAAK/N,EAAAA,GAAgB0N,EAAK1B,UACzB+B,IAEDA,EAAKhO,EAAAA,GAAcG,IAKnBmI,EADA2F,MAAMC,QAAQP,EAAKpJ,OACVoJ,EAAKpJ,MAEL,CAACoJ,EAAKpJ,OAGnBmJ,EAAUS,KAAK,CACX9L,UAAWoC,EACXwH,SAAU+B,EACV1F,SACA8D,eAAgBuB,EAAKvB,gBAE7B,CAEA,OAAOsB,CAAS,EA8CAU,CAAgBf,EAAOgB,MAAM,IACtCC,OAAOC,IAAQ,IAAAC,EAAAC,EACd7B,EAAQ,IACJN,GACAA,GAAW,GAIC,QAAZkC,EAACD,EAAI7M,eAAO,IAAA8M,GAAXA,EAAa5J,SAAS,QAAsB,QAAZ6J,EAACF,EAAI7M,eAAO,IAAA+M,GAAXA,EAAa7J,SAAS,cACxD4H,EAAa+B,EAAI7M,QACrB,IAzBAkL,EAAQ,GA0BV,GACH,CAACrI,IAIJ,MAAMmK,GAAmBtK,EAAAA,EAAAA,cAAauK,IAClC,MAAMC,EAA6BD,EAAQ7K,QAAQkI,GAAQA,EAAI3J,YAEzDwM,EAAOD,EAA2B7I,KAAKiG,IACzC,MAAM8C,EAAgB,mBAAHlI,OAAsBoF,EAAI3J,WACvC0M,EAASrO,EAAAA,GAAgBsL,EAAIC,UAG7B+C,EAAezC,EAAexH,MAAMN,GAASA,EAAKC,OAASsH,EAAI3J,YAErE,IAAK0M,EAAQ,CAGT,MAAME,EAAYjD,EAAI1D,OAAOvC,KAAKmJ,GAAW,IAAAtI,OAASsI,EAAG,OAAKC,KAAK,MAGnE,MAA2B,iBAAvBH,aAAY,EAAZA,EAAcrO,MACP,IAAPiG,OAAWqI,EAAS,SAAArI,OAAQkI,GAEzB,GAAPlI,OAAUkI,EAAa,SAAAlI,OAAQqI,EAAS,IAC5C,CAEA,GAAoB,SAAhBF,EAAOpO,KAAiB,CACxB,MAAMsO,EAAYjD,EAAI1D,OAAOvC,KAAKmJ,GAAW,IAAAtI,OAASsI,EAAG,OAAKC,KAAK,MAGnE,MAA2B,iBAAvBH,aAAY,EAAZA,EAAcrO,MACP,IAAPiG,OAAWqI,EAAS,MAAArI,OAAKmI,EAAOnO,MAAK,KAAAgG,OAAIkI,GAEtC,GAAPlI,OAAUkI,EAAa,KAAAlI,OAAImI,EAAOnO,MAAK,MAAAgG,OAAKqI,EAAS,IACzD,CAGA,MAAM1K,EAAQyH,EAAI1D,OAAOe,OAAS,EAAI2C,EAAI1D,OAAO,GAAK,GAEtD,MAAoB,eAAhByG,EAAOpO,KACA,GAAPiG,OAAUkI,EAAa,KAAAlI,OAAImI,EAAOnO,MAAK,MAAAgG,OAAKrC,EAAK,KAI9C,GAAPqC,OAAUkI,EAAa,KAAAlI,OAAImI,EAAOnO,MAAK,MAAAgG,OAAKrC,EAAK,SAClD4K,KAAK,QAER7L,EAASuL,GACLvC,GAGAA,EAAoB,KAATuC,GAAeD,EAA2BvF,OAAS,EAClE,GACD,CAAC/F,EAAUgJ,EAAYC,IAGpB6C,GAA8BhL,EAAAA,EAAAA,cAAY,IAvKDiL,EAC/C9C,EACA5I,IAEO4I,EAAexH,MAAMN,IAAS,IAAA6K,EAAAC,EAAAC,EACjC,MAAMpJ,EAAY3B,EAAKC,KAAKE,SAAS,KAC/ByB,GAAqB,QAAViJ,EAAA7K,EAAK9B,aAAK,IAAA2M,OAAA,EAAVA,EAAYhJ,QAAkB,QAAdiJ,EAAI9K,EAAK9B,aAAK,IAAA4M,OAAA,EAAVA,EAAYhJ,MAC3CC,EAAyC,WAAd,QAAVgJ,EAAA/K,EAAK9B,aAAK,IAAA6M,OAAA,EAAVA,EAAY/I,SAEnC,OAAQL,IADQC,GAAYG,GAAkB7C,EAClB,IA+JrB0L,CAAoC9C,EAAgB5I,IAC5D,CAAC4I,EAAgB5I,IAGd8L,GAASrL,EAAAA,EAAAA,cAAY,KACvB,GAA8B,IAA1BmI,EAAelD,OAGf,YADAmD,EAAa,mHAIjB,MAAMkD,EAA0BN,IAC3BM,EAKL9C,GAAS+C,IAAgB,IAAAC,EACrB,MAMMjB,EAAU,IAAIgB,EANL,CACXtN,UAAWqN,EAAwBhL,KACnCuH,SAAUjM,EAAAA,GAAcG,GACxBmI,OAAQ,GACR8D,gBAAiC,QAAjBwD,EAAArD,EAAe,UAAE,IAAAqD,OAAA,EAAjBA,EAAmBjP,OAAQ,KAK/C,OAFA+N,EAAiBC,GACjBzB,EAA+ByB,EAAQtF,OAAS,GACzCsF,CAAO,IAddnC,EAAa,wDAef,GACH,CAACD,EAAgBmC,EAAkBU,IAEhCS,GAAYzL,EAAAA,EAAAA,cAAa0L,IAC3BlD,GAAS+C,IACL,MAAMhB,EAAUgB,EAAYI,UAAUD,EAAO,GAE7C,OADApB,EAAiBC,GACVA,CAAO,GAChB,GACH,CAACD,IAEEsB,GAAqB5L,EAAAA,EAAAA,cAAY,CAAC0L,EAAezN,KACnDuK,GAAS+C,IACL,MAAMhB,EAAU,IAAIgB,GACdM,EAAetB,EAAQmB,GAAOzN,UASpC,OARAsM,EAAQmB,GAAMI,EAAAA,EAAA,GAAOvB,EAAQmB,IAAM,IAAEzN,cAGjC4N,IAAiB5N,IACjBsM,EAAQmB,GAAOxH,OAAS,GACxBqG,EAAQmB,GAAO7D,SAAWjM,EAAAA,GAAcG,IAE5CuO,EAAiBC,GACVA,CAAO,GAChB,GACH,CAACD,IAEEyB,GAAoB/L,EAAAA,EAAAA,cAAY,CAAC0L,EAAeM,KAClDxD,GAAS+C,IACL,MAAMU,EAAcV,EAAYG,GAAO7D,SACvC,IAAIvC,EAAY,IAAIiG,EAAYG,GAAOxH,QAEnC8H,IAAgBpQ,EAAAA,GAAcS,IAAM4P,IAAgBrQ,EAAAA,GAAcS,GAGlEiJ,EAAYA,EAAU3D,KAAK4D,GAAMA,EAAEI,SAAQjG,QAAQ6F,GAAY,KAANA,IAClDyG,IAAgBpQ,EAAAA,GAAcS,IAGjCiJ,EAAUL,OAAS,IACnBK,EAAY,CAACA,EAAU,KAI/B,MAAMiF,EAAU,IAAIgB,GAQpB,OAPAhB,EAAQmB,GAAMI,EAAAA,EAAA,GACPP,EAAYG,IAAM,IACrB7D,SAAUmE,EACV9H,OAAQoB,IAGZgF,EAAiBC,GACVA,CAAO,GAChB,GACH,CAACD,IAEE4B,GAAkBlM,EAAAA,EAAAA,cAAY,CAAC0L,EAAexH,KAChDsE,GAAS+C,IACL,MAAMhB,EAAU,IAAIgB,GAGpB,OAFAhB,EAAQmB,GAAMI,EAAAA,EAAA,GAAOvB,EAAQmB,IAAM,IAAExH,WACrCoG,EAAiBC,GACVA,CAAO,GAChB,GACH,CAACD,IAEJ,OACIzN,IAAAA,cAAA,OAAKC,UAAU,gBACXD,IAAAA,cAAA,SAAOC,UAAU,uBACbD,IAAAA,cAAA,aACIA,IAAAA,cAAA,MAAIC,UAAU,4BACVD,IAAAA,cAAA,MAAIC,UAAU,+BACVD,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,8CACHC,eAAe,eAGvBJ,IAAAA,cAAA,MAAIC,UAAU,+BACVD,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,6CACHC,eAAe,cAGvBJ,IAAAA,cAAA,MAAIC,UAAU,+BACVD,IAAAA,cAAA,QAAMC,UAAU,qCACZD,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,2CACHC,eAAe,aAI3BJ,IAAAA,cAAA,MAAIC,UAAU,0CAGtBD,IAAAA,cAAA,aACqB,IAAhB0L,EAAKtD,OACFpI,IAAAA,cAAA,UACIA,IAAAA,cAAA,MACIsP,QAAS,EACTrP,UAAU,6BAEVD,IAAAA,cAAA,YACK2C,EAAc,CACXxC,GAAI,gDACJC,eAAgB,2DAMhCsL,EAAK5G,KAAI,CAACiG,EAAK8D,KAAK,IAAAU,EAAAC,EAAA,OAChBxP,IAAAA,cAAA,MACI4E,IAAKiK,EACL5O,UAAU,qBAEVD,IAAAA,cAAA,MAAIC,UAAU,sBACVD,IAAAA,cAACkC,EAAqB,CAClBC,iBAAkB4I,EAAI3J,UACtBgB,oBAAqBkJ,EACrBvL,SAAUA,EACVsC,SAAWjB,GAAc2N,EAAmBF,EAAOzN,GACnDkB,OAAM,2BAAAqD,OAA6BkJ,GACnCtM,SAAQ,6BAAAoD,OAA+BkJ,GACvCrM,SAAUqM,IAAU7C,EACpBvJ,aAAcA,IAAMwJ,EAA+B,MACnDvJ,4BAA6BA,KAGrC1C,IAAAA,cAAA,MAAIC,UAAU,sBACVD,IAAAA,cAAC2G,EAAoB,CACjBC,gBAAiBmE,EAAIC,SACrBjL,SAAUA,EACVsC,SAAW2I,GAAakE,EAAkBL,EAAO7D,MAGzDhL,IAAAA,cAAA,MAAIC,UAAU,sBACVD,IAAAA,cAAC8K,EAAiB,CACdC,IAAKA,EACLhL,SAAUA,EACVkI,aAAeZ,GAAqBgI,EAAgBR,EAAOxH,GAC3DzG,QAASmK,EAAI3J,YAAsE,QAA1DmO,EAAAjE,EAAexH,MAAMN,GAASA,EAAKC,OAASsH,EAAI3J,mBAAU,IAAAmO,GAAO,QAAPC,EAA1DD,EAA4D7N,aAAK,IAAA8N,OAAP,EAA1DA,EAAmE5O,UAAgB,MAGpHZ,IAAAA,cAAA,MAAIC,UAAU,8BACVD,IAAAA,cAAA,UACIN,KAAK,SACLO,UAAU,2BACVH,QAASA,IAAM8O,EAAUC,GACzB9O,SAAUA,EACV,aAAY4C,EAAc,CAACxC,GAAI,+CAAgDC,eAAgB,gBAE/FJ,IAAAA,cAAA,KAAGC,UAAU,kCAGpB,KAIjBD,IAAAA,cAAA,aACIA,IAAAA,cAAA,UACIA,IAAAA,cAAA,MACIsP,QAAS,EACTrP,UAAU,sCAEVD,IAAAA,cAACK,EAAAA,GAAkB,CACfP,QAAS0O,EACTzO,SAAUA,GAAsC,IAA1BuL,EAAelD,aAOzDpI,IAAAA,cAAA,OAAKC,UAAU,6BACXD,IAAAA,cAACO,EAAAA,GAAQ,CACLE,QAASkC,EAAc,CACnBxC,GAAI,8CACJC,eAAgB,qJAGxBJ,IAAAA,cAACJ,EAAAA,GAAU,CACPE,QAASA,IAAM+L,GAAmB,GAClC9L,SAAUA,IAAauD,KAI9BsI,GACG5L,IAAAA,cAACyP,EAAAA,EAAgB,CACbC,SAAUA,IAAM7D,GAAmB,GACnCJ,QAAS,CACLkE,UAAWA,OACXC,YAAaA,CAACC,EAAcC,EAAeC,KAEhCC,EAAAA,EAAAA,IAAyB1M,EAAOuM,EAAMC,EAAOC,EAAOvE,MAK1EM,GACG9L,IAAAA,cAACiQ,EAAAA,EAAY,CACTP,SAAUA,IAAM3D,GAAiB,KAKrD,CAACX,EAAArK,UAAA,CAhaGuC,MAAKtC,IAAAA,OAAAC,WACLoB,SAAQrB,IAAAA,KAAAC,WACRoK,WAAUrK,IAAAA,KACVjB,SAAQiB,IAAAA,KACRsK,eAActK,IAAAA,MAAAC,WACdyB,4BAA2B1B,IAAAA,KAAAC,WAC3BsK,aAAYvK,IAAAA,KAAAC,WACZuK,UAASxK,IAAAA,OACTyK,QAAOzK,IAAAA,MAAA,CACHkL,aAAYlL,IAAAA,KAAAC,aAAAA,YAyZpB,S,2HCxaA,MAAMgP,EAAgCpQ,IAA+B,IAA9B,SAAC6P,EAAQ,OAAEQ,GAAcrQ,EAC5D,OACIG,IAAAA,cAACmQ,EAAAA,GAAY,CACThQ,GAAG,eACHF,UAAU,2BACV,kBAAgB,oBAChByP,SAAUA,EACVQ,OAAQA,EACRE,gBACIpQ,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,4CACHC,eAAe,qCAGvBiQ,mBACIrQ,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,gDACHC,eAAe,8FAGvBkQ,eAAe,EACfC,aAAa,EACbC,cAAc,OAEdxQ,IAAAA,cAAA,OAAKC,UAAU,qCACXD,IAAAA,cAAA,OAAKC,UAAU,2BACXD,IAAAA,cAACW,EAAAA,EAAQ,CACLF,QAAS,yrBAGjBT,IAAAA,cAAA,OAAKC,UAAU,2CACXD,IAAAA,cAAA,OAAKC,UAAU,0CACXD,IAAAA,cAAA,KAAGC,UAAU,kCACbD,IAAAA,cAAA,QAAMC,UAAU,yCACZD,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,4DACHC,eAAe,sBAI3BJ,IAAAA,cAAA,OAAKC,UAAU,wCACXD,IAAAA,cAACW,EAAAA,EAAQ,CACLF,QAAS,sKAEbT,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,oDACHC,eAAe,8DACfiH,OAAQ,CACJoJ,KAAOC,GACH1Q,IAAAA,cAAC2Q,EAAAA,EAAY,CACT7P,KAAK,mBACL8P,SAAS,kBAERF,SAQlB,EAErBT,EAAAlP,UAAA,CAnEE2O,SAAQ1O,IAAAA,KAAAC,WACRiP,OAAMlP,IAAAA,MAoEV,S,8ICpDA,SAASyO,EAAgB5P,GAGF,IAHG,SACtB6P,EAAQ,QACRjE,GACI5L,EACJ,MAAMgR,GAAWC,EAAAA,EAAAA,gBACVjB,EAAMkB,IAAWhO,EAAAA,EAAAA,UAAiB,KAClCiO,EAAOC,IAAYlO,EAAAA,EAAAA,UAAwB,KAC3CmO,EAAOC,IAAYpO,EAAAA,EAAAA,UAAiB,IACpCqO,EAASC,IAActO,EAAAA,EAAAA,WAAkB,IACzCuO,EAAeC,IAAoBxO,EAAAA,EAAAA,UAAmB,IAEvDyO,GAAarO,EAAAA,EAAAA,cAAYsO,eAAOC,EAAoBC,GAA2C,IAA3BC,EAAcC,UAAAzJ,OAAA,QAAAtC,IAAA+L,UAAA,IAAAA,UAAA,GACpFR,GAAW,GACX,MAAMjF,QAAsDyE,EAASpF,EAAQmE,YAAY8B,EAAYC,EAxBtF,KAyBf,GAAIvF,SAAAA,EAAQgB,KAAM,CACd,MAAM0E,EAAW1F,EAAOgB,KAAK4D,MAEzBC,EADAW,EACSE,EAECC,GAAc,IAAIA,KAAcD,IAE9CX,EAAS/E,EAAOgB,KAAK8D,MACzB,MACID,EAAS,IACTE,EAAS,GAEbE,GAAW,EACf,GAAG,CAACR,EAAUpF,IAwBd,OAtBA1H,EAAAA,EAAAA,YAAU,KACNyN,EAAW3B,EAAM,GAAG,GACrB,IAqBC7P,IAAAA,cAACgS,EAAAA,MAAK,CACFC,gBAAgB,0CAChBC,MAAM,EACNhC,OAAQR,EACR9J,KAAK,OACL,kBAAgB,wBAChBzF,GAAG,oBAEHH,IAAAA,cAACgS,EAAAA,MAAMG,OAAM,CACTC,aAAa,EACbC,MAAO,CAACC,QAAS,OAAQC,WAAY,WAErCvS,IAAAA,cAACgS,EAAAA,MAAMQ,MAAK,CACRC,eAAe,KACftS,GAAG,yBAEHH,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,mCACHC,eAAe,+BAI3BJ,IAAAA,cAACgS,EAAAA,MAAMU,KAAI,KACP1S,IAAAA,cAAC2S,EAAAA,EAAkB,CACf3B,MAAOA,EACP4B,aAvFG,GAwFH1B,MAAOA,EACP2B,SAxCQC,IACpB,GAAI1B,IAAYJ,EAAM5I,OAClB,OAEJ,GArDe,GAqDX0K,EAtDW,GAuDX,OAEJ,MAAMC,EAAoB/B,EAAMA,EAAM5I,OAAS,GAAGjI,GAClDoR,EAAiB,IAAID,EAAeyB,IACpCvB,EAAW3B,EAAMkD,EAAkB,EAgCvBC,OA/CMC,IAClB1B,EAAiB,IACjBR,EAAQkC,GACRzB,EAAWyB,EAAS,IAAI,EAAK,EA6CjBC,gBAAiB,CAAC,KAKtC,CAACzD,EAAA1O,UAAA,CA7FG2O,SAAQ1O,IAAAA,KAAAC,WACRwK,QAAOzK,IAAAA,MAAA,CACH4O,YAAW5O,IAAAA,KAAAC,WACX0O,UAAS3O,IAAAA,OAAAC,YA4FjB,S,gHCnFA,MAAMkS,EAAsBtT,IAA+D,IACnFuT,EACAC,EACAC,EACAC,GAJqB,KAACrB,EAAI,UAAEsB,EAAS,SAAEC,EAAQ,YAAEC,EAAW,SAAEC,GAAgB9T,EAK9E8T,GACAP,EAAeQ,EAASC,cACxBR,EAAiBO,EAASE,gBAC1BR,EAAiBM,EAASG,gBAC1BR,EAA6BK,EAASI,8BAEtCZ,EAAeQ,EAASK,eACxBZ,EAAiBO,EAASM,iBAC1BZ,EAAiBM,EAASO,iBAC1BZ,EAA6BK,EAASQ,8BAG1C,MAAM1N,EACF1G,IAAAA,cAACE,EAAAA,iBAAgBkH,OAAAiN,OAAA,GACTjB,EAAY,CAChB/L,OAAQ,CAACqM,kBAIXjT,EACFT,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,SACIA,IAAAA,cAACE,EAAAA,iBAAgBkH,OAAAiN,OAAA,GACThB,EAAc,CAClBhM,OAAQ,CAACqM,YAAa1T,IAAAA,cAAA,cAAS0T,QAGvC1T,IAAAA,cAAA,SACIA,IAAAA,cAACE,EAAAA,iBAAgBkH,OAAAiN,OAAA,GACTd,EAA0B,CAC9BlM,OAAQ,CAACqM,YAAa1T,IAAAA,cAAA,cAAS0T,SAMzCY,EACFtU,IAAAA,cAACE,EAAAA,iBACOoT,GAINiB,EACFvU,IAAAA,cAACE,EAAAA,iBAAgB,CACbC,GAAG,yDACHC,eAAe,eAMvB,OACIJ,IAAAA,cAACwU,EAAAA,EAAY,CACTtC,KAAMA,EACNxL,MAAOA,EACPjG,QAASA,EACTgU,WAPW,wBAQXC,mBAAoB,kBACpBC,kBAAmBL,EACnBM,iBAAkBL,EAClBf,UAAWA,EACXC,SAAUA,GACZ,EAERN,EAAApS,UAAA,CA5FEmR,KAAIlR,IAAAA,KAAAC,WAKJuS,UAASxS,IAAAA,KAAAC,WAKTwS,SAAQzS,IAAAA,KAAAC,WAKRyS,YAAW1S,IAAAA,OAAAC,WAKX0S,SAAQ3S,IAAAA,KAAAC,YA0EZ,MAAM2S,GAAWiB,EAAAA,EAAAA,gBAAe,CAC5BV,iBAAkB,CACdhU,GAAI,mEACJC,eAAgB,mCAEpB8T,iBAAkB,CACd/T,GAAI,4EACJC,eAAgB,sNAEpBgU,6BAA8B,CAC1BjU,GAAI,6EACJC,eAAgB,wEAEpB6T,eAAgB,CACZ9T,GAAI,iEACJC,eAAgB,+CAEpB2T,gBAAiB,CACb5T,GAAI,kEACJC,eAAgB,kCAEpB0T,gBAAiB,CACb3T,GAAI,2EACJC,eAAgB,2LAEpB4T,4BAA6B,CACzB7T,GAAI,4EACJC,eAAgB,uEAEpByT,cAAe,CACX1T,GAAI,gEACJC,eAAgB,gDAIxB,G,wgBCzHe,MAAM0U,UAAmB9U,IAAAA,cAI7B+U,WAAAA,CAAY5T,GACf6T,MAAM7T,GAAO8T,EAAA,mBAkCK7R,IACb8R,KAAKC,YAAYnR,SAAYkR,KAAKC,YAAYnR,QAAQoR,SAAShS,EAAEC,SAClE6R,KAAKG,SAAS,CAACC,UAAU,GAC7B,IACHL,EAAA,qBAEsB,MACdC,KAAKK,MAAMD,UAAYJ,KAAKM,WAAWxR,SACxCkR,KAAKM,WAAWxR,QAAQyR,QAE5BP,KAAKG,SAAS,CAACC,UAAWJ,KAAKK,MAAMD,UAAU,IAClDL,EAAA,0BAE2BS,IACxBR,KAAKG,SAAS,CAACM,SAAS,IACxBT,KAAK/T,MAAMkB,SAASqT,EAAaE,IAAI,IACxCX,EAAA,iBAEmB9L,IAChB,MAAM7F,EAAQ6F,EAAM9F,OAAOC,MAErB+C,GAAQwP,EAAAA,EAAAA,GAAUvS,GAClBwS,EAAkB,IAAMzP,EAAM0P,QAEhC1P,EAAM2P,WACNd,KAAK/T,MAAMkB,SAASyT,GAGxBZ,KAAKG,SAAS,CAAC/R,SAAO,IACzB2R,EAAA,gBAEkB9L,IACf+L,KAAKG,SAAS,CACVM,SAAS,IAGTxM,EAAM9F,QACN8F,EAAM9F,OAAO4S,kBAAkB,EAAG9M,EAAM9F,OAAOC,MAAM8E,OACzD,IACH6M,EAAA,eAEgB,KACb,MAAM3R,EAAQ4R,KAAKK,MAAMjS,MAEnB+C,GAAQwP,EAAAA,EAAAA,GAAUvS,GAClBwS,EAAkB,IAAMzP,EAAM0P,QAEhC1P,EAAM2P,WACNd,KAAK/T,MAAMkB,SAASyT,GAEpBZ,KAAKG,SAAS,CACV/R,MAAOwS,KAGXZ,KAAKG,SAAS,CACV/R,MAAO4R,KAAK/T,MAAMmC,QAI1B4R,KAAKG,SAAS,CACVM,SAAS,GACX,IACLV,EAAA,kBAEoB9L,IAEC,UAAdA,EAAMvE,KAAiC,MAAduE,EAAMvE,KAC/BsQ,KAAKgB,cACT,IArGAhB,KAAKC,YAAcnV,IAAAA,YACnBkV,KAAKM,WAAaxV,IAAAA,YAElBkV,KAAKK,MAAQ,CACTI,SAAS,EACTL,UAAU,EACVhS,MAAOnC,EAAMmC,MAErB,CAEA,+BAAO6S,CAAyBhV,EAAcoU,GAC1C,OAAKA,EAAMI,SAAWxU,EAAMmC,QAAUiS,EAAMjS,MAMrC,KALI,CACHA,MAAOnC,EAAMmC,MAKzB,CAEO8S,kBAAAA,CAAmBC,EAAkBC,GACxC,MAAOhB,SAAUiB,GAAgBD,GAC3B,SAAChB,GAAYJ,KAAKK,MAEpBD,IAAaiB,IACTjB,EACApR,SAASsS,iBAAiB,QAAStB,KAAKuB,WAAY,CAACC,SAAS,IAE9DxS,SAASyS,oBAAoB,QAASzB,KAAKuB,YAGvD,CAyEOG,MAAAA,GACH,MAAM,GAACzW,GAAM+U,KAAK/T,OACZ,SAACmU,EAAQ,MAAEhS,GAAS4R,KAAKK,MAE/B,OACIvV,IAAAA,cAAA,OAAKC,UAAU,2BACXD,IAAAA,cAAA,SACIG,GAAE,GAAAwF,OAAKxF,EAAE,oBACT0W,IAAK3B,KAAKM,WACVvV,UAAU,eACVP,KAAK,OACL4D,MAAOA,EACPjB,SAAU6S,KAAK7S,SACfqI,OAAQwK,KAAKxK,OACbD,QAASyK,KAAKzK,QACdf,UAAWwL,KAAKxL,UAChBiB,UAAW,EACX5K,SAAUmV,KAAK/T,MAAM2V,WACrB,cAAY,2BAGd5B,KAAK/T,MAAM2V,YACT9W,IAAAA,cAAA,QACIG,GAAE,GAAAwF,OAAKxF,EAAE,oBACTF,UAAU,8BACVH,QAASoV,KAAKgB,cAEdlW,IAAAA,cAAA,KACIG,GAAE,GAAAwF,OAAKxF,EAAE,yBACTF,UAAU,aACVoS,MAAO,CACH0E,gBAAiBzT,MAKhCgS,GACGtV,IAAAA,cAAA,OACI6W,IAAK3B,KAAKC,YACVlV,UAAU,gBACVE,GAAE,GAAAwF,OAAKxF,EAAE,uBAETH,IAAAA,cAACgX,EAAAA,GAAY,CACT3Q,MAAO/C,EACPjB,SAAU6S,KAAK+B,kBACfC,cAAc,KAMtC,EACHjC,EAlKoBH,EAAU,aAZ3B3U,GAAEa,IAAAA,OAAAC,WACFoB,SAAQrB,IAAAA,KAAAC,WACRqC,MAAKtC,IAAAA,OAAAC,WACL6V,WAAU9V,IAAAA,M,8FC0CP,MAAMmW,EAAkC3L,IAC3C,MAAMqF,GAAWC,EAAAA,EAAAA,eAEjB,OAAOvN,EAAAA,EAAAA,UAAQ,KAAM,CAKjB6T,uBAAwBA,CAACtH,EAAeC,IAC7Bc,GAASuG,EAAAA,EAAAA,IAAuBtH,EAAOC,EAAOvE,IAMzDU,aAAemL,GACJxG,GAAS3E,EAAAA,EAAAA,IAAamL,EAAY7L,IAM7CoE,YAAaA,CAACyH,EAAoBxH,EAAcC,EAAeC,IACpDc,GAASb,EAAAA,EAAAA,IAAyBqH,EAAYxH,EAAMC,EAAOC,EAAOvE,IAM7E8L,iBAAmB9L,GACRqF,GAAS0G,EAAAA,EAAAA,IAAuB/L,IAM3CgM,kBAAoBC,GACT5G,GAAS6G,EAAAA,EAAAA,IAA0BD,IAM9CE,oBAAsBC,GACX/G,GAASgH,EAAAA,EAAAA,IAA0BD,IAM9CE,kBAAmB,SAACtM,GAA+C,IAA5BsH,EAAIjB,UAAAzJ,OAAA,QAAAtC,IAAA+L,UAAA,GAAAA,UAAA,GAAG,EAAGkG,EAAOlG,UAAAzJ,OAAA,QAAAtC,IAAA+L,UAAA,GAAAA,UAAA,GAAG,IACvD,OAAOhB,GAASiH,EAAAA,EAAAA,IAAkBtM,EAAWsH,EAAMiF,GACvD,EAKAC,UAAYC,GACDpH,GAASmH,EAAAA,EAAAA,IAAUC,IAM9BC,gCAAiCA,CAACN,EAAkBO,IACzCtH,GAASqH,EAAAA,EAAAA,IAAgCN,EAAUO,IAM9DC,mCAAqCf,GAC1BxG,GAASuH,EAAAA,EAAAA,IAAmCf,EAAY7L,IAMnE6M,2BAA6BC,GAClBzH,GAASwH,EAAAA,EAAAA,IAA2BC,OAE/C,CAACzH,EAAUrF,GAAW,C,yMCxHvB,SAAS+L,EAAuBpX,EAAYqL,GAC/C,OAAO+M,EAAAA,EAAAA,IAAe,CAClBC,WAAYC,EAAAA,GAAQlB,uBACpBmB,UAAW,CAACC,EAAAA,GAAWC,gCACvBC,OAAQ,CACJ1Y,EACAqL,IAGZ,CAEO,SAASkM,EAA0BD,GACtC,OAAOhG,MAAOZ,EAAUiI,KACpB,IAAI1L,EACJ,IACIA,QAAaqL,EAAAA,GAAQM,kCAAkCtB,EAC3D,CAAE,MAAOlL,GAEL,OADAyM,EAAAA,EAAAA,IAAuBzM,EAAsBsE,EAAUiI,GAChD,CAACvM,QACZ,CAMA,OAJAsE,EACI,CAACnR,KAAMiZ,EAAAA,GAAWM,qCAAsC7L,SAGrD,CAACA,OAAK,CAErB,CAEO,SAASyK,EAA0B1X,GACtC,OAAOoY,EAAAA,EAAAA,IAAe,CAClBC,WAAYC,EAAAA,GAAQZ,0BACpBa,UAAW,CAACC,EAAAA,GAAWO,sCACvBL,OAAQ,CACJ1Y,IAGZ,CAEO,SAASgZ,EAA4BtJ,EAAcnQ,EAAcoQ,EAAeC,GACnF,OAAO0B,MAAOZ,EAAUiI,KACpB,IAAI1L,EACJ,IACIA,QAAaqL,EAAAA,GAAQU,4BAA4BtJ,EAAMnQ,EAAMoQ,EAAOC,EACxE,CAAE,MAAOxD,GAEL,OADAyM,EAAAA,EAAAA,IAAuBzM,EAAsBsE,EAAUiI,GAChD,CAACvM,QACZ,CAMA,OAJAsE,EACI,CAACnR,KAAMiZ,EAAAA,GAAWS,wCAAyChM,KAAMA,EAAKiM,WAGnE,CAACjM,OAAK,CAErB,CAEO,SAASkM,EAAkCnZ,EAAY0P,EAAc0J,GACxE,OAAO9H,MAAOZ,EAAUiI,KACpB,IAAI1L,EACJ,IACIA,QAAaqL,EAAAA,GAAQe,uCAAuCrZ,EAAI0P,EAAM0J,EAC1E,CAAE,MAAOhN,GAEL,OADAyM,EAAAA,EAAAA,IAAuBzM,EAAsBsE,EAAUiI,GAChD,CAACvM,QACZ,CAEA,MAAMkN,EAAmC,CAAC,EAQ1C,OAPAA,EAAOtZ,GAAMiN,EAAKsM,SAAS5U,KAAK6U,GAAYA,EAAQxZ,KAEpD0Q,GAAS+I,EAAAA,EAAAA,IAAa,CAClB,CAACla,KAAMiZ,EAAAA,GAAWkB,uCAAwCzM,KAAMqM,GAChE,CAAC/Z,KAAMoa,EAAAA,GAAaC,kBAAmB3M,KAAMA,EAAKsM,aAG/C,CAACtM,OAAK,CAErB,CAEO,SAAS4M,EAAoCpC,EAAkBqC,GAClE,OAAO1B,EAAAA,EAAAA,IAAe,CAClBC,WAAYC,EAAAA,GAAQuB,oCACpBtB,UAAW,CAACC,EAAAA,GAAWuB,kDACvBrB,OAAQ,CACJjB,EACAqC,IAGZ,CAEO,SAASE,EAAwCvC,EAAkBqC,GACtE,OAAO1B,EAAAA,EAAAA,IAAe,CAClBC,WAAYC,EAAAA,GAAQ0B,wCACpBzB,UAAW,CAACC,EAAAA,GAAWyB,sDACvBvB,OAAQ,CACJjB,EACAqC,IAGZ,CAEO,SAAS7C,EAAuBtH,EAAeC,EAAevE,GACjE,OAAO+M,EAAAA,EAAAA,IAAe,CAClBC,WAAYC,EAAAA,GAAQrB,uBACpByB,OAAQ,CACJ/I,EACAC,EACAvE,IAGZ,CAEO,SAAS0M,EAAgCN,EAAkBO,GAC9D,OAAOI,EAAAA,EAAAA,IAAe,CAClBC,WAAYC,EAAAA,GAAQP,gCACpBW,OAAQ,CACJjB,EACAO,IAGZ,CAEO,SAASnI,EAAyBqH,EAAoBxH,EAAcC,EAAeC,EAAevE,GACrG,OAAOiG,MAAOZ,EAAUiI,KACpB,IAAI1L,EACJ,IACIA,QAAaqL,EAAAA,GAAQ4B,4BAA4BhD,EAAYxH,EAAMC,EAAOC,EAAOvE,EACrF,CAAE,MAAOe,GAEL,OADAyM,EAAAA,EAAAA,IAAuBzM,EAAsBsE,EAAUiI,GAChD,CAACvM,QACZ,CAMA,OAJAsE,EACI,CAACnR,KAAM4a,EAAAA,GAAUC,kBAAmBnN,KAAMA,EAAK4D,QAG5C,CAAC5D,OAAK,CAErB,CAEO,SAASlB,EAAamL,EAAoB7L,GAC7C,OAAO+M,EAAAA,EAAAA,IAAe,CAClBC,WAAYC,EAAAA,GAAQ+B,yBACpB3B,OAAQ,CAACxB,EAAY7L,IAE7B,CAEO,SAAS4M,EAAmCf,EAAoB7L,GACnE,OAAOiG,MAAOZ,EAAUiI,KACpB,IAAI1L,EACJ,IACIA,QAAaqL,EAAAA,GAAQL,mCAAmCf,EAAY7L,EACxE,CAAE,MAAOe,GAEL,OADAyM,EAAAA,EAAAA,IAAuBzM,EAAsBsE,EAAUiI,GAChD,CAACvM,QACZ,CACA,MAAO,CAACa,OAAK,CAErB,CAEO,SAASiL,EAA2BC,GACvC,OAAO7G,MAAOZ,EAAUiI,KACpB,IAAI1L,EACJ,IACIA,QAAaqL,EAAAA,GAAQJ,2BAA2BC,EACpD,CAAE,MAAO/L,GAEL,OADAyM,EAAAA,EAAAA,IAAuBzM,EAAsBsE,EAAUiI,GAChD,CAACvM,QACZ,CACA,MAAO,CAACa,OAAK,CAErB,C","sources":["webpack://mattermost-webapp/./src/components/admin_console/access_control/editors/shared.tsx","webpack://mattermost-webapp/./src/components/admin_console/access_control/editors/table_editor/attribute_selector_menu.tsx","webpack://mattermost-webapp/./src/components/admin_console/access_control/editors/table_editor/operator_selector_menu.tsx","webpack://mattermost-webapp/./src/components/admin_console/access_control/editors/table_editor/multi_value_selector_menu.tsx","webpack://mattermost-webapp/./src/components/admin_console/access_control/editors/table_editor/single_value_selector_menu.tsx","webpack://mattermost-webapp/./src/components/admin_console/access_control/editors/table_editor/value_selector_menu.tsx","webpack://mattermost-webapp/./src/components/admin_console/access_control/editors/table_editor/table_editor.tsx","webpack://mattermost-webapp/./src/components/admin_console/access_control/modals/cel_help/cel_help_modal.tsx","webpack://mattermost-webapp/./src/components/admin_console/access_control/modals/policy_test/test_modal.tsx","webpack://mattermost-webapp/./src/components/admin_console/team_channel_settings/convert_confirm_modal.tsx","webpack://mattermost-webapp/./src/components/color_input.tsx","webpack://mattermost-webapp/./src/hooks/useChannelAccessControlActions.ts","webpack://mattermost-webapp/./src/packages/mattermost-redux/src/actions/access_control.ts"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport './shared.scss';\r\nimport Markdown from 'components/markdown';\r\n\r\n// CEL operator constants\r\nexport enum CELOperator {\r\n    EQUALS = '==',\r\n    NOT_EQUALS = '!=',\r\n    STARTS_WITH = 'startsWith',\r\n    ENDS_WITH = 'endsWith',\r\n    CONTAINS = 'contains',\r\n    IN = 'in',\r\n}\r\n\r\n// Operator label constants\r\nexport enum OperatorLabel {\r\n    IS = 'is',\r\n    IS_NOT = 'is not',\r\n    STARTS_WITH = 'starts with',\r\n    ENDS_WITH = 'ends with',\r\n    CONTAINS = 'contains',\r\n    IN = 'in',\r\n}\r\n\r\n// Map from CEL operator to UI label\r\nexport const OPERATOR_LABELS: Record<string, string> = {\r\n    [CELOperator.EQUALS]: OperatorLabel.IS,\r\n    [CELOperator.NOT_EQUALS]: OperatorLabel.IS_NOT,\r\n    [CELOperator.STARTS_WITH]: OperatorLabel.STARTS_WITH,\r\n    [CELOperator.ENDS_WITH]: OperatorLabel.ENDS_WITH,\r\n    [CELOperator.CONTAINS]: OperatorLabel.CONTAINS,\r\n    [CELOperator.IN]: OperatorLabel.IN,\r\n};\r\n\r\ntype OperatorType = 'comparison' | 'method' | 'list';\r\n\r\n// Map from UI label to operator configuration\r\nexport const OPERATOR_CONFIG: Record<string, {type: OperatorType; celOp: CELOperator}> = {\r\n    [OperatorLabel.IS]: {type: 'comparison', celOp: CELOperator.EQUALS},\r\n    [OperatorLabel.IS_NOT]: {type: 'comparison', celOp: CELOperator.NOT_EQUALS},\r\n    [OperatorLabel.STARTS_WITH]: {type: 'method', celOp: CELOperator.STARTS_WITH},\r\n    [OperatorLabel.ENDS_WITH]: {type: 'method', celOp: CELOperator.ENDS_WITH},\r\n    [OperatorLabel.CONTAINS]: {type: 'method', celOp: CELOperator.CONTAINS},\r\n    [OperatorLabel.IN]: {type: 'list', celOp: CELOperator.IN},\r\n};\r\n\r\ninterface TestButtonProps {\r\n    onClick: () => void;\r\n    disabled: boolean;\r\n}\r\n\r\ninterface AddAttributeButtonProps {\r\n    onClick: () => void;\r\n    disabled: boolean;\r\n}\r\n\r\ninterface HelpTextProps {\r\n    message: string;\r\n    onLearnMoreClick?: () => void;\r\n}\r\n\r\nexport function TestButton({onClick, disabled}: TestButtonProps): JSX.Element {\r\n    return (\r\n        <button\r\n            className='btn btn-sm btn-tertiary'\r\n            onClick={onClick}\r\n            disabled={disabled}\r\n        >\r\n            <i className='icon icon-lock-outline'/>\r\n            <FormattedMessage\r\n                id='admin.access_control.table_editor.test_access_rule'\r\n                defaultMessage='Test access rule'\r\n            />\r\n        </button>\r\n    );\r\n}\r\n\r\nexport function AddAttributeButton({onClick, disabled}: AddAttributeButtonProps): JSX.Element {\r\n    return (\r\n        <button\r\n            className='btn btn-sm btn-tertiary'\r\n            onClick={onClick}\r\n            disabled={disabled}\r\n        >\r\n            <i className='icon icon-plus'/>\r\n            <FormattedMessage\r\n                id='admin.access_control.table_editor.add_attribute'\r\n                defaultMessage='Add attribute'\r\n            />\r\n        </button>\r\n    );\r\n}\r\n\r\nexport function HelpText({message, onLearnMoreClick}: HelpTextProps): JSX.Element {\r\n    return (\r\n        <div className='editor__help-text'>\r\n            <Markdown\r\n                message={message}\r\n                options={{mentionHighlight: false}}\r\n            />\r\n            {onLearnMoreClick && (\r\n                <a\r\n                    href='#'\r\n                    className='editor__learn-more'\r\n                    onClick={onLearnMoreClick}\r\n                >\r\n                    <FormattedMessage\r\n                        id='admin.access_control.table_editor.learnMore'\r\n                        defaultMessage='Learn more about creating access expressions with examples.'\r\n                    />\r\n                </a>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useMemo, useState, useEffect, useCallback, useRef} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {\r\n    CheckIcon,\r\n    MenuVariantIcon,\r\n    ChevronDownCircleOutlineIcon,\r\n    EmailOutlineIcon,\r\n    FormatListBulletedIcon,\r\n    LinkVariantIcon,\r\n    PoundIcon,\r\n    InformationOutlineIcon,\r\n    SyncIcon,\r\n    ShieldAlertOutlineIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type IconProps from '@mattermost/compass-icons/components/props';\r\nimport type {UserPropertyField} from '@mattermost/types/properties';\r\n\r\nimport * as Menu from 'components/menu';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport './selector_menus.scss';\r\n\r\n// Define AttributeIcon outside the main component\r\nconst AttributeIcon = (props: IconProps & { attribute?: UserPropertyField }) => {\r\n    const {attribute, ...iconProps} = props;\r\n    if (attribute) {\r\n        const valueType = attribute.attrs?.value_type;\r\n        if (valueType === 'email') {\r\n            return <EmailOutlineIcon {...iconProps}/>;\r\n        }\r\n        if (valueType === 'url') {\r\n            return <LinkVariantIcon {...iconProps}/>;\r\n        }\r\n        if (valueType === 'phone') {\r\n            return <PoundIcon {...iconProps}/>;\r\n        }\r\n\r\n        // If no specific value_type, check the field type\r\n        switch (attribute.type) {\r\n        case 'select':\r\n            return <ChevronDownCircleOutlineIcon {...iconProps}/>;\r\n        case 'multiselect':\r\n            return <FormatListBulletedIcon {...iconProps}/>;\r\n        case 'text':\r\n        default:\r\n            return <MenuVariantIcon {...iconProps}/>;\r\n        }\r\n    }\r\n    return <MenuVariantIcon {...iconProps}/>;\r\n};\r\n\r\ninterface AttributeSelectorProps {\r\n    currentAttribute: string;\r\n    availableAttributes: UserPropertyField[];\r\n    disabled: boolean;\r\n    onChange: (attribute: string) => void;\r\n    menuId: string;\r\n    buttonId: string;\r\n    autoOpen?: boolean;\r\n    onMenuOpened?: () => void;\r\n    enableUserManagedAttributes: boolean;\r\n}\r\n\r\nconst AttributeSelectorMenu = ({currentAttribute, availableAttributes, disabled, onChange, menuId, buttonId, autoOpen = false, onMenuOpened, enableUserManagedAttributes}: AttributeSelectorProps) => {\r\n    const {formatMessage} = useIntl();\r\n    const [filter, setFilter] = useState('');\r\n    const prevAutoOpen = useRef(false);\r\n\r\n    const onFilterChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setFilter(e.target.value);\r\n    }, []); // setFilter is stable\r\n\r\n    const options = useMemo(() => {\r\n        return availableAttributes.filter((attr) => {\r\n            return attr.name.toLowerCase().includes(filter.toLowerCase());\r\n        });\r\n    }, [availableAttributes, filter]);\r\n\r\n    const handleAttributeChange = React.useCallback((attribute: string) => {\r\n        onChange(attribute);\r\n        setFilter(''); // Reset filter after selection\r\n    }, [onChange]); // setFilter is stable, onChange is a dependency\r\n\r\n    const selectedAttributeObject = useMemo(() => {\r\n        return availableAttributes.find((attr) => attr.name === currentAttribute);\r\n    }, [currentAttribute, availableAttributes]);\r\n\r\n    useEffect(() => {\r\n        if (autoOpen && !prevAutoOpen.current) {\r\n            const buttonElement = document.getElementById(buttonId);\r\n            buttonElement?.click();\r\n            if (onMenuOpened) {\r\n                onMenuOpened();\r\n            }\r\n        }\r\n        prevAutoOpen.current = autoOpen;\r\n    }, [autoOpen, buttonId, onMenuOpened]);\r\n\r\n    return (\r\n        <Menu.Container\r\n            menuButton={{\r\n                id: buttonId,\r\n                class: classNames('btn btn-transparent field-selector-menu-button', {\r\n                    disabled,\r\n                }),\r\n                children: (\r\n                    <>\r\n                        <AttributeIcon attribute={selectedAttributeObject}/>\r\n                        {currentAttribute || formatMessage({id: 'admin.access_control.table_editor.selector.select_attribute', defaultMessage: 'Select attribute'})}\r\n                    </>\r\n                ),\r\n                dataTestId: 'attributeSelectorMenuButton',\r\n                disabled,\r\n            }}\r\n            menu={{\r\n                id: menuId,\r\n                'aria-label': 'Select attribute',\r\n                className: 'select-attribute-mui-menu',\r\n            }}\r\n        >\r\n            <Menu.InputItem\r\n                key='filter_attributes'\r\n                id='filter_attributes'\r\n                type='text'\r\n                placeholder={formatMessage({id: 'admin.access_control.table_editor.selector.filter_attributes', defaultMessage: 'Search attributes...'})}\r\n                className='attribute-selector-search'\r\n                value={filter}\r\n                onChange={onFilterChange}\r\n            />\r\n            {options.map((option) => {\r\n                const {name} = option;\r\n                const hasSpaces = name.includes(' ');\r\n                const isSynced = option.attrs?.ldap || option.attrs?.saml;\r\n                const isAdminManaged = option.attrs?.managed === 'admin';\r\n                const allowed = isSynced || isAdminManaged || enableUserManagedAttributes;\r\n\r\n                const menuItem = (\r\n                    <Menu.Item\r\n                        id={`attribute-${name}`}\r\n                        key={name}\r\n                        role='menuitemradio'\r\n                        forceCloseOnSelect={true}\r\n                        aria-checked={name === currentAttribute}\r\n                        onClick={hasSpaces ? undefined : () => handleAttributeChange(name)}\r\n                        labels={<span>{name}</span>}\r\n                        disabled={hasSpaces || !allowed}\r\n                        leadingElement={\r\n                            <AttributeIcon\r\n                                attribute={option}\r\n                                size={18}\r\n                            />\r\n                        }\r\n                        trailingElements={(\r\n                            <>\r\n                                {hasSpaces && (\r\n                                    <InformationOutlineIcon\r\n                                        size={18}\r\n                                    />\r\n                                )}\r\n                                {!allowed && !isSynced && (\r\n                                    <ShieldAlertOutlineIcon\r\n                                        size={18}\r\n                                        color='rgba(var(--center-channel-color-rgb), 0.5)'\r\n                                    />\r\n                                )}\r\n                                {isSynced && (\r\n                                    <SyncIcon\r\n                                        size={18}\r\n                                        color='rgba(var(--center-channel-color-rgb), 0.5)'\r\n                                    />\r\n                                )}\r\n                                {name === currentAttribute &&\r\n                                    <CheckIcon/>\r\n                                }\r\n                            </>\r\n                        )}\r\n                    />\r\n                );\r\n\r\n                // Determine tooltip content based on conditions\r\n                let tooltipContent = null;\r\n                if (hasSpaces) {\r\n                    tooltipContent = formatMessage({\r\n                        id: 'admin.access_control.table_editor.attribute_spaces_not_supported',\r\n                        defaultMessage: 'CEL is not compatible with variable names containing spaces',\r\n                    });\r\n                } else if (!allowed) {\r\n                    tooltipContent = formatMessage({\r\n                        id: 'admin.access_control.table_editor.not_safe_to_use',\r\n                        defaultMessage: 'Values for this attribute are managed by users and should not be used for access control. Please link attribute to AD/LDAP for use in access policies.',\r\n                    });\r\n                } else if (isSynced) {\r\n                    tooltipContent = formatMessage({\r\n                        id: 'admin.access_control.table_editor.attribute_synced',\r\n                        defaultMessage: 'This attribute is synced from an external source',\r\n                    });\r\n                }\r\n\r\n                // Wrap in tooltip if needed\r\n                if (tooltipContent) {\r\n                    return (\r\n                        <WithTooltip\r\n                            key={name}\r\n                            title={tooltipContent}\r\n                        >\r\n                            <div className='menu-item-tooltip-wrapper'>\r\n                                {menuItem}\r\n                            </div>\r\n                        </WithTooltip>\r\n                    );\r\n                }\r\n\r\n                return menuItem;\r\n            })}\r\n        </Menu.Container>\r\n    );\r\n};\r\n\r\nexport default AttributeSelectorMenu;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport type {ComponentType} from 'react';\r\nimport React, {useMemo, useState} from 'react';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {defineMessage, FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport {CheckIcon, ElementOfIcon, EqualIcon, FunctionIcon, NotEqualVariantIcon} from '@mattermost/compass-icons/components';\r\nimport type IconProps from '@mattermost/compass-icons/components/props';\r\nimport type {IDMappedObjects} from '@mattermost/types/utilities';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\nimport {OperatorLabel} from '../shared';\r\nimport './selector_menus.scss';\r\n\r\ninterface OperatorSelectorProps {\r\n    currentOperator: string;\r\n    disabled: boolean;\r\n    onChange: (operator: string) => void;\r\n}\r\n\r\nconst OperatorSelectorMenu = ({currentOperator, disabled, onChange}: OperatorSelectorProps) => {\r\n    const {formatMessage} = useIntl();\r\n    const [filter, setFilter] = useState('');\r\n\r\n    const handleOperatorChange = React.useCallback((descriptor: OperatorDescriptor) => {\r\n        onChange(descriptor.id);\r\n        setFilter('');\r\n    }, [onChange]);\r\n\r\n    const currentOperatorDescriptor = useMemo(() => {\r\n        return getOperatorDescriptor(currentOperator);\r\n    }, [currentOperator]);\r\n\r\n    const CurrentOperatorIcon = currentOperatorDescriptor.icon;\r\n\r\n    const onFilterChange = React.useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setFilter(e.target.value);\r\n    }, []);\r\n\r\n    const filteredOperators = useMemo(() => {\r\n        return Object.values(OPERATOR_DESCRIPTORS).filter((desc) => {\r\n            const label = formatMessage(desc.label);\r\n            return label.toLowerCase().includes(filter.toLowerCase());\r\n        });\r\n    }, [filter, formatMessage]);\r\n\r\n    return (\r\n        <Menu.Container\r\n            menuButton={{\r\n                id: 'operator-selector-button',\r\n                class: classNames('btn btn-transparent field-selector-menu-button', {\r\n                    disabled,\r\n                }),\r\n                children: (\r\n                    <>\r\n                        <CurrentOperatorIcon\r\n                            size={18}\r\n                            color='rgba(var(--center-channel-color-rgb), 0.64)'\r\n                        />\r\n                        <FormattedMessage {...currentOperatorDescriptor.label}/>\r\n                    </>\r\n                ),\r\n                dataTestId: 'operatorSelectorMenuButton',\r\n                disabled,\r\n            }}\r\n            menu={{\r\n                id: 'operator-selector-menu',\r\n                'aria-label': 'Select operator',\r\n                className: 'select-operator-mui-menu',\r\n            }}\r\n        >\r\n            <Menu.InputItem\r\n                key='filter_operators'\r\n                id='filter_operators'\r\n                type='text'\r\n                placeholder={formatMessage({id: 'admin.access_control.table_editor.selector.filter_operators', defaultMessage: 'Search operators...'})}\r\n                className='attribute-selector-search'\r\n                value={filter}\r\n                onChange={onFilterChange}\r\n            />\r\n            {filteredOperators.map((descriptor) => {\r\n                const {id, icon: Icon, label} = descriptor;\r\n\r\n                return (\r\n                    <Menu.Item\r\n                        id={id}\r\n                        key={id}\r\n                        role='menuitemradio'\r\n                        forceCloseOnSelect={true}\r\n                        aria-checked={id === currentOperatorDescriptor.id}\r\n                        onClick={() => handleOperatorChange(descriptor)}\r\n                        labels={<FormattedMessage {...label}/>}\r\n                        leadingElement={<Icon size={18}/>}\r\n                        trailingElements={id === currentOperatorDescriptor.id && (\r\n                            <CheckIcon/>\r\n                        )}\r\n                    />\r\n                );\r\n            })}\r\n        </Menu.Container>\r\n    );\r\n};\r\n\r\nexport default OperatorSelectorMenu;\r\n\r\nconst getOperatorDescriptor = (operatorValue: string): OperatorDescriptor => {\r\n    for (const descriptor of Object.values(OPERATOR_DESCRIPTORS)) {\r\n        if (descriptor.id === operatorValue) {\r\n            return descriptor;\r\n        }\r\n    }\r\n\r\n    return OPERATOR_DESCRIPTORS.is;\r\n};\r\n\r\ntype OperatorDescriptor = {\r\n    id: OperatorLabel;\r\n    icon: ComponentType<IconProps>;\r\n    label: MessageDescriptor;\r\n};\r\n\r\nconst OPERATOR_DESCRIPTORS: IDMappedObjects<OperatorDescriptor> = {\r\n    [OperatorLabel.IS]: {\r\n        id: OperatorLabel.IS,\r\n        icon: EqualIcon,\r\n        label: defineMessage({\r\n            id: 'admin.access_control.table_editor.operator.is',\r\n            defaultMessage: 'is',\r\n        }),\r\n    },\r\n    [OperatorLabel.IS_NOT]: {\r\n        id: OperatorLabel.IS_NOT,\r\n        icon: NotEqualVariantIcon,\r\n        label: defineMessage({\r\n            id: 'admin.access_control.table_editor.operator.is_not',\r\n            defaultMessage: 'is not',\r\n        }),\r\n    },\r\n    [OperatorLabel.IN]: {\r\n        id: OperatorLabel.IN,\r\n        icon: ElementOfIcon,\r\n        label: defineMessage({\r\n            id: 'admin.access_control.table_editor.operator.in',\r\n            defaultMessage: 'in',\r\n        }),\r\n    },\r\n    [OperatorLabel.STARTS_WITH]: {\r\n        id: OperatorLabel.STARTS_WITH,\r\n        icon: FunctionIcon,\r\n        label: defineMessage({\r\n            id: 'admin.access_control.table_editor.operator.starts_with',\r\n            defaultMessage: 'starts with',\r\n        }),\r\n    },\r\n    [OperatorLabel.ENDS_WITH]: {\r\n        id: OperatorLabel.ENDS_WITH,\r\n        icon: FunctionIcon,\r\n        label: defineMessage({\r\n            id: 'admin.access_control.table_editor.operator.ends_with',\r\n            defaultMessage: 'ends with',\r\n        }),\r\n    },\r\n    [OperatorLabel.CONTAINS]: {\r\n        id: OperatorLabel.CONTAINS,\r\n        icon: FunctionIcon,\r\n        label: defineMessage({\r\n            id: 'admin.access_control.table_editor.operator.contains',\r\n            defaultMessage: 'contains',\r\n        }),\r\n    },\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useState, useMemo, useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {CheckIcon, ChevronDownIcon, CloseIcon} from '@mattermost/compass-icons/components';\r\nimport type {PropertyFieldOption} from '@mattermost/types/properties';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\nimport './selector_menus.scss';\r\n\r\n// MultiValueSelector handles selection of multiple values (operator 'in')\r\nconst MultiValueSelector = ({\r\n    values,\r\n    disabled,\r\n    updateValues,\r\n    options = [],\r\n    allowCreateValue = false,\r\n    placeholder,\r\n}: {\r\n    values: string[];\r\n    disabled: boolean;\r\n    updateValues: (values: string[]) => void;\r\n    options?: PropertyFieldOption[];\r\n    allowCreateValue?: boolean;\r\n    placeholder?: string;\r\n}) => {\r\n    const {formatMessage} = useIntl();\r\n    const [filter, setFilter] = useState('');\r\n\r\n    const hasOptions = options.length > 0;\r\n    const actualAllowCreateForMenu = hasOptions ? allowCreateValue : true;\r\n\r\n    // Filter logic for options\r\n    const onFilterChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setFilter(e.target.value);\r\n    }, []);\r\n\r\n    const filteredOptions = useMemo(() => {\r\n        return options.filter((option) => {\r\n            const name = option.name || '';\r\n            return name.toLowerCase().includes(filter.toLowerCase());\r\n        });\r\n    }, [options, filter]);\r\n\r\n    const defaultMultiPlaceholder = formatMessage({\r\n        id: 'admin.access_control.table_editor.values.select_values',\r\n        defaultMessage: 'Select values...',\r\n    });\r\n\r\n    const defaultCreatePlaceholder = formatMessage({\r\n        id: 'admin.access_control.table_editor.values.create_placeholder',\r\n        defaultMessage: 'Type to create value',\r\n    });\r\n\r\n    const handleSelectItem = useCallback((name: string) => {\r\n        const newValues = values.includes(name) ?\r\n            values.filter((v) => v !== name) :\r\n            [...values, name];\r\n        updateValues(newValues);\r\n    }, [values, updateValues]);\r\n\r\n    const handleCreateValue = useCallback((valueToCreate: string) => {\r\n        const trimmedValue = valueToCreate.trim();\r\n        if (!trimmedValue || values.includes(trimmedValue)) {\r\n            return;\r\n        }\r\n        updateValues([...values, trimmedValue]);\r\n        setFilter('');\r\n    }, [values, updateValues]);\r\n\r\n    const handleInputKeyDownForMenu = useCallback((e: React.KeyboardEvent<HTMLInputElement>) => {\r\n        if (e.key !== 'Tab') {\r\n            e.stopPropagation();\r\n        }\r\n\r\n        if (e.key === 'Enter' && actualAllowCreateForMenu && filter.trim()) {\r\n            e.preventDefault();\r\n            handleCreateValue(filter);\r\n        }\r\n    }, [actualAllowCreateForMenu, filter, handleCreateValue]);\r\n\r\n    const handleRemoveValue = useCallback((event: React.MouseEvent<HTMLDivElement> | React.KeyboardEvent<HTMLDivElement>, valueToRemove: string) => {\r\n        event.stopPropagation();\r\n        const newValues = values.filter((v) => v !== valueToRemove);\r\n        updateValues(newValues);\r\n    }, [values, updateValues]);\r\n\r\n    // Memoize cell contents to prevent unnecessary re-renders\r\n    const cellContents = useMemo(() => {\r\n        if (values.length === 0) {\r\n            let visualPlaceholderText = defaultMultiPlaceholder;\r\n            if (actualAllowCreateForMenu && options.length === 0) {\r\n                visualPlaceholderText = defaultCreatePlaceholder;\r\n            }\r\n            const actualTextDisplayed = placeholder || visualPlaceholderText;\r\n            const useStyle = actualTextDisplayed === defaultMultiPlaceholder || actualTextDisplayed === defaultCreatePlaceholder;\r\n\r\n            return (\r\n                <span className={classNames({'value-selector-menu-button__placeholder': useStyle})}>\r\n                    {actualTextDisplayed}\r\n                </span>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='value-selector-menu-button__multi-values-container'>\r\n                {values.map((value) => (\r\n                    <div\r\n                        key={value}\r\n                        className='select__multi-value'\r\n                    >\r\n                        <div className='select__multi-value__label'>{value}</div>\r\n                        {!disabled && (\r\n                            <div\r\n                                className='select__multi-value__remove'\r\n                                onClick={(e) => handleRemoveValue(e, value)}\r\n                                role='button'\r\n                                tabIndex={0}\r\n                                onKeyDown={(e: React.KeyboardEvent<HTMLDivElement>) => {\r\n                                    if (e.key === 'Enter' || e.key === ' ') {\r\n                                        handleRemoveValue(e, value);\r\n                                    }\r\n                                }}\r\n                            >\r\n                                <CloseIcon size={12}/>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        );\r\n    }, [values, disabled]);\r\n\r\n    return (\r\n        <div className='values-editor'>\r\n            <Menu.Container\r\n                menuButton={{\r\n                    id: 'value-selector-button',\r\n                    class: classNames('btn btn-transparent field-selector-menu-button', {\r\n                        disabled,\r\n                    }),\r\n                    children: (\r\n                        <span className='value-selector-menu-button__inner-wrapper'>\r\n                            {cellContents}\r\n                            <ChevronDownIcon\r\n                                size={18}\r\n                                color='rgba(var(--center-channel-color-rgb), 0.5)'\r\n                            />\r\n                        </span>\r\n                    ),\r\n                    dataTestId: 'valueSelectorMenuButton',\r\n                    disabled,\r\n                }}\r\n                menu={{\r\n                    id: 'value-selector-menu',\r\n                    'aria-label': placeholder || defaultMultiPlaceholder,\r\n                    className: 'select-value-mui-menu',\r\n                }}\r\n            >\r\n                <Menu.InputItem\r\n                    key='filter_values'\r\n                    id='filter_values'\r\n                    type='text'\r\n                    placeholder={formatMessage({\r\n                        id: 'admin.access_control.table_editor.selector.filter_or_create',\r\n                        defaultMessage: 'Search or create value...',\r\n                    })}\r\n                    className='attribute-selector-search'\r\n                    value={filter}\r\n                    onChange={onFilterChange}\r\n                    onKeyDown={handleInputKeyDownForMenu}\r\n                />\r\n                {filteredOptions.map((option) => {\r\n                    const name = option.name || '';\r\n                    const id = option.id || name;\r\n                    const isSelected = values.includes(name);\r\n\r\n                    return (\r\n                        <Menu.Item\r\n                            id={`value-option-${id}`}\r\n                            key={id}\r\n                            role='menuitemcheckbox'\r\n                            forceCloseOnSelect={false}\r\n                            aria-checked={isSelected}\r\n                            onClick={() => handleSelectItem(name)}\r\n                            labels={<span>{name}</span>}\r\n                            trailingElements={isSelected && (\r\n                                <CheckIcon/>\r\n                            )}\r\n                        />\r\n                    );\r\n                })}\r\n                {actualAllowCreateForMenu && filter.trim() && !filteredOptions.some((opt) => opt.name === filter.trim()) && (\r\n                    <Menu.Item\r\n                        id='create-value-option'\r\n                        key='create-value-option'\r\n                        onClick={() => handleCreateValue(filter)}\r\n                        labels={<span>\r\n                            {formatMessage({\r\n                                id: 'admin.access_control.table_editor.create_value',\r\n                                defaultMessage: 'Create \"{value}\"',\r\n                            }, {value: filter.trim()})}\r\n                        </span>}\r\n                    />\r\n                )}\r\n            </Menu.Container>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MultiValueSelector;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useState, useMemo, useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {CheckIcon, ChevronDownIcon} from '@mattermost/compass-icons/components';\r\nimport type {PropertyFieldOption} from '@mattermost/types/properties';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\nimport './selector_menus.scss';\r\n\r\n// SingleValueSelector handles selection of a single value (operators like 'is', 'contains', etc.)\r\nconst SingleValueSelector = ({\r\n    value,\r\n    disabled,\r\n    updateValue,\r\n    options = [],\r\n    allowCreateValue = false,\r\n    placeholder,\r\n}: {\r\n    value: string;\r\n    disabled: boolean;\r\n    updateValue: (value: string) => void;\r\n    options?: PropertyFieldOption[];\r\n    allowCreateValue?: boolean;\r\n    placeholder?: string;\r\n}) => {\r\n    const {formatMessage} = useIntl();\r\n    const [filter, setFilter] = useState('');\r\n    const [inputValue, setInputValue] = useState('');\r\n    const [isEditing, setIsEditing] = useState(false);\r\n\r\n    const hasOptions = options.length > 0;\r\n\r\n    // Simple input logic for attributes without options\r\n    const commitInputValue = useCallback(() => {\r\n        const trimmedValue = inputValue.trim();\r\n        if (trimmedValue) {\r\n            updateValue(trimmedValue);\r\n        }\r\n        setInputValue('');\r\n        setIsEditing(false);\r\n    }, [inputValue, updateValue]);\r\n\r\n    const handleKeyDownSimpleInput = useCallback((e: React.KeyboardEvent<HTMLInputElement>) => {\r\n        if (e.key === 'Enter') {\r\n            e.preventDefault();\r\n            commitInputValue();\r\n        }\r\n    }, [commitInputValue]);\r\n\r\n    // Filter logic for options\r\n    const onFilterChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setFilter(e.target.value);\r\n    }, []);\r\n\r\n    const filteredOptions = useMemo(() => {\r\n        return options.filter((option) => {\r\n            const name = option.name || '';\r\n            return name.toLowerCase().includes(filter.toLowerCase());\r\n        });\r\n    }, [options, filter]);\r\n\r\n    const defaultPlaceholder = formatMessage({\r\n        id: 'admin.access_control.table_editor.value.select_value',\r\n        defaultMessage: 'Select value',\r\n    });\r\n\r\n    const handleSelectItem = useCallback((name: string) => {\r\n        updateValue(name);\r\n        setFilter('');\r\n    }, [updateValue]);\r\n\r\n    const handleCreateValue = useCallback((valueToCreate: string) => {\r\n        const trimmedValue = valueToCreate.trim();\r\n        if (trimmedValue) {\r\n            updateValue(trimmedValue);\r\n        }\r\n        setFilter('');\r\n    }, [updateValue]);\r\n\r\n    const handleInputKeyDownForMenu = useCallback((e: React.KeyboardEvent<HTMLInputElement>) => {\r\n        if (e.key !== 'Tab') {\r\n            e.stopPropagation();\r\n        }\r\n\r\n        if (e.key === 'Enter' && allowCreateValue && filter.trim()) {\r\n            e.preventDefault();\r\n            handleCreateValue(filter);\r\n        }\r\n    }, [allowCreateValue, filter, handleCreateValue]);\r\n\r\n    if (!hasOptions) {\r\n        // For attributes without options, show simple input field\r\n        return (\r\n            <div className='values-editor'>\r\n                <input\r\n                    type='text'\r\n                    className='values-editor__simple-input'\r\n                    value={isEditing ? inputValue : value}\r\n                    onChange={(e) => setInputValue(e.target.value)}\r\n                    onKeyDown={handleKeyDownSimpleInput}\r\n                    onFocus={() => {\r\n                        setIsEditing(true);\r\n                        if (value) {\r\n                            setInputValue(value);\r\n                        }\r\n                    }}\r\n                    onBlur={commitInputValue}\r\n                    placeholder={placeholder || formatMessage({\r\n                        id: 'admin.access_control.table_editor.value.placeholder',\r\n                        defaultMessage: 'Add value...',\r\n                    })}\r\n                    disabled={disabled}\r\n                    maxLength={Constants.MAX_CUSTOM_ATTRIBUTE_LENGTH}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // For attributes with options, show dropdown menu\r\n    const actualTextDisplayed = value || placeholder || defaultPlaceholder;\r\n    const useStyle = actualTextDisplayed === defaultPlaceholder;\r\n\r\n    return (\r\n        <div className='values-editor'>\r\n            <Menu.Container\r\n                menuButton={{\r\n                    id: 'value-selector-button',\r\n                    class: classNames('btn btn-transparent field-selector-menu-button', {\r\n                        disabled,\r\n                    }),\r\n                    children: (\r\n                        <span className='value-selector-menu-button__inner-wrapper'>\r\n                            <span\r\n                                className={classNames({'value-selector-menu-button__placeholder': useStyle})}\r\n                            >\r\n                                {actualTextDisplayed}\r\n                            </span>\r\n                            <ChevronDownIcon\r\n                                size={18}\r\n                                color='rgba(var(--center-channel-color-rgb), 0.5)'\r\n                            />\r\n                        </span>\r\n                    ),\r\n                    dataTestId: 'valueSelectorMenuButton',\r\n                    disabled,\r\n                }}\r\n                menu={{\r\n                    id: 'value-selector-menu',\r\n                    'aria-label': placeholder || defaultPlaceholder,\r\n                    className: 'select-value-mui-menu',\r\n                }}\r\n            >\r\n                <Menu.InputItem\r\n                    key='filter_values'\r\n                    id='filter_values'\r\n                    type='text'\r\n                    placeholder={formatMessage({\r\n                        id: 'admin.access_control.table_editor.selector.filter_or_create',\r\n                        defaultMessage: 'Search or create value...',\r\n                    })}\r\n                    className='attribute-selector-search'\r\n                    value={filter}\r\n                    onChange={onFilterChange}\r\n                    onKeyDown={handleInputKeyDownForMenu}\r\n                />\r\n                {filteredOptions.map((option) => {\r\n                    const name = option.name || '';\r\n                    const id = option.id || name;\r\n                    const isSelected = value === name;\r\n\r\n                    return (\r\n                        <Menu.Item\r\n                            id={`value-option-${id}`}\r\n                            key={id}\r\n                            role='menuitemradio'\r\n                            forceCloseOnSelect={true}\r\n                            aria-checked={isSelected}\r\n                            onClick={() => handleSelectItem(name)}\r\n                            labels={<span>{name}</span>}\r\n                            trailingElements={isSelected && (\r\n                                <CheckIcon/>\r\n                            )}\r\n                        />\r\n                    );\r\n                })}\r\n                {allowCreateValue && filter.trim() && !filteredOptions.some((opt) => opt.name === filter.trim()) && (\r\n                    <Menu.Item\r\n                        id='create-value-option'\r\n                        key='create-value-option'\r\n                        onClick={() => handleCreateValue(filter)}\r\n                        labels={<span>\r\n                            {formatMessage({\r\n                                id: 'admin.access_control.table_editor.create_value',\r\n                                defaultMessage: 'Create \"{value}\"',\r\n                            }, {value: filter.trim()})}\r\n                        </span>}\r\n                    />\r\n                )}\r\n            </Menu.Container>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SingleValueSelector;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {PropertyFieldOption} from '@mattermost/types/properties';\r\n\r\nimport MultiValueSelector from './multi_value_selector_menu';\r\nimport SingleValueSelector from './single_value_selector_menu';\r\n\r\nexport interface TableRow {\r\n    attribute: string;\r\n    operator: string;\r\n    values: string[];\r\n    attribute_type: string;\r\n}\r\n\r\nexport interface ValueSelectorMenuProps {\r\n    row: TableRow;\r\n    disabled: boolean;\r\n    updateValues: (values: string[]) => void;\r\n    options?: PropertyFieldOption[];\r\n    allowCreateValue?: boolean;\r\n    placeholder?: string;\r\n}\r\n\r\n// Main ValueSelectorMenu component that delegates to the appropriate selector\r\nconst ValueSelectorMenu = ({\r\n    row,\r\n    disabled,\r\n    updateValues,\r\n    options = [],\r\n    allowCreateValue = false,\r\n    placeholder,\r\n}: ValueSelectorMenuProps) => {\r\n    const isMultiOperator = row.operator === 'in';\r\n\r\n    if (isMultiOperator) {\r\n        return (\r\n            <MultiValueSelector\r\n                values={row.values}\r\n                disabled={disabled}\r\n                updateValues={updateValues}\r\n                options={options}\r\n                allowCreateValue={allowCreateValue}\r\n                placeholder={placeholder}\r\n            />\r\n        );\r\n    }\r\n\r\n    // For single-value operators\r\n    return (\r\n        <SingleValueSelector\r\n            value={row.values[0] || ''}\r\n            disabled={disabled}\r\n            updateValue={(value) => updateValues([value])}\r\n            options={options}\r\n            allowCreateValue={allowCreateValue}\r\n            placeholder={placeholder}\r\n        />\r\n    );\r\n};\r\n\r\nexport default ValueSelectorMenu;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState, useEffect, useCallback} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport type {AccessControlVisualAST} from '@mattermost/types/access_control';\r\nimport type {UserPropertyField} from '@mattermost/types/properties';\r\n\r\nimport {searchUsersForExpression} from 'mattermost-redux/actions/access_control';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AttributeSelectorMenu from './attribute_selector_menu';\r\nimport OperatorSelectorMenu from './operator_selector_menu';\r\nimport type {TableRow} from './value_selector_menu';\r\nimport ValueSelectorMenu from './value_selector_menu';\r\n\r\nimport CELHelpModal from '../../modals/cel_help/cel_help_modal';\r\nimport TestResultsModal from '../../modals/policy_test/test_modal';\r\nimport {AddAttributeButton, TestButton, HelpText, OPERATOR_CONFIG, OPERATOR_LABELS, OperatorLabel} from '../shared';\r\n\r\nimport './table_editor.scss';\r\n\r\ninterface TableEditorProps {\r\n    value: string;\r\n    onChange: (value: string) => void;\r\n    onValidate?: (isValid: boolean) => void;\r\n    disabled?: boolean;\r\n    userAttributes: UserPropertyField[];\r\n    enableUserManagedAttributes: boolean;\r\n    onParseError: (error: string) => void;\r\n    channelId?: string; // Optional channelId for channel-specific context\r\n    actions: {\r\n        getVisualAST: (expr: string) => Promise<ActionResult>;\r\n    };\r\n}\r\n\r\n// Finds the first available (non-disabled) attribute from a list of user attributes.\r\n// An attribute is considered available if it doesn't have spaces in its name (CEL incompatible)\r\n// and is considered \"safe\" (synced from LDAP/SAML, admin-managed, OR enableUserManagedAttributes is true).\r\nexport const findFirstAvailableAttributeFromList = (\r\n    userAttributes: UserPropertyField[],\r\n    enableUserManagedAttributes: boolean,\r\n): UserPropertyField | undefined => {\r\n    return userAttributes.find((attr) => {\r\n        const hasSpaces = attr.name.includes(' ');\r\n        const isSynced = attr.attrs?.ldap || attr.attrs?.saml;\r\n        const isAdminManaged = attr.attrs?.managed === 'admin';\r\n        const allowed = isSynced || isAdminManaged || enableUserManagedAttributes;\r\n        return !hasSpaces && allowed;\r\n    });\r\n};\r\n\r\n// Parses a CEL (Common Expression Language) string into a structured array of TableRow objects.\r\n// This allows the expression to be displayed and edited in a user-friendly table format.\r\nexport const parseExpression = (visualAST: AccessControlVisualAST): TableRow[] => {\r\n    const tableRows: TableRow[] = [];\r\n\r\n    if (!visualAST) {\r\n        return tableRows;\r\n    }\r\n\r\n    for (const node of visualAST.conditions) {\r\n        let attr;\r\n\r\n        // Extracts the attribute name, removing the 'user.attributes.' prefix.\r\n        if (node.attribute.startsWith('user.attributes.')) {\r\n            attr = node.attribute.slice(16); // Length of 'user.attributes.'\r\n        } else {\r\n            throw new Error(`Unknown attribute: ${node.attribute}`);\r\n        }\r\n\r\n        let op = OPERATOR_LABELS[node.operator];\r\n        if (!op) {\r\n            // Fallback for unknown operators, defaulting to 'is' logic\r\n            op = OperatorLabel.IS;\r\n        }\r\n\r\n        let values;\r\n        if (Array.isArray(node.value)) {\r\n            values = node.value;\r\n        } else {\r\n            values = [node.value];\r\n        }\r\n\r\n        tableRows.push({\r\n            attribute: attr,\r\n            operator: op,\r\n            values,\r\n            attribute_type: node.attribute_type,\r\n        });\r\n    }\r\n\r\n    return tableRows;\r\n};\r\n\r\n// TableEditor provides a user-friendly table interface for constructing and editing\r\n// CEL (Common Expression Language) expressions based on user attributes.\r\n// It parses incoming CEL expressions into rows and reconstructs the expression upon changes.\r\n// The biggest limitation is that all expressions are ANDed together, so it's not possible to\r\n// have OR logic.\r\nfunction TableEditor({\r\n    value,\r\n    onChange,\r\n    onValidate,\r\n    disabled = false,\r\n    userAttributes,\r\n    enableUserManagedAttributes,\r\n    onParseError,\r\n    channelId,\r\n    actions,\r\n}: TableEditorProps): JSX.Element {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const [rows, setRows] = useState<TableRow[]>([]);\r\n    const [showTestResults, setShowTestResults] = useState(false);\r\n    const [showHelpModal, setShowHelpModal] = useState(false);\r\n    const [autoOpenAttributeMenuForRow, setAutoOpenAttributeMenuForRow] = useState<number | null>(null);\r\n\r\n    // Effect to parse the incoming CEL expression string (value prop)\r\n    // and update the internal rows state. Handles errors during parsing.\r\n    useEffect(() => {\r\n        // Skip parsing if no expression to avoid unnecessary API calls\r\n        if (!value || value.trim() === '') {\r\n            setRows([]);\r\n            return;\r\n        }\r\n\r\n        actions.getVisualAST(value).then((result) => {\r\n            if (result.error) {\r\n                setRows([]);\r\n\r\n                // Only call onParseError for actual parsing errors, not permission errors\r\n                if (!result.error.message?.includes('403') && !result.error.message?.includes('Forbidden')) {\r\n                    onParseError(result.error.message);\r\n                }\r\n                return;\r\n            }\r\n\r\n            setRows(parseExpression(result.data));\r\n        }).catch((err) => {\r\n            setRows([]);\r\n            if (onValidate) {\r\n                onValidate(false);\r\n            }\r\n\r\n            // Only call onParseError for actual parsing errors, not permission errors\r\n            if (!err.message?.includes('403') && !err.message?.includes('Forbidden')) {\r\n                onParseError(err.message);\r\n            }\r\n        });\r\n    }, [value]);\r\n\r\n    // Converts the internal rows state back into a CEL expression string\r\n    // and calls the onChange and onValidate props.\r\n    const updateExpression = useCallback((newRows: TableRow[]) => {\r\n        const rowsThatCanFormExpressions = newRows.filter((row) => row.attribute); // Only include rows that have an attribute selected\r\n\r\n        const expr = rowsThatCanFormExpressions.map((row) => {\r\n            const attributeExpr = `user.attributes.${row.attribute}`;\r\n            const config = OPERATOR_CONFIG[row.operator];\r\n\r\n            // Find the attribute object to check its type\r\n            const attributeObj = userAttributes.find((attr) => attr.name === row.attribute);\r\n\r\n            if (!config) {\r\n                // Fallback for unknown operators, defaulting to 'in' logic\r\n                // This handles cases where row.operator might be an unexpected string.\r\n                const valuesStr = row.values.map((val: string) => `\"${val}\"`).join(', ');\r\n\r\n                // For multiselect, reverse the order since multiselect attributes can contain multiple values\r\n                if (attributeObj?.type === 'multiselect') {\r\n                    return `[${valuesStr}] in ${attributeExpr}`;\r\n                }\r\n                return `${attributeExpr} in [${valuesStr}]`;\r\n            }\r\n\r\n            if (config.type === 'list') { // Handles 'in'\r\n                const valuesStr = row.values.map((val: string) => `\"${val}\"`).join(', ');\r\n\r\n                // For multiselect, reverse the order since multiselect attributes can contain multiple values\r\n                if (attributeObj?.type === 'multiselect') {\r\n                    return `[${valuesStr}] ${config.celOp} ${attributeExpr}`;\r\n                }\r\n                return `${attributeExpr} ${config.celOp} [${valuesStr}]`;\r\n            }\r\n\r\n            // For 'comparison' and 'method' types, they operate on a single value.\r\n            const value = row.values.length > 0 ? row.values[0] : '';\r\n\r\n            if (config.type === 'comparison') {\r\n                return `${attributeExpr} ${config.celOp} \"${value}\"`;\r\n            }\r\n\r\n            // config.type must be 'method'\r\n            return `${attributeExpr}.${config.celOp}(\"${value}\")`;\r\n        }).join(' && ');\r\n\r\n        onChange(expr);\r\n        if (onValidate) {\r\n            // Basic validation: if we can build an expression, or if the expression is empty\r\n            // (e.g. no rows, or rows without attributes yet), it's valid from table perspective.\r\n            onValidate(expr === '' || rowsThatCanFormExpressions.length > 0);\r\n        }\r\n    }, [onChange, onValidate, userAttributes]);\r\n\r\n    // Helper function to find the first available (non-disabled) attribute\r\n    const findFirstAvailableAttribute = useCallback(() => {\r\n        return findFirstAvailableAttributeFromList(userAttributes, enableUserManagedAttributes);\r\n    }, [userAttributes, enableUserManagedAttributes]);\r\n\r\n    // Row Manipulation Handlers\r\n    const addRow = useCallback(() => {\r\n        if (userAttributes.length === 0) {\r\n            // Show a helpful message instead of silently failing\r\n            onParseError('No user attributes available. Please ensure ABAC is properly configured and you have the necessary permissions.');\r\n            return;\r\n        }\r\n\r\n        const firstAvailableAttribute = findFirstAvailableAttribute();\r\n        if (!firstAvailableAttribute) {\r\n            onParseError('No available user attributes found for rule creation.');\r\n            return;\r\n        }\r\n\r\n        setRows((currentRows) => {\r\n            const newRow = {\r\n                attribute: firstAvailableAttribute.name, // Default to the first available attribute\r\n                operator: OperatorLabel.IS, // Default operator\r\n                values: [],\r\n                attribute_type: userAttributes[0]?.type || '',\r\n            };\r\n            const newRows = [...currentRows, newRow];\r\n            updateExpression(newRows); // Ensure expression is updated immediately\r\n            setAutoOpenAttributeMenuForRow(newRows.length - 1); // Set for the new row\r\n            return newRows;\r\n        });\r\n    }, [userAttributes, updateExpression, findFirstAvailableAttribute]);\r\n\r\n    const removeRow = useCallback((index: number) => {\r\n        setRows((currentRows) => {\r\n            const newRows = currentRows.toSpliced(index, 1);\r\n            updateExpression(newRows);\r\n            return newRows;\r\n        });\r\n    }, [updateExpression]);\r\n\r\n    const updateRowAttribute = useCallback((index: number, attribute: string) => {\r\n        setRows((currentRows) => {\r\n            const newRows = [...currentRows];\r\n            const oldAttribute = newRows[index].attribute;\r\n            newRows[index] = {...newRows[index], attribute};\r\n\r\n            // If attribute changes, we are resetting values.\r\n            if (oldAttribute !== attribute) {\r\n                newRows[index].values = [];\r\n                newRows[index].operator = OperatorLabel.IS;\r\n            }\r\n            updateExpression(newRows);\r\n            return newRows;\r\n        });\r\n    }, [updateExpression]);\r\n\r\n    const updateRowOperator = useCallback((index: number, newOperator: string) => {\r\n        setRows((currentRows) => {\r\n            const oldOperator = currentRows[index].operator;\r\n            let newValues = [...currentRows[index].values]; // Start with a copy of current values\r\n\r\n            if (newOperator === OperatorLabel.IN && oldOperator !== OperatorLabel.IN) {\r\n                // Transitioning TO 'in' FROM a non-'in' (likely single-value) operator:\r\n                // Trim each value and then filter out any that become empty strings.\r\n                newValues = newValues.map((v) => v.trim()).filter((v) => v !== '');\r\n            } else if (newOperator !== OperatorLabel.IN) {\r\n                // Transitioning TO a non-'in' (single-value) operator (or staying as one):\r\n                // If there are multiple values (e.g., coming from 'in'), take only the first one.\r\n                if (newValues.length > 1) {\r\n                    newValues = [newValues[0]];\r\n                }\r\n            }\r\n\r\n            const newRows = [...currentRows];\r\n            newRows[index] = {\r\n                ...currentRows[index],\r\n                operator: newOperator,\r\n                values: newValues,\r\n            };\r\n\r\n            updateExpression(newRows);\r\n            return newRows;\r\n        });\r\n    }, [updateExpression]);\r\n\r\n    const updateRowValues = useCallback((index: number, values: string[]) => {\r\n        setRows((currentRows) => {\r\n            const newRows = [...currentRows];\r\n            newRows[index] = {...newRows[index], values};\r\n            updateExpression(newRows);\r\n            return newRows;\r\n        });\r\n    }, [updateExpression]);\r\n\r\n    return (\r\n        <div className='table-editor'>\r\n            <table className='table-editor__table'>\r\n                <thead>\r\n                    <tr className='table-editor__header-row'>\r\n                        <th className='table-editor__column-header'>\r\n                            <FormattedMessage\r\n                                id='admin.access_control.table_editor.attribute'\r\n                                defaultMessage='Attribute'\r\n                            />\r\n                        </th>\r\n                        <th className='table-editor__column-header'>\r\n                            <FormattedMessage\r\n                                id='admin.access_control.table_editor.operator'\r\n                                defaultMessage='Operator'\r\n                            />\r\n                        </th>\r\n                        <th className='table-editor__column-header'>\r\n                            <span className='table-editor__column-header-value'>\r\n                                <FormattedMessage\r\n                                    id='admin.access_control.table_editor.values'\r\n                                    defaultMessage='Values'\r\n                                />\r\n                            </span>\r\n                        </th>\r\n                        <th className='table-editor__column-header-actions'/>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    {rows.length === 0 ? (\r\n                        <tr>\r\n                            <td\r\n                                colSpan={4}\r\n                                className='table-editor__blank-state'\r\n                            >\r\n                                <span>\r\n                                    {formatMessage({\r\n                                        id: 'admin.access_control.table_editor.blank_state',\r\n                                        defaultMessage: 'Select a user attribute and values to create a rule',\r\n                                    })}\r\n                                </span>\r\n                            </td>\r\n                        </tr>\r\n                    ) : (\r\n                        rows.map((row, index) => (\r\n                            <tr\r\n                                key={index}\r\n                                className='table-editor__row'\r\n                            >\r\n                                <td className='table-editor__cell'>\r\n                                    <AttributeSelectorMenu\r\n                                        currentAttribute={row.attribute}\r\n                                        availableAttributes={userAttributes}\r\n                                        disabled={disabled}\r\n                                        onChange={(attribute) => updateRowAttribute(index, attribute)}\r\n                                        menuId={`attribute-selector-menu-${index}`}\r\n                                        buttonId={`attribute-selector-button-${index}`}\r\n                                        autoOpen={index === autoOpenAttributeMenuForRow}\r\n                                        onMenuOpened={() => setAutoOpenAttributeMenuForRow(null)}\r\n                                        enableUserManagedAttributes={enableUserManagedAttributes}\r\n                                    />\r\n                                </td>\r\n                                <td className='table-editor__cell'>\r\n                                    <OperatorSelectorMenu\r\n                                        currentOperator={row.operator}\r\n                                        disabled={disabled}\r\n                                        onChange={(operator) => updateRowOperator(index, operator)}\r\n                                    />\r\n                                </td>\r\n                                <td className='table-editor__cell'>\r\n                                    <ValueSelectorMenu\r\n                                        row={row}\r\n                                        disabled={disabled}\r\n                                        updateValues={(values: string[]) => updateRowValues(index, values)}\r\n                                        options={row.attribute ? userAttributes.find((attr) => attr.name === row.attribute)?.attrs?.options || [] : []}\r\n                                    />\r\n                                </td>\r\n                                <td className='table-editor__cell-actions'>\r\n                                    <button\r\n                                        type='button'\r\n                                        className='table-editor__row-remove'\r\n                                        onClick={() => removeRow(index)}\r\n                                        disabled={disabled}\r\n                                        aria-label={formatMessage({id: 'admin.access_control.table_editor.remove_row', defaultMessage: 'Remove row'})}\r\n                                    >\r\n                                        <i className='icon icon-trash-can-outline'/>\r\n                                    </button>\r\n                                </td>\r\n                            </tr>\r\n                        ))\r\n                    )}\r\n                </tbody>\r\n                <tfoot>\r\n                    <tr>\r\n                        <td\r\n                            colSpan={4}\r\n                            className='table-editor__add-button-container'\r\n                        >\r\n                            <AddAttributeButton\r\n                                onClick={addRow}\r\n                                disabled={disabled || userAttributes.length === 0}\r\n                            />\r\n                        </td>\r\n                    </tr>\r\n                </tfoot>\r\n            </table>\r\n\r\n            <div className='table-editor__actions-row'>\r\n                <HelpText\r\n                    message={formatMessage({\r\n                        id: 'admin.access_control.table_editor.help_text',\r\n                        defaultMessage: 'Each row is a single condition that must be met for a user to comply with the policy. All rules are combined with logical AND operator (`&&`).',\r\n                    })}\r\n                />\r\n                <TestButton\r\n                    onClick={() => setShowTestResults(true)}\r\n                    disabled={disabled || !value}\r\n                />\r\n            </div>\r\n\r\n            {showTestResults && (\r\n                <TestResultsModal\r\n                    onExited={() => setShowTestResults(false)}\r\n                    actions={{\r\n                        openModal: () => {},\r\n                        searchUsers: (term: string, after: string, limit: number) => {\r\n                            // Return the action for the modal to dispatch\r\n                            return searchUsersForExpression(value, term, after, limit, channelId);\r\n                        },\r\n                    }}\r\n                />\r\n            )}\r\n            {showHelpModal && (\r\n                <CELHelpModal\r\n                    onExited={() => setShowHelpModal(false)}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default TableEditor;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\n\r\nimport ExternalLink from 'components/external_link';\r\nimport Markdown from 'components/markdown';\r\n\r\nimport './cel_help_modal.scss';\r\n\r\ntype Props = {\r\n    onExited: () => void;\r\n    onHide?: () => void;\r\n};\r\n\r\nconst CELHelpModal: React.FC<Props> = ({onExited, onHide}: Props) => {\r\n    return (\r\n        <GenericModal\r\n            id='CELHelpModal'\r\n            className='cel-help-modal--centered'\r\n            aria-labelledby='CELHelpModalLabel'\r\n            onExited={onExited}\r\n            onHide={onHide}\r\n            modalHeaderText={(\r\n                <FormattedMessage\r\n                    id='admin.access_control.cel_help_modal.title'\r\n                    defaultMessage='Common Expression Language (CEL)'\r\n                />\r\n            )}\r\n            modalSubheaderText={(\r\n                <FormattedMessage\r\n                    id='admin.access_control.cel_help_modal.subheader'\r\n                    defaultMessage='With CEL you can define conditions to filter user attributes and control resource access.'\r\n                />\r\n            )}\r\n            compassDesign={true}\r\n            bodyPadding={false}\r\n            modalLocation='top'\r\n        >\r\n            <div className='cel-help-modal__content-container'>\r\n                <div className='cel-help-modal__content'>\r\n                    <Markdown\r\n                        message={'### Basic Syntax\\nCEL expressions evaluate to boolean values (`true`/`false`) to determine if access should be granted.\\n### Common Examples\\n- To match a specific program:\\n&ensp;`user.attributes.Program == \"Delta\"`\\n- To match any of multiple teams:\\n&ensp;`user.attributes.Team in [\"Sales\", \"Engineering\"]`\\n- To match an email domain:\\n&ensp;`user.attributes.Email.endsWith(\"example.com\")`\\n- To combine conditions (for this example with `OR` operator, altertanitvely use `&&` for `AND` operation):\\n&ensp;`user.attrs.Program == \"Alpha\" || user.attrs.Team == \"Operations\"`\\n### Supported Operators and functions\\n- `==`, `!=`, `&&`, `||`, `in`, `contains()`, `startsWith()`, `endsWith()`'}\r\n                    />\r\n                </div>\r\n                <div className='cel-help-additional-info-modal__content'>\r\n                    <div className='cel-help-additional-info-modal__header'>\r\n                        <i className='icon icon-information-outline'/>\r\n                        <span className='cel-help-additional-info-modal__title'>\r\n                            <FormattedMessage\r\n                                id='admin.access_control.cel_help_modal.important_notes_title'\r\n                                defaultMessage='Important Notes'\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    <div className='cel-help-additional-info-modal__text'>\r\n                        <Markdown\r\n                            message={'- Operators like `<` or `>` are forbidden due to incorrect string comparison.\\n- Only `user.attributes` are supported; any other variables are not supported yet.'}\r\n                        />\r\n                        <FormattedMessage\r\n                            id='admin.access_control.cel_help_modal.external_link'\r\n                            defaultMessage='For more information, visit <link>CEL Documentation</link>.'\r\n                            values={{\r\n                                link: (msg: React.ReactNode) => (\r\n                                    <ExternalLink\r\n                                        href='https://cel.dev/'\r\n                                        location='cel_help_modal'\r\n                                    >\r\n                                        {msg}\r\n                                    </ExternalLink>\r\n                                ),\r\n                            }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </GenericModal>\r\n    );\r\n};\r\n\r\nexport default CELHelpModal;\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState, useCallback} from 'react';\r\nimport {Modal} from 'react-bootstrap';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport type {AccessControlTestResult} from '@mattermost/types/access_control';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport SearchableUserList from 'components/searchable_user_list/searchable_user_list_container';\r\n\r\nimport type {ModalData} from 'types/actions';\r\nimport type {ActionFuncAsync} from 'types/store';\r\n\r\nimport './test_modal.scss';\r\n\r\nconst USERS_TO_FETCH = 50;\r\nconst USERS_PER_PAGE = 10;\r\n\r\ntype Props = {\r\n    onExited: () => void;\r\n    actions: {\r\n        searchUsers: (term: string, after: string, limit: number) => ActionFuncAsync<AccessControlTestResult>;\r\n        openModal?: <P>(modalData: ModalData<P>) => void;\r\n    };\r\n}\r\n\r\nfunction TestResultsModal({\r\n    onExited,\r\n    actions,\r\n}: Props): JSX.Element {\r\n    const dispatch = useDispatch<any>();\r\n    const [term, setTerm] = useState<string>('');\r\n    const [users, setUsers] = useState<UserProfile[]>([]);\r\n    const [total, setTotal] = useState<number>(0);\r\n    const [loading, setLoading] = useState<boolean>(true);\r\n    const [cursorHistory, setCursorHistory] = useState<string[]>([]); // Stores the 'after' cursor for page 1, page 2, etc.\r\n\r\n    const fetchUsers = useCallback(async (searchTerm: string, cursor: string, reset: boolean = false) => {\r\n        setLoading(true);\r\n        const result: ActionResult<AccessControlTestResult> = await dispatch(actions.searchUsers(searchTerm, cursor, USERS_TO_FETCH));\r\n        if (result?.data) {\r\n            const newUsers = result.data.users;\r\n            if (reset) {\r\n                setUsers(newUsers);\r\n            } else {\r\n                setUsers((prevUsers) => [...prevUsers, ...newUsers]);\r\n            }\r\n            setTotal(result.data.total);\r\n        } else {\r\n            setUsers([]);\r\n            setTotal(0);\r\n        }\r\n        setLoading(false);\r\n    }, [dispatch, actions]);\r\n\r\n    useEffect(() => {\r\n        fetchUsers(term, '');\r\n    }, []);\r\n\r\n    const handleSearch = (newTerm: string) => {\r\n        setCursorHistory([]);\r\n        setTerm(newTerm);\r\n        fetchUsers(newTerm, '', true);\r\n    };\r\n\r\n    const handleNextPage = (page: number) => {\r\n        if (loading || !users.length) {\r\n            return;\r\n        }\r\n        if (page * USERS_PER_PAGE < USERS_TO_FETCH) {\r\n            return;\r\n        }\r\n        const cursorForNextPage = users[users.length - 1].id;\r\n        setCursorHistory([...cursorHistory, cursorForNextPage]);\r\n        fetchUsers(term, cursorForNextPage);\r\n    };\r\n\r\n    return (\r\n        <Modal\r\n            dialogClassName='a11y__modal more-modal TestResultsModal'\r\n            show={true}\r\n            onHide={onExited}\r\n            role='none'\r\n            aria-labelledby='testResultsModalLabel'\r\n            id='testResultsModal'\r\n        >\r\n            <Modal.Header\r\n                closeButton={true}\r\n                style={{display: 'flex', alignItems: 'center'}}\r\n            >\r\n                <Modal.Title\r\n                    componentClass='h1'\r\n                    id='testResultsModalLabel'\r\n                >\r\n                    <FormattedMessage\r\n                        id='admin.access_control.testResults'\r\n                        defaultMessage='Access Rule Test Results'\r\n                    />\r\n                </Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <SearchableUserList\r\n                    users={users}\r\n                    usersPerPage={USERS_PER_PAGE}\r\n                    total={total}\r\n                    nextPage={handleNextPage}\r\n                    search={handleSearch}\r\n                    actionUserProps={{}}\r\n                />\r\n            </Modal.Body>\r\n        </Modal>\r\n    );\r\n}\r\n\r\nexport default TestResultsModal;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, defineMessages} from 'react-intl';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\n\r\ntype Props = {\r\n\r\n    /*\r\n     * Bool whether the modal is shown\r\n     */\r\n    show: boolean;\r\n\r\n    /*\r\n     * Action to call on confirm\r\n     */\r\n    onConfirm: (checked: boolean) => void;\r\n\r\n    /*\r\n     * Action to call on cancel\r\n     */\r\n    onCancel: (checked: boolean) => void;\r\n\r\n    /*\r\n     * Channel display name\r\n     */\r\n    displayName: string;\r\n\r\n    /*\r\n     * Channel privacy setting\r\n     */\r\n    toPublic: boolean;\r\n};\r\n\r\nconst ConvertConfirmModal = ({show, onConfirm, onCancel, displayName, toPublic}: Props) => {\r\n    let titleMessage;\r\n    let convertMessage;\r\n    let confirmMessage;\r\n    let convertConfirmationMessage;\r\n    if (toPublic) {\r\n        titleMessage = messages.toPublicTitle;\r\n        convertMessage = messages.toPublicMessage;\r\n        confirmMessage = messages.toPublicConfirm;\r\n        convertConfirmationMessage = messages.toPublicMessageConfirmation;\r\n    } else {\r\n        titleMessage = messages.toPrivateTitle;\r\n        convertMessage = messages.toPrivateMessage;\r\n        confirmMessage = messages.toPrivateConfirm;\r\n        convertConfirmationMessage = messages.toPrivateMessageConfirmation;\r\n    }\r\n\r\n    const title = (\r\n        <FormattedMessage\r\n            {...titleMessage}\r\n            values={{displayName}}\r\n        />\r\n    );\r\n\r\n    const message = (\r\n        <>\r\n            <p>\r\n                <FormattedMessage\r\n                    {...convertMessage}\r\n                    values={{displayName: <strong>{displayName}</strong>}}\r\n                />\r\n            </p>\r\n            <p>\r\n                <FormattedMessage\r\n                    {...convertConfirmationMessage}\r\n                    values={{displayName: <strong>{displayName}</strong>}}\r\n                />\r\n            </p>\r\n        </>\r\n    );\r\n\r\n    const confirmButton = (\r\n        <FormattedMessage\r\n            {...confirmMessage}\r\n        />\r\n    );\r\n\r\n    const cancelButton = (\r\n        <FormattedMessage\r\n            id='admin.team_channel_settings.convertConfirmModal.cancel'\r\n            defaultMessage='No, cancel'\r\n        />\r\n    );\r\n\r\n    const modalClass = 'discard-changes-modal';\r\n\r\n    return (\r\n        <ConfirmModal\r\n            show={show}\r\n            title={title}\r\n            message={message}\r\n            modalClass={modalClass}\r\n            confirmButtonClass={'btn btn-primary'}\r\n            confirmButtonText={confirmButton}\r\n            cancelButtonText={cancelButton}\r\n            onConfirm={onConfirm}\r\n            onCancel={onCancel}\r\n        />\r\n    );\r\n};\r\n\r\nconst messages = defineMessages({\r\n    toPrivateConfirm: {\r\n        id: 'admin.team_channel_settings.convertConfirmModal.toPrivateConfirm',\r\n        defaultMessage: 'Yes, convert to private channel',\r\n    },\r\n    toPrivateMessage: {\r\n        id: 'admin.team_channel_settings.convertConfirmModal.toPrivateMessageFirstLine',\r\n        defaultMessage: 'When you convert {displayName} to a private channel, history and membership are preserved. Publicly shared files remain accessible to anyone with the link. Membership in a private channel is by invitation only.',\r\n    },\r\n    toPrivateMessageConfirmation: {\r\n        id: 'admin.team_channel_settings.convertConfirmModal.toPrivateMessageSecondLine',\r\n        defaultMessage: 'Are you sure you want to convert {displayName} to a private channel?',\r\n    },\r\n    toPrivateTitle: {\r\n        id: 'admin.team_channel_settings.convertConfirmModal.toPrivateTitle',\r\n        defaultMessage: 'Convert {displayName} to a private channel?',\r\n    },\r\n    toPublicConfirm: {\r\n        id: 'admin.team_channel_settings.convertConfirmModal.toPublicConfirm',\r\n        defaultMessage: 'Yes, convert to public channel',\r\n    },\r\n    toPublicMessage: {\r\n        id: 'admin.team_channel_settings.convertConfirmModal.toPublicMessageFirstLine',\r\n        defaultMessage: 'When you convert {displayName} to a public channel, history and membership are preserved. Public channels are discoverable and can be joined by users on the system without invitation.',\r\n    },\r\n    toPublicMessageConfirmation: {\r\n        id: 'admin.team_channel_settings.convertConfirmModal.toPublicMessageSecondLine',\r\n        defaultMessage: 'Are you sure you want to convert {displayName} to a public channel?',\r\n    },\r\n    toPublicTitle: {\r\n        id: 'admin.team_channel_settings.convertConfirmModal.toPublicTitle',\r\n        defaultMessage: 'Convert {displayName} to a public channel?',\r\n    },\r\n});\r\n\r\nexport default ConvertConfirmModal;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {ChromePicker} from 'react-color';\r\nimport type {ColorResult} from 'react-color';\r\nimport tinycolor from 'tinycolor2';\r\n\r\ntype Props = {\r\n    id: string;\r\n    onChange: (color: string) => void;\r\n    value: string;\r\n    isDisabled?: boolean;\r\n}\r\n\r\ntype State = {\r\n    focused: boolean;\r\n    isOpened: boolean;\r\n    value: string;\r\n}\r\n\r\nexport default class ColorInput extends React.PureComponent<Props, State> {\r\n    private colorPicker: React.RefObject<HTMLDivElement>;\r\n    private colorInput: React.RefObject<HTMLInputElement>;\r\n\r\n    public constructor(props: Props) {\r\n        super(props);\r\n        this.colorPicker = React.createRef();\r\n        this.colorInput = React.createRef();\r\n\r\n        this.state = {\r\n            focused: false,\r\n            isOpened: false,\r\n            value: props.value,\r\n        };\r\n    }\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        if (!state.focused && props.value !== state.value) {\r\n            return {\r\n                value: props.value,\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    public componentDidUpdate(prevProps: Props, prevState: State) {\r\n        const {isOpened: prevIsOpened} = prevState;\r\n        const {isOpened} = this.state;\r\n\r\n        if (isOpened !== prevIsOpened) {\r\n            if (isOpened) {\r\n                document.addEventListener('click', this.checkClick, {capture: true});\r\n            } else {\r\n                document.removeEventListener('click', this.checkClick);\r\n            }\r\n        }\r\n    }\r\n\r\n    private checkClick = (e: MouseEvent): void => {\r\n        if (!this.colorPicker.current || !this.colorPicker.current.contains(e.target as Element)) {\r\n            this.setState({isOpened: false});\r\n        }\r\n    };\r\n\r\n    private togglePicker = () => {\r\n        if (!this.state.isOpened && this.colorInput.current) {\r\n            this.colorInput.current.focus();\r\n        }\r\n        this.setState({isOpened: !this.state.isOpened});\r\n    };\r\n\r\n    public handleColorChange = (newColorData: ColorResult) => {\r\n        this.setState({focused: false});\r\n        this.props.onChange(newColorData.hex);\r\n    };\r\n\r\n    private onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        const value = event.target.value;\r\n\r\n        const color = tinycolor(value);\r\n        const normalizedColor = '#' + color.toHex();\r\n\r\n        if (color.isValid()) {\r\n            this.props.onChange(normalizedColor);\r\n        }\r\n\r\n        this.setState({value});\r\n    };\r\n\r\n    private onFocus = (event: React.FocusEvent<HTMLInputElement>): void => {\r\n        this.setState({\r\n            focused: true,\r\n        });\r\n\r\n        if (event.target) {\r\n            event.target.setSelectionRange(1, event.target.value.length);\r\n        }\r\n    };\r\n\r\n    private onBlur = () => {\r\n        const value = this.state.value;\r\n\r\n        const color = tinycolor(value);\r\n        const normalizedColor = '#' + color.toHex();\r\n\r\n        if (color.isValid()) {\r\n            this.props.onChange(normalizedColor);\r\n\r\n            this.setState({\r\n                value: normalizedColor,\r\n            });\r\n        } else {\r\n            this.setState({\r\n                value: this.props.value,\r\n            });\r\n        }\r\n\r\n        this.setState({\r\n            focused: false,\r\n        });\r\n    };\r\n\r\n    private onKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\r\n        // open picker on enter or space\r\n        if (event.key === 'Enter' || event.key === ' ') {\r\n            this.togglePicker();\r\n        }\r\n    };\r\n\r\n    public render() {\r\n        const {id} = this.props;\r\n        const {isOpened, value} = this.state;\r\n\r\n        return (\r\n            <div className='color-input input-group'>\r\n                <input\r\n                    id={`${id}-inputColorValue`}\r\n                    ref={this.colorInput}\r\n                    className='form-control'\r\n                    type='text'\r\n                    value={value}\r\n                    onChange={this.onChange}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n                    onKeyDown={this.onKeyDown}\r\n                    maxLength={7}\r\n                    disabled={this.props.isDisabled}\r\n                    data-testid='color-inputColorValue'\r\n\r\n                />\r\n                {!this.props.isDisabled &&\r\n                    <span\r\n                        id={`${id}-squareColorIcon`}\r\n                        className='input-group-addon color-pad'\r\n                        onClick={this.togglePicker}\r\n                    >\r\n                        <i\r\n                            id={`${id}-squareColorIconValue`}\r\n                            className='color-icon'\r\n                            style={{\r\n                                backgroundColor: value,\r\n                            }}\r\n                        />\r\n                    </span>\r\n                }\r\n                {isOpened && (\r\n                    <div\r\n                        ref={this.colorPicker}\r\n                        className='color-popover'\r\n                        id={`${id}-ChromePickerModal`}\r\n                    >\r\n                        <ChromePicker\r\n                            color={value}\r\n                            onChange={this.handleColorChange}\r\n                            disableAlpha={true}\r\n                        />\r\n                    </div>\r\n                )}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useMemo} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport type {AccessControlVisualAST, AccessControlTestResult, AccessControlPolicy} from '@mattermost/types/access_control';\r\nimport type {ChannelMembership} from '@mattermost/types/channels';\r\nimport type {JobTypeBase} from '@mattermost/types/jobs';\r\nimport type {UserPropertyField} from '@mattermost/types/properties';\r\n\r\nimport {\r\n    getAccessControlFields,\r\n    getVisualAST,\r\n    searchUsersForExpression,\r\n    getAccessControlPolicy,\r\n    createAccessControlPolicy,\r\n    updateAccessControlPolicyActive,\r\n    deleteAccessControlPolicy,\r\n    validateExpressionAgainstRequester,\r\n    createAccessControlSyncJob,\r\n} from 'mattermost-redux/actions/access_control';\r\nimport {getChannelMembers} from 'mattermost-redux/actions/channels';\r\nimport {createJob} from 'mattermost-redux/actions/jobs';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nexport interface ChannelAccessControlActions {\r\n    getAccessControlFields: (after: string, limit: number) => Promise<ActionResult<UserPropertyField[]>>;\r\n    getVisualAST: (expression: string) => Promise<ActionResult<AccessControlVisualAST>>;\r\n    searchUsers: (expression: string, term: string, after: string, limit: number) => Promise<ActionResult<AccessControlTestResult>>;\r\n    getChannelPolicy: (channelId: string) => Promise<ActionResult<AccessControlPolicy>>;\r\n    saveChannelPolicy: (policy: AccessControlPolicy) => Promise<ActionResult<AccessControlPolicy>>;\r\n    deleteChannelPolicy: (policyId: string) => Promise<ActionResult>;\r\n    getChannelMembers: (channelId: string, page?: number, perPage?: number) => Promise<ActionResult<ChannelMembership[]>>;\r\n    createJob: (job: JobTypeBase & { data: any }) => Promise<ActionResult>;\r\n    updateAccessControlPolicyActive: (policyId: string, active: boolean) => Promise<ActionResult>;\r\n    validateExpressionAgainstRequester: (expression: string) => Promise<ActionResult<{requester_matches: boolean}>>;\r\n    createAccessControlSyncJob: (jobData: {policy_id: string}) => Promise<ActionResult>;\r\n}\r\n\r\n/**\r\n * Hook that provides access control actions for both System Console and Channel Settings contexts.\r\n * This is a thin wrapper around the existing redux actions that provides:\r\n * - Consistent interface for both system and channel contexts\r\n * - Channel-specific security for channel admin contexts\r\n * - Simplified usage in components without needing to import redux actions directly\r\n * - Improved readability and maintainability of components\r\n * - Easier testing and mocking in unit tests\r\n * - Centralized access control logic for easier updates and changes\r\n * - Single source of truth for ABAC actions for the channel context\r\n *\r\n * @param channelId - Optional channel ID for channel-specific context. Required for channel admin contexts, optional for system admin contexts.\r\n * @returns Object containing access control action functions\r\n */\r\nexport const useChannelAccessControlActions = (channelId?: string): ChannelAccessControlActions => {\r\n    const dispatch = useDispatch();\r\n\r\n    return useMemo(() => ({\r\n\r\n        /**\r\n         * Get available user attribute fields for access control rules\r\n         */\r\n        getAccessControlFields: (after: string, limit: number) => {\r\n            return dispatch(getAccessControlFields(after, limit, channelId));\r\n        },\r\n\r\n        /**\r\n         * Convert a CEL expression to a visual AST for table editor display\r\n         */\r\n        getVisualAST: (expression: string) => {\r\n            return dispatch(getVisualAST(expression, channelId));\r\n        },\r\n\r\n        /**\r\n         * Search users that match a given access control expression\r\n         */\r\n        searchUsers: (expression: string, term: string, after: string, limit: number) => {\r\n            return dispatch(searchUsersForExpression(expression, term, after, limit, channelId));\r\n        },\r\n\r\n        /**\r\n         * Get the access control policy for a specific channel\r\n         */\r\n        getChannelPolicy: (channelId: string) => {\r\n            return dispatch(getAccessControlPolicy(channelId));\r\n        },\r\n\r\n        /**\r\n         * Save or update the access control policy for a channel\r\n         */\r\n        saveChannelPolicy: (policy: AccessControlPolicy) => {\r\n            return dispatch(createAccessControlPolicy(policy));\r\n        },\r\n\r\n        /**\r\n         * Delete the access control policy for a channel\r\n         */\r\n        deleteChannelPolicy: (policyId: string) => {\r\n            return dispatch(deleteAccessControlPolicy(policyId));\r\n        },\r\n\r\n        /**\r\n         * Get channel members for a specific channel\r\n         */\r\n        getChannelMembers: (channelId: string, page = 0, perPage = 200) => {\r\n            return dispatch(getChannelMembers(channelId, page, perPage));\r\n        },\r\n\r\n        /**\r\n         * Create a job for access control synchronization\r\n         */\r\n        createJob: (job: JobTypeBase & { data: any }) => {\r\n            return dispatch(createJob(job));\r\n        },\r\n\r\n        /**\r\n         * Update the active status of an access control policy\r\n         */\r\n        updateAccessControlPolicyActive: (policyId: string, active: boolean) => {\r\n            return dispatch(updateAccessControlPolicyActive(policyId, active));\r\n        },\r\n\r\n        /**\r\n         * Validate if the current user (requester) matches an access control expression\r\n         */\r\n        validateExpressionAgainstRequester: (expression: string) => {\r\n            return dispatch(validateExpressionAgainstRequester(expression, channelId));\r\n        },\r\n\r\n        /**\r\n         * Create an access control sync job with deduplication\r\n         */\r\n        createAccessControlSyncJob: (jobData: {policy_id: string}) => {\r\n            return dispatch(createAccessControlSyncJob(jobData));\r\n        },\r\n    }), [dispatch, channelId]);\r\n};\r\n\r\nexport default useChannelAccessControlActions;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {batchActions} from 'redux-batched-actions';\r\n\r\nimport type {AccessControlPoliciesResult, AccessControlPolicy, AccessControlTestResult} from '@mattermost/types/access_control';\r\nimport type {ChannelSearchOpts, ChannelsWithTotalCount} from '@mattermost/types/channels';\r\nimport type {ServerError} from '@mattermost/types/errors';\r\n\r\nimport {AdminTypes, ChannelTypes, UserTypes} from 'mattermost-redux/action_types';\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport type {ActionFuncAsync} from 'mattermost-redux/types/actions';\r\n\r\nimport {bindClientFunc, forceLogoutIfNecessary} from './helpers';\r\n\r\nexport function getAccessControlPolicy(id: string, channelId?: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.getAccessControlPolicy,\r\n        onSuccess: [AdminTypes.RECEIVED_ACCESS_CONTROL_POLICY],\r\n        params: [\r\n            id,\r\n            channelId,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function createAccessControlPolicy(policy: AccessControlPolicy): ActionFuncAsync<AccessControlPolicy> {\r\n    return async (dispatch, getState) => {\r\n        let data;\r\n        try {\r\n            data = await Client4.updateOrCreateAccessControlPolicy(policy);\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n            return {error};\r\n        }\r\n\r\n        dispatch(\r\n            {type: AdminTypes.CREATE_ACCESS_CONTROL_POLICY_SUCCESS, data},\r\n        );\r\n\r\n        return {data};\r\n    };\r\n}\r\n\r\nexport function deleteAccessControlPolicy(id: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.deleteAccessControlPolicy,\r\n        onSuccess: [AdminTypes.DELETE_ACCESS_CONTROL_POLICY_SUCCESS],\r\n        params: [\r\n            id,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function searchAccessControlPolicies(term: string, type: string, after: string, limit: number): ActionFuncAsync<AccessControlPoliciesResult> {\r\n    return async (dispatch, getState) => {\r\n        let data;\r\n        try {\r\n            data = await Client4.searchAccessControlPolicies(term, type, after, limit);\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n            return {error};\r\n        }\r\n\r\n        dispatch(\r\n            {type: AdminTypes.RECEIVED_ACCESS_CONTROL_POLICIES_SEARCH, data: data.policies},\r\n        );\r\n\r\n        return {data};\r\n    };\r\n}\r\n\r\nexport function searchAccessControlPolicyChannels(id: string, term: string, opts: ChannelSearchOpts): ActionFuncAsync<ChannelsWithTotalCount> {\r\n    return async (dispatch, getState) => {\r\n        let data;\r\n        try {\r\n            data = await Client4.searchChildAccessControlPolicyChannels(id, term, opts);\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n            return {error};\r\n        }\r\n\r\n        const childs: Record<string, string[]> = {};\r\n        childs[id] = data.channels.map((channel) => channel.id);\r\n\r\n        dispatch(batchActions([\r\n            {type: AdminTypes.RECEIVED_ACCESS_CONTROL_CHILD_POLICIES, data: childs},\r\n            {type: ChannelTypes.RECEIVED_CHANNELS, data: data.channels},\r\n        ]));\r\n\r\n        return {data};\r\n    };\r\n}\r\n\r\nexport function assignChannelsToAccessControlPolicy(policyId: string, channelIds: string[]) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.assignChannelsToAccessControlPolicy,\r\n        onSuccess: [AdminTypes.ASSIGN_CHANNELS_TO_ACCESS_CONTROL_POLICY_SUCCESS],\r\n        params: [\r\n            policyId,\r\n            channelIds,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function unassignChannelsFromAccessControlPolicy(policyId: string, channelIds: string[]) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.unassignChannelsFromAccessControlPolicy,\r\n        onSuccess: [AdminTypes.UNASSIGN_CHANNELS_FROM_ACCESS_CONTROL_POLICY_SUCCESS],\r\n        params: [\r\n            policyId,\r\n            channelIds,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function getAccessControlFields(after: string, limit: number, channelId?: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.getAccessControlFields,\r\n        params: [\r\n            after,\r\n            limit,\r\n            channelId,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function updateAccessControlPolicyActive(policyId: string, active: boolean) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.updateAccessControlPolicyActive,\r\n        params: [\r\n            policyId,\r\n            active,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function searchUsersForExpression(expression: string, term: string, after: string, limit: number, channelId?: string): ActionFuncAsync<AccessControlTestResult> {\r\n    return async (dispatch, getState) => {\r\n        let data;\r\n        try {\r\n            data = await Client4.testAccessControlExpression(expression, term, after, limit, channelId);\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n            return {error};\r\n        }\r\n\r\n        dispatch(\r\n            {type: UserTypes.RECEIVED_PROFILES, data: data.users},\r\n        );\r\n\r\n        return {data};\r\n    };\r\n}\r\n\r\nexport function getVisualAST(expression: string, channelId?: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.expressionToVisualFormat,\r\n        params: [expression, channelId],\r\n    });\r\n}\r\n\r\nexport function validateExpressionAgainstRequester(expression: string, channelId?: string): ActionFuncAsync<{requester_matches: boolean}> {\r\n    return async (dispatch, getState) => {\r\n        let data;\r\n        try {\r\n            data = await Client4.validateExpressionAgainstRequester(expression, channelId);\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n            return {error};\r\n        }\r\n        return {data};\r\n    };\r\n}\r\n\r\nexport function createAccessControlSyncJob(jobData: {policy_id: string}): ActionFuncAsync<any> {\r\n    return async (dispatch, getState) => {\r\n        let data;\r\n        try {\r\n            data = await Client4.createAccessControlSyncJob(jobData);\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n            return {error};\r\n        }\r\n        return {data};\r\n    };\r\n}\r\n"],"names":["CELOperator","OperatorLabel","OPERATOR_LABELS","EQUALS","IS","NOT_EQUALS","IS_NOT","STARTS_WITH","ENDS_WITH","CONTAINS","IN","OPERATOR_CONFIG","type","celOp","TestButton","_ref","onClick","disabled","React","className","FormattedMessage","id","defaultMessage","AddAttributeButton","_ref2","HelpText","_ref3","message","onLearnMoreClick","Markdown","options","mentionHighlight","href","propTypes","_pt","isRequired","AttributeIcon","props","attribute","iconProps","_objectWithoutProperties","_excluded","_attribute$attrs","valueType","attrs","value_type","EmailOutlineIcon","LinkVariantIcon","PoundIcon","ChevronDownCircleOutlineIcon","FormatListBulletedIcon","MenuVariantIcon","AttributeSelectorMenu","currentAttribute","availableAttributes","onChange","menuId","buttonId","autoOpen","onMenuOpened","enableUserManagedAttributes","formatMessage","useIntl","filter","setFilter","useState","prevAutoOpen","useRef","onFilterChange","useCallback","e","target","value","useMemo","attr","name","toLowerCase","includes","handleAttributeChange","selectedAttributeObject","find","useEffect","current","buttonElement","document","getElementById","click","Menu","menuButton","class","classNames","children","dataTestId","menu","key","placeholder","map","option","_option$attrs","_option$attrs2","_option$attrs3","hasSpaces","isSynced","ldap","saml","isAdminManaged","managed","allowed","menuItem","concat","role","forceCloseOnSelect","undefined","labels","leadingElement","size","trailingElements","InformationOutlineIcon","ShieldAlertOutlineIcon","color","SyncIcon","CheckIcon","tooltipContent","WithTooltip","title","OperatorSelectorMenu","currentOperator","handleOperatorChange","descriptor","currentOperatorDescriptor","getOperatorDescriptor","CurrentOperatorIcon","icon","filteredOperators","Object","values","OPERATOR_DESCRIPTORS","desc","label","Icon","operatorValue","is","EqualIcon","defineMessage","NotEqualVariantIcon","ElementOfIcon","FunctionIcon","updateValues","allowCreateValue","actualAllowCreateForMenu","length","filteredOptions","defaultMultiPlaceholder","defaultCreatePlaceholder","handleSelectItem","newValues","v","handleCreateValue","valueToCreate","trimmedValue","trim","handleInputKeyDownForMenu","stopPropagation","preventDefault","handleRemoveValue","event","valueToRemove","cellContents","visualPlaceholderText","actualTextDisplayed","useStyle","tabIndex","onKeyDown","CloseIcon","ChevronDownIcon","isSelected","some","opt","updateValue","inputValue","setInputValue","isEditing","setIsEditing","hasOptions","commitInputValue","handleKeyDownSimpleInput","defaultPlaceholder","onFocus","onBlur","maxLength","Constants","MAX_CUSTOM_ATTRIBUTE_LENGTH","ValueSelectorMenu","row","operator","MultiValueSelector","SingleValueSelector","attribute_type","TableEditor","onValidate","userAttributes","onParseError","channelId","actions","rows","setRows","showTestResults","setShowTestResults","showHelpModal","setShowHelpModal","autoOpenAttributeMenuForRow","setAutoOpenAttributeMenuForRow","getVisualAST","then","result","_result$error$message","_result$error$message2","error","visualAST","tableRows","node","conditions","startsWith","Error","slice","op","Array","isArray","push","parseExpression","data","catch","err","_err$message","_err$message2","updateExpression","newRows","rowsThatCanFormExpressions","expr","attributeExpr","config","attributeObj","valuesStr","val","join","findFirstAvailableAttribute","findFirstAvailableAttributeFromList","_attr$attrs","_attr$attrs2","_attr$attrs3","addRow","firstAvailableAttribute","currentRows","_userAttributes$","removeRow","index","toSpliced","updateRowAttribute","oldAttribute","_objectSpread","updateRowOperator","newOperator","oldOperator","updateRowValues","colSpan","_userAttributes$find","_userAttributes$find$","TestResultsModal","onExited","openModal","searchUsers","term","after","limit","searchUsersForExpression","CELHelpModal","onHide","GenericModal","modalHeaderText","modalSubheaderText","compassDesign","bodyPadding","modalLocation","link","msg","ExternalLink","location","dispatch","useDispatch","setTerm","users","setUsers","total","setTotal","loading","setLoading","cursorHistory","setCursorHistory","fetchUsers","async","searchTerm","cursor","reset","arguments","newUsers","prevUsers","Modal","dialogClassName","show","Header","closeButton","style","display","alignItems","Title","componentClass","Body","SearchableUserList","usersPerPage","nextPage","page","cursorForNextPage","search","newTerm","actionUserProps","ConvertConfirmModal","titleMessage","convertMessage","confirmMessage","convertConfirmationMessage","onConfirm","onCancel","displayName","toPublic","messages","toPublicTitle","toPublicMessage","toPublicConfirm","toPublicMessageConfirmation","toPrivateTitle","toPrivateMessage","toPrivateConfirm","toPrivateMessageConfirmation","assign","confirmButton","cancelButton","ConfirmModal","modalClass","confirmButtonClass","confirmButtonText","cancelButtonText","defineMessages","ColorInput","constructor","super","_defineProperty","this","colorPicker","contains","setState","isOpened","state","colorInput","focus","newColorData","focused","hex","tinycolor","normalizedColor","toHex","isValid","setSelectionRange","togglePicker","getDerivedStateFromProps","componentDidUpdate","prevProps","prevState","prevIsOpened","addEventListener","checkClick","capture","removeEventListener","render","ref","isDisabled","backgroundColor","ChromePicker","handleColorChange","disableAlpha","useChannelAccessControlActions","getAccessControlFields","expression","getChannelPolicy","getAccessControlPolicy","saveChannelPolicy","policy","createAccessControlPolicy","deleteChannelPolicy","policyId","deleteAccessControlPolicy","getChannelMembers","perPage","createJob","job","updateAccessControlPolicyActive","active","validateExpressionAgainstRequester","createAccessControlSyncJob","jobData","bindClientFunc","clientFunc","Client4","onSuccess","AdminTypes","RECEIVED_ACCESS_CONTROL_POLICY","params","getState","updateOrCreateAccessControlPolicy","forceLogoutIfNecessary","CREATE_ACCESS_CONTROL_POLICY_SUCCESS","DELETE_ACCESS_CONTROL_POLICY_SUCCESS","searchAccessControlPolicies","RECEIVED_ACCESS_CONTROL_POLICIES_SEARCH","policies","searchAccessControlPolicyChannels","opts","searchChildAccessControlPolicyChannels","childs","channels","channel","batchActions","RECEIVED_ACCESS_CONTROL_CHILD_POLICIES","ChannelTypes","RECEIVED_CHANNELS","assignChannelsToAccessControlPolicy","channelIds","ASSIGN_CHANNELS_TO_ACCESS_CONTROL_POLICY_SUCCESS","unassignChannelsFromAccessControlPolicy","UNASSIGN_CHANNELS_FROM_ACCESS_CONTROL_POLICY_SUCCESS","testAccessControlExpression","UserTypes","RECEIVED_PROFILES","expressionToVisualFormat"],"sourceRoot":""}