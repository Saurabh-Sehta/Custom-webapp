{"version":3,"file":"2669.ebda6e01aa7519b6bc79.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/actions/channel_bookmarks.ts","webpack://mattermost-webapp/./src/packages/mattermost-redux/src/actions/channel_bookmarks.ts","webpack://mattermost-webapp/./src/actions/views/channel_sidebar.ts","webpack://mattermost-webapp/./src/components/searchable_channel_list.tsx","webpack://mattermost-webapp/./src/components/browse_channels/browse_channels.tsx","webpack://mattermost-webapp/./src/components/browse_channels/index.ts","webpack://mattermost-webapp/./src/components/channel_bookmarks/utils.ts","webpack://mattermost-webapp/./src/components/channel_move_to_sub_menu/index.tsx","webpack://mattermost-webapp/./src/components/edit_category_modal/edit_category_modal.tsx","webpack://mattermost-webapp/./src/components/edit_category_modal/index.ts","webpack://mattermost-webapp/./src/components/leave_team_modal/leave_team_modal.tsx","webpack://mattermost-webapp/./src/components/leave_team_modal/index.ts","webpack://mattermost-webapp/./src/components/list_modal.tsx","webpack://mattermost-webapp/./src/components/search_shortcut/search_shortcut.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/create_new_category_menu_item.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/mark_as_read_confirm_modal.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/mark_as_read_menu_item.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/sidebar_category_generic_menu.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category_header.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/channel_mention_badge.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/channel_pencil_icon/channel_pencil_icon.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/channel_pencil_icon/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_icon/sidebar_channel_icon.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_menu/sidebar_channel_menu.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_menu/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_link/sidebar_channel_link.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_link/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_base_channel/sidebar_base_channel.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_base_channel/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_direct_channel/sidebar_direct_channel.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_direct_channel/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_group_channel/sidebar_group_channel.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_group_channel/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel.tsx","webpack://mattermost-webapp/./src/components/team_controller/actions/index.ts","webpack://mattermost-webapp/./src/components/channel_layout/channel_identifier_router/actions.ts","webpack://mattermost-webapp/./src/components/dynamic_virtualized_list/list_item_size_observer.ts","webpack://mattermost-webapp/./src/components/dynamic_virtualized_list/list_item.tsx","webpack://mattermost-webapp/./src/components/dynamic_virtualized_list/index.jsx","webpack://mattermost-webapp/./src/components/common/svg_images_components/channel_intro_private_svg.tsx","webpack://mattermost-webapp/./src/components/common/svg_images_components/channel_intro_public_svg.tsx","webpack://mattermost-webapp/./src/components/common/svg_images_components/channel_intro_town_square_svg.tsx","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/add_members_button.tsx","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/pluggable_intro_buttons/pluggable_intro_buttons.tsx","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/pluggable_intro_buttons/index.ts","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/channel_intro_message.tsx","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/index.ts","webpack://mattermost-webapp/./src/components/post_view/post_list_row/post_list_row.tsx","webpack://mattermost-webapp/./src/components/post_view/post_list_row/index.ts","webpack://mattermost-webapp/./src/components/widgets/icons/scroll_to_bottom_icon.tsx","webpack://mattermost-webapp/./src/components/post_view/scroll_to_bottom_arrows.tsx","webpack://mattermost-webapp/./src/components/hint-toast/hint_toast.tsx","webpack://mattermost-webapp/./src/components/scroll_to_bottom_toast/scroll_to_bottom_toast.tsx","webpack://mattermost-webapp/./src/components/scroll_to_bottom_toast/index.tsx","webpack://mattermost-webapp/./src/components/toast_wrapper/toast_wrapper.tsx","webpack://mattermost-webapp/./src/components/toast_wrapper/index.ts","webpack://mattermost-webapp/./src/components/post_view/post_list_virtualized/latest_post_reader.tsx","webpack://mattermost-webapp/./src/components/post_view/post_list_virtualized/post_list_virtualized.tsx","webpack://mattermost-webapp/./src/components/post_view/post_list/post_list.tsx","webpack://mattermost-webapp/./src/components/post_view/post_list/index.tsx","webpack://mattermost-webapp/./src/components/post_view/post_view.tsx","webpack://mattermost-webapp/./src/components/post_view/index.ts","webpack://mattermost-webapp/./src/components/channel_view/input_loading.tsx","webpack://mattermost-webapp/./src/components/channel_view/channel_view.tsx","webpack://mattermost-webapp/./src/components/channel_view/index.ts","webpack://mattermost-webapp/./src/components/channel_layout/channel_identifier_router/channel_identifier_router.tsx","webpack://mattermost-webapp/./src/components/channel_layout/channel_identifier_router/index.ts","webpack://mattermost-webapp/./src/components/channel_layout/center_channel/center_channel.tsx","webpack://mattermost-webapp/./src/components/channel_layout/center_channel/index.ts","webpack://mattermost-webapp/./src/components/query_param_actions/query_param_action_controller.tsx","webpack://mattermost-webapp/./src/components/data_prefetch/actions.ts","webpack://mattermost-webapp/./src/components/data_prefetch/data_prefetch.tsx","webpack://mattermost-webapp/./src/components/data_prefetch/index.ts","webpack://mattermost-webapp/./src/components/resizable_sidebar/resizable_lhs/index.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_header/sidebar_team_menu.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_header/sidebar_header.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_header/index.ts","webpack://mattermost-webapp/./src/components/quick_switch_modal/quick_switch_modal.tsx","webpack://mattermost-webapp/./src/components/quick_switch_modal/index.tsx","webpack://mattermost-webapp/./src/components/sidebar/channel_filter/channel_filter.tsx","webpack://mattermost-webapp/./src/components/sidebar/channel_filter/index.ts","webpack://mattermost-webapp/./src/components/sidebar/channel_navigator/channel_navigator.tsx","webpack://mattermost-webapp/./src/components/sidebar/channel_navigator/index.ts","webpack://mattermost-webapp/./src/components/delete_category_modal/delete_category_modal.tsx","webpack://mattermost-webapp/./src/components/delete_category_modal/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/index.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_sorting_menu.tsx","webpack://mattermost-webapp/./src/selectors/views/add_channel_dropdown.ts","webpack://mattermost-webapp/./src/components/sidebar/add_channels_cta_button.tsx","webpack://mattermost-webapp/./src/actions/views/add_channel_dropdown.ts","webpack://mattermost-webapp/./src/components/sidebar/invite_members_button.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_list/sidebar_list.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_list/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar.tsx","webpack://mattermost-webapp/./src/components/sidebar/index.ts","webpack://mattermost-webapp/./src/components/threading/channel_threads/posts_channel_reset_watcher/posts_channel_reset_watcher.tsx","webpack://mattermost-webapp/./src/components/unreads_status_handler/unreads_status_handler.tsx","webpack://mattermost-webapp/./src/components/unreads_status_handler/index.ts","webpack://mattermost-webapp/./src/components/channel_layout/channel_controller.tsx","webpack://mattermost-webapp/./src/components/team_controller/team_controller.tsx","webpack://mattermost-webapp/./src/components/common/hooks/useTelemetryIdentifySync.tsx","webpack://mattermost-webapp/./src/components/team_controller/index.ts","webpack://mattermost-webapp/./src/components/team_groups_manage_modal/team_groups_manage_modal.tsx","webpack://mattermost-webapp/./src/components/team_groups_manage_modal/index.ts","webpack://mattermost-webapp/./src/components/team_members_dropdown/team_members_dropdown.tsx","webpack://mattermost-webapp/./src/components/team_members_dropdown/index.ts","webpack://mattermost-webapp/./src/components/member_list_team/member_list_team.tsx","webpack://mattermost-webapp/./src/components/member_list_team/index.ts","webpack://mattermost-webapp/./src/components/team_members_modal/team_members_modal.tsx","webpack://mattermost-webapp/./src/components/team_members_modal/index.ts","webpack://mattermost-webapp/./src/components/common/select_text_input/select_text_input.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/allowed_domains_select.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/invite_section_input.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/open_invite.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/team_access_tab.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/index.ts","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/team_description_section.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/team_name_section.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/team_picture_section.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/team_info_tab.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/index.ts","webpack://mattermost-webapp/./src/components/team_settings/team_settings.tsx","webpack://mattermost-webapp/./src/components/team_settings/index.ts","webpack://mattermost-webapp/./src/components/team_settings_modal/team_settings_modal.tsx","webpack://mattermost-webapp/./src/components/team_settings_modal/index.ts","webpack://mattermost-webapp/./src/components/widgets/icons/fa_edit_icon.tsx","webpack://mattermost-webapp/./src/components/widgets/modals/components/save_changes_panel.tsx","webpack://mattermost-webapp/./src/packages/mattermost-redux/src/selectors/entities/channel_bookmarks.ts","webpack://mattermost-webapp/./src/selectors/lhs.ts"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChannelBookmark, ChannelBookmarkCreate, ChannelBookmarkPatch} from '@mattermost/types/channel_bookmarks';\r\n\r\nimport * as Actions from 'mattermost-redux/actions/channel_bookmarks';\r\n\r\nimport {getConnectionId} from 'selectors/general';\r\n\r\nimport type {ActionFuncAsync} from 'types/store';\r\n\r\nexport function deleteBookmark(channelId: string, id: string): ActionFuncAsync<boolean> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const connectionId = getConnectionId(state);\r\n        return dispatch(Actions.deleteBookmark(channelId, id, connectionId));\r\n    };\r\n}\r\n\r\nexport function createBookmark(channelId: string, bookmark: ChannelBookmarkCreate): ActionFuncAsync<boolean> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const connectionId = getConnectionId(state);\r\n        return dispatch(Actions.createBookmark(channelId, bookmark, connectionId));\r\n    };\r\n}\r\n\r\nexport function editBookmark(channelId: string, id: string, patch: ChannelBookmarkPatch): ActionFuncAsync<boolean> {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const connectionId = getConnectionId(state);\r\n        return dispatch(Actions.editBookmark(channelId, id, patch, connectionId));\r\n    };\r\n}\r\n\r\nexport function reorderBookmark(channelId: string, id: string, newOrder: number): ActionFuncAsync<boolean> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const connectionId = getConnectionId(state);\r\n        return dispatch(Actions.reorderBookmark(channelId, id, newOrder, connectionId));\r\n    };\r\n}\r\n\r\nexport function fetchChannelBookmarks(channelId: string): ActionFuncAsync<ChannelBookmark[]> {\r\n    return Actions.fetchChannelBookmarks(channelId);\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChannelBookmark, ChannelBookmarkCreate, ChannelBookmarkPatch} from '@mattermost/types/channel_bookmarks';\r\n\r\nimport {ChannelBookmarkTypes} from 'mattermost-redux/action_types';\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport {getChannelBookmark} from 'mattermost-redux/selectors/entities/channel_bookmarks';\r\nimport type {ActionFuncAsync, DispatchFunc} from 'mattermost-redux/types/actions';\r\n\r\nimport {logError} from './errors';\r\nimport {forceLogoutIfNecessary} from './helpers';\r\n\r\nexport function deleteBookmark(channelId: string, id: string, connectionId: string): ActionFuncAsync<boolean> {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const bookmark = getChannelBookmark(state, channelId, id);\r\n\r\n        try {\r\n            await Client4.deleteChannelBookmark(channelId, id, connectionId);\r\n\r\n            dispatch({\r\n                type: ChannelBookmarkTypes.BOOKMARK_DELETED,\r\n                data: bookmark,\r\n            });\r\n        } catch (error) {\r\n            return {\r\n                data: false,\r\n                error,\r\n            };\r\n        }\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function createBookmark(channelId: string, bookmark: ChannelBookmarkCreate, connectionId: string): ActionFuncAsync<boolean> {\r\n    return async (dispatch: DispatchFunc) => {\r\n        try {\r\n            const createdBookmark = await Client4.createChannelBookmark(channelId, bookmark, connectionId);\r\n\r\n            dispatch({\r\n                type: ChannelBookmarkTypes.RECEIVED_BOOKMARK,\r\n                data: createdBookmark,\r\n            });\r\n        } catch (error) {\r\n            return {\r\n                data: false,\r\n                error,\r\n            };\r\n        }\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function editBookmark(channelId: string, id: string, patch: ChannelBookmarkPatch, connectionId: string): ActionFuncAsync<boolean> {\r\n    return async (dispatch: DispatchFunc) => {\r\n        try {\r\n            const {updated, deleted} = await Client4.updateChannelBookmark(channelId, id, patch, connectionId);\r\n\r\n            if (updated) {\r\n                dispatch({\r\n                    type: ChannelBookmarkTypes.RECEIVED_BOOKMARK,\r\n                    data: updated,\r\n                });\r\n            }\r\n\r\n            if (deleted) {\r\n                dispatch({\r\n                    type: ChannelBookmarkTypes.BOOKMARK_DELETED,\r\n                    data: deleted,\r\n                });\r\n            }\r\n        } catch (error) {\r\n            return {\r\n                data: false,\r\n                error,\r\n            };\r\n        }\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function reorderBookmark(channelId: string, id: string, newOrder: number, connectionId: string): ActionFuncAsync<boolean> {\r\n    return async (dispatch: DispatchFunc) => {\r\n        try {\r\n            const bookmarks = await Client4.updateChannelBookmarkSortOrder(channelId, id, newOrder, connectionId);\r\n\r\n            dispatch({\r\n                type: ChannelBookmarkTypes.RECEIVED_BOOKMARKS,\r\n                data: {channelId, bookmarks},\r\n            });\r\n        } catch (error) {\r\n            return {\r\n                data: false,\r\n                error,\r\n            };\r\n        }\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function fetchChannelBookmarks(channelId: string): ActionFuncAsync<ChannelBookmark[]> {\r\n    return async (dispatch, getState) => {\r\n        let bookmarks;\r\n        try {\r\n            bookmarks = await Client4.getChannelBookmarks(channelId);\r\n\r\n            dispatch({\r\n                type: ChannelBookmarkTypes.RECEIVED_BOOKMARKS,\r\n                data: {channelId, bookmarks},\r\n            });\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error, dispatch, getState);\r\n            dispatch(logError(error));\r\n            return {error};\r\n        }\r\n\r\n        return {data: bookmarks};\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {createCategory as createCategoryRedux, moveChannelsToCategory} from 'mattermost-redux/actions/channel_categories';\r\nimport {General} from 'mattermost-redux/constants';\r\nimport {CategoryTypes} from 'mattermost-redux/constants/channel_categories';\r\nimport {getCategory, makeGetChannelIdsForCategory} from 'mattermost-redux/selectors/entities/channel_categories';\r\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\r\nimport {insertMultipleWithoutDuplicates} from 'mattermost-redux/utils/array_utils';\r\n\r\nimport {getCategoriesForCurrentTeam, getChannelsInCategoryOrder, getDisplayedChannels} from 'selectors/views/channel_sidebar';\r\n\r\nimport {ActionTypes} from 'utils/constants';\r\n\r\nimport type {ActionFunc, ActionFuncAsync, DraggingState, GlobalState} from 'types/store';\r\n\r\nexport function setUnreadFilterEnabled(enabled: boolean) {\r\n    return {\r\n        type: ActionTypes.SET_UNREAD_FILTER_ENABLED,\r\n        enabled,\r\n    };\r\n}\r\n\r\nexport function setDraggingState(data: DraggingState) {\r\n    return {\r\n        type: ActionTypes.SIDEBAR_DRAGGING_SET_STATE,\r\n        data,\r\n    };\r\n}\r\n\r\nexport function stopDragging() {\r\n    return {type: ActionTypes.SIDEBAR_DRAGGING_STOP};\r\n}\r\n\r\nexport function createCategory(teamId: string, displayName: string, channelIds?: string[]): ActionFuncAsync<unknown> {\r\n    return async (dispatch, getState) => {\r\n        if (channelIds) {\r\n            const state = getState();\r\n            const multiSelectedChannelIds = state.views.channelSidebar.multiSelectedChannelIds;\r\n            channelIds.forEach((channelId) => {\r\n                if (multiSelectedChannelIds.indexOf(channelId) >= 0) {\r\n                    dispatch(multiSelectChannelAdd(channelId));\r\n                }\r\n            });\r\n        }\r\n\r\n        const result = await dispatch(createCategoryRedux(teamId, displayName, channelIds));\r\n        return dispatch({\r\n            type: ActionTypes.ADD_NEW_CATEGORY_ID,\r\n            data: result.data!.id,\r\n        });\r\n    };\r\n}\r\n\r\n// addChannelsInSidebar moves channels to a given category without specifying the order in the sidebar, so the channels\r\n// will always go to the first position in the category\r\nexport function addChannelsInSidebar(categoryId: string, channelId: string) {\r\n    return moveChannelsInSidebar(categoryId, 0, channelId, false);\r\n}\r\n\r\n// moveChannelsInSidebar moves channels to a given category in the sidebar, but it accounts for when the target index\r\n// may have changed due to archived channels not being shown in the sidebar.\r\nexport function moveChannelsInSidebar(categoryId: string, targetIndex: number, draggableChannelId: string, setManualSorting = true): ActionFuncAsync<unknown> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const multiSelectedChannelIds = state.views.channelSidebar.multiSelectedChannelIds;\r\n        let channelIds = [];\r\n\r\n        // Multi channel case\r\n        if (multiSelectedChannelIds.length && multiSelectedChannelIds.indexOf(draggableChannelId) !== -1) {\r\n            const categories = getCategoriesForCurrentTeam(state);\r\n            const displayedChannels = getDisplayedChannels(state);\r\n\r\n            let channelsToMove = [draggableChannelId];\r\n\r\n            // Filter out channels that can't go in the category specified\r\n            const targetCategory = categories.find((category) => category.id === categoryId);\r\n            channelsToMove = multiSelectedChannelIds.filter((channelId) => {\r\n                const selectedChannel = displayedChannels.find((channel) => channelId === channel.id);\r\n                const isDMGM = selectedChannel?.type === General.DM_CHANNEL || selectedChannel?.type === General.GM_CHANNEL;\r\n                return targetCategory?.type === CategoryTypes.CUSTOM || targetCategory?.type === CategoryTypes.FAVORITES || (isDMGM && targetCategory?.type === CategoryTypes.DIRECT_MESSAGES) || (!isDMGM && targetCategory?.type !== CategoryTypes.DIRECT_MESSAGES);\r\n            });\r\n\r\n            // Reorder such that the channels move in the order that they appear in the sidebar\r\n            const displayedChannelIds = displayedChannels.map((channel) => channel.id);\r\n            channelsToMove.sort((a, b) => displayedChannelIds.indexOf(a) - displayedChannelIds.indexOf(b));\r\n\r\n            // Remove selection from channels that were moved\r\n            channelsToMove.forEach((channelId) => dispatch(multiSelectChannelAdd(channelId)));\r\n            channelIds = channelsToMove;\r\n        } else {\r\n            channelIds = [draggableChannelId];\r\n        }\r\n\r\n        const newIndex = adjustTargetIndexForMove(state, categoryId, channelIds, targetIndex, draggableChannelId);\r\n        return dispatch(moveChannelsToCategory(categoryId, channelIds, newIndex, setManualSorting));\r\n    };\r\n}\r\n\r\nexport function adjustTargetIndexForMove(state: GlobalState, categoryId: string, channelIds: string[], targetIndex: number, draggableChannelId: string) {\r\n    if (targetIndex === 0) {\r\n        // The channel is being placed first, so there's nothing above that could affect the index\r\n        return 0;\r\n    }\r\n\r\n    const category = getCategory(state, categoryId);\r\n    const filteredChannelIds = makeGetChannelIdsForCategory()(state, category);\r\n\r\n    // When dragging multiple channels, we don't actually remove all of them from the list as react-beautiful-dnd doesn't support that\r\n    // Account for channels removed above the insert point, except the one currently being dragged which is already accounted for by react-beautiful-dnd\r\n    const removedChannelsAboveInsert = filteredChannelIds.filter((channel, index) => channel !== draggableChannelId && channelIds.indexOf(channel) !== -1 && index <= targetIndex);\r\n    const shiftedIndex = targetIndex - removedChannelsAboveInsert.length;\r\n\r\n    if (category.channel_ids.length === filteredChannelIds.length) {\r\n        // There are no archived channels in the category, so the shiftedIndex will be correct\r\n        return shiftedIndex;\r\n    }\r\n\r\n    const updatedChannelIds = insertMultipleWithoutDuplicates(filteredChannelIds, channelIds, shiftedIndex);\r\n\r\n    // After \"moving\" the channel in the sidebar, find what channel comes above it\r\n    const previousChannelId = updatedChannelIds[updatedChannelIds.indexOf(channelIds[0]) - 1];\r\n\r\n    // We want the channel to still be below that channel, so place the new index below it\r\n    let newIndex = category.channel_ids.indexOf(previousChannelId) + 1;\r\n\r\n    // If the channel is moving downwards, then the target index will need to be reduced by one to account for\r\n    // the channel being removed. For example, if we're moving channelA from [channelA, channelB, channelC] to\r\n    // [channelB, channelA, channelC], newIndex would currently be 2 (which comes after channelB), but we need\r\n    // it to be 1 (which comes after channelB once channelA is removed).\r\n    const sourceIndex = category.channel_ids.indexOf(channelIds[0]);\r\n    if (sourceIndex !== -1 && sourceIndex < newIndex) {\r\n        newIndex -= 1;\r\n    }\r\n\r\n    return Math.max(newIndex - removedChannelsAboveInsert.length, 0);\r\n}\r\n\r\nexport function clearChannelSelection(): ActionFunc<unknown> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n\r\n        if (state.views.channelSidebar.multiSelectedChannelIds.length === 0) {\r\n            // No selection to clear\r\n            return {data: false};\r\n        }\r\n\r\n        dispatch({\r\n            type: ActionTypes.MULTISELECT_CHANNEL_CLEAR,\r\n        });\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function multiSelectChannelAdd(channelId: string): ActionFunc<unknown> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const multiSelectedChannelIds = state.views.channelSidebar.multiSelectedChannelIds;\r\n\r\n        // Nothing already selected, so we include the active channel\r\n        if (!multiSelectedChannelIds.length) {\r\n            const currentChannel = getCurrentChannelId(state);\r\n            dispatch({\r\n                type: ActionTypes.MULTISELECT_CHANNEL,\r\n                data: currentChannel,\r\n            });\r\n        }\r\n\r\n        return dispatch({\r\n            type: ActionTypes.MULTISELECT_CHANNEL_ADD,\r\n            data: channelId,\r\n        });\r\n    };\r\n}\r\n\r\n// Much of this logic was pulled from the react-beautiful-dnd sample multiselect implementation\r\n// Found here: https://github.com/atlassian/react-beautiful-dnd/tree/master/stories/src/multi-drag\r\nexport function multiSelectChannelTo(channelId: string): ActionFunc<unknown> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const multiSelectedChannelIds = state.views.channelSidebar.multiSelectedChannelIds;\r\n        let lastSelected = state.views.channelSidebar.lastSelectedChannel;\r\n\r\n        // Nothing already selected, so start with the active channel\r\n        if (!multiSelectedChannelIds.length) {\r\n            const currentChannel = getCurrentChannelId(state);\r\n            dispatch({\r\n                type: ActionTypes.MULTISELECT_CHANNEL,\r\n                data: currentChannel,\r\n            });\r\n            lastSelected = currentChannel;\r\n        }\r\n\r\n        const allChannelsIdsInOrder = getChannelsInCategoryOrder(state).map((channel) => channel.id);\r\n        const indexOfNew: number = allChannelsIdsInOrder.indexOf(channelId);\r\n        const indexOfLast: number = allChannelsIdsInOrder.indexOf(lastSelected);\r\n\r\n        // multi selecting in the same column\r\n        // need to select everything between the last index and the current index inclusive\r\n\r\n        // nothing to do here\r\n        if (indexOfNew === indexOfLast) {\r\n            return {data: false};\r\n        }\r\n\r\n        const start: number = Math.min(indexOfLast, indexOfNew);\r\n        const end: number = Math.max(indexOfLast, indexOfNew);\r\n\r\n        const inBetween = allChannelsIdsInOrder.slice(start, end + 1);\r\n\r\n        // everything inbetween needs to have it's selection toggled.\r\n        // with the exception of the start and end values which will always be selected\r\n\r\n        return dispatch({\r\n            type: ActionTypes.MULTISELECT_CHANNEL_TO,\r\n            data: inBetween,\r\n        });\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage, defineMessages, injectIntl, type WrappedComponentProps} from 'react-intl';\r\n\r\nimport {ArchiveOutlineIcon, CheckIcon, ChevronDownIcon, GlobeIcon, LockOutlineIcon, AccountOutlineIcon, GlobeCheckedIcon} from '@mattermost/compass-icons/components';\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport {isPrivateChannel} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport MagnifyingGlassSVG from 'components/common/svg_images_components/magnifying_glass_svg';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport * as Menu from 'components/menu';\r\nimport QuickInput from 'components/quick_input';\r\nimport SharedChannelIndicator from 'components/shared_channel_indicator';\r\nimport CheckboxCheckedIcon from 'components/widgets/icons/checkbox_checked_icon';\r\nimport LoadingWrapper from 'components/widgets/loading/loading_wrapper';\r\n\r\nimport {isArchivedChannel} from 'utils/channel_utils';\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\nimport * as UserAgent from 'utils/user_agent';\r\n\r\nimport type {FilterType} from './browse_channels/browse_channels';\r\nimport {Filter} from './browse_channels/browse_channels';\r\n\r\nconst NEXT_BUTTON_TIMEOUT_MILLISECONDS = 500;\r\n\r\ninterface Props extends WrappedComponentProps {\r\n    channels: Channel[];\r\n    channelsPerPage: number;\r\n    nextPage: (page: number) => void;\r\n    isSearch: boolean;\r\n    search: (term: string) => void;\r\n    handleJoin: (channel: Channel, done: () => void) => void;\r\n    noResultsText: JSX.Element;\r\n    changeFilter: (filter: FilterType) => void;\r\n    filter: FilterType;\r\n    myChannelMemberships: RelationOneToOne<Channel, ChannelMembership>;\r\n    closeModal: (modalId: string) => void;\r\n    hideJoinedChannelsPreference: (shouldHideJoinedChannels: boolean) => void;\r\n    rememberHideJoinedChannelsChecked: boolean;\r\n    loading?: boolean;\r\n    channelsMemberCount?: Record<string, number>;\r\n}\r\n\r\ntype State = {\r\n    joiningChannel: string;\r\n    page: number;\r\n    nextDisabled: boolean;\r\n    channelSearchValue: string;\r\n    isSearch?: boolean;\r\n}\r\n\r\nexport class SearchableChannelList extends React.PureComponent<Props, State> {\r\n    private nextTimeoutId: number | NodeJS.Timeout;\r\n    private filter: React.RefObject<HTMLInputElement>;\r\n    private channelListScroll: React.RefObject<HTMLDivElement>;\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        return {isSearch: props.isSearch, page: props.isSearch && !state.isSearch ? 0 : state.page};\r\n    }\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.nextTimeoutId = 0;\r\n\r\n        this.state = {\r\n            joiningChannel: '',\r\n            page: 0,\r\n            nextDisabled: false,\r\n            channelSearchValue: '',\r\n        };\r\n\r\n        this.filter = React.createRef();\r\n        this.channelListScroll = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        // only focus the search box on desktop so that we don't cause the keyboard to open on mobile\r\n        if (!UserAgent.isMobile() && this.filter.current) {\r\n            this.filter.current.focus();\r\n        }\r\n        document.addEventListener('keydown', this.onKeyDown);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.onKeyDown);\r\n    }\r\n\r\n    onKeyDown = (e: KeyboardEvent) => {\r\n        const target = e.target as HTMLElement;\r\n        const isEnterKeyPressed = isKeyPressed(e, Constants.KeyCodes.ENTER);\r\n        if (isEnterKeyPressed && (e.shiftKey || e.ctrlKey || e.altKey)) {\r\n            return;\r\n        }\r\n        if (isEnterKeyPressed && target?.classList.contains('more-modal__row')) {\r\n            target.click();\r\n        }\r\n    };\r\n\r\n    handleJoin = (channel: Channel, e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        this.setState({joiningChannel: channel.id});\r\n        this.props.handleJoin(\r\n            channel,\r\n            () => {\r\n                this.setState({joiningChannel: ''});\r\n            },\r\n        );\r\n        if (this.isMemberOfChannel(channel.id)) {\r\n            this.props.closeModal(ModalIdentifiers.MORE_CHANNELS);\r\n        }\r\n    };\r\n\r\n    isMemberOfChannel(channelId: string) {\r\n        return this.props.myChannelMemberships[channelId];\r\n    }\r\n\r\n    createChannelRow = (channel: Channel) => {\r\n        const ariaLabel = `${channel.display_name}, ${channel.purpose}`.toLowerCase();\r\n        let channelTypeIcon;\r\n\r\n        if (isArchivedChannel(channel)) {\r\n            channelTypeIcon = <ArchiveOutlineIcon size={18}/>;\r\n        } else if (isPrivateChannel(channel)) {\r\n            channelTypeIcon = <LockOutlineIcon size={18}/>;\r\n        } else {\r\n            channelTypeIcon = <GlobeIcon size={18}/>;\r\n        }\r\n        let memberCount = 0;\r\n        if (this.props.channelsMemberCount?.[channel.id]) {\r\n            memberCount = this.props.channelsMemberCount[channel.id];\r\n        }\r\n\r\n        const membershipIndicator = this.isMemberOfChannel(channel.id) ? (\r\n            <div\r\n                id='membershipIndicatorContainer'\r\n                aria-label={this.props.intl.formatMessage({id: 'more_channels.membership_indicator', defaultMessage: 'Membership Indicator: Joined'})}\r\n            >\r\n                <CheckIcon size={14}/>\r\n                <FormattedMessage\r\n                    id={'more_channels.joined'}\r\n                    defaultMessage={'Joined'}\r\n                />\r\n            </div>\r\n        ) : null;\r\n\r\n        const channelPurposeContainerAriaLabel = this.props.intl.formatMessage(\r\n            messages.channelPurpose,\r\n            {memberCount, channelPurpose: channel.purpose || ''},\r\n        );\r\n\r\n        const channelPurposeContainer = (\r\n            <div\r\n                id='channelPurposeContainer'\r\n                aria-label={channelPurposeContainerAriaLabel}\r\n            >\r\n                {membershipIndicator}\r\n                {membershipIndicator ? <span className='dot'/> : null}\r\n                <AccountOutlineIcon size={14}/>\r\n                <span data-testid={`channelMemberCount-${channel.name}`} >{memberCount}</span>\r\n                {channel.purpose.length > 0 ? <span className='dot'/> : null}\r\n                <span className='more-modal__description'>{channel.purpose}</span>\r\n            </div>\r\n        );\r\n\r\n        const joinViewChannelButtonClass = classNames('btn btn-sm', {\r\n            'btn-secondary outlineButton': this.isMemberOfChannel(channel.id),\r\n            'btn-primary primaryButton': !this.isMemberOfChannel(channel.id),\r\n        });\r\n\r\n        const joinViewChannelButton = (\r\n            <button\r\n                id='joinViewChannelButton'\r\n                onClick={(e) => this.handleJoin(channel, e)}\r\n                className={joinViewChannelButtonClass}\r\n                disabled={Boolean(this.state.joiningChannel)}\r\n                tabIndex={-1}\r\n                aria-label={this.isMemberOfChannel(channel.id) ? this.props.intl.formatMessage({id: 'more_channels.view', defaultMessage: 'View'}) : this.props.intl.formatMessage({id: 'joinChannel.JoinButton', defaultMessage: 'Join'})}\r\n            >\r\n                <LoadingWrapper\r\n                    loading={this.state.joiningChannel === channel.id}\r\n                    text={messages.joiningButton}\r\n                >\r\n                    <FormattedMessage\r\n                        id={this.isMemberOfChannel(channel.id) ? 'more_channels.view' : 'joinChannel.JoinButton'}\r\n                        defaultMessage={this.isMemberOfChannel(channel.id) ? 'View' : 'Join'}\r\n                    />\r\n                </LoadingWrapper>\r\n            </button>\r\n        );\r\n\r\n        const sharedChannelIcon = channel.shared ? (\r\n            <SharedChannelIndicator\r\n                className='shared-channel-icon'\r\n                withTooltip={true}\r\n            />\r\n        ) : null;\r\n\r\n        return (\r\n            <div\r\n                className='more-modal__row'\r\n                key={channel.id}\r\n                id={`ChannelRow-${channel.name}`}\r\n                data-testid={`ChannelRow-${channel.name}`}\r\n                aria-label={ariaLabel}\r\n                onClick={(e) => this.handleJoin(channel, e)}\r\n                tabIndex={0}\r\n            >\r\n                <div className='more-modal__details'>\r\n                    <div className='style--none more-modal__name'>\r\n                        {channelTypeIcon}\r\n                        <span id='channelName'>{channel.display_name}</span>\r\n                        {sharedChannelIcon}\r\n                    </div>\r\n                    {channelPurposeContainer}\r\n                </div>\r\n                <div className='more-modal__actions'>\r\n                    {joinViewChannelButton}\r\n                    {this.state.joiningChannel === channel.id && !this.isMemberOfChannel(channel.id) && (\r\n                        <span\r\n                            className='sr-only'\r\n                            role='alert'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='more_channels.joinedChannel'\r\n                                defaultMessage='Joined channel {channelName}'\r\n                                values={{\r\n                                    channelName: channel.display_name,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    nextPage = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        this.setState({page: this.state.page + 1, nextDisabled: true});\r\n        this.nextTimeoutId = setTimeout(() => this.setState({nextDisabled: false}), NEXT_BUTTON_TIMEOUT_MILLISECONDS);\r\n        this.props.nextPage(this.state.page + 1);\r\n        this.channelListScroll.current?.scrollTo({top: 0});\r\n    };\r\n\r\n    previousPage = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        this.setState({page: this.state.page - 1});\r\n        this.channelListScroll.current?.scrollTo({top: 0});\r\n    };\r\n\r\n    doSearch = () => {\r\n        this.props.search(this.state.channelSearchValue);\r\n        if (this.state.channelSearchValue === '') {\r\n            this.setState({page: 0});\r\n        }\r\n    };\r\n    filterChange = (filterType: FilterType) => {\r\n        this.props.changeFilter(filterType);\r\n        if (this.props.filter !== filterType) {\r\n            this.setState({page: 0});\r\n        }\r\n    };\r\n    handleChange = (e?: React.FormEvent<HTMLInputElement>) => {\r\n        if (e?.currentTarget) {\r\n            this.setState({channelSearchValue: e?.currentTarget.value}, () => this.doSearch());\r\n        }\r\n    };\r\n    handleClear = () => {\r\n        this.setState({channelSearchValue: ''}, () => this.doSearch());\r\n    };\r\n    handleChecked = () => {\r\n        // If it was checked, and now we're unchecking it, clear the preference\r\n        if (this.props.rememberHideJoinedChannelsChecked) {\r\n            this.props.hideJoinedChannelsPreference(false);\r\n        } else {\r\n            this.props.hideJoinedChannelsPreference(true);\r\n        }\r\n    };\r\n    getEmptyStateMessage = () => {\r\n        if (this.state.channelSearchValue.length > 0) {\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.noMore'\r\n                    tagName='strong'\r\n                    defaultMessage='No results for {text}'\r\n                    values={{text: this.state.channelSearchValue}}\r\n                />\r\n            );\r\n        }\r\n        switch (this.props.filter) {\r\n        case Filter.Archived:\r\n            return (\r\n                <FormattedMessage\r\n                    id={'more_channels.noArchived'}\r\n                    tagName='strong'\r\n                    defaultMessage={'No archived channels'}\r\n                />\r\n            );\r\n        case Filter.Private:\r\n            return (\r\n                <FormattedMessage\r\n                    id={'more_channels.noPrivate'}\r\n                    tagName='strong'\r\n                    defaultMessage={'No private channels'}\r\n                />\r\n            );\r\n        case Filter.Public:\r\n            return (\r\n                <FormattedMessage\r\n                    id={'more_channels.noPublic'}\r\n                    tagName='strong'\r\n                    defaultMessage={'No public channels'}\r\n                />\r\n            );\r\n        default:\r\n            return (\r\n                <FormattedMessage\r\n                    id={'more_channels.noChannels'}\r\n                    tagName='strong'\r\n                    defaultMessage={'No channels'}\r\n                />\r\n            );\r\n        }\r\n    };\r\n    getFilterLabel = () => {\r\n        switch (this.props.filter) {\r\n        case Filter.Archived:\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.show_archived_channels'\r\n                    defaultMessage='Channel Type: Archived'\r\n                />\r\n            );\r\n        case Filter.Public:\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.show_public_channels'\r\n                    defaultMessage='Channel Type: Public'\r\n                />\r\n            );\r\n        case Filter.Private:\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.show_private_channels'\r\n                    defaultMessage='Channel Type: Private'\r\n                />\r\n            );\r\n        default:\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.show_all_channels'\r\n                    defaultMessage='Channel Type: All'\r\n                />\r\n            );\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const channels = this.props.channels;\r\n        let listContent;\r\n        let nextButton;\r\n        let previousButton;\r\n\r\n        if (this.props.loading && channels.length === 0) {\r\n            listContent = <LoadingScreen/>;\r\n        } else if (channels.length === 0) {\r\n            listContent = (\r\n                <div\r\n                    className='no-channel-message'\r\n                    aria-label={this.state.channelSearchValue.length > 0 ? this.props.intl.formatMessage(messages.noMore, {text: this.state.channelSearchValue}) : this.props.intl.formatMessage({id: 'widgets.channels_input.empty', defaultMessage: 'No channels found'})\r\n                    }\r\n                >\r\n                    <MagnifyingGlassSVG/>\r\n                    <h3 className='primary-message'>\r\n                        {this.getEmptyStateMessage()}\r\n                    </h3>\r\n                    {this.props.noResultsText}\r\n                </div>\r\n            );\r\n        } else {\r\n            const pageStart = this.state.page * this.props.channelsPerPage;\r\n            const pageEnd = pageStart + this.props.channelsPerPage;\r\n            const channelsToDisplay = this.props.channels.slice(pageStart, pageEnd);\r\n            listContent = channelsToDisplay.map(this.createChannelRow);\r\n\r\n            if (channelsToDisplay.length >= this.props.channelsPerPage && pageEnd < this.props.channels.length) {\r\n                nextButton = (\r\n                    <button\r\n                        className='btn btn-sm btn-tertiary filter-control filter-control__next'\r\n                        onClick={this.nextPage}\r\n                        disabled={this.state.nextDisabled}\r\n                        aria-label={this.props.intl.formatMessage({id: 'more_channels.next', defaultMessage: 'Next'})}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='more_channels.next'\r\n                            defaultMessage='Next'\r\n                        />\r\n                    </button>\r\n                );\r\n            }\r\n\r\n            if (this.state.page > 0) {\r\n                previousButton = (\r\n                    <button\r\n                        className='btn btn-sm btn-tertiary filter-control filter-control__prev'\r\n                        onClick={this.previousPage}\r\n                        aria-label={this.props.intl.formatMessage({id: 'more_channels.prev', defaultMessage: 'Previous'})}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='more_channels.prev'\r\n                            defaultMessage='Previous'\r\n                        />\r\n                    </button>\r\n                );\r\n            }\r\n        }\r\n\r\n        const input = (\r\n            <div className='filter-row'>\r\n                <span\r\n                    id='searchIcon'\r\n                    aria-hidden='true'\r\n                >\r\n                    <i className='icon icon-magnify'/>\r\n                </span>\r\n                <QuickInput\r\n                    id='searchChannelsTextbox'\r\n                    ref={this.filter}\r\n                    className='form-control filter-textbox'\r\n                    placeholder={this.props.intl.formatMessage({id: 'filtered_channels_list.search', defaultMessage: 'Search channels'})}\r\n                    onInput={this.handleChange}\r\n                    clearable={true}\r\n                    onClear={this.handleClear}\r\n                    value={this.state.channelSearchValue}\r\n                    aria-label={this.props.intl.formatMessage({id: 'filtered_channels_list.search', defaultMessage: 'Search Channels'})}\r\n                />\r\n            </div>\r\n        );\r\n\r\n        const checkIcon = (\r\n            <CheckIcon\r\n                size={18}\r\n                color={'var(--button-bg)'}\r\n            />\r\n        );\r\n        const channelDropdownItems = [\r\n            <Menu.Item\r\n                key='channelsMoreDropdownAll'\r\n                id='channelsMoreDropdownAll'\r\n                onClick={() => this.filterChange(Filter.All)}\r\n                leadingElement={<GlobeCheckedIcon size={16}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='suggestion.all'\r\n                        defaultMessage='All channel types'\r\n                    />\r\n                }\r\n                trailingElements={this.props.filter === Filter.All ? checkIcon : null}\r\n                aria-label={this.props.intl.formatMessage({id: 'suggestion.all', defaultMessage: 'All channel types'})}\r\n            />,\r\n            <Menu.Item\r\n                key='channelsMoreDropdownPublic'\r\n                id='channelsMoreDropdownPublic'\r\n                onClick={() => this.filterChange(Filter.Public)}\r\n                leadingElement={<GlobeIcon size={16}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='suggestion.public'\r\n                        defaultMessage='Public channels'\r\n                    />\r\n                }\r\n                trailingElements={this.props.filter === Filter.Public ? checkIcon : null}\r\n                aria-label={this.props.intl.formatMessage({id: 'suggestion.public', defaultMessage: 'Public channels'})}\r\n            />,\r\n            <Menu.Item\r\n                key='channelsMoreDropdownPrivate'\r\n                id='channelsMoreDropdownPrivate'\r\n                onClick={() => this.filterChange(Filter.Private)}\r\n                leadingElement={<LockOutlineIcon size={16}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='suggestion.private'\r\n                        defaultMessage='Private channels'\r\n                    />\r\n                }\r\n                trailingElements={this.props.filter === Filter.Private ? checkIcon : null}\r\n                aria-label={this.props.intl.formatMessage({id: 'suggestion.private', defaultMessage: 'Private channels'})}\r\n            />,\r\n        ];\r\n\r\n        channelDropdownItems.push(\r\n            <Menu.Separator key='channelsMoreDropdownSeparator'/>,\r\n            <Menu.Item\r\n                key='channelsMoreDropdownArchived'\r\n                id='channelsMoreDropdownArchived'\r\n                onClick={() => this.filterChange(Filter.Archived)}\r\n                leadingElement={<ArchiveOutlineIcon size={16}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='suggestion.archive'\r\n                        defaultMessage='Archived channels'\r\n                    />\r\n                }\r\n                trailingElements={this.props.filter === Filter.Archived ? checkIcon : null}\r\n                aria-label={this.props.intl.formatMessage({id: 'suggestion.archive', defaultMessage: 'Archived channels'})}\r\n            />,\r\n        );\r\n        const menuButton = (\r\n            <>\r\n                {this.getFilterLabel()}\r\n                <ChevronDownIcon\r\n                    color={'rgba(var(--center-channel-color-rgb), 0.64)'}\r\n                    size={16}\r\n                />\r\n            </>\r\n        );\r\n        const channelDropdown = (\r\n            <>\r\n                <div\r\n                    role='status'\r\n                    aria-atomic='true'\r\n                    className='sr-only'\r\n                >\r\n                    {this.props.intl.formatMessage({\r\n                        id: 'more_channels.channel_type_filter.filter_type_set',\r\n                        defaultMessage: 'Channel type filter set to {filterType}',\r\n                    }, {\r\n                        filterType: this.props.filter,\r\n                    })}\r\n                </div>\r\n                <Menu.Container\r\n                    menuButton={{\r\n                        id: 'menuWrapper',\r\n                        children: menuButton,\r\n                        'aria-label': this.props.intl.formatMessage({id: 'more_channels.channel_type_filter', defaultMessage: 'Channel type filter'}),\r\n                    }}\r\n                    menu={{\r\n                        id: 'browseChannelsDropdown',\r\n                        'aria-label': this.props.intl.formatMessage({id: 'more_channels.channel_type_filter', defaultMessage: 'Channel type filter'}),\r\n                    }}\r\n                >\r\n                    {channelDropdownItems.map((item) => item)}\r\n                </Menu.Container>\r\n            </>\r\n        );\r\n\r\n        const hideJoinedButtonClass = classNames('get-app__checkbox', {checked: this.props.rememberHideJoinedChannelsChecked});\r\n        const hideJoinedPreferenceCheckbox = (\r\n            <div\r\n                id={'hideJoinedPreferenceCheckbox'}\r\n                onClick={this.handleChecked}\r\n                onKeyDown={(e) => {\r\n                    e.stopPropagation();\r\n                    if (e.key === 'Enter' || e.key === ' ') {\r\n                        this.handleChecked();\r\n                    }\r\n                }}\r\n                role='checkbox'\r\n                aria-checked={this.props.rememberHideJoinedChannelsChecked}\r\n                aria-label={this.props.intl.formatMessage({id: 'more_channels.hide_joined_channels', defaultMessage: 'Hide joined channels'})}\r\n                tabIndex={0}\r\n            >\r\n                <div className={hideJoinedButtonClass}>\r\n                    {this.props.rememberHideJoinedChannelsChecked ? <CheckboxCheckedIcon/> : null}\r\n                </div>\r\n                <FormattedMessage\r\n                    id='more_channels.hide_joined'\r\n                    defaultMessage='Hide Joined'\r\n                />\r\n            </div>\r\n        );\r\n\r\n        let channelCountLabel;\r\n        if (channels.length === 0) {\r\n            channelCountLabel = this.props.intl.formatMessage({id: 'more_channels.count_zero', defaultMessage: '0 Results'});\r\n        } else if (channels.length === 1) {\r\n            channelCountLabel = this.props.intl.formatMessage({id: 'more_channels.count_one', defaultMessage: '1 Result'});\r\n        } else if (channels.length > 1) {\r\n            channelCountLabel = this.props.intl.formatMessage(messages.channelCount, {count: channels.length});\r\n        } else {\r\n            channelCountLabel = this.props.intl.formatMessage({id: 'more_channels.count_zero', defaultMessage: '0 Results'});\r\n        }\r\n\r\n        const dropDownContainer = (\r\n            <div className='more-modal__dropdown'>\r\n                <span id='channelCountLabel'>{channelCountLabel}</span>\r\n                <span\r\n                    className='sr-only'\r\n                    role='status'\r\n                    aria-live='polite'\r\n                >\r\n                    {channelCountLabel}\r\n                </span>\r\n                <div id='modalPreferenceContainer'>\r\n                    {channelDropdown}\r\n                    {hideJoinedPreferenceCheckbox}\r\n                </div>\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <div className='filtered-user-list'>\r\n                {input}\r\n                {dropDownContainer}\r\n                <div\r\n                    role='search'\r\n                    className='more-modal__list'\r\n                    tabIndex={-1}\r\n                >\r\n                    <div\r\n                        id='moreChannelsList'\r\n                        tabIndex={-1}\r\n                        ref={this.channelListScroll}\r\n                    >\r\n                        {listContent}\r\n                    </div>\r\n                </div>\r\n                <div className='filter-controls'>\r\n                    {previousButton}\r\n                    {nextButton}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst messages = defineMessages({\r\n    channelCount: {\r\n        id: 'more_channels.count',\r\n        defaultMessage: '{count} Results',\r\n    },\r\n    channelPurpose: {\r\n        id: 'more_channels.channel_purpose',\r\n        defaultMessage: 'Channel Information: Membership Indicator: Joined, Member count {memberCount} , Purpose: {channelPurpose}',\r\n    },\r\n    joiningButton: {\r\n        id: 'joinChannel.joiningButton',\r\n        defaultMessage: 'Joining...',\r\n    },\r\n    noMore: {\r\n        id: 'more_channels.noMore',\r\n        defaultMessage: 'No results for {text}',\r\n    },\r\n});\r\n\r\nexport default injectIntl(SearchableChannelList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {Channel, ChannelMembership, ChannelSearchOpts, ChannelsWithTotalCount} from '@mattermost/types/channels';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport NewChannelModal from 'components/new_channel_modal/new_channel_modal';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\nimport SearchableChannelList from 'components/searchable_channel_list';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants, {ModalIdentifiers, RHSStates, StoragePrefixes} from 'utils/constants';\r\nimport {getRelativeChannelURL} from 'utils/url';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nimport type {ModalData} from 'types/actions';\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nimport './browse_channels.scss';\r\n\r\nconst CHANNELS_CHUNK_SIZE = 50;\r\nconst CHANNELS_PER_PAGE = 50;\r\nconst SEARCH_TIMEOUT_MILLISECONDS = 100;\r\nexport enum Filter {\r\n    All = 'All',\r\n    Public = 'Public',\r\n    Private = 'Private',\r\n    Archived = 'Archived',\r\n}\r\n\r\nexport type FilterType = keyof typeof Filter;\r\n\r\ntype Actions = {\r\n    getChannels: (teamId: string, page: number, perPage: number) => Promise<ActionResult<Channel[]>>;\r\n    getArchivedChannels: (teamId: string, page: number, channelsPerPage: number) => Promise<ActionResult<Channel[]>>;\r\n    joinChannel: (currentUserId: string, teamId: string, channelId: string) => Promise<ActionResult>;\r\n    searchAllChannels: (term: string, opts?: ChannelSearchOpts) => Promise<ActionResult<Channel[] | ChannelsWithTotalCount>>;\r\n    openModal: <P>(modalData: ModalData<P>) => void;\r\n    closeModal: (modalId: string) => void;\r\n\r\n    /*\r\n     * Function to set a key-value pair in the local storage\r\n     */\r\n    setGlobalItem: (name: string, value: string) => void;\r\n    closeRightHandSide: () => void;\r\n    getChannelsMemberCount: (channelIds: string[]) => Promise<ActionResult>;\r\n}\r\n\r\nexport type Props = {\r\n    channels: Channel[];\r\n    archivedChannels: Channel[];\r\n    privateChannels: Channel[];\r\n    currentUserId: string;\r\n    teamId: string;\r\n    teamName?: string;\r\n    channelsRequestStarted?: boolean;\r\n    myChannelMemberships: RelationOneToOne<Channel, ChannelMembership>;\r\n    shouldHideJoinedChannels: boolean;\r\n    rhsState?: RhsState;\r\n    rhsOpen?: boolean;\r\n    channelsMemberCount?: Record<string, number>;\r\n    actions: Actions;\r\n}\r\n\r\ntype State = {\r\n    loading: boolean;\r\n    filter: FilterType;\r\n    search: boolean;\r\n    searchedChannels: Channel[];\r\n    serverError: React.ReactNode | string;\r\n    searching: boolean;\r\n    searchTerm: string;\r\n}\r\n\r\nexport default class BrowseChannels extends React.PureComponent<Props, State> {\r\n    public searchTimeoutId: number;\r\n    activeChannels: Channel[] = [];\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.searchTimeoutId = 0;\r\n\r\n        this.state = {\r\n            loading: true,\r\n            filter: Filter.All,\r\n            search: false,\r\n            searchedChannels: [],\r\n            serverError: null,\r\n            searching: false,\r\n            searchTerm: '',\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (!this.props.teamId) {\r\n            this.loadComplete();\r\n            return;\r\n        }\r\n\r\n        const promises = [\r\n            this.props.actions.getChannels(this.props.teamId, 0, CHANNELS_CHUNK_SIZE * 2),\r\n            this.props.actions.getArchivedChannels(this.props.teamId, 0, CHANNELS_CHUNK_SIZE * 2),\r\n        ];\r\n\r\n        Promise.all(promises).then((results) => {\r\n            const channelIDsForMemberCount = results.flatMap((result) => {\r\n                return result.data ? result.data.map((channel) => channel.id) : [];\r\n            },\r\n            );\r\n            this.props.privateChannels.forEach((channel) => channelIDsForMemberCount.push(channel.id));\r\n            if (channelIDsForMemberCount.length > 0) {\r\n                this.props.actions.getChannelsMemberCount(channelIDsForMemberCount);\r\n            }\r\n        });\r\n        this.loadComplete();\r\n    }\r\n\r\n    loadComplete = () => {\r\n        this.setState({loading: false});\r\n    };\r\n\r\n    handleNewChannel = () => {\r\n        this.handleExit();\r\n        this.closeEditRHS();\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.NEW_CHANNEL_MODAL,\r\n            dialogType: NewChannelModal,\r\n        });\r\n    };\r\n\r\n    handleExit = () => {\r\n        this.props.actions.closeModal(ModalIdentifiers.MORE_CHANNELS);\r\n    };\r\n\r\n    closeEditRHS = () => {\r\n        if (this.props.rhsOpen && this.props.rhsState === RHSStates.EDIT_HISTORY) {\r\n            this.props.actions.closeRightHandSide();\r\n        }\r\n    };\r\n\r\n    onChange = (force: boolean) => {\r\n        if (this.state.search && !force) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            searchedChannels: [],\r\n            serverError: null,\r\n        });\r\n    };\r\n\r\n    nextPage = (page: number) => {\r\n        this.props.actions.getChannels(this.props.teamId, page + 1, CHANNELS_PER_PAGE).then((result) => {\r\n            if (result.data && result.data.length > 0) {\r\n                this.props.actions.getChannelsMemberCount(result.data.map((channel) => channel.id));\r\n            }\r\n        });\r\n    };\r\n\r\n    handleJoin = async (channel: Channel, done: () => void) => {\r\n        const {actions, currentUserId, teamId, teamName} = this.props;\r\n        let result;\r\n\r\n        if (!this.isMemberOfChannel(channel.id)) {\r\n            result = await actions.joinChannel(currentUserId, teamId, channel.id);\r\n        }\r\n\r\n        if (result?.error) {\r\n            this.setState({serverError: result.error.message});\r\n        } else {\r\n            this.props.actions.getChannelsMemberCount([channel.id]);\r\n            getHistory().push(getRelativeChannelURL(teamName!, channel.name));\r\n            this.closeEditRHS();\r\n        }\r\n\r\n        if (done) {\r\n            done();\r\n        }\r\n    };\r\n\r\n    search = (term: string) => {\r\n        clearTimeout(this.searchTimeoutId);\r\n\r\n        if (term === '') {\r\n            this.onChange(true);\r\n            this.setState({search: false, searchedChannels: [], searching: false, searchTerm: term});\r\n            this.searchTimeoutId = 0;\r\n            return;\r\n        }\r\n        this.setState({search: true, searching: true, searchTerm: term});\r\n\r\n        const searchTimeoutId = window.setTimeout(\r\n            async () => {\r\n                try {\r\n                    const {data} = await this.props.actions.searchAllChannels(term, {team_ids: [this.props.teamId], nonAdminSearch: true, include_deleted: true}) as ActionResult<Channel[]>;\r\n                    if (searchTimeoutId !== this.searchTimeoutId) {\r\n                        return;\r\n                    }\r\n\r\n                    if (data) {\r\n                        const channelIDsForMemberCount = data.map((channel: Channel) => channel.id);\r\n                        if (channelIDsForMemberCount.length > 0) {\r\n                            this.props.actions.getChannelsMemberCount(channelIDsForMemberCount);\r\n                        }\r\n                        this.setSearchResults(data.filter((channel) => channel.team_id === this.props.teamId));\r\n                    } else {\r\n                        this.setState({searchedChannels: [], searching: false});\r\n                    }\r\n                } catch (ignoredErr) {\r\n                    this.setState({searchedChannels: [], searching: false});\r\n                }\r\n            },\r\n            SEARCH_TIMEOUT_MILLISECONDS,\r\n        );\r\n\r\n        this.searchTimeoutId = searchTimeoutId;\r\n    };\r\n\r\n    setSearchResults = (channels: Channel[]) => {\r\n        // filter out private channels that the user is not a member of\r\n        let searchedChannels = channels.filter((c) => c.type !== Constants.PRIVATE_CHANNEL || this.isMemberOfChannel(c.id));\r\n        if (this.state.filter === Filter.Private) {\r\n            searchedChannels = channels.filter((c) => c.type === Constants.PRIVATE_CHANNEL && this.isMemberOfChannel(c.id));\r\n        }\r\n        if (this.state.filter === Filter.Public) {\r\n            searchedChannels = channels.filter((c) => c.type === Constants.OPEN_CHANNEL && c.delete_at === 0);\r\n        }\r\n        if (this.state.filter === Filter.Archived) {\r\n            searchedChannels = channels.filter((c) => c.delete_at !== 0);\r\n        }\r\n        if (this.props.shouldHideJoinedChannels) {\r\n            searchedChannels = this.getChannelsWithoutJoined(searchedChannels);\r\n        }\r\n        this.setState({searchedChannels, searching: false});\r\n    };\r\n\r\n    changeFilter = (filter: FilterType) => {\r\n        // search again when switching channels to update search results\r\n        this.search(this.state.searchTerm);\r\n        this.setState({filter});\r\n    };\r\n\r\n    isMemberOfChannel(channelId: string) {\r\n        return this.props.myChannelMemberships[channelId];\r\n    }\r\n\r\n    handleShowJoinedChannelsPreference = (shouldHideJoinedChannels: boolean) => {\r\n        // search again when switching channels to update search results\r\n        this.search(this.state.searchTerm);\r\n        this.props.actions.setGlobalItem(StoragePrefixes.HIDE_JOINED_CHANNELS, shouldHideJoinedChannels.toString());\r\n    };\r\n\r\n    getChannelsWithoutJoined = (channelList: Channel[]) => channelList.filter((channel) => !this.isMemberOfChannel(channel.id));\r\n\r\n    getActiveChannels = () => {\r\n        const {channels, archivedChannels, shouldHideJoinedChannels, privateChannels} = this.props;\r\n        const {search, searchedChannels, filter} = this.state;\r\n\r\n        const allChannels = channels.concat(privateChannels).sort((a, b) => a.display_name.localeCompare(b.display_name));\r\n        const allChannelsWithoutJoined = this.getChannelsWithoutJoined(allChannels);\r\n        const publicChannelsWithoutJoined = this.getChannelsWithoutJoined(channels);\r\n        const archivedChannelsWithoutJoined = this.getChannelsWithoutJoined(archivedChannels);\r\n        const privateChannelsWithoutJoined = this.getChannelsWithoutJoined(privateChannels);\r\n\r\n        const filterOptions = {\r\n            [Filter.All]: shouldHideJoinedChannels ? allChannelsWithoutJoined : allChannels,\r\n            [Filter.Archived]: shouldHideJoinedChannels ? archivedChannelsWithoutJoined : archivedChannels,\r\n            [Filter.Private]: shouldHideJoinedChannels ? privateChannelsWithoutJoined : privateChannels,\r\n            [Filter.Public]: shouldHideJoinedChannels ? publicChannelsWithoutJoined : channels,\r\n        };\r\n\r\n        if (search) {\r\n            return searchedChannels;\r\n        }\r\n\r\n        return filterOptions[filter] || filterOptions[Filter.All];\r\n    };\r\n\r\n    render() {\r\n        const {teamId, channelsRequestStarted, shouldHideJoinedChannels} = this.props;\r\n        const {search, serverError: serverErrorState, searching} = this.state;\r\n\r\n        this.activeChannels = this.getActiveChannels();\r\n\r\n        let serverError;\r\n        if (serverErrorState) {\r\n            serverError =\r\n                <div className='form-group has-error'><label className='control-label'>{serverErrorState}</label></div>;\r\n        }\r\n\r\n        const createNewChannelButton = (className: string, icon?: JSX.Element) => {\r\n            const buttonClassName = classNames('btn', className);\r\n            return (\r\n                <TeamPermissionGate\r\n                    teamId={teamId}\r\n                    permissions={[Permissions.CREATE_PUBLIC_CHANNEL]}\r\n                >\r\n                    <button\r\n                        type='button'\r\n                        id='createNewChannelButton'\r\n                        className={buttonClassName}\r\n                        onClick={this.handleNewChannel}\r\n                        aria-label={localizeMessage({id: 'more_channels.create', defaultMessage: 'Create New Channel'})}\r\n                    >\r\n                        {icon}\r\n                        <FormattedMessage\r\n                            id='more_channels.create'\r\n                            defaultMessage='Create New Channel'\r\n                        />\r\n                    </button>\r\n                </TeamPermissionGate>\r\n            );\r\n        };\r\n\r\n        const noResultsText = (\r\n            <>\r\n                <p className='secondary-message'>\r\n                    <FormattedMessage\r\n                        id='more_channels.searchError'\r\n                        defaultMessage='Try searching different keywords, checking for typos or adjusting the filters.'\r\n                    />\r\n                </p>\r\n                {createNewChannelButton('btn-primary', <i className='icon-plus'/>)}\r\n            </>\r\n        );\r\n\r\n        const body = this.state.loading ? <LoadingScreen/> : (\r\n            <>\r\n                <SearchableChannelList\r\n                    channels={this.activeChannels}\r\n                    channelsPerPage={CHANNELS_PER_PAGE}\r\n                    nextPage={this.nextPage}\r\n                    isSearch={search}\r\n                    search={this.search}\r\n                    handleJoin={this.handleJoin}\r\n                    noResultsText={noResultsText}\r\n                    loading={search ? searching : channelsRequestStarted}\r\n                    changeFilter={this.changeFilter}\r\n                    filter={this.state.filter}\r\n                    myChannelMemberships={this.props.myChannelMemberships}\r\n                    closeModal={this.props.actions.closeModal}\r\n                    hideJoinedChannelsPreference={this.handleShowJoinedChannelsPreference}\r\n                    rememberHideJoinedChannelsChecked={shouldHideJoinedChannels}\r\n                    channelsMemberCount={this.props.channelsMemberCount}\r\n                />\r\n                {serverError}\r\n            </>\r\n        );\r\n\r\n        const title = (\r\n            <FormattedMessage\r\n                id='more_channels.title'\r\n                defaultMessage='Browse Channels'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <GenericModal\r\n                id='browseChannelsModal'\r\n                onExited={this.handleExit}\r\n                compassDesign={true}\r\n                modalHeaderText={title}\r\n                headerButton={createNewChannelButton('btn-secondary btn-sm')}\r\n                autoCloseOnConfirmButton={false}\r\n                aria-modal={true}\r\n                enforceFocus={false}\r\n                bodyPadding={false}\r\n            >\r\n                {body}\r\n            </GenericModal>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {getChannels, getArchivedChannels, joinChannel, getChannelsMemberCount, searchAllChannels} from 'mattermost-redux/actions/channels';\r\nimport {RequestStatus} from 'mattermost-redux/constants';\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getChannelsInCurrentTeam, getMyChannelMemberships, getChannelsMemberCount as getChannelsMemberCountSelector} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam, getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {setGlobalItem} from 'actions/storage';\r\nimport {openModal, closeModal} from 'actions/views/modals';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\nimport {makeGetGlobalItem} from 'selectors/storage';\r\n\r\nimport Constants, {StoragePrefixes} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport BrowseChannels from './browse_channels';\r\n\r\nconst getChannelsWithoutArchived = createSelector(\r\n    'getChannelsWithoutArchived',\r\n    getChannelsInCurrentTeam,\r\n    (channels: Channel[]) => channels && channels.filter((c) => c.delete_at === 0 && c.type !== Constants.PRIVATE_CHANNEL),\r\n);\r\n\r\nconst getArchivedOtherChannels = createSelector(\r\n    'getArchivedOtherChannels',\r\n    getChannelsInCurrentTeam,\r\n    (channels: Channel[]) => channels && channels.filter((c) => c.delete_at !== 0),\r\n);\r\n\r\nconst getPrivateChannelsSelector = createSelector(\r\n    'getPrivateChannelsSelector',\r\n    getChannelsInCurrentTeam,\r\n    (channels: Channel[]) => channels && channels.filter((c) => c.type === Constants.PRIVATE_CHANNEL),\r\n);\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const team = getCurrentTeam(state);\r\n    const getGlobalItem = makeGetGlobalItem(StoragePrefixes.HIDE_JOINED_CHANNELS, 'false');\r\n\r\n    return {\r\n        channels: getChannelsWithoutArchived(state) || [],\r\n        archivedChannels: getArchivedOtherChannels(state) || [],\r\n        privateChannels: getPrivateChannelsSelector(state) || [],\r\n        currentUserId: getCurrentUserId(state),\r\n        teamId: getCurrentTeamId(state),\r\n        teamName: team?.name,\r\n        channelsRequestStarted: state.requests.channels.getChannels.status === RequestStatus.STARTED,\r\n        myChannelMemberships: getMyChannelMemberships(state) || {},\r\n        shouldHideJoinedChannels: getGlobalItem(state) === 'true',\r\n        rhsState: getRhsState(state),\r\n        rhsOpen: getIsRhsOpen(state),\r\n        channelsMemberCount: getChannelsMemberCountSelector(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getChannels,\r\n            getArchivedChannels,\r\n            joinChannel,\r\n            searchAllChannels,\r\n            openModal,\r\n            closeModal,\r\n            setGlobalItem,\r\n            closeRightHandSide,\r\n            getChannelsMemberCount,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(BrowseChannels);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useEffect, useMemo, useState} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getChannelBookmarks} from 'mattermost-redux/selectors/entities/channel_bookmarks';\r\nimport {getChannel, getMyChannelMember} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig, getFeatureFlagValue, getLicense} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {insertWithoutDuplicates} from 'mattermost-redux/utils/array_utils';\r\n\r\nimport {fetchChannelBookmarks, reorderBookmark} from 'actions/channel_bookmarks';\r\nimport {loadCustomEmojisIfNeeded} from 'actions/emoji_actions';\r\n\r\nimport Constants from 'utils/constants';\r\nimport {trimmedEmojiName} from 'utils/emoji_utils';\r\nimport {canUploadFiles, isPublicLinksEnabled} from 'utils/file_utils';\r\n\r\nexport const MAX_BOOKMARKS_PER_CHANNEL = 50;\r\n\r\nconst {OPEN_CHANNEL, PRIVATE_CHANNEL, GM_CHANNEL, DM_CHANNEL} = Constants as {OPEN_CHANNEL: 'O'; PRIVATE_CHANNEL: 'P'; GM_CHANNEL: 'G'; DM_CHANNEL: 'D'};\r\n\r\ntype TAction = 'add' | 'edit' | 'delete' | 'order';\r\ntype TActionKey = `${TAction}${typeof OPEN_CHANNEL | typeof PRIVATE_CHANNEL}`;\r\n\r\nconst key = (a: TAction, c: typeof OPEN_CHANNEL | typeof PRIVATE_CHANNEL): TActionKey => {\r\n    return `${a}${c}`;\r\n};\r\n\r\nconst BOOKMARK_PERMISSION = {\r\n\r\n    // open channel\r\n    [key('add', OPEN_CHANNEL)]: Permissions.ADD_BOOKMARK_PUBLIC_CHANNEL,\r\n    [key('edit', OPEN_CHANNEL)]: Permissions.EDIT_BOOKMARK_PUBLIC_CHANNEL,\r\n    [key('delete', OPEN_CHANNEL)]: Permissions.DELETE_BOOKMARK_PUBLIC_CHANNEL,\r\n    [key('order', OPEN_CHANNEL)]: Permissions.ORDER_BOOKMARK_PUBLIC_CHANNEL,\r\n\r\n    // private channel\r\n    [key('add', PRIVATE_CHANNEL)]: Permissions.ADD_BOOKMARK_PRIVATE_CHANNEL,\r\n    [key('edit', PRIVATE_CHANNEL)]: Permissions.EDIT_BOOKMARK_PRIVATE_CHANNEL,\r\n    [key('delete', PRIVATE_CHANNEL)]: Permissions.DELETE_BOOKMARK_PRIVATE_CHANNEL,\r\n    [key('order', PRIVATE_CHANNEL)]: Permissions.ORDER_BOOKMARK_PRIVATE_CHANNEL,\r\n} as const;\r\n\r\nexport const useChannelBookmarkPermission = (channelId: string, action: TAction) => {\r\n    return useSelector((state: GlobalState) => getHaveIChannelBookmarkPermission(state, channelId, action));\r\n};\r\n\r\nexport const getHaveIChannelBookmarkPermission = (state: GlobalState, channelId: string, action: TAction) => {\r\n    const channel: Channel | undefined = getChannel(state, channelId);\r\n\r\n    if (!channel) {\r\n        return false;\r\n    }\r\n\r\n    if (channel.delete_at !== 0) {\r\n        return false;\r\n    }\r\n\r\n    const {type} = channel;\r\n\r\n    if (type === 'threads') {\r\n        return false;\r\n    }\r\n\r\n    if (type === GM_CHANNEL || type === DM_CHANNEL) {\r\n        const myMembership = getMyChannelMember(state, channelId);\r\n        return myMembership?.channel_id === channelId;\r\n    }\r\n\r\n    const permission = BOOKMARK_PERMISSION[key(action, type)];\r\n\r\n    return channel && permission && haveIChannelPermission(state, channel.team_id, channelId, permission);\r\n};\r\n\r\nexport const useCanUploadFiles = () => {\r\n    return useSelector((state: GlobalState) => canUploadFiles(getConfig(state)));\r\n};\r\n\r\nexport const useCanGetPublicLink = () => {\r\n    return useSelector((state: GlobalState) => isPublicLinksEnabled(getConfig(state)));\r\n};\r\n\r\nexport const useCanGetLinkPreviews = () => {\r\n    return useSelector((state: GlobalState) => getConfig(state).EnableLinkPreviews === 'true');\r\n};\r\n\r\nexport const getIsChannelBookmarksEnabled = (state: GlobalState) => {\r\n    const isEnabled = getFeatureFlagValue(state, 'ChannelBookmarks') === 'true';\r\n\r\n    if (!isEnabled) {\r\n        return false;\r\n    }\r\n\r\n    const license = getLicense(state);\r\n\r\n    return license?.IsLicensed === 'true';\r\n};\r\n\r\nexport const useChannelBookmarks = (channelId: string) => {\r\n    const dispatch = useDispatch();\r\n    const bookmarks = useSelector((state: GlobalState) => getChannelBookmarks(state, channelId));\r\n\r\n    const order = useMemo(() => {\r\n        return Object.keys(bookmarks).sort((a, b) => bookmarks[a].sort_order - bookmarks[b].sort_order);\r\n    }, [bookmarks]);\r\n    const [tempOrder, setTempOrder] = useState<typeof order>();\r\n\r\n    useEffect(() => {\r\n        if (tempOrder) {\r\n            setTempOrder(undefined);\r\n        }\r\n    }, [order]);\r\n\r\n    useEffect(() => {\r\n        if (channelId) {\r\n            dispatch(fetchChannelBookmarks(channelId));\r\n        }\r\n    }, [channelId]);\r\n\r\n    useEffect(() => {\r\n        const emojis = Object.values(bookmarks).reduce<string[]>((result, {emoji}) => {\r\n            if (emoji) {\r\n                result.push(trimmedEmojiName(emoji));\r\n            }\r\n\r\n            return result;\r\n        }, []);\r\n\r\n        if (emojis.length) {\r\n            dispatch(loadCustomEmojisIfNeeded(emojis));\r\n        }\r\n    }, [bookmarks]);\r\n\r\n    const reorder = async (id: string, prevOrder: number, nextOrder: number) => {\r\n        setTempOrder(insertWithoutDuplicates(order, id, nextOrder));\r\n        const {error} = await dispatch(reorderBookmark(channelId, id, nextOrder));\r\n\r\n        if (error) {\r\n            setTempOrder(undefined);\r\n        }\r\n    };\r\n\r\n    return {\r\n        bookmarks,\r\n        order: tempOrder ?? order,\r\n        reorder,\r\n    } as const;\r\n};\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\nimport type {MouseEvent, KeyboardEvent} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {\r\n    FolderOutlineIcon,\r\n    StarOutlineIcon,\r\n    FolderMoveOutlineIcon,\r\n    ChevronRightIcon,\r\n    CheckIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {CategoryTypes} from 'mattermost-redux/constants/channel_categories';\r\nimport {getCategoryInTeamWithChannel} from 'mattermost-redux/selectors/entities/channel_categories';\r\nimport {getAllChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {addChannelsInSidebar} from 'actions/views/channel_sidebar';\r\nimport {openModal} from 'actions/views/modals';\r\nimport {getCategoriesForCurrentTeam} from 'selectors/views/channel_sidebar';\r\n\r\nimport EditCategoryModal from 'components/edit_category_modal';\r\nimport * as Menu from 'components/menu';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\ntype Props = {\r\n    channel: Channel;\r\n    inHeaderDropdown?: boolean;\r\n};\r\n\r\nconst ChannelMoveToSubMenu = (props: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const allChannels = useSelector(getAllChannels);\r\n    const multiSelectedChannelIds = useSelector((state: GlobalState) => state.views.channelSidebar.multiSelectedChannelIds);\r\n\r\n    const currentTeam = useSelector(getCurrentTeam);\r\n    const categories = useSelector((state: GlobalState) => {\r\n        return currentTeam ? getCategoriesForCurrentTeam(state) : undefined;\r\n    });\r\n    const currentCategory = useSelector((state: GlobalState) => {\r\n        return currentTeam ? getCategoryInTeamWithChannel(state, currentTeam?.id || '', props.channel.id) : undefined;\r\n    });\r\n\r\n    function handleMoveToCategory(event: MouseEvent<HTMLLIElement> | KeyboardEvent<HTMLLIElement>, categoryId: string) {\r\n        event.preventDefault();\r\n\r\n        if (currentCategory?.id !== categoryId) {\r\n            dispatch(addChannelsInSidebar(categoryId, props.channel.id));\r\n        }\r\n    }\r\n\r\n    function handleMoveToNewCategory() {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.EDIT_CATEGORY,\r\n            dialogType: EditCategoryModal,\r\n            dialogProps: {\r\n                channelIdsToAdd: multiSelectedChannelIds.indexOf(props.channel.id) === -1 ? [props.channel.id] : multiSelectedChannelIds,\r\n            },\r\n        }));\r\n    }\r\n\r\n    function createSubmenuItemsForCategoryArray(categories: ChannelCategory[], currentCategory?: ChannelCategory) {\r\n        const allCategories = categories.map((category: ChannelCategory) => {\r\n            let text = <span>{category.display_name}</span>;\r\n\r\n            if (category.type === CategoryTypes.FAVORITES) {\r\n                text = (\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.favorites'\r\n                        defaultMessage='Favorites'\r\n                    />\r\n                );\r\n            }\r\n            if (category.type === CategoryTypes.CHANNELS) {\r\n                text = (\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.channels'\r\n                        defaultMessage='Channels'\r\n                    />\r\n                );\r\n            }\r\n\r\n            let selectedCategory = null;\r\n            if (currentCategory && currentCategory.display_name === category.display_name) {\r\n                selectedCategory = (\r\n                    <CheckIcon\r\n                        color='var(--button-bg)'\r\n                        size={18}\r\n                    />\r\n                );\r\n            }\r\n\r\n            return (\r\n                <Menu.Item\r\n                    id={`moveToCategory-${props.channel.id}-${category.id}`}\r\n                    key={`moveToCategory-${props.channel.id}-${category.id}`}\r\n                    leadingElement={category.type === CategoryTypes.FAVORITES ? (<StarOutlineIcon size={18}/>) : (<FolderOutlineIcon size={18}/>)}\r\n                    labels={text}\r\n                    trailingElements={selectedCategory}\r\n                    onClick={(event) => handleMoveToCategory(event, category.id)}\r\n                />\r\n            );\r\n        });\r\n\r\n        const dividerAndNewCategory = [\r\n            <Menu.Separator key='ChannelMenu-moveToDivider'/>,\r\n            <Menu.Item\r\n                id={`moveToNewCategory-${props.channel.id}`}\r\n                key={`moveToNewCategory-${props.channel.id}`}\r\n                aria-haspopup={true}\r\n                leadingElement={<FolderMoveOutlineIcon size={18}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.moveToNewCategory'\r\n                        defaultMessage='New Category'\r\n                    />\r\n                }\r\n                onClick={handleMoveToNewCategory}\r\n            />,\r\n        ];\r\n\r\n        return [...allCategories, ...dividerAndNewCategory];\r\n    }\r\n\r\n    function filterCategoriesBasedOnChannelType(categories: ChannelCategory[], isDmOrGm = false) {\r\n        if (isDmOrGm) {\r\n            return categories.filter((category) => category.type !== CategoryTypes.CHANNELS);\r\n        }\r\n\r\n        return categories.filter((category) => category.type !== CategoryTypes.DIRECT_MESSAGES);\r\n    }\r\n\r\n    function getMoveToCategorySubmenuItems(categories: ChannelCategory[], currentCategory?: ChannelCategory) {\r\n        const isSubmenuOneOfSelectedChannels = multiSelectedChannelIds.includes(props.channel.id);\r\n\r\n        // If sub menu is in channel header dropdown OR If multiple channels are selected but the menu is open outside of those selected channels\r\n        if (props.inHeaderDropdown || !isSubmenuOneOfSelectedChannels) {\r\n            const isDmOrGm = props.channel.type === Constants.DM_CHANNEL || props.channel.type === Constants.GM_CHANNEL;\r\n            const filteredCategories = filterCategoriesBasedOnChannelType(categories, isDmOrGm);\r\n            return createSubmenuItemsForCategoryArray(filteredCategories, currentCategory);\r\n        }\r\n\r\n        const areAllSelectedChannelsDMorGM = multiSelectedChannelIds.every((channelId) => allChannels[channelId].type === Constants.DM_CHANNEL || allChannels[channelId].type === Constants.GM_CHANNEL);\r\n        if (areAllSelectedChannelsDMorGM) {\r\n            const filteredCategories = filterCategoriesBasedOnChannelType(categories, true);\r\n            return createSubmenuItemsForCategoryArray(filteredCategories, currentCategory);\r\n        }\r\n\r\n        const areAllSelectedChannelsAreNotDMorGM = multiSelectedChannelIds.every((channelId) => allChannels[channelId].type !== Constants.DM_CHANNEL && allChannels[channelId].type !== Constants.GM_CHANNEL);\r\n        if (areAllSelectedChannelsAreNotDMorGM) {\r\n            const filteredCategories = filterCategoriesBasedOnChannelType(categories, false);\r\n            return createSubmenuItemsForCategoryArray(filteredCategories, currentCategory);\r\n        }\r\n\r\n        // If we have a mix of channel types, we need to filter out both the DM and Channel categories\r\n        const filteredCategories = categories.filter((category) => category.type !== CategoryTypes.CHANNELS && category.type !== CategoryTypes.DIRECT_MESSAGES);\r\n        return createSubmenuItemsForCategoryArray(filteredCategories, currentCategory);\r\n    }\r\n\r\n    if (!categories) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <Menu.SubMenu\r\n            id={`moveTo-${props.channel.id}`}\r\n            labels={\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_channel_menu.moveTo'\r\n                    defaultMessage='Move to...'\r\n                />\r\n            }\r\n            leadingElement={props.inHeaderDropdown ? null : <FolderMoveOutlineIcon size={18}/>}\r\n            trailingElements={<ChevronRightIcon size={16}/>}\r\n            menuId={`moveTo-${props.channel.id}-menu`}\r\n            menuAriaLabel={formatMessage({id: 'sidebar_left.sidebar_channel_menu.moveTo.dropdownAriaLabel', defaultMessage: 'Move to submenu'})}\r\n        >\r\n            {getMoveToCategorySubmenuItems(categories, currentCategory)}\r\n        </Menu.SubMenu>\r\n    );\r\n};\r\n\r\nexport default memo(ChannelMoveToSubMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\n\r\nimport QuickInput, {MaxLengthInput} from 'components/quick_input';\r\n\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nimport '../category_modal.scss';\r\n\r\nconst MAX_LENGTH = 22;\r\nconst ACTION_WAIT_MS = 1000;\r\n\r\ntype Props = {\r\n    onExited: () => void;\r\n    currentTeamId: string;\r\n    categoryId?: string;\r\n    initialCategoryName?: string;\r\n    channelIdsToAdd?: string[];\r\n    actions: {\r\n        createCategory: (teamId: string, displayName: string, channelIds?: string[] | undefined) => void;\r\n        renameCategory: (categoryId: string, newName: string) => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    categoryName: string;\r\n}\r\n\r\nexport default class EditCategoryModal extends React.PureComponent<Props, State> {\r\n    timeoutId: NodeJS.Timeout | null = null;\r\n    isProcessing = false;\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            categoryName: props.initialCategoryName || '',\r\n        };\r\n    }\r\n\r\n    handleClear = () => {\r\n        this.setState({categoryName: ''});\r\n    };\r\n\r\n    handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({categoryName: e.target.value});\r\n    };\r\n\r\n    handleCancel = () => {\r\n        this.handleClear();\r\n    };\r\n\r\n    componentWillUnmount() {\r\n        if (this.timeoutId) {\r\n            clearTimeout(this.timeoutId);\r\n        }\r\n    }\r\n\r\n    handleConfirm = () => {\r\n        if (this.isProcessing) {\r\n            return;\r\n        }\r\n        this.isProcessing = true;\r\n        this.timeoutId = setTimeout(() => {\r\n            this.isProcessing = false;\r\n        }, ACTION_WAIT_MS);\r\n\r\n        if (this.props.categoryId) {\r\n            this.props.actions.renameCategory(this.props.categoryId, this.state.categoryName);\r\n        } else {\r\n            this.props.actions.createCategory(this.props.currentTeamId, this.state.categoryName, this.props.channelIdsToAdd);\r\n        }\r\n    };\r\n\r\n    isConfirmDisabled = () => {\r\n        return !this.state.categoryName ||\r\n            (Boolean(this.props.initialCategoryName) && this.props.initialCategoryName === this.state.categoryName) || this.state.categoryName.length > MAX_LENGTH;\r\n    };\r\n\r\n    getText = () => {\r\n        let modalHeaderText;\r\n        let editButtonText;\r\n        let helpText;\r\n\r\n        if (this.props.categoryId) {\r\n            modalHeaderText = (\r\n                <FormattedMessage\r\n                    id='rename_category_modal.renameCategory'\r\n                    defaultMessage='Rename Category'\r\n                />\r\n            );\r\n            editButtonText = (\r\n                <FormattedMessage\r\n                    id='rename_category_modal.rename'\r\n                    defaultMessage='Rename'\r\n                />\r\n            );\r\n        } else {\r\n            modalHeaderText = (\r\n                <FormattedMessage\r\n                    id='create_category_modal.createCategory'\r\n                    defaultMessage='Create New Category'\r\n                />\r\n            );\r\n            editButtonText = (\r\n                <FormattedMessage\r\n                    id='create_category_modal.create'\r\n                    defaultMessage='Create'\r\n                />\r\n            );\r\n            helpText = (\r\n                <FormattedMessage\r\n                    id='edit_category_modal.helpText'\r\n                    defaultMessage='Drag channels into this category to organize your sidebar.'\r\n                />\r\n            );\r\n        }\r\n\r\n        return {\r\n            modalHeaderText,\r\n            editButtonText,\r\n            helpText,\r\n        };\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            modalHeaderText,\r\n            editButtonText,\r\n            helpText,\r\n        } = this.getText();\r\n\r\n        return (\r\n            <GenericModal\r\n                id='editCategoryModal'\r\n                modalHeaderText={modalHeaderText}\r\n                confirmButtonText={editButtonText}\r\n                compassDesign={true}\r\n                onExited={this.props.onExited}\r\n                handleEnterKeyPress={this.handleConfirm}\r\n                handleConfirm={this.handleConfirm}\r\n                handleCancel={this.handleCancel}\r\n                isConfirmDisabled={this.isConfirmDisabled()}\r\n            >\r\n                <QuickInput\r\n                    inputComponent={MaxLengthInput}\r\n                    autoFocus={true}\r\n                    className='form-control filter-textbox'\r\n                    type='text'\r\n                    value={this.state.categoryName}\r\n                    placeholder={localizeMessage({id: 'edit_category_modal.placeholder', defaultMessage: 'Name your category'})}\r\n                    clearable={true}\r\n                    onClear={this.handleClear}\r\n                    onChange={this.handleChange}\r\n                    maxLength={MAX_LENGTH}\r\n                />\r\n                {Boolean(helpText) && <span className='edit-category__helpText'>\r\n                    {helpText}\r\n                </span>}\r\n            </GenericModal>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {renameCategory} from 'mattermost-redux/actions/channel_categories';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {createCategory} from 'actions/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport EditCategoryModal from './edit_category_modal';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        currentTeamId: getCurrentTeamId(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createCategory,\r\n            renameCategory,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditCategoryModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {Modal} from 'react-bootstrap';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport * as UserUtils from 'mattermost-redux/utils/user_utils';\r\n\r\nimport Constants from 'utils/constants';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\n\r\ntype Props = {\r\n    currentUser: UserProfile;\r\n    currentUserId: string;\r\n    currentTeamId: string;\r\n    numOfPublicChannels: number;\r\n    numOfPrivateChannels: number;\r\n    onExited: () => void;\r\n    actions: {\r\n        leaveTeam: (teamId: string, userId: string) => void;\r\n        toggleSideBarRightMenu: () => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    show: boolean;\r\n};\r\n\r\nexport default class LeaveTeamModal extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            show: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keypress', this.handleKeyPress);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keypress', this.handleKeyPress);\r\n    }\r\n\r\n    handleHide = () => {\r\n        this.setState({\r\n            show: false,\r\n        });\r\n    };\r\n\r\n    handleKeyPress = (e: KeyboardEvent) => {\r\n        if (isKeyPressed(e, Constants.KeyCodes.ENTER)) {\r\n            this.handleSubmit();\r\n        }\r\n    };\r\n\r\n    handleSubmit = () => {\r\n        this.handleHide();\r\n\r\n        this.props.actions.leaveTeam(\r\n            this.props.currentTeamId,\r\n            this.props.currentUserId,\r\n        );\r\n        this.props.actions.toggleSideBarRightMenu();\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            currentUser,\r\n            numOfPrivateChannels,\r\n            numOfPublicChannels,\r\n        } = this.props;\r\n\r\n        const isGuest = UserUtils.isGuest(currentUser.roles);\r\n\r\n        let modalMessage;\r\n        if (isGuest) {\r\n            if (numOfPublicChannels !== 0 && numOfPrivateChannels !== 0) {\r\n                modalMessage = (\r\n                    <FormattedMessage\r\n                        id='leave_team_modal_guest.description'\r\n                        defaultMessage='<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} and {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> You won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                        values={{\r\n                            num_of_public_channels: numOfPublicChannels,\r\n                            num_of_private_channels: numOfPrivateChannels,\r\n                            strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                        }}\r\n                    />\r\n                );\r\n            } else if (numOfPublicChannels === 0) {\r\n                modalMessage = (\r\n                    <FormattedMessage\r\n                        id='leave_team_modal_guest_only_private.description'\r\n                        defaultMessage='<strong>You will be removed from {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> You won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                        values={{\r\n                            num_of_private_channels: numOfPrivateChannels,\r\n                            strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                        }}\r\n                    />\r\n                );\r\n            } else {\r\n                modalMessage = (\r\n                    <FormattedMessage\r\n                        id='leave_team_modal_guest_only_public.description'\r\n                        defaultMessage='<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} on this team.</strong> You won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                        values={{\r\n                            num_of_public_channels: numOfPublicChannels,\r\n                            strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                        }}\r\n                    />\r\n                );\r\n            }\r\n        } else if (numOfPublicChannels !== 0 && numOfPrivateChannels !== 0) {\r\n            modalMessage = (\r\n                <FormattedMessage\r\n                    id='leave_team_modal.description'\r\n                    defaultMessage='<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} and {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> If the team is private you won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                    values={{\r\n                        num_of_public_channels: numOfPublicChannels,\r\n                        num_of_private_channels: numOfPrivateChannels,\r\n                        strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                    }}\r\n                />\r\n            );\r\n        } else if (numOfPublicChannels === 0) {\r\n            modalMessage = (\r\n                <FormattedMessage\r\n                    id='leave_team_modal_private.description'\r\n                    defaultMessage='<strong>You will be removed from {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> If the team is private you won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                    values={{\r\n                        num_of_private_channels: numOfPrivateChannels,\r\n                        strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                    }}\r\n                />\r\n            );\r\n        } else {\r\n            modalMessage = (\r\n                <FormattedMessage\r\n                    id='leave_team_modal_public.description'\r\n                    defaultMessage='<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} on this team.</strong> Are you sure?'\r\n                    values={{\r\n                        num_of_public_channels: numOfPublicChannels,\r\n                        strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                    }}\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <Modal\r\n                dialogClassName='a11y__modal'\r\n                className='modal-confirm'\r\n                show={this.state.show}\r\n                onExited={this.props.onExited}\r\n                onHide={this.handleHide}\r\n                id='leaveTeamModal'\r\n                role='none'\r\n                aria-labelledby='leaveTeamModalLabel'\r\n            >\r\n                <Modal.Header closeButton={false}>\r\n                    <Modal.Title\r\n                        componentClass='h1'\r\n                        id='leaveTeamModalLabel'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='leave_team_modal.title'\r\n                            defaultMessage='Leave the team?'\r\n                        />\r\n                    </Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    {modalMessage}\r\n                </Modal.Body>\r\n                <Modal.Footer>\r\n                    <button\r\n                        type='button'\r\n                        className='btn btn-tertiary'\r\n                        onClick={this.handleHide}\r\n                        id='leaveTeamNo'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='leave_team_modal.no'\r\n                            defaultMessage='No'\r\n                        />\r\n                    </button>\r\n                    <button\r\n                        type='button'\r\n                        className='btn btn-danger'\r\n                        onClick={this.handleSubmit}\r\n                        id='leaveTeamYes'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='leave_team_modal.yes'\r\n                            defaultMessage='Yes'\r\n                        />\r\n                    </button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {removeUserFromTeam as leaveTeam} from 'mattermost-redux/actions/teams';\r\nimport {getMyChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId, getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {toggleSideBarRightMenuAction} from 'actions/global_actions';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport LeaveTeamModal from './leave_team_modal';\r\n\r\nfunction getNumOfPrivateChannels(state: GlobalState) {\r\n    const channels = getMyChannels(state);\r\n\r\n    return channels.filter((channel) => channel.type === Constants.PRIVATE_CHANNEL).length;\r\n}\r\n\r\nfunction getNumOfPublicChannels(state: GlobalState) {\r\n    const channels = getMyChannels(state);\r\n\r\n    return channels.filter((channel) => channel.type === Constants.OPEN_CHANNEL).length;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const currentUserId = getCurrentUserId(state);\r\n    const currentTeamId = getCurrentTeamId(state);\r\n    const currentUser = getCurrentUser(state);\r\n\r\n    return {\r\n        currentUserId,\r\n        currentTeamId,\r\n        currentUser,\r\n        numOfPrivateChannels: getNumOfPrivateChannels(state),\r\n        numOfPublicChannels: getNumOfPublicChannels(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            leaveTeam,\r\n            toggleSideBarRightMenu: toggleSideBarRightMenuAction,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LeaveTeamModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {Modal} from 'react-bootstrap';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Group} from '@mattermost/types/groups';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nexport const DEFAULT_NUM_PER_PAGE = 50;\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * titleText (optional) a string to show at the top bar of the modal.\r\n     */\r\n    titleText?: string;\r\n\r\n    /**\r\n     * searchPlaceholderText (optional) a string to show as a placeholder in the search input.\r\n     */\r\n    searchPlaceholderText?: string;\r\n\r\n    /**\r\n     * titleBarButtonText (optional) a string representing a title bar button text.\r\n     */\r\n    titleBarButtonText?: string;\r\n\r\n    /**\r\n     * numPerPage (optional) a number setting how many items per page should be displayed. Defaults to\r\n     * DEFAULT_NUM_PER_PAGE.\r\n     */\r\n    numPerPage?: number;\r\n\r\n    /**\r\n     * show (optional) a boolean setting to hide the modal via props rather then unmounting it.\r\n     */\r\n    show?: boolean;\r\n\r\n    /**\r\n     * titleBarButtonOnClick (optional) a func to handle title button bar clicks.\r\n     */\r\n    titleBarButtonOnClick?: () => void;\r\n\r\n    /**\r\n     * loadItems is a function that receives the params (pageNumber, searchTerm) and should return an object\r\n     * with the shape {items: [], totalCount: 0}.\r\n     * items: an array of objects that are passed to each renderRow function.\r\n     * totalCount: an integer representing the total number of items as displayed in the pagination text.\r\n     *\r\n     * Example:\r\n     *     const loadItems = async (pageNumber, searchTerm) => {\r\n     *         const {data} = await loadFromServer(searchTerm, pageNumber, PER_PAGE);\r\n     *         return {\r\n     *             items: data.users,\r\n     *             totalCount: data.total,\r\n     *         };\r\n     *     };\r\n     */\r\n    loadItems: (page: number, searchTerm: string) => Promise<{\r\n        items: Group[];\r\n        totalCount: number;\r\n    }>;\r\n\r\n    /**\r\n     * onHide (optional) a function to be invoked when the modal is closed.\r\n     */\r\n    onHide?: () => void;\r\n\r\n    /**\r\n     * renderRow is a function that receives the params (item, listModal) and should return JSX.\r\n     * item: an object as returned by each entry in the loadItems function's 'items' array.\r\n     * listModal: the instance of the ListModal component class.\r\n     *\r\n     * Example:\r\n     *     const renderRow = (item, listModal) => <div>{item.id}</div>;\r\n     */\r\n    renderRow: (item: Group, listModal: ListModal) => JSX.Element;\r\n}\r\n\r\ntype State = {\r\n    show: boolean;\r\n    page: number;\r\n    items: Group[];\r\n    totalCount: number;\r\n    loading: boolean;\r\n    searchTerm: string;\r\n}\r\n\r\nexport default class ListModal extends React.PureComponent<Props, State> {\r\n    static defaultProps = {\r\n        show: true,\r\n    };\r\n    numPerPage: number;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.numPerPage = props.numPerPage || DEFAULT_NUM_PER_PAGE;\r\n\r\n        this.state = {\r\n            show: true,\r\n            page: 0,\r\n            items: [],\r\n            totalCount: 0,\r\n            loading: true,\r\n            searchTerm: '',\r\n        };\r\n    }\r\n\r\n    async componentDidMount() {\r\n        const {totalCount, items} = await this.props.loadItems(0, '');\r\n        this.setState({totalCount, items, loading: false});\r\n    }\r\n\r\n    handleHide = () => {\r\n        this.setState({show: false});\r\n    };\r\n\r\n    handleExit = () => {\r\n        if (this.props.onHide) {\r\n            this.props.onHide();\r\n        }\r\n    };\r\n\r\n    renderRows() {\r\n        if (this.state.loading) {\r\n            return (\r\n                <div>\r\n                    <LoadingScreen\r\n                        position='absolute'\r\n                        key='loading'\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n        return this.state.items.map((item) => (\r\n            this.props.renderRow(item, this)\r\n        ));\r\n    }\r\n\r\n    onNext = () => {\r\n        const nextPage = this.state.page + 1;\r\n        this.onPageChange(nextPage);\r\n    };\r\n\r\n    onPrev = () => {\r\n        const prevPage = this.state.page - 1;\r\n        this.onPageChange(prevPage);\r\n    };\r\n\r\n    onPageChange = async (page: number) => {\r\n        this.setState({loading: true});\r\n        const result = await this.props.loadItems(page, this.state.searchTerm);\r\n        this.setState({page, items: result.items, loading: false});\r\n    };\r\n\r\n    onSearchInput = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        const {target} = event;\r\n        const searchTerm = target.value;\r\n        this.setState({loading: true, searchTerm});\r\n        const result = await this.props.loadItems(0, searchTerm);\r\n        const {items, totalCount} = result;\r\n        this.setState({loading: false, items, totalCount});\r\n    };\r\n\r\n    paginationRange() {\r\n        let startCount = (this.state.page * this.numPerPage) + 1;\r\n        const endCount = (startCount + this.state.items.length) - 1;\r\n        if (endCount === 0) {\r\n            startCount = 0;\r\n        }\r\n        return {startCount, endCount};\r\n    }\r\n\r\n    render() {\r\n        if (!this.props.show) {\r\n            return null;\r\n        }\r\n        const {endCount, startCount} = this.paginationRange();\r\n        return (\r\n            <div>\r\n                <Modal\r\n                    dialogClassName='a11y__modal more-modal more-modal--action'\r\n                    show={this.state.show}\r\n                    onHide={this.handleHide}\r\n                    onExited={this.handleExit}\r\n                >\r\n                    <Modal.Header closeButton={true}>\r\n                        <Modal.Title componentClass='h1'>\r\n                            <span className='name'>{this.props.titleText}</span>\r\n                        </Modal.Title>\r\n                        {this.props.titleBarButtonText && this.props.titleBarButtonOnClick &&\r\n                            <a\r\n                                className='btn btn-md btn-primary'\r\n                                href='#'\r\n                                onClick={this.props.titleBarButtonOnClick}\r\n                            >\r\n                                {this.props.titleBarButtonText}\r\n                            </a>}\r\n                    </Modal.Header>\r\n                    <Modal.Body>\r\n                        <div className='filtered-user-list'>\r\n                            <div className='filter-row'>\r\n                                <div className='col-xs-12'>\r\n                                    <label\r\n                                        className='hidden-label'\r\n                                        htmlFor='searchUsersInput'\r\n                                    >\r\n                                        {this.props.searchPlaceholderText}\r\n                                    </label>\r\n                                    <input\r\n                                        id='searchUsersInput'\r\n                                        className='form-control filter-textbox'\r\n                                        placeholder={this.props.searchPlaceholderText}\r\n                                        onChange={this.onSearchInput}\r\n                                    />\r\n                                </div>\r\n                                <div className='col-sm-12'>\r\n                                    <span className='member-count pull-left'>\r\n                                        <FormattedMessage\r\n                                            id='list_modal.paginatorCount'\r\n                                            defaultMessage='{startCount, number} - {endCount, number} of {total, number} total'\r\n                                            values={{\r\n                                                startCount,\r\n                                                endCount,\r\n                                                total: this.state.totalCount,\r\n                                            }}\r\n                                        />\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                            <div className='more-modal__list'>\r\n                                <div>\r\n                                    {this.renderRows()}\r\n                                </div>\r\n                            </div>\r\n                            <div className='filter-controls'>\r\n                                {this.state.page > 0 &&\r\n                                <button\r\n                                    onClick={this.onPrev}\r\n                                    className='btn btn-sm btn-tertiary filter-control filter-control__prev'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='filtered_user_list.prev'\r\n                                        defaultMessage='Previous'\r\n                                    />\r\n                                </button>}\r\n                                {this.props.numPerPage && (this.state.items.length >= this.props.numPerPage) && endCount !== this.state.totalCount &&\r\n                                <button\r\n                                    onClick={this.onNext}\r\n                                    className='btn btn-sm btn-tertiary filter-control filter-control__next'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='filtered_user_list.next'\r\n                                        defaultMessage='Next'\r\n                                    />\r\n                                </button>}\r\n                            </div>\r\n                        </div>\r\n                    </Modal.Body>\r\n                </Modal>\r\n            </div >\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\n\r\nimport {ShortcutKey, ShortcutKeyVariant} from 'components/shortcut_key';\r\n\r\nimport {isDesktopApp, isMac} from 'utils/user_agent';\r\n\r\nimport './search_shortcut.scss';\r\n\r\nexport type SearchShortcutProps = {\r\n    className?: string;\r\n    variant?: ShortcutKeyVariant;\r\n}\r\n\r\nexport const SearchShortcut = ({className, variant}: SearchShortcutProps) => {\r\n    const controlKey = isMac() ? '' : 'Ctrl';\r\n    const shortcutKeyVariant = variant || ShortcutKeyVariant.Contrast;\r\n\r\n    return (\r\n        <span className={classNames('search-shortcut', className)}>\r\n            <ShortcutKey variant={shortcutKeyVariant}>{controlKey}</ShortcutKey>\r\n            {!isDesktopApp() && <ShortcutKey variant={shortcutKeyVariant}>{'Shift'}</ShortcutKey>}\r\n            <ShortcutKey variant={shortcutKeyVariant}>{'F'}</ShortcutKey>\r\n        </span>\r\n    );\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport {FolderPlusOutlineIcon} from '@mattermost/compass-icons/components';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport EditCategoryModal from 'components/edit_category_modal';\r\nimport * as Menu from 'components/menu';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\ntype Props = {\r\n    id: string;\r\n}\r\n\r\nconst CreateNewCategoryMenuItem = ({\r\n    id,\r\n    ...otherProps\r\n}: Props) => {\r\n    const dispatch = useDispatch();\r\n    const handleCreateCategory = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.EDIT_CATEGORY,\r\n            dialogType: EditCategoryModal,\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            id={`create-${id}`}\r\n            onClick={handleCreateCategory}\r\n            aria-haspopup={true}\r\n            leadingElement={<FolderPlusOutlineIcon size={18}/>}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_category_menu.createCategory'\r\n                    defaultMessage='Create New Category'\r\n                />\r\n            )}\r\n            {...otherProps}\r\n        />\r\n    );\r\n};\r\n\r\nexport default CreateNewCategoryMenuItem;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\n\r\nimport 'components/category_modal.scss';\r\n\r\ntype Props = {\r\n    handleConfirm: () => void;\r\n    numChannels: number;\r\n    onExited: () => void;\r\n};\r\n\r\nconst handleCancel = () => null;\r\n\r\nconst MarkAsReadConfirmModal = ({\r\n    handleConfirm,\r\n    numChannels,\r\n    onExited,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    const header = intl.formatMessage({id: 'mark_as_read_confirm_modal.header', defaultMessage: 'Mark as read'});\r\n    const body = intl.formatMessage({id: 'mark_as_read_confirm_modal.body', defaultMessage: 'Are you sure you want to mark {numChannels} channels as read?'}, {numChannels});\r\n    const confirm = intl.formatMessage({id: 'mark_as_read_confirm_modal.confirm', defaultMessage: 'Mark as read'});\r\n\r\n    return (\r\n        <GenericModal\r\n            ariaLabel={header}\r\n            compassDesign={true}\r\n            modalHeaderText={header}\r\n            handleConfirm={handleConfirm}\r\n            handleCancel={handleCancel}\r\n            onExited={onExited}\r\n            confirmButtonText={confirm}\r\n        >\r\n            <span className='mark-as-read__helpText'>\r\n                {body}\r\n            </span>\r\n        </GenericModal>\r\n    );\r\n};\r\n\r\nexport default MarkAsReadConfirmModal;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport {MarkAsUnreadIcon} from '@mattermost/compass-icons/components';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport MarkAsReadConfirmModal from './mark_as_read_confirm_modal';\r\n\r\ntype Props = {\r\n    id: string;\r\n    handleViewCategory: () => void;\r\n    numChannels: number;\r\n}\r\n\r\nconst MarkAsUnreadItem = ({\r\n    id,\r\n    handleViewCategory,\r\n    numChannels,\r\n    ...otherProps\r\n}: Props) => {\r\n    const dispatch = useDispatch();\r\n\r\n    const onClick = useCallback(() => {\r\n        if (numChannels <= 0) {\r\n            return;\r\n        }\r\n\r\n        if (numChannels === 1) {\r\n            handleViewCategory();\r\n            return;\r\n        }\r\n\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.DELETE_CATEGORY,\r\n            dialogType: MarkAsReadConfirmModal,\r\n            dialogProps: {\r\n                handleConfirm: handleViewCategory,\r\n                numChannels,\r\n            },\r\n        }));\r\n    }, [dispatch, handleViewCategory, numChannels]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            id={`view-${id}`}\r\n            onClick={onClick}\r\n            aria-haspopup={numChannels > 1}\r\n            leadingElement={<MarkAsUnreadIcon size={18}/>}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_category_menu.viewCategory'\r\n                    defaultMessage='Mark category as read'\r\n                />\r\n            )}\r\n            {...otherProps}\r\n        />\r\n    );\r\n};\r\n\r\nexport default MarkAsUnreadItem;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {memo, useState} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {\r\n    DotsVerticalIcon,\r\n} from '@mattermost/compass-icons/components';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\ntype Props = {\r\n    id: string;\r\n    children: React.ReactNode[];\r\n    name: string;\r\n};\r\n\r\nconst SidebarCategoryGenericMenu = ({\r\n    id,\r\n    children,\r\n    name,\r\n}: Props) => {\r\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n\r\n    const {formatMessage} = useIntl();\r\n\r\n    function handleMenuToggle(isOpen: boolean) {\r\n        setIsMenuOpen(isOpen);\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={classNames(\r\n                'SidebarMenu',\r\n                'MenuWrapper',\r\n                {\r\n                    'MenuWrapper--open': isMenuOpen,\r\n                    menuOpen: isMenuOpen,\r\n                },\r\n            )}\r\n        >\r\n            <Menu.Container\r\n                menuButton={{\r\n                    id: `SidebarCategoryMenu-Button-${id}`,\r\n                    'aria-label': formatMessage({id: 'sidebar_left.sidebar_category_menu.editCategory', defaultMessage: 'Category options'}, {name}),\r\n                    class: 'SidebarMenu_menuButton',\r\n                    children: <DotsVerticalIcon size={16}/>,\r\n                }}\r\n                menuButtonTooltip={{\r\n                    text: formatMessage({id: 'sidebar_left.sidebar_category_menu.editCategory', defaultMessage: 'Category options'}, {name}),\r\n                    class: 'hidden-xs',\r\n                }}\r\n                menu={{\r\n                    id: `SidebarChannelMenu-MenuList-${id}`,\r\n                    'aria-label': formatMessage({id: 'sidebar_left.sidebar_category_menu.dropdownAriaLabel', defaultMessage: 'Edit category menu'}),\r\n                    onToggle: handleMenuToggle,\r\n                }}\r\n            >\r\n                {children}\r\n            </Menu.Container>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(SidebarCategoryGenericMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport type {DraggableProvidedDragHandleProps} from 'react-beautiful-dnd';\r\n\r\nimport {wrapEmojis} from 'utils/emoji_utils';\r\n\r\ntype StaticProps = {\r\n    children?: React.ReactNode;\r\n    displayName: string;\r\n}\r\n\r\nexport const SidebarCategoryHeaderStatic = React.forwardRef((props: StaticProps, ref?: React.Ref<HTMLDivElement>) => {\r\n    return (\r\n        <div className='SidebarChannelGroupHeader SidebarChannelGroupHeader--static'>\r\n            <div\r\n                ref={ref}\r\n                className='SidebarChannelGroupHeader_groupButton'\r\n            >\r\n                <div className='SidebarChannelGroupHeader_text'>\r\n                    {wrapEmojis(props.displayName)}\r\n                </div>\r\n                {props.children}\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\nSidebarCategoryHeaderStatic.displayName = 'SidebarCategoryHeaderStatic';\r\n\r\ntype Props = StaticProps & {\r\n    dragHandleProps?: DraggableProvidedDragHandleProps;\r\n    isCollapsed: boolean;\r\n    isCollapsible: boolean;\r\n    isDragging?: boolean;\r\n    isDraggingOver?: boolean;\r\n    muted: boolean;\r\n    onClick: (event: React.MouseEvent<HTMLElement>) => void;\r\n}\r\n\r\nexport const SidebarCategoryHeader = React.forwardRef((props: Props, ref?: React.Ref<HTMLButtonElement>) => {\r\n    const {dragHandleProps} = props;\r\n\r\n    // (Accessibility) Ensures interactive controls are not nested as they are not always announced\r\n    // by screen readers or can cause focus problems for assistive technologies.\r\n    if (dragHandleProps && dragHandleProps.role) {\r\n        Reflect.deleteProperty(dragHandleProps, 'role');\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={classNames('SidebarChannelGroupHeader', {\r\n                muted: props.muted,\r\n                dragging: props.isDragging,\r\n            })}\r\n        >\r\n            <button\r\n                ref={ref}\r\n                className={classNames('SidebarChannelGroupHeader_groupButton')}\r\n                aria-label={props.displayName}\r\n                onClick={props.onClick}\r\n                aria-expanded={!props.isCollapsed}\r\n            >\r\n                <i\r\n                    className={classNames('icon icon-chevron-down', {\r\n                        'icon-rotate-minus-90': props.isCollapsed,\r\n                        'hide-arrow': !props.isCollapsible,\r\n                    })}\r\n                />\r\n                <div\r\n                    className='SidebarChannelGroupHeader_text'\r\n                    {...dragHandleProps}\r\n                    tabIndex={-1}\r\n                >\r\n                    {wrapEmojis(props.displayName)}\r\n                </div>\r\n            </button>\r\n            {props.children}\r\n        </div>\r\n    );\r\n});\r\nSidebarCategoryHeader.defaultProps = {\r\n    isCollapsible: true,\r\n    isDragging: false,\r\n    isDraggingOver: false,\r\n};\r\nSidebarCategoryHeader.displayName = 'SidebarCategoryHeader';\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\n\r\ntype Props = {\r\n    unreadMentions: number;\r\n    hasUrgent?: boolean;\r\n    icon?: React.ReactNode;\r\n    className?: string;\r\n};\r\n\r\nexport default function ChannelMentionBadge({unreadMentions, hasUrgent, icon, className}: Props) {\r\n    if (unreadMentions > 0) {\r\n        return (\r\n            <span\r\n                id='unreadMentions'\r\n                className={classNames({badge: true, urgent: hasUrgent}, className)}\r\n            >\r\n                {icon}\r\n                <span className='unreadMentions'>\r\n                    {unreadMentions}\r\n                </span>\r\n            </span>\r\n        );\r\n    }\r\n\r\n    return null;\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\n\r\nimport './channel_pencil_icon.scss';\r\n\r\ntype Props = {\r\n    hasDraft: boolean;\r\n};\r\n\r\nfunction ChannelPencilIcon({hasDraft}: Props) {\r\n    if (hasDraft) {\r\n        return (\r\n            <i\r\n                data-testid='draftIcon'\r\n                className='icon icon-pencil-outline channel-pencil-icon'\r\n            />\r\n        );\r\n    }\r\n    return null;\r\n}\r\n\r\nexport default memo(ChannelPencilIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\r\n\r\nimport {getPostDraft} from 'selectors/rhs';\r\n\r\nimport {StoragePrefixes} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\nimport type {PostDraft} from 'types/store/draft';\r\n\r\nimport ChannelPencilIcon from './channel_pencil_icon';\r\n\r\ntype OwnProps = {\r\n    id: Channel['id'];\r\n}\r\n\r\nfunction hasDraft(draft: PostDraft|null, id: Channel['id'], currentChannelId?: string): boolean {\r\n    if (draft === null) {\r\n        return false;\r\n    }\r\n\r\n    return Boolean(draft.message.trim() || draft.fileInfos.length || draft.uploadsInProgress.length) && currentChannelId !== id;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const currentChannelId = getCurrentChannelId(state);\r\n    const draft = getPostDraft(state, StoragePrefixes.DRAFT, ownProps.id);\r\n\r\n    return {\r\n        hasDraft: hasDraft(draft, ownProps.id, currentChannelId),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(ChannelPencilIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\ntype Props = {\r\n    icon: JSX.Element | null;\r\n    isDeleted: boolean;\r\n};\r\n\r\nfunction SidebarChannelIcon({isDeleted, icon}: Props) {\r\n    if (isDeleted) {\r\n        return (\r\n            <i className='icon icon-archive-outline'/>\r\n        );\r\n    }\r\n    return icon;\r\n}\r\n\r\nexport default SidebarChannelIcon;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useRef, memo} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport {\r\n    MarkAsUnreadIcon,\r\n    StarIcon,\r\n    StarOutlineIcon,\r\n    BellOutlineIcon,\r\n    BellOffOutlineIcon,\r\n    LinkVariantIcon,\r\n    AccountPlusOutlineIcon,\r\n    DotsVerticalIcon,\r\n    ExitToAppIcon,\r\n} from '@mattermost/compass-icons/components';\r\n\r\nimport ChannelInviteModal from 'components/channel_invite_modal';\r\nimport ChannelMoveToSubmenu from 'components/channel_move_to_sub_menu';\r\nimport * as Menu from 'components/menu';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\nimport {copyToClipboard} from 'utils/utils';\r\n\r\nimport type {PropsFromRedux, OwnProps} from './index';\r\n\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\nconst SidebarChannelMenu = ({\r\n    channel,\r\n    channelLink,\r\n    currentUserId,\r\n    favoriteChannel,\r\n    isFavorite,\r\n    isMuted,\r\n    isUnread,\r\n    managePrivateChannelMembers,\r\n    managePublicChannelMembers,\r\n    readMultipleChannels,\r\n    markMostRecentPostInChannelAsUnread,\r\n    muteChannel,\r\n    onMenuToggle,\r\n    openModal,\r\n    unfavoriteChannel,\r\n    unmuteChannel,\r\n    channelLeaveHandler,\r\n}: Props) => {\r\n    const isLeaving = useRef(false);\r\n\r\n    const {formatMessage} = useIntl();\r\n\r\n    let markAsReadUnreadMenuItem: JSX.Element | null = null;\r\n    if (isUnread) {\r\n        function handleMarkAsRead() {\r\n            // We use mark multiple to not update the active channel in the server\r\n            readMultipleChannels([channel.id]);\r\n        }\r\n\r\n        markAsReadUnreadMenuItem = (\r\n            <Menu.Item\r\n                id={`markAsRead-${channel.id}`}\r\n                onClick={handleMarkAsRead}\r\n                leadingElement={<MarkAsUnreadIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.markAsRead'\r\n                        defaultMessage='Mark as Read'\r\n                    />\r\n                )}\r\n            />\r\n\r\n        );\r\n    } else {\r\n        function handleMarkAsUnread() {\r\n            markMostRecentPostInChannelAsUnread(channel.id);\r\n        }\r\n\r\n        markAsReadUnreadMenuItem = (\r\n            <Menu.Item\r\n                id={`markAsUnread-${channel.id}`}\r\n                onClick={handleMarkAsUnread}\r\n                leadingElement={<MarkAsUnreadIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.markAsUnread'\r\n                        defaultMessage='Mark as Unread'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    let favoriteUnfavoriteMenuItem: JSX.Element | null = null;\r\n    if (isFavorite) {\r\n        function handleUnfavoriteChannel() {\r\n            unfavoriteChannel(channel.id);\r\n        }\r\n\r\n        favoriteUnfavoriteMenuItem = (\r\n            <Menu.Item\r\n                id={`unfavorite-${channel.id}`}\r\n                onClick={handleUnfavoriteChannel}\r\n                leadingElement={<StarIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.unfavoriteChannel'\r\n                        defaultMessage='Unfavorite'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    } else {\r\n        function handleFavoriteChannel() {\r\n            favoriteChannel(channel.id);\r\n        }\r\n\r\n        favoriteUnfavoriteMenuItem = (\r\n\r\n            <Menu.Item\r\n                id={`favorite-${channel.id}`}\r\n                onClick={handleFavoriteChannel}\r\n                leadingElement={<StarOutlineIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.favoriteChannel'\r\n                        defaultMessage='Favorite'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    let muteUnmuteChannelMenuItem: JSX.Element | null = null;\r\n    if (isMuted) {\r\n        let muteChannelText = (\r\n            <FormattedMessage\r\n                id='sidebar_left.sidebar_channel_menu.unmuteChannel'\r\n                defaultMessage='Unmute Channel'\r\n            />\r\n        );\r\n        if (channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) {\r\n            muteChannelText = (\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_channel_menu.unmute'\r\n                    defaultMessage='Unmute'\r\n                />\r\n            );\r\n        }\r\n\r\n        function handleUnmuteChannel() {\r\n            unmuteChannel(currentUserId, channel.id);\r\n        }\r\n\r\n        muteUnmuteChannelMenuItem = (\r\n            <Menu.Item\r\n                id={`unmute-${channel.id}`}\r\n                onClick={handleUnmuteChannel}\r\n                leadingElement={<BellOffOutlineIcon size={18}/>}\r\n                labels={muteChannelText}\r\n            />\r\n        );\r\n    } else {\r\n        let muteChannelText = (\r\n            <FormattedMessage\r\n                id='sidebar_left.sidebar_channel_menu.muteChannel'\r\n                defaultMessage='Mute Channel'\r\n            />\r\n        );\r\n        if (channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) {\r\n            muteChannelText = (\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_channel_menu.mute'\r\n                    defaultMessage='Mute'\r\n                />\r\n            );\r\n        }\r\n\r\n        function handleMuteChannel() {\r\n            muteChannel(currentUserId, channel.id);\r\n        }\r\n\r\n        muteUnmuteChannelMenuItem = (\r\n            <Menu.Item\r\n                id={`mute-${channel.id}`}\r\n                onClick={handleMuteChannel}\r\n                leadingElement={<BellOutlineIcon size={18}/>}\r\n                labels={muteChannelText}\r\n            />\r\n        );\r\n    }\r\n\r\n    let copyLinkMenuItem: JSX.Element | null = null;\r\n    if (channel.type === Constants.OPEN_CHANNEL || channel.type === Constants.PRIVATE_CHANNEL) {\r\n        function handleCopyLink() {\r\n            copyToClipboard(channelLink);\r\n        }\r\n\r\n        copyLinkMenuItem = (\r\n            <Menu.Item\r\n                id={`copyLink-${channel.id}`}\r\n                onClick={handleCopyLink}\r\n                leadingElement={<LinkVariantIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.copyLink'\r\n                        defaultMessage='Copy Link'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    let addMembersMenuItem: JSX.Element | null = null;\r\n    if ((channel.type === Constants.PRIVATE_CHANNEL && managePrivateChannelMembers) || (channel.type === Constants.OPEN_CHANNEL && managePublicChannelMembers)) {\r\n        function handleAddMembers() {\r\n            openModal({\r\n                modalId: ModalIdentifiers.CHANNEL_INVITE,\r\n                dialogType: ChannelInviteModal,\r\n                dialogProps: {channel},\r\n            });\r\n        }\r\n\r\n        addMembersMenuItem = (\r\n            <Menu.Item\r\n                id={`addMembers-${channel.id}`}\r\n                onClick={handleAddMembers}\r\n                aria-haspopup='true'\r\n                leadingElement={<AccountPlusOutlineIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.addMembers'\r\n                        defaultMessage='Add Members'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    let leaveChannelMenuItem: JSX.Element | null = null;\r\n    if (channel.name !== Constants.DEFAULT_CHANNEL) {\r\n        let leaveChannelText = (\r\n            <FormattedMessage\r\n                id='sidebar_left.sidebar_channel_menu.leaveChannel'\r\n                defaultMessage='Leave Channel'\r\n            />\r\n        );\r\n        if (channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) {\r\n            leaveChannelText = (\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_channel_menu.leaveConversation'\r\n                    defaultMessage='Close Conversation'\r\n                />\r\n            );\r\n        }\r\n\r\n        function handleLeaveChannel() {\r\n            if (isLeaving.current || !channelLeaveHandler) {\r\n                return;\r\n            }\r\n\r\n            isLeaving.current = true;\r\n\r\n            channelLeaveHandler(() => {\r\n                isLeaving.current = false;\r\n            });\r\n        }\r\n\r\n        leaveChannelMenuItem = (\r\n            <Menu.Item\r\n                id={`leave-${channel.id}`}\r\n                onClick={handleLeaveChannel}\r\n                leadingElement={<ExitToAppIcon size={18}/>}\r\n                labels={leaveChannelText}\r\n                isDestructive={true}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Menu.Container\r\n            menuButton={{\r\n                id: `SidebarChannelMenu-Button-${channel.id}`,\r\n                class: 'SidebarMenu_menuButton',\r\n                'aria-label': formatMessage({\r\n                    id: 'sidebar_left.sidebar_channel_menu.editChannel.ariaLabel',\r\n                    defaultMessage: 'Channel options for {channelName}',\r\n                }, {channelName: channel.name}),\r\n                children: <DotsVerticalIcon size={16}/>,\r\n            }}\r\n            menuButtonTooltip={{\r\n                class: 'hidden-xs',\r\n                text: formatMessage({id: 'sidebar_left.sidebar_channel_menu.editChannel', defaultMessage: 'Channel options'}),\r\n            }}\r\n            menu={{\r\n                id: `SidebarChannelMenu-MenuList-${channel.id}`,\r\n                'aria-label': formatMessage({id: 'sidebar_left.sidebar_channel_menu.dropdownAriaLabel', defaultMessage: 'Edit channel menu'}),\r\n                onToggle: onMenuToggle,\r\n            }}\r\n        >\r\n            {markAsReadUnreadMenuItem}\r\n            {favoriteUnfavoriteMenuItem}\r\n            {muteUnmuteChannelMenuItem}\r\n            <Menu.Separator/>\r\n            <ChannelMoveToSubmenu channel={channel}/>\r\n            {(copyLinkMenuItem || addMembersMenuItem) && <Menu.Separator/>}\r\n            {copyLinkMenuItem}\r\n            {addMembersMenuItem}\r\n            {leaveChannelMenuItem && <Menu.Separator/>}\r\n            {leaveChannelMenuItem}\r\n        </Menu.Container>\r\n    );\r\n};\r\n\r\nexport default memo(SidebarChannelMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {favoriteChannel, unfavoriteChannel, readMultipleChannels} from 'mattermost-redux/actions/channels';\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport {isFavoriteChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getMyChannelMemberships, getCurrentUserId} from 'mattermost-redux/selectors/entities/common';\r\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport {unmuteChannel, muteChannel} from 'actions/channel_actions';\r\nimport {markMostRecentPostInChannelAsUnread} from 'actions/post_actions';\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport {getSiteURL} from 'utils/url';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarChannelMenu from './sidebar_channel_menu';\r\n\r\nexport type OwnProps = {\r\n    channel: Channel;\r\n    channelLink: string;\r\n    isUnread: boolean;\r\n    channelLeaveHandler?: (callback: () => void) => void;\r\n    onMenuToggle: (open: boolean) => void;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const member = getMyChannelMemberships(state)[ownProps.channel.id];\r\n    const currentTeam = getCurrentTeam(state);\r\n\r\n    let managePublicChannelMembers = false;\r\n    let managePrivateChannelMembers = false;\r\n\r\n    if (currentTeam) {\r\n        managePublicChannelMembers = haveIChannelPermission(state, currentTeam.id, ownProps.channel.id, Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS);\r\n        managePrivateChannelMembers = haveIChannelPermission(state, currentTeam.id, ownProps.channel.id, Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS);\r\n    }\r\n\r\n    return {\r\n        currentUserId: getCurrentUserId(state),\r\n        isFavorite: isFavoriteChannel(state, ownProps.channel.id),\r\n        isMuted: isChannelMuted(member),\r\n        channelLink: `${getSiteURL()}${ownProps.channelLink}`,\r\n        managePublicChannelMembers,\r\n        managePrivateChannelMembers,\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    readMultipleChannels,\r\n    markMostRecentPostInChannelAsUnread,\r\n    favoriteChannel,\r\n    unfavoriteChannel,\r\n    muteChannel,\r\n    unmuteChannel,\r\n    openModal,\r\n};\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(SidebarChannelMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {type WrappedComponentProps, injectIntl} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {mark} from 'actions/telemetry_actions';\r\n\r\nimport CustomStatusEmoji from 'components/custom_status/custom_status_emoji';\r\nimport SharedChannelIndicator from 'components/shared_channel_indicator';\r\nimport {ChannelsAndDirectMessagesTour} from 'components/tours/onboarding_tour';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport Constants, {RHSStates} from 'utils/constants';\r\nimport {wrapEmojis} from 'utils/emoji_utils';\r\nimport {cmdOrCtrlPressed} from 'utils/keyboard';\r\nimport {Mark} from 'utils/performance_telemetry';\r\n\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nimport ChannelMentionBadge from '../channel_mention_badge';\r\nimport ChannelPencilIcon from '../channel_pencil_icon';\r\nimport SidebarChannelIcon from '../sidebar_channel_icon';\r\nimport SidebarChannelMenu from '../sidebar_channel_menu';\r\n\r\ntype Props = WrappedComponentProps & {\r\n    channel: Channel;\r\n    link: string;\r\n    label: string;\r\n    ariaLabelPrefix?: string;\r\n    channelLeaveHandler?: (callback: () => void) => void;\r\n    icon: JSX.Element | null;\r\n\r\n    /**\r\n     * Number of unread mentions in this channel\r\n     */\r\n    unreadMentions: number;\r\n\r\n    /**\r\n     * Whether or not the channel is shown as unread\r\n     */\r\n    isUnread: boolean;\r\n\r\n    /**\r\n     * Checks if the current channel is muted\r\n     */\r\n    isMuted: boolean;\r\n\r\n    isChannelSelected: boolean;\r\n\r\n    teammateId?: string;\r\n\r\n    firstChannelName?: string;\r\n\r\n    showChannelsTutorialStep: boolean;\r\n\r\n    hasUrgent: boolean;\r\n    rhsState?: RhsState;\r\n    rhsOpen?: boolean;\r\n    isSharedChannel?: boolean;\r\n    remoteNames: string[];\r\n\r\n    actions: {\r\n        markMostRecentPostInChannelAsUnread: (channelId: string) => void;\r\n        clearChannelSelection: () => void;\r\n        multiSelectChannelTo: (channelId: string) => void;\r\n        multiSelectChannelAdd: (channelId: string) => void;\r\n        unsetEditingPost: () => void;\r\n        closeRightHandSide: () => void;\r\n        fetchChannelRemotes: (channelId: string) => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    isMenuOpen: boolean;\r\n    showTooltip: boolean;\r\n};\r\n\r\nexport class SidebarChannelLink extends React.PureComponent<Props, State> {\r\n    labelRef: React.RefObject<HTMLDivElement>;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.labelRef = React.createRef();\r\n\r\n        this.state = {\r\n            isMenuOpen: false,\r\n            showTooltip: false,\r\n        };\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        this.enableToolTipIfNeeded();\r\n\r\n        if (this.props.isSharedChannel && this.props.channel?.id && this.props.remoteNames.length === 0) {\r\n            this.props.actions.fetchChannelRemotes(this.props.channel.id);\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props): void {\r\n        if (prevProps.label !== this.props.label) {\r\n            this.enableToolTipIfNeeded();\r\n        }\r\n\r\n        if (this.props.isSharedChannel &&\r\n            (prevProps.channel?.id !== this.props.channel?.id || prevProps.channel?.team_id !== this.props.channel?.team_id) &&\r\n            this.props.remoteNames.length === 0 &&\r\n            this.props.channel?.id) {\r\n            this.props.actions.fetchChannelRemotes(this.props.channel.id);\r\n        }\r\n    }\r\n\r\n    enableToolTipIfNeeded = (): void => {\r\n        const element = this.labelRef.current;\r\n        const showTooltip = element && element.offsetWidth < element.scrollWidth;\r\n        this.setState({showTooltip: Boolean(showTooltip)});\r\n    };\r\n\r\n    getAriaLabel = (): string => {\r\n        const {label, ariaLabelPrefix, unreadMentions, intl} = this.props;\r\n\r\n        let ariaLabel = label;\r\n\r\n        if (ariaLabelPrefix) {\r\n            ariaLabel += ` ${ariaLabelPrefix}`;\r\n        }\r\n\r\n        if (unreadMentions === 1) {\r\n            ariaLabel += ` ${unreadMentions} ${intl.formatMessage({id: 'accessibility.sidebar.types.mention', defaultMessage: 'mention'})}`;\r\n        } else if (unreadMentions > 1) {\r\n            ariaLabel += ` ${unreadMentions} ${intl.formatMessage({id: 'accessibility.sidebar.types.mentions', defaultMessage: 'mentions'})}`;\r\n        }\r\n\r\n        if (this.props.isUnread && unreadMentions === 0) {\r\n            ariaLabel += ` ${intl.formatMessage({id: 'accessibility.sidebar.types.unread', defaultMessage: 'unread'})}`;\r\n        }\r\n\r\n        return ariaLabel.toLowerCase();\r\n    };\r\n\r\n    handleChannelClick = (event: React.MouseEvent<HTMLAnchorElement>): void => {\r\n        mark(Mark.ChannelLinkClicked);\r\n        this.handleSelectChannel(event);\r\n\r\n        if (this.props.rhsOpen && this.props.rhsState === RHSStates.EDIT_HISTORY) {\r\n            this.props.actions.closeRightHandSide();\r\n        }\r\n    };\r\n\r\n    handleSelectChannel = (event: React.MouseEvent<HTMLAnchorElement>): void => {\r\n        if (event.defaultPrevented || event.button !== 0) {\r\n            return;\r\n        }\r\n\r\n        if (cmdOrCtrlPressed(event as unknown as React.KeyboardEvent)) {\r\n            event.preventDefault();\r\n            this.props.actions.multiSelectChannelAdd(this.props.channel.id);\r\n        } else if (event.shiftKey) {\r\n            event.preventDefault();\r\n            this.props.actions.multiSelectChannelTo(this.props.channel.id);\r\n        } else if (event.altKey && !this.props.isUnread) {\r\n            event.preventDefault();\r\n            this.props.actions.markMostRecentPostInChannelAsUnread(this.props.channel.id);\r\n        } else {\r\n            this.props.actions.clearChannelSelection();\r\n        }\r\n    };\r\n\r\n    handleMenuToggle = (isMenuOpen: boolean) => {\r\n        this.setState({isMenuOpen});\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        const {\r\n            channel,\r\n            icon,\r\n            isChannelSelected,\r\n            isMuted,\r\n            isUnread,\r\n            label,\r\n            link,\r\n            unreadMentions,\r\n            firstChannelName,\r\n            showChannelsTutorialStep,\r\n            hasUrgent,\r\n        } = this.props;\r\n\r\n        let channelsTutorialTip: JSX.Element | null = null;\r\n\r\n        // firstChannelName is based on channel.name,\r\n        // but we want to display `display_name` to the user, so we check against `.name` for channel equality but pass in the .display_name value\r\n        if (firstChannelName === channel.name || (!firstChannelName && showChannelsTutorialStep && channel.name === Constants.DEFAULT_CHANNEL)) {\r\n            channelsTutorialTip = firstChannelName ? (<ChannelsAndDirectMessagesTour firstChannelName={channel.display_name}/>) : <ChannelsAndDirectMessagesTour/>;\r\n        }\r\n\r\n        let labelElement: JSX.Element = (\r\n            <span\r\n                ref={this.labelRef}\r\n                className='SidebarChannelLinkLabel'\r\n            >\r\n                {wrapEmojis(label)}\r\n            </span>\r\n        );\r\n        if (this.state.showTooltip) {\r\n            labelElement = (\r\n                <WithTooltip\r\n                    title={label}\r\n                >\r\n                    {labelElement}\r\n                </WithTooltip>\r\n            );\r\n        }\r\n\r\n        const customStatus = this.props.teammateId ? (\r\n            <CustomStatusEmoji\r\n                userID={this.props.teammateId}\r\n                showTooltip={true}\r\n                spanStyle={{\r\n                    height: 18,\r\n                }}\r\n                emojiStyle={{\r\n                    marginTop: -4,\r\n                    marginBottom: 0,\r\n                    opacity: 0.8,\r\n                }}\r\n            />\r\n        ) : null;\r\n\r\n        const sharedChannelIcon = this.props.isSharedChannel ? (\r\n            <SharedChannelIndicator\r\n                className='icon'\r\n                withTooltip={true}\r\n                remoteNames={this.props.remoteNames}\r\n            />\r\n        ) : null;\r\n\r\n        const content = (\r\n            <>\r\n                <SidebarChannelIcon\r\n                    isDeleted={channel.delete_at !== 0}\r\n                    icon={icon}\r\n                />\r\n                <div\r\n                    className='SidebarChannelLinkLabel_wrapper'\r\n                >\r\n                    {labelElement}\r\n                    {customStatus}\r\n                    <Pluggable\r\n                        pluggableName='SidebarChannelLinkLabel'\r\n                        channel={this.props.channel}\r\n                    />\r\n                    {sharedChannelIcon}\r\n                </div>\r\n                <ChannelPencilIcon id={channel.id}/>\r\n                <ChannelMentionBadge\r\n                    unreadMentions={unreadMentions}\r\n                    hasUrgent={hasUrgent}\r\n                />\r\n                <div\r\n                    className={classNames(\r\n                        'SidebarMenu',\r\n                        'MenuWrapper',\r\n                        {menuOpen: this.state.isMenuOpen},\r\n                        {'MenuWrapper--open': this.state.isMenuOpen},\r\n                    )}\r\n                >\r\n                    <SidebarChannelMenu\r\n                        channel={channel}\r\n                        channelLink={link}\r\n                        isUnread={isUnread}\r\n                        channelLeaveHandler={this.props.channelLeaveHandler}\r\n                        onMenuToggle={this.handleMenuToggle}\r\n                    />\r\n                </div>\r\n            </>\r\n        );\r\n\r\n        // NOTE: class added to temporarily support the desktop app's at-mention DOM scraping of the old sidebar\r\n        const className = classNames([\r\n            'SidebarLink',\r\n            {\r\n                menuOpen: this.state.isMenuOpen,\r\n                muted: isMuted,\r\n                'unread-title': this.props.isUnread,\r\n                selected: isChannelSelected,\r\n            },\r\n        ]);\r\n        return (\r\n            <Link\r\n                className={className}\r\n                id={`sidebarItem_${channel.name}`}\r\n                aria-label={this.getAriaLabel()}\r\n                to={link}\r\n                onClick={this.handleChannelClick}\r\n                tabIndex={0}\r\n            >\r\n                {content}\r\n                {channelsTutorialTip}\r\n            </Link>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(SidebarChannelLink);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {fetchChannelRemotes} from 'mattermost-redux/actions/shared_channels';\r\nimport {makeGetChannelUnreadCount} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentUserId, getMyChannelMemberships} from 'mattermost-redux/selectors/entities/common';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getInt} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getRemoteNamesForChannel} from 'mattermost-redux/selectors/entities/shared_channels';\r\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport {markMostRecentPostInChannelAsUnread, unsetEditingPost} from 'actions/post_actions';\r\nimport {clearChannelSelection, multiSelectChannelAdd, multiSelectChannelTo} from 'actions/views/channel_sidebar';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getFirstChannelName} from 'selectors/onboarding';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\nimport {isChannelSelected} from 'selectors/views/channel_sidebar';\r\n\r\nimport {\r\n    GenericTaskSteps,\r\n    OnboardingTaskCategory,\r\n    OnboardingTasksName,\r\n} from 'components/onboarding_tasks';\r\nimport {FINISHED, OnboardingTourSteps, TutorialTourName} from 'components/tours';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarChannelLink from './sidebar_channel_link';\r\n\r\ntype OwnProps = {\r\n    channel: Channel;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getUnreadCount = makeGetChannelUnreadCount();\r\n\r\n    return (state: GlobalState, ownProps: OwnProps) => {\r\n        const member = getMyChannelMemberships(state)[ownProps.channel.id];\r\n        const unreadCount = getUnreadCount(state, ownProps.channel.id);\r\n        const config = getConfig(state);\r\n        const enableTutorial = config.EnableTutorial === 'true';\r\n        const currentUserId = getCurrentUserId(state);\r\n        const tutorialStep = getInt(state, TutorialTourName.ONBOARDING_TUTORIAL_STEP, currentUserId, 0);\r\n        const triggerStep = getInt(state, OnboardingTaskCategory, OnboardingTasksName.CHANNELS_TOUR, FINISHED);\r\n        const channelTourTriggered = triggerStep === GenericTaskSteps.STARTED;\r\n        const isOnboardingFlowEnabled = config.EnableOnboardingFlow;\r\n        const showChannelsTour = enableTutorial && tutorialStep === OnboardingTourSteps.CHANNELS_AND_DIRECT_MESSAGES;\r\n        const showChannelsTutorialStep = showChannelsTour && channelTourTriggered && isOnboardingFlowEnabled === 'true';\r\n\r\n        const remoteNames = ownProps.channel?.shared ?\r\n            getRemoteNamesForChannel(state, ownProps.channel.id) : [];\r\n\r\n        return {\r\n            unreadMentions: unreadCount.mentions,\r\n            unreadMsgs: unreadCount.messages,\r\n            isUnread: unreadCount.showUnread,\r\n            isMuted: isChannelMuted(member),\r\n            hasUrgent: unreadCount.hasUrgent,\r\n            isChannelSelected: isChannelSelected(state, ownProps.channel.id),\r\n            firstChannelName: showChannelsTutorialStep ? getFirstChannelName(state) : '',\r\n            showChannelsTutorialStep,\r\n            rhsState: getRhsState(state),\r\n            rhsOpen: getIsRhsOpen(state),\r\n            remoteNames,\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            markMostRecentPostInChannelAsUnread,\r\n            unsetEditingPost,\r\n            clearChannelSelection,\r\n            multiSelectChannelTo,\r\n            multiSelectChannelAdd,\r\n            closeRightHandSide,\r\n            fetchChannelRemotes,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SidebarChannelLink);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport LeaveChannelModal from 'components/leave_channel_modal';\r\nimport SidebarChannelLink from 'components/sidebar/sidebar_channel/sidebar_channel_link';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport SidebarBaseChannelIcon from './sidebar_base_channel_icon';\r\n\r\nimport type {PropsFromRedux} from './index';\r\n\r\nexport interface Props extends PropsFromRedux {\r\n    channel: Channel;\r\n    currentTeamName: string;\r\n}\r\n\r\nconst SidebarBaseChannel = ({\r\n    channel,\r\n    currentTeamName,\r\n    actions,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    const handleLeavePublicChannel = useCallback((callback: () => void) => {\r\n        actions.leaveChannel(channel.id);\r\n        callback();\r\n    }, [channel.id, actions.leaveChannel]);\r\n\r\n    const handleLeavePrivateChannel = useCallback((callback: () => void) => {\r\n        actions.openModal({modalId: ModalIdentifiers.LEAVE_PRIVATE_CHANNEL_MODAL, dialogType: LeaveChannelModal, dialogProps: {channel}});\r\n        callback();\r\n    }, [channel, actions.openModal]);\r\n\r\n    let channelLeaveHandler = null;\r\n    if (channel.type === Constants.OPEN_CHANNEL && channel.name !== Constants.DEFAULT_CHANNEL) {\r\n        channelLeaveHandler = handleLeavePublicChannel;\r\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n        channelLeaveHandler = handleLeavePrivateChannel;\r\n    }\r\n\r\n    const channelIcon = (\r\n        <SidebarBaseChannelIcon\r\n            channelType={channel.type}\r\n        />\r\n    );\r\n\r\n    let ariaLabelPrefix;\r\n    if (channel.type === Constants.OPEN_CHANNEL) {\r\n        ariaLabelPrefix = intl.formatMessage({id: 'accessibility.sidebar.types.public', defaultMessage: 'public channel'});\r\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n        ariaLabelPrefix = intl.formatMessage({id: 'accessibility.sidebar.types.private', defaultMessage: 'private channel'});\r\n    }\r\n\r\n    return (\r\n        <SidebarChannelLink\r\n            channel={channel}\r\n            link={`/${currentTeamName}/channels/${channel.name}`}\r\n            label={channel.display_name}\r\n            ariaLabelPrefix={ariaLabelPrefix}\r\n            channelLeaveHandler={channelLeaveHandler!}\r\n            icon={channelIcon}\r\n            isSharedChannel={channel.shared}\r\n        />\r\n    );\r\n};\r\n\r\nexport default SidebarBaseChannel;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {leaveChannel} from 'actions/views/channel';\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport SidebarBaseChannel from './sidebar_base_channel';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            leaveChannel,\r\n            openModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(null, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(SidebarBaseChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {PreferenceType} from '@mattermost/types/preferences';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ProfilePicture from 'components/profile_picture';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport SidebarChannelLink from '../sidebar_channel_link';\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    channel: Channel;\r\n    teammate?: UserProfile;\r\n    currentTeamName: string;\r\n    currentUserId: string;\r\n    redirectChannel: string;\r\n    active: boolean;\r\n    actions: {\r\n        savePreferences: (userId: string, preferences: PreferenceType[]) => Promise<ActionResult>;\r\n        leaveDirectChannel: (channelId: string) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\nclass SidebarDirectChannel extends React.PureComponent<Props> {\r\n    handleLeaveChannel = (callback: () => void) => {\r\n        const id = this.props.channel.teammate_id;\r\n        const category = Constants.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW;\r\n\r\n        const currentUserId = this.props.currentUserId;\r\n        this.props.actions.savePreferences(currentUserId, [{user_id: currentUserId, category, name: id!, value: 'false'}]).then(callback);\r\n        this.props.actions.leaveDirectChannel(this.props.channel.name);\r\n\r\n        if (this.props.active) {\r\n            getHistory().push(`/${this.props.currentTeamName}/channels/${this.props.redirectChannel}`);\r\n        }\r\n    };\r\n\r\n    getIcon = () => {\r\n        const {channel, teammate} = this.props;\r\n\r\n        if (!teammate) {\r\n            return null;\r\n        }\r\n\r\n        if (teammate.id && teammate.delete_at) {\r\n            return (\r\n                <i className='icon icon-archive-outline'/>\r\n            );\r\n        }\r\n\r\n        let className = '';\r\n        if (channel.status === 'online') {\r\n            className = 'status-online';\r\n        } else if (channel.status === 'away') {\r\n            className = 'status-away';\r\n        } else if (channel.status === 'dnd') {\r\n            className = 'status-dnd';\r\n        }\r\n\r\n        return (\r\n            <ProfilePicture\r\n                src={Client4.getProfilePictureUrl(teammate.id, teammate.last_picture_update)}\r\n                size={'xs'}\r\n                status={teammate.is_bot ? '' : channel.status}\r\n                wrapperClass='DirectChannel__profile-picture'\r\n                newStatusIcon={true}\r\n                statusClass={`DirectChannel__status-icon ${className}`}\r\n            />\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const {channel, teammate, currentTeamName} = this.props;\r\n\r\n        if (!teammate) {\r\n            return null;\r\n        }\r\n\r\n        let displayName = channel.display_name;\r\n        if (this.props.currentUserId === teammate.id) {\r\n            displayName = this.props.intl.formatMessage({\r\n                id: 'sidebar.directchannel.you',\r\n                defaultMessage: '{displayname} (you)',\r\n            }, {\r\n                displayname: channel.display_name,\r\n            });\r\n        }\r\n\r\n        return (\r\n            <SidebarChannelLink\r\n                teammateId={teammate.id}\r\n                channel={channel}\r\n                link={`/${currentTeamName}/messages/@${teammate.username}`}\r\n                label={displayName}\r\n                channelLeaveHandler={this.handleLeaveChannel}\r\n                icon={this.getIcon()}\r\n                isSharedChannel={Boolean(teammate.remote_id)}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(SidebarDirectChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {getCurrentChannelId, getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser, getUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {leaveDirectChannel} from 'actions/views/channel';\r\n\r\nimport SidebarDirectChannel from './sidebar_direct_channel';\r\n\r\ntype OwnProps = {\r\n    channel: Channel;\r\n    currentTeamName: string;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const teammate = getUser(state, ownProps.channel.teammate_id!);\r\n    const currentUser = getCurrentUser(state);\r\n    const currentTeam = getCurrentTeam(state);\r\n    const redirectChannel = currentTeam ? getRedirectChannelNameForTeam(state, currentTeam.id) : '';\r\n    const currentChannelId = getCurrentChannelId(state);\r\n    const active = ownProps.channel.id === currentChannelId;\r\n\r\n    return {\r\n        teammate,\r\n        currentUserId: currentUser.id,\r\n        redirectChannel,\r\n        active,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            savePreferences,\r\n            leaveDirectChannel,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarDirectChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback} from 'react';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {PreferenceType} from '@mattermost/types/preferences';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport SidebarChannelLink from 'components/sidebar/sidebar_channel/sidebar_channel_link';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    channel: Channel;\r\n    currentTeamName: string;\r\n    currentUserId: string;\r\n    redirectChannel: string;\r\n    active: boolean;\r\n    membersCount: number;\r\n    actions: {\r\n        savePreferences: (userId: string, preferences: PreferenceType[]) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\nconst SidebarGroupChannel = ({\r\n    channel,\r\n    currentUserId,\r\n    actions,\r\n    active,\r\n    currentTeamName,\r\n    redirectChannel,\r\n    membersCount,\r\n}: Props) => {\r\n    const handleLeaveChannel = useCallback((callback: () => void) => {\r\n        const id = channel.id;\r\n        const category = Constants.Preferences.CATEGORY_GROUP_CHANNEL_SHOW;\r\n\r\n        actions.savePreferences(currentUserId, [{user_id: currentUserId, category, name: id, value: 'false'}]).then(callback);\r\n\r\n        if (active) {\r\n            getHistory().push(`/${currentTeamName}/channels/${redirectChannel}`);\r\n        }\r\n    }, [channel.id, actions, active, currentTeamName, redirectChannel, currentUserId]);\r\n\r\n    const getIcon = () => {\r\n        return (\r\n            <div className='status status--group'>{membersCount}</div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <SidebarChannelLink\r\n            channel={channel}\r\n            link={`/${currentTeamName}/messages/${channel.name}`}\r\n            label={channel.display_name}\r\n            channelLeaveHandler={handleLeaveChannel}\r\n            icon={getIcon()}\r\n        />\r\n    );\r\n};\r\n\r\nexport default memo(SidebarGroupChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {getCurrentChannelId, getRedirectChannelNameForTeam, makeGetGmChannelMemberCount} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport SidebarGroupChannel from './sidebar_group_channel';\r\n\r\ntype OwnProps = {\r\n    channel: Channel;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getMemberCount = makeGetGmChannelMemberCount();\r\n\r\n    return (state: GlobalState, ownProps: OwnProps) => {\r\n        const currentUserId = getCurrentUserId(state);\r\n        const currentTeam = getCurrentTeam(state);\r\n        const redirectChannel = currentTeam ? getRedirectChannelNameForTeam(state, currentTeam.id) : '';\r\n        const currentChannelId = getCurrentChannelId(state);\r\n        const membersCount = getMemberCount(state, ownProps.channel);\r\n        const active = ownProps.channel.id === currentChannelId;\r\n\r\n        return {\r\n            currentUserId,\r\n            redirectChannel,\r\n            active,\r\n            membersCount,\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            savePreferences,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SidebarGroupChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\n\r\nimport {getCurrentChannelId, makeGetChannel, makeGetChannelUnreadCount} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {getAutoSortedCategoryIds, getDraggingState, isChannelSelected} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarChannel from './sidebar_channel';\r\n\r\ntype OwnProps = {\r\n    channelId: string;\r\n    channelIndex: number;\r\n    isCategoryCollapsed: boolean;\r\n    isCategoryDragged: boolean;\r\n    isDraggable: boolean;\r\n    isAutoSortedCategory: boolean;\r\n\r\n    /**\r\n     * Sets the ref for the sidebar channel div element, so that it can be used by parent components\r\n     */\r\n    setChannelRef: (channelId: string, ref: HTMLLIElement) => void;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getChannel = makeGetChannel();\r\n    const getUnreadCount = makeGetChannelUnreadCount();\r\n\r\n    return (state: GlobalState, ownProps: OwnProps) => {\r\n        const channel = getChannel(state, ownProps.channelId);\r\n        const currentTeam = getCurrentTeam(state);\r\n\r\n        const currentChannelId = getCurrentChannelId(state);\r\n\r\n        const unreadCount = getUnreadCount(state, channel?.id || '');\r\n\r\n        return {\r\n            channel,\r\n            isCurrentChannel: channel?.id === currentChannelId,\r\n            currentTeamName: currentTeam?.name,\r\n            unreadMentions: unreadCount.mentions,\r\n            isUnread: unreadCount.showUnread,\r\n            draggingState: getDraggingState(state),\r\n            isChannelSelected: isChannelSelected(state, ownProps.channelId),\r\n            multiSelectedChannelIds: state.views.channelSidebar.multiSelectedChannelIds,\r\n            autoSortedCategoryIds: getAutoSortedCategoryIds(state),\r\n        };\r\n    };\r\n}\r\n\r\nconst connector = connect(makeMapStateToProps);\r\n\r\ntype PropsFromRedux = Omit<ConnectedProps<typeof connector>, 'dispatch'>;\r\n\r\nexport type Props = OwnProps & PropsFromRedux;\r\n\r\nexport default connector(SidebarChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useState} from 'react';\r\nimport type {AnimationEvent, ReactNode} from 'react';\r\nimport {Draggable} from 'react-beautiful-dnd';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\nimport SidebarBaseChannel from './sidebar_base_channel';\r\nimport SidebarDirectChannel from './sidebar_direct_channel';\r\nimport SidebarGroupChannel from './sidebar_group_channel';\r\n\r\nimport type {Props} from './index';\r\n\r\nfunction SidebarChannel({\r\n    isCategoryCollapsed,\r\n    isCategoryDragged,\r\n    isUnread,\r\n    isCurrentChannel,\r\n    setChannelRef,\r\n    channel,\r\n    currentTeamName,\r\n    isDraggable,\r\n    isChannelSelected,\r\n    draggingState,\r\n    multiSelectedChannelIds,\r\n    channelIndex,\r\n    isAutoSortedCategory,\r\n    autoSortedCategoryIds,\r\n}: Props) {\r\n    const [show, setShow] = useState(true);\r\n    if (!channel) {\r\n        return null;\r\n    }\r\n\r\n    if (!currentTeamName) {\r\n        return null;\r\n    }\r\n\r\n    function isCollapsed() {\r\n        return isCategoryDragged || (isCategoryCollapsed && !isUnread && !isCurrentChannel);\r\n    }\r\n\r\n    function setRef(refMethod?: (element: HTMLLIElement) => void) {\r\n        return (ref: HTMLLIElement) => {\r\n            setChannelRef(channel?.id || '', ref);\r\n            refMethod?.(ref);\r\n        };\r\n    }\r\n\r\n    function handleAnimationStart(event: AnimationEvent) {\r\n        if (event && event.animationName === 'toOpaqueAnimation' && !isCollapsed()) {\r\n            setShow(true);\r\n        }\r\n    }\r\n\r\n    function handleAnimationEnd(event: AnimationEvent) {\r\n        if (event && event.animationName === 'toTransparentAnimation' && isCollapsed()) {\r\n            setShow(false);\r\n        }\r\n    }\r\n\r\n    let component: ReactNode;\r\n    if (!show) {\r\n        component = null;\r\n    } else if (channel.type === Constants.DM_CHANNEL) {\r\n        component = (\r\n            <SidebarDirectChannel\r\n                channel={channel}\r\n                currentTeamName={currentTeamName}\r\n            />\r\n        );\r\n    } else if (channel.type === Constants.GM_CHANNEL) {\r\n        component = (\r\n            <SidebarGroupChannel\r\n                channel={channel}\r\n                currentTeamName={currentTeamName}\r\n            />\r\n        );\r\n    } else {\r\n        component = (\r\n            <SidebarBaseChannel\r\n                channel={channel}\r\n                currentTeamName={currentTeamName}\r\n            />\r\n        );\r\n    }\r\n\r\n    if (isDraggable) {\r\n        let selectedCount: React.ReactNode;\r\n        if (isChannelSelected && draggingState.state && draggingState.id === channel.id && multiSelectedChannelIds.length > 1) {\r\n            selectedCount = show ? (\r\n                <div className='SidebarChannel__selectedCount'>\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel.selectedCount'\r\n                        defaultMessage='{count} selected'\r\n                        values={{count: multiSelectedChannelIds.length}}\r\n                    />\r\n                </div>\r\n            ) : null;\r\n        }\r\n\r\n        return (\r\n            <Draggable\r\n                draggableId={channel.id}\r\n                index={channelIndex}\r\n            >\r\n                {(provided, snapshot) => {\r\n                    return (\r\n                        <li\r\n                            draggable='false'\r\n                            ref={setRef(provided.innerRef)}\r\n                            className={classNames('SidebarChannel', {\r\n                                collapsed: isCollapsed(),\r\n                                expanded: !isCollapsed(),\r\n                                unread: isUnread,\r\n                                active: isCurrentChannel,\r\n                                dragging: snapshot.isDragging,\r\n                                selectedDragging: isChannelSelected && draggingState.state && draggingState.id !== channel.id,\r\n                                fadeOnDrop: snapshot.isDropAnimating && snapshot.draggingOver && autoSortedCategoryIds.has(snapshot.draggingOver),\r\n                                noFloat: isAutoSortedCategory && !snapshot.isDragging,\r\n                            })}\r\n                            {...provided.draggableProps}\r\n                            {...provided.dragHandleProps}\r\n                            onAnimationStart={handleAnimationStart}\r\n                            onAnimationEnd={handleAnimationEnd}\r\n                            role='listitem'\r\n                            tabIndex={-1}\r\n                        >\r\n                            {component}\r\n                            {selectedCount}\r\n                        </li>\r\n                    );\r\n                }}\r\n            </Draggable>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <li\r\n            ref={setRef()}\r\n            className={classNames('SidebarChannel', {\r\n                collapsed: isCollapsed(),\r\n                expanded: !isCollapsed(),\r\n                unread: isUnread,\r\n                active: isCurrentChannel,\r\n            })}\r\n            onAnimationStart={handleAnimationStart}\r\n            onAnimationEnd={handleAnimationEnd}\r\n            role='listitem'\r\n        >\r\n            {component}\r\n        </li>\r\n    );\r\n}\r\n\r\nexport default SidebarChannel;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ServerError} from '@mattermost/types/errors';\r\nimport type {GetGroupsForUserParams, GetGroupsParams} from '@mattermost/types/groups';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {fetchChannelsAndMembers} from 'mattermost-redux/actions/channels';\r\nimport {logError} from 'mattermost-redux/actions/errors';\r\nimport {getGroups, getAllGroupsAssociatedToChannelsInTeam, getAllGroupsAssociatedToTeam, getGroupsByUserIdPaginated} from 'mattermost-redux/actions/groups';\r\nimport {forceLogoutIfNecessary} from 'mattermost-redux/actions/helpers';\r\nimport {getTeamByName, selectTeam} from 'mattermost-redux/actions/teams';\r\nimport {getIsUserStatusesConfigEnabled} from 'mattermost-redux/selectors/entities/common';\r\nimport {getLicense} from 'mattermost-redux/selectors/entities/general';\r\nimport {isCustomGroupsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {addVisibleUsersInCurrentChannelAndSelfToStatusPoll} from 'actions/status_actions';\r\nimport {addUserToTeam} from 'actions/team_actions';\r\nimport LocalStorageStore from 'stores/local_storage_store';\r\n\r\nimport {isSuccess} from 'types/actions';\r\nimport type {ActionFuncAsync} from 'types/store';\r\n\r\nexport function initializeTeam(team: Team): ActionFuncAsync<Team> {\r\n    return async (dispatch, getState) => {\r\n        dispatch(selectTeam(team.id));\r\n\r\n        const state = getState();\r\n        const currentUser = getCurrentUser(state);\r\n        LocalStorageStore.setPreviousTeamId(currentUser.id, team.id);\r\n\r\n        const enabledUserStatuses = getIsUserStatusesConfigEnabled(state);\r\n        if (enabledUserStatuses) {\r\n            dispatch(addVisibleUsersInCurrentChannelAndSelfToStatusPoll());\r\n        }\r\n\r\n        const license = getLicense(state);\r\n        const customGroupEnabled = isCustomGroupsEnabled(state);\r\n        if (license &&\r\n            license.IsLicensed === 'true' &&\r\n            (license.LDAPGroups === 'true' || customGroupEnabled)) {\r\n            const groupsParams: GetGroupsParams = {\r\n                filter_allow_reference: false,\r\n                page: 0,\r\n                per_page: 60,\r\n                include_member_count: true,\r\n                include_member_ids: true,\r\n                include_archived: false,\r\n            };\r\n            const myGroupsParams: GetGroupsForUserParams = {\r\n                ...groupsParams,\r\n                filter_has_member: currentUser.id,\r\n            };\r\n\r\n            if (currentUser) {\r\n                dispatch(getGroupsByUserIdPaginated(myGroupsParams));\r\n            }\r\n\r\n            if (license.LDAPGroups === 'true') {\r\n                dispatch(getAllGroupsAssociatedToChannelsInTeam(team.id, true));\r\n            }\r\n\r\n            if (team.group_constrained && license.LDAPGroups === 'true') {\r\n                dispatch(getAllGroupsAssociatedToTeam(team.id, true));\r\n            } else {\r\n                dispatch(getGroups(groupsParams));\r\n            }\r\n        }\r\n\r\n        return {data: team};\r\n    };\r\n}\r\n\r\nexport function joinTeam(teamname: string, joinedOnFirstLoad: boolean): ActionFuncAsync<Team> {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const currentUser = getCurrentUser(state);\r\n\r\n        try {\r\n            const teamByNameResult = await dispatch(getTeamByName(teamname));\r\n            if (isSuccess(teamByNameResult)) {\r\n                const team = teamByNameResult.data;\r\n\r\n                if (currentUser && team && team.delete_at === 0) {\r\n                    const addUserToTeamResult = await dispatch(addUserToTeam(team.id, currentUser.id));\r\n                    if (isSuccess(addUserToTeamResult)) {\r\n                        if (joinedOnFirstLoad) {\r\n                            LocalStorageStore.setTeamIdJoinedOnLoad(team.id);\r\n                        }\r\n\r\n                        await dispatch(initializeTeam(team));\r\n\r\n                        try {\r\n                            await dispatch(fetchChannelsAndMembers(team.id));\r\n                        } catch (error) {\r\n                            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n                            dispatch(logError(error as ServerError));\r\n                            return {error: error as ServerError};\r\n                        }\r\n\r\n                        return {data: team};\r\n                    }\r\n                    throw addUserToTeamResult.error;\r\n                }\r\n                throw new Error('Team not found or deleted');\r\n            } else {\r\n                throw teamByNameResult.error;\r\n            }\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n            dispatch(logError(error as ServerError));\r\n            return {error: error as ServerError};\r\n        }\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {History} from 'history';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {joinChannel, getChannelByNameAndTeamName, getChannelMember, markGroupChannelOpen, fetchChannelsAndMembers} from 'mattermost-redux/actions/channels';\r\nimport {getUser, getUserByUsername, getUserByEmail} from 'mattermost-redux/actions/users';\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport {getChannelByName, getOtherChannels, getChannel, getChannelsNameMapInTeam, getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getTeamByName} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId, getUserByUsername as selectUserByUsername, getUser as selectUser, getUserByEmail as selectUserByEmail} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {openDirectChannelToUserId} from 'actions/channel_actions';\r\nimport * as GlobalActions from 'actions/global_actions';\r\n\r\nimport {joinPrivateChannelPrompt} from 'utils/channel_utils';\r\nimport {Constants} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {ActionFuncAsync} from 'types/store';\r\n\r\nimport type {Match, MatchAndHistory} from './channel_identifier_router';\r\n\r\nconst LENGTH_OF_ID = 26;\r\nconst LENGTH_OF_GROUP_ID = 40;\r\nconst LENGTH_OF_USER_ID_PAIR = 54;\r\nconst USER_ID_PAIR_REGEXP = new RegExp(`^[a-zA-Z0-9]{${LENGTH_OF_ID}}__[a-zA-Z0-9]{${LENGTH_OF_ID}}$`);\r\n\r\nexport function onChannelByIdentifierEnter({match, history}: MatchAndHistory): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {path, identifier, team} = match.params;\r\n\r\n        if (!identifier) {\r\n            return {data: undefined};\r\n        }\r\n\r\n        const teamObj = getTeamByName(state, team);\r\n        if (!teamObj) {\r\n            return {data: undefined};\r\n        }\r\n\r\n        const channelPath = await getPathFromIdentifier(state, path, identifier);\r\n\r\n        switch (channelPath) {\r\n        case 'channel_name':\r\n            dispatch(goToChannelByChannelName(match, history));\r\n            break;\r\n        case 'channel_id':\r\n            dispatch(goToChannelByChannelId(match, history));\r\n            break;\r\n        case 'group_channel_group_id':\r\n            dispatch(goToGroupChannelByGroupId(match, history));\r\n            break;\r\n        case 'direct_channel_username':\r\n            dispatch(goToDirectChannelByUsername(match, history));\r\n            break;\r\n        case 'direct_channel_email':\r\n            dispatch(goToDirectChannelByEmail(match, history));\r\n            break;\r\n        case 'direct_channel_user_ids':\r\n            dispatch(goToDirectChannelByUserIds(match, history));\r\n            break;\r\n        case 'direct_channel_user_id':\r\n            dispatch(goToDirectChannelByUserId(match, history, identifier));\r\n            break;\r\n        case 'error':\r\n            await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n            handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n            break;\r\n        }\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport async function getPathFromIdentifier(state: GlobalState, path: string, identifier: string) {\r\n    if (path === 'channels') {\r\n        // It's hard to tell an ID apart from a channel name of the same length, so check first if\r\n        // the identifier matches a channel that we have\r\n        const channelsByName = getChannelByName(state, identifier);\r\n        const moreChannelsByName = getOtherChannels(state).find((chan) => chan.name === identifier);\r\n\r\n        if (identifier.length === LENGTH_OF_ID) {\r\n            if (!channelsByName && !moreChannelsByName) {\r\n                try {\r\n                    await Client4.getChannel(identifier);\r\n                    return 'channel_id';\r\n                } catch (e) {\r\n                    if (e.status_code === 404) {\r\n                        return 'channel_name';\r\n                    }\r\n                    return 'error';\r\n                }\r\n            }\r\n            return 'channel_name';\r\n        } else if (\r\n            (!channelsByName && !moreChannelsByName && identifier.length === LENGTH_OF_GROUP_ID) ||\r\n            (\r\n                (channelsByName && channelsByName.type === Constants.GM_CHANNEL) ||\r\n                (moreChannelsByName && moreChannelsByName.type === Constants.GM_CHANNEL)\r\n            )\r\n        ) {\r\n            return 'group_channel_group_id';\r\n        } else if (isDirectChannelIdentifier(identifier)) {\r\n            return 'direct_channel_user_ids';\r\n        }\r\n        return 'channel_name';\r\n    } else if (path === 'messages') {\r\n        if (identifier.indexOf('@') === 0) {\r\n            return 'direct_channel_username';\r\n        } else if (identifier.indexOf('@') > 0) {\r\n            return 'direct_channel_email';\r\n        } else if (identifier.length === LENGTH_OF_ID) {\r\n            return 'direct_channel_user_id';\r\n        } else if (identifier.length === LENGTH_OF_GROUP_ID) {\r\n            return 'group_channel_group_id';\r\n        }\r\n        return 'error';\r\n    }\r\n\r\n    return 'error';\r\n}\r\n\r\nexport function goToChannelByChannelId(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const channelId = identifier.toLowerCase();\r\n\r\n        let channel = getChannel(state, channelId);\r\n        const member = state.entities.channels.myMembers[channelId];\r\n        const teamObj = getTeamByName(state, team);\r\n        if (!channel || !member) {\r\n            const dispatchResult = await dispatch(joinChannel(getCurrentUserId(state), teamObj!.id, channelId, ''));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleChannelJoinError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            channel = dispatchResult.data!.channel;\r\n        }\r\n\r\n        if (channel.type === Constants.DM_CHANNEL) {\r\n            dispatch(goToDirectChannelByUserId(match, history, Utils.getUserIdFromChannelId(channel.name, getCurrentUserId(state))));\r\n        } else if (channel.type === Constants.GM_CHANNEL) {\r\n            history.replace(`/${team}/messages/${channel.name}`);\r\n        } else {\r\n            history.replace(`/${team}/channels/${channel.name}`);\r\n        }\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport function goToChannelByChannelName(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const channelName = identifier.toLowerCase();\r\n\r\n        const teamObj = getTeamByName(state, team);\r\n        if (!teamObj) {\r\n            return {data: undefined};\r\n        }\r\n\r\n        let channel = getChannelsNameMapInTeam(state, teamObj!.id)[channelName];\r\n        if (!channel) {\r\n            const getChannelDispatchResult = await dispatch(getChannelByNameAndTeamName(team, channelName, true));\r\n            if ('data' in getChannelDispatchResult) {\r\n                channel = getChannelDispatchResult.data!;\r\n            }\r\n        }\r\n\r\n        let member;\r\n        if (channel) {\r\n            member = state.entities.channels.myMembers[channel.id];\r\n            if (!member) {\r\n                const membership = await dispatch(getChannelMember(channel.id, getCurrentUserId(state)));\r\n                if ('data' in membership) {\r\n                    member = membership.data;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!channel || !member) {\r\n            if (channel?.type === Constants.PRIVATE_CHANNEL) {\r\n                // If we are here, we have permissions to join the channel\r\n                // and the channel is private. Therefore prompt always.\r\n                const joinPromptResult = await dispatch(joinPrivateChannelPrompt(teamObj, channel.display_name));\r\n                if ('data' in joinPromptResult && !joinPromptResult.data!.join) {\r\n                    return {data: undefined};\r\n                }\r\n            }\r\n\r\n            const joinChannelDispatchResult = await dispatch(joinChannel(getCurrentUserId(state), teamObj!.id, channel?.id || '', channelName));\r\n            if ('error' in joinChannelDispatchResult) {\r\n                if (!channel) {\r\n                    const getChannelDispatchResult = await dispatch(getChannelByNameAndTeamName(team, channelName, true));\r\n                    if ('error' in getChannelDispatchResult || getChannelDispatchResult.data!.delete_at === 0) {\r\n                        await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                        handleChannelJoinError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                        return {data: undefined};\r\n                    }\r\n                    channel = getChannelDispatchResult.data!;\r\n                }\r\n            } else {\r\n                channel = joinChannelDispatchResult.data!.channel;\r\n            }\r\n        }\r\n\r\n        if (channel.type === Constants.DM_CHANNEL) {\r\n            dispatch(goToDirectChannelByUserIds(match, history));\r\n        } else if (channel.type === Constants.GM_CHANNEL) {\r\n            history.replace(`/${team}/messages/${channel.name}`);\r\n        } else {\r\n            doChannelChange(channel);\r\n        }\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nfunction goToDirectChannelByUsername(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const username = identifier.slice(1, identifier.length).toLowerCase();\r\n        const teamObj = getTeamByName(state, team);\r\n\r\n        let user = selectUserByUsername(state, username);\r\n        if (!user) {\r\n            const dispatchResult = await dispatch(getUserByUsername(username));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            user = dispatchResult.data!;\r\n        }\r\n\r\n        const directChannelDispatchRes = await dispatch(openDirectChannelToUserId(user.id));\r\n        if ('error' in directChannelDispatchRes) {\r\n            await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n            handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n            return {data: undefined};\r\n        }\r\n\r\n        doChannelChange(directChannelDispatchRes.data!);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport function goToDirectChannelByUserId(match: Match, history: History, userId: string): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team} = match.params;\r\n        const teamObj = getTeamByName(state, team);\r\n\r\n        let user = selectUser(state, userId);\r\n        if (!user) {\r\n            const dispatchResult = await dispatch(getUser(userId));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            user = dispatchResult.data!;\r\n        }\r\n\r\n        history.replace(`/${team}/messages/@${user.username}`);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport function goToDirectChannelByUserIds(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const userId = Utils.getUserIdFromChannelId(identifier.toLowerCase(), getCurrentUserId(getState()));\r\n        const teamObj = getTeamByName(state, team);\r\n\r\n        let user = selectUser(state, userId);\r\n        if (!user) {\r\n            const dispatchResult = await dispatch(getUser(userId));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            user = dispatchResult.data!;\r\n        }\r\n\r\n        history.replace(`/${team}/messages/@${user.username}`);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport function goToDirectChannelByEmail(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const email = identifier.toLowerCase();\r\n        const teamObj = getTeamByName(state, team);\r\n\r\n        let user = selectUserByEmail(state, email);\r\n        if (!user) {\r\n            const dispatchResult = await dispatch(getUserByEmail(email));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            user = dispatchResult.data!;\r\n        }\r\n\r\n        history.replace(`/${team}/messages/@${user.username}`);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nfunction goToGroupChannelByGroupId(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {identifier, team} = match.params;\r\n        const groupId = identifier.toLowerCase();\r\n\r\n        history.replace(match.url.replace('/channels/', '/messages/'));\r\n\r\n        let channel = getChannelByName(state, groupId);\r\n        const teamObj = getTeamByName(state, team);\r\n        if (!channel) {\r\n            const dispatchResult = await dispatch(joinChannel(getCurrentUserId(state), teamObj!.id, '', groupId));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            channel = dispatchResult.data!.channel;\r\n        }\r\n\r\n        dispatch(markGroupChannelOpen(channel!.id));\r\n\r\n        doChannelChange(channel!);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nfunction doChannelChange(channel: Channel) {\r\n    GlobalActions.emitChannelClickEvent(channel);\r\n}\r\n\r\nfunction handleError(match: Match, history: History, defaultChannel: string) {\r\n    const {team} = match.params;\r\n    history.push(team ? `/${team}/channels/${defaultChannel}` : '/');\r\n}\r\n\r\nfunction isDirectChannelIdentifier(identifier: string) {\r\n    return identifier.length === LENGTH_OF_USER_ID_PAIR && USER_ID_PAIR_REGEXP.test(identifier);\r\n}\r\n\r\nasync function handleChannelJoinError(match: Match, history: History, defaultChannel: string) {\r\n    const {team} = match.params;\r\n    history.push(team ? `/error?type=channel_not_found&returnTo=/${team}/channels/${defaultChannel}` : '/');\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\ntype TrackedItemCallback = (changedHeight: number) => void;\r\ntype TrackedItemData = {element: Element; callback: TrackedItemCallback};\r\ntype TrackedItemsMap = Map<string, TrackedItemData>;\r\n\r\nexport class ListItemSizeObserver {\r\n    private observer: ResizeObserver;\r\n\r\n    private trackedItems: TrackedItemsMap = new Map();\r\n\r\n    private static instance: ListItemSizeObserver | null = null;\r\n\r\n    private constructor() {\r\n        this.observer = new ResizeObserver(this.handleResizeObserver);\r\n    }\r\n\r\n    public static getInstance(): ListItemSizeObserver {\r\n        if (!ListItemSizeObserver.instance) {\r\n            // Following class based singleton pattern to avoid multiple instances of the observer\r\n            ListItemSizeObserver.instance = new ListItemSizeObserver();\r\n        }\r\n        return ListItemSizeObserver.instance;\r\n    }\r\n\r\n    private handleResizeObserver = (resizeEntries: ResizeObserverEntry[]) => {\r\n        resizeEntries.forEach((resizeEntry) => {\r\n            const resizedElement = resizeEntry.target;\r\n\r\n            let itemData: TrackedItemData | undefined;\r\n            for (const [, trackedItemData] of this.trackedItems.entries()) {\r\n                // Reverse lookup by element to get the item's data\r\n                if (trackedItemData.element === resizedElement) {\r\n                    itemData = trackedItemData;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!itemData) {\r\n                return;\r\n            }\r\n\r\n            const changedHeight = Math.ceil(resizeEntry.borderBoxSize[0].blockSize);\r\n            itemData.callback(changedHeight);\r\n        });\r\n    };\r\n\r\n    public observe(itemId: string, element: Element, callback: TrackedItemCallback): () => void {\r\n        this.trackedItems.set(itemId, {element, callback});\r\n        this.observer.observe(element);\r\n\r\n        return () => this.unobserve(itemId);\r\n    }\r\n\r\n    private unobserve(itemId: string): void {\r\n        const trackedItemToUnobserve = this.trackedItems.get(itemId);\r\n        if (trackedItemToUnobserve) {\r\n            this.observer.unobserve(trackedItemToUnobserve.element);\r\n            this.trackedItems.delete(itemId);\r\n        }\r\n    }\r\n}\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport debounce from 'lodash/debounce';\r\nimport type {ReactNode} from 'react';\r\nimport React, {memo, useEffect, useRef} from 'react';\r\n\r\nimport {ListItemSizeObserver} from './list_item_size_observer';\r\n\r\nconst RESIZE_DEBOUNCE_TIME = 200; // in ms\r\n\r\nconst listItemSizeObserver = ListItemSizeObserver.getInstance();\r\n\r\ninterface Props {\r\n    item: ReactNode;\r\n    itemId: string;\r\n    index: number;\r\n    height: number;\r\n    width?: number; // Its optional since it may not be available when the parent component is mounted\r\n    onHeightChange: (itemId: string, height: number, forceScrollCorrection: boolean) => void;\r\n    onUnmount: (itemId: string, index: number) => void;\r\n}\r\n\r\n/**\r\n * This component is used to measure the height of a row and update the height of the row when it changes.\r\n * Uses a shared ResizeObserver instance for better performance with many items.\r\n */\r\nconst ListItem = (props: Props) => {\r\n    const rowRef = useRef<HTMLDivElement>(null);\r\n\r\n    const heightRef = useRef(props.height);\r\n    const widthRef = useRef(props.width);\r\n    const indexRef = useRef(props.index);\r\n\r\n    // This prevents stale closures in the ResizeObserver callback\r\n    // and ensures event handlers always have the latest values\r\n    // we also update these refs whenever their source values change\r\n    useEffect(() => {\r\n        heightRef.current = props.height;\r\n        widthRef.current = props.width;\r\n        indexRef.current = props.index;\r\n    }, [props.itemId, props.height, props.width, props.index]);\r\n\r\n    // This effect is used to measure the height of the row as soon as the component mounts\r\n    useEffect(() => {\r\n        const newHeight = Math.ceil(rowRef?.current?.offsetHeight ?? 0);\r\n        props.onHeightChange(props.itemId, newHeight, false);\r\n    }, [props.itemId]);\r\n\r\n    // This effects adds the observer which calls height change callback debounced\r\n    useEffect(() => {\r\n        const debouncedOnHeightChange = debounce((changedHeight: number) => {\r\n            // Check if component is still mounted as it may have been\r\n            // unmounted by the time the debounced function is called\r\n            if (!rowRef.current) {\r\n                return;\r\n            }\r\n\r\n            // If width of container has changed then scroll bar position will be out of sync\r\n            // so we need to force a scroll correction\r\n            const forceScrollCorrection = rowRef.current.offsetWidth !== widthRef.current;\r\n\r\n            heightRef.current = changedHeight;\r\n\r\n            props.onHeightChange(props.itemId, changedHeight, forceScrollCorrection);\r\n        }, RESIZE_DEBOUNCE_TIME);\r\n\r\n        function itemRowSizeObserverCallback(changedHeight: number) {\r\n            if (!rowRef.current) {\r\n                return;\r\n            }\r\n\r\n            if (changedHeight !== heightRef.current) {\r\n                debouncedOnHeightChange(changedHeight);\r\n            }\r\n        }\r\n\r\n        let cleanupSizeObserver: () => void;\r\n\r\n        // We add the observer here to a row\r\n        if (rowRef.current) {\r\n            cleanupSizeObserver = listItemSizeObserver.observe(props.itemId, rowRef.current, itemRowSizeObserverCallback);\r\n        }\r\n\r\n        return () => {\r\n            // We remove the observer here from a row\r\n            cleanupSizeObserver?.();\r\n            debouncedOnHeightChange?.cancel();\r\n            props.onUnmount(props.itemId, indexRef.current);\r\n        };\r\n    }, [props.itemId]);\r\n\r\n    return (\r\n        <div\r\n            ref={rowRef}\r\n            role='listitem'\r\n            className='item_measurer'\r\n        >\r\n            {props.item}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(ListItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\n/* eslint-disable no-underscore-dangle */\r\n/* eslint-disable react/prop-types */\r\n\r\nimport memoizeOne from 'memoize-one';\r\nimport {createElement, PureComponent} from 'react';\r\n\r\nimport ListItem from './list_item';\r\n\r\nconst atBottomMargin = 10;\r\n\r\nexport class DynamicVirtualizedList extends PureComponent {\r\n    _listMetaData = {\r\n        itemOffsetMap: {},\r\n        itemSizeMap: {},\r\n        totalMeasuredSize: 0,\r\n        atBottom: true,\r\n    };\r\n\r\n    _itemStyleCache = {};\r\n    _outerRef;\r\n    _scrollCorrectionInProgress = false;\r\n    _scrollByCorrection = null;\r\n    _keepScrollPosition = false;\r\n    _keepScrollToBottom = false;\r\n    _mountingCorrections = 0;\r\n    _correctedInstances = 0;\r\n\r\n    static defaultProps = {\r\n        innerTagName: 'div',\r\n        itemData: undefined,\r\n        outerTagName: 'div',\r\n        overscanCountForward: 30,\r\n        overscanCountBackward: 10,\r\n    };\r\n\r\n    state = {\r\n        scrollDirection: 'backward',\r\n        scrollOffset: typeof this.props.initialScrollOffset === 'number' ? this.props.initialScrollOffset : 0,\r\n        scrollUpdateWasRequested: false,\r\n        scrollDelta: 0,\r\n        scrollHeight: 0,\r\n        localOlderPostsToRender: [],\r\n    };\r\n\r\n    // Always use explicit constructor for React components.\r\n    // It produces less code after transpilation. (#26)\r\n    // eslint-disable-next-line no-useless-constructor\r\n    constructor(props) {\r\n        super(props);\r\n    }\r\n\r\n    scrollBy = (scrollOffset, scrollBy) => () => {\r\n        const element = this._outerRef;\r\n        if (typeof element.scrollBy === 'function' && scrollBy) {\r\n            element.scrollBy(0, scrollBy);\r\n        } else if (scrollOffset) {\r\n            element.scrollTop = scrollOffset;\r\n        }\r\n\r\n        this._scrollCorrectionInProgress = false;\r\n    };\r\n\r\n    scrollTo(scrollOffset, scrollByValue, useAnimationFrame = false) {\r\n        this._scrollCorrectionInProgress = true;\r\n        this.setState(\r\n            (prevState) => ({\r\n                scrollDirection: prevState.scrollOffset >= scrollOffset ? 'backward' : 'forward',\r\n                scrollOffset,\r\n                scrollUpdateWasRequested: true,\r\n                scrollByValue,\r\n            }),\r\n            () => {\r\n                if (useAnimationFrame) {\r\n                    this._scrollByCorrection = window.requestAnimationFrame(\r\n                        this.scrollBy(\r\n                            this.state.scrollOffset,\r\n                            this.state.scrollByValue,\r\n                        ),\r\n                    );\r\n                } else {\r\n                    this.scrollBy(\r\n                        this.state.scrollOffset,\r\n                        this.state.scrollByValue,\r\n                    )();\r\n                }\r\n            },\r\n        );\r\n\r\n        this.forceUpdate();\r\n    }\r\n\r\n    scrollToItem(index, align = 'auto', offset = 0) {\r\n        const {scrollOffset} = this.state;\r\n\r\n        //Ideally the below scrollTo works fine but firefox has 6px issue and stays 6px from bottom when corrected\r\n        //so manually keeping scroll position bottom for now\r\n        const element = this._outerRef;\r\n        if (index === 0 && align === 'end') {\r\n            this.scrollTo(element.scrollHeight - this.props.height);\r\n            return;\r\n        }\r\n\r\n        const offsetOfItem = getOffsetForIndexAndAlignment(\r\n            this.props,\r\n            index,\r\n            align,\r\n            scrollOffset,\r\n            this._listMetaData,\r\n        );\r\n        if (!offsetOfItem) {\r\n            const itemSize = getItemSize(this.props, index, this._listMetaData);\r\n            if (!itemSize && this.props.scrollToFailed) {\r\n                if (this.state.scrolledToInitIndex) {\r\n                    this.props.scrollToFailed(index);\r\n                }\r\n            }\r\n        }\r\n\r\n        this.scrollTo(offsetOfItem + offset);\r\n    }\r\n\r\n    componentDidMount() {\r\n        const {initialScrollOffset} = this.props;\r\n\r\n        if (typeof initialScrollOffset === 'number' && this._outerRef !== null) {\r\n            const element = this._outerRef;\r\n            element.scrollTop = initialScrollOffset;\r\n        }\r\n\r\n        this._commitHook();\r\n    }\r\n\r\n    getSnapshotBeforeUpdate(_, prevState) {\r\n        if (prevState.localOlderPostsToRender[0] !== this.state.localOlderPostsToRender[0] ||\r\n            prevState.localOlderPostsToRender[1] !== this.state.localOlderPostsToRender[1]\r\n        ) {\r\n            const element = this._outerRef;\r\n            const previousScrollTop = element.scrollTop;\r\n            const previousScrollHeight = element.scrollHeight;\r\n            return {\r\n                previousScrollTop,\r\n                previousScrollHeight,\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if (this.state.scrolledToInitIndex) {\r\n            const {\r\n                scrollDirection,\r\n                scrollOffset,\r\n                scrollUpdateWasRequested,\r\n                scrollHeight,\r\n            } = this.state;\r\n\r\n            const {\r\n                scrollDirection: prevScrollDirection,\r\n                scrollOffset: prevScrollOffset,\r\n                scrollUpdateWasRequested: prevScrollUpdateWasRequested,\r\n                scrollHeight: previousScrollHeight,\r\n            } = prevState;\r\n\r\n            if (\r\n                scrollDirection !== prevScrollDirection ||\r\n                scrollOffset !== prevScrollOffset ||\r\n                scrollUpdateWasRequested !== prevScrollUpdateWasRequested ||\r\n                scrollHeight !== previousScrollHeight\r\n            ) {\r\n                this._callPropsCallbacks();\r\n            }\r\n            if (!prevState.scrolledToInitIndex) {\r\n                this._keepScrollPosition = false;\r\n                this._keepScrollToBottom = false;\r\n            }\r\n        }\r\n\r\n        this._commitHook();\r\n        if (prevProps.itemData !== this.props.itemData) {\r\n            this._dataChange();\r\n        }\r\n\r\n        if (prevProps.height !== this.props.height) {\r\n            this._heightChange(prevProps.height, prevState.scrollOffset);\r\n        }\r\n\r\n        if (prevState.scrolledToInitIndex !== this.state.scrolledToInitIndex) {\r\n            this._dataChange(); // though this is not data change we are checking for first load change\r\n        }\r\n\r\n        if (prevProps.width !== this.props.width) {\r\n            this.innerRefWidth = this.props.innerRef.current.clientWidth;\r\n            this._widthChange(prevProps.height, prevState.scrollOffset);\r\n        }\r\n\r\n        if (prevState.localOlderPostsToRender[0] !== this.state.localOlderPostsToRender[0] ||\r\n            prevState.localOlderPostsToRender[1] !== this.state.localOlderPostsToRender[1]\r\n        ) {\r\n            const postlistScrollHeight = this._outerRef.scrollHeight;\r\n\r\n            const scrollValue = snapshot.previousScrollTop + (postlistScrollHeight - snapshot.previousScrollHeight);\r\n\r\n            this.scrollTo(\r\n                scrollValue,\r\n                scrollValue - snapshot.previousScrollTop,\r\n                true,\r\n            );\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this._scrollByCorrection) {\r\n            window.cancelAnimationFrame(this._scrollByCorrection);\r\n        }\r\n    }\r\n\r\n    _callOnItemsRendered = memoizeOne((overscanStartIndex, overscanStopIndex, visibleStartIndex, visibleStopIndex) =>\r\n        this.props.onItemsRendered({\r\n            overscanStartIndex,\r\n            overscanStopIndex,\r\n            visibleStartIndex,\r\n            visibleStopIndex,\r\n        }),\r\n    );\r\n\r\n    _callOnScroll = memoizeOne((scrollDirection, scrollOffset, scrollUpdateWasRequested, scrollHeight, clientHeight) =>\r\n        this.props.onScroll({\r\n            scrollDirection,\r\n            scrollOffset,\r\n            scrollUpdateWasRequested,\r\n            scrollHeight,\r\n            clientHeight,\r\n        }),\r\n    );\r\n\r\n    _callPropsCallbacks() {\r\n        const {itemData, height} = this.props;\r\n        const {\r\n            scrollDirection,\r\n            scrollOffset,\r\n            scrollUpdateWasRequested,\r\n            scrollHeight,\r\n        } = this.state;\r\n        const itemCount = itemData.length;\r\n\r\n        if (typeof this.props.onItemsRendered === 'function') {\r\n            if (itemCount > 0) {\r\n                const [\r\n                    overscanStartIndex,\r\n                    overscanStopIndex,\r\n                    visibleStartIndex,\r\n                    visibleStopIndex,\r\n                ] = this._getRangeToRender();\r\n\r\n                this._callOnItemsRendered(\r\n                    overscanStartIndex,\r\n                    overscanStopIndex,\r\n                    visibleStartIndex,\r\n                    visibleStopIndex,\r\n                );\r\n\r\n                if (\r\n                    scrollDirection === 'backward' &&\r\n                    scrollOffset < 1000 &&\r\n                    overscanStopIndex !== itemCount - 1\r\n                ) {\r\n                    const sizeOfNextElement = getItemSize(\r\n                        this.props,\r\n                        overscanStopIndex + 1,\r\n                        this._listMetaData,\r\n                    ).size;\r\n                    if (!sizeOfNextElement && this.state.scrolledToInitIndex) {\r\n                        this.setState((prevState) => {\r\n                            if (\r\n                                prevState.localOlderPostsToRender[0] !==\r\n                                overscanStopIndex + 1\r\n                            ) {\r\n                                return {\r\n                                    localOlderPostsToRender: [\r\n                                        overscanStopIndex + 1,\r\n                                        overscanStopIndex + 50,\r\n                                    ],\r\n                                };\r\n                            }\r\n                            return null;\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (typeof this.props.onScroll === 'function') {\r\n            this._callOnScroll(\r\n                scrollDirection,\r\n                scrollOffset,\r\n                scrollUpdateWasRequested,\r\n                scrollHeight,\r\n                height,\r\n            );\r\n        }\r\n    }\r\n\r\n    // This method is called after mount and update.\r\n    // List implementations can override this method to be notified.\r\n    _commitHook = () => {\r\n        if (\r\n            !this.state.scrolledToInitIndex &&\r\n            Object.keys(this._listMetaData.itemOffsetMap).length\r\n        ) {\r\n            const {index, position, offset} = this.props.initScrollToIndex();\r\n            this.scrollToItem(index, position, offset);\r\n            this.setState({\r\n                scrolledToInitIndex: true,\r\n            });\r\n\r\n            if (index === 0) {\r\n                this._keepScrollToBottom = true;\r\n            } else {\r\n                this._keepScrollPosition = true;\r\n            }\r\n        }\r\n    };\r\n\r\n    // This method is called when data changes\r\n    // List implementations can override this method to be notified.\r\n    _dataChange = () => {\r\n        if (this._listMetaData.totalMeasuredSize < this.props.height) {\r\n            this.props.canLoadMorePosts();\r\n        }\r\n    };\r\n\r\n    _heightChange = (prevHeight, prevOffset) => {\r\n        const wasAtBottom =\r\n            prevOffset + prevHeight >=\r\n            this._listMetaData.totalMeasuredSize - atBottomMargin;\r\n\r\n        if (wasAtBottom) {\r\n            this.scrollToItem(0, 'end');\r\n        }\r\n    };\r\n\r\n    _widthChange = (prevHeight, prevOffset) => {\r\n        const wasAtBottom =\r\n            prevOffset + prevHeight >=\r\n            this._listMetaData.totalMeasuredSize - atBottomMargin;\r\n\r\n        if (wasAtBottom) {\r\n            this.scrollToItem(0, 'end');\r\n        }\r\n    };\r\n\r\n    // Lazily create and cache item styles while scrolling,\r\n    // So that pure component sCU will prevent re-renders.\r\n    // We maintain this cache, and pass a style prop rather than index,\r\n    // So that List can clear cached styles and force item re-render if necessary.\r\n    _getItemStyle = (index) => {\r\n        const {itemData} = this.props;\r\n\r\n        const itemStyleCache = this._itemStyleCache;\r\n\r\n        let style;\r\n        if (Object.prototype.hasOwnProperty.call(itemStyleCache, itemData[index])) {\r\n            style = itemStyleCache[itemData[index]];\r\n        } else {\r\n            style = {\r\n                left: 0,\r\n                top: getItemOffset(this.props, index, this._listMetaData),\r\n                height: getItemSize(this.props, index, this._listMetaData),\r\n                width: '100%',\r\n            };\r\n            itemStyleCache[itemData[index]] = style;\r\n        }\r\n\r\n        return style;\r\n    };\r\n\r\n    _getRangeToRender(scrollTop) {\r\n        const {itemData, overscanCountForward, overscanCountBackward} =\r\n            this.props;\r\n        const {scrollDirection, scrollOffset} = this.state;\r\n        const itemCount = itemData.length;\r\n\r\n        if (itemCount === 0) {\r\n            return [0, 0, 0, 0];\r\n        }\r\n        const scrollOffsetValue = scrollTop >= 0 ? scrollTop : scrollOffset;\r\n        const startIndex = getStartIndexForOffset(\r\n            this.props,\r\n            scrollOffsetValue,\r\n            this._listMetaData,\r\n        );\r\n        const stopIndex = getStopIndexForStartIndex(\r\n            this.props,\r\n            startIndex,\r\n            scrollOffsetValue,\r\n            this._listMetaData,\r\n        );\r\n\r\n        // Overscan by one item in each direction so that tab/focus works.\r\n        // If there isn't at least one extra item, tab loops back around.\r\n        const overscanBackward = scrollDirection === 'backward' ? overscanCountBackward : Math.max(1, overscanCountForward);\r\n\r\n        const overscanForward = scrollDirection === 'forward' ? overscanCountBackward : Math.max(1, overscanCountForward);\r\n\r\n        const minValue = Math.max(0, stopIndex - overscanBackward);\r\n        let maxValue = Math.max(0, Math.min(itemCount - 1, startIndex + overscanForward));\r\n\r\n        while (\r\n            !getItemSize(this.props, maxValue, this._listMetaData) &&\r\n            maxValue > 0 &&\r\n            this._listMetaData.totalMeasuredSize > this.props.height\r\n        ) {\r\n            maxValue--;\r\n        }\r\n\r\n        if (\r\n            !this.state.scrolledToInitIndex &&\r\n            this.props.initRangeToRender.length\r\n        ) {\r\n            return this.props.initRangeToRender;\r\n        }\r\n\r\n        return [minValue, maxValue, startIndex, stopIndex];\r\n    }\r\n\r\n    _correctScroll = () => {\r\n        const {scrollOffset} = this.state;\r\n        const element = this._outerRef;\r\n        if (element) {\r\n            element.scrollTop = scrollOffset;\r\n            this._scrollCorrectionInProgress = false;\r\n            this._correctedInstances = 0;\r\n            this._mountingCorrections = 0;\r\n        }\r\n    };\r\n\r\n    _generateOffsetMeasurements = () => {\r\n        const {itemOffsetMap, itemSizeMap} = this._listMetaData;\r\n        const {itemData} = this.props;\r\n        this._listMetaData.totalMeasuredSize = 0;\r\n\r\n        for (let i = itemData.length - 1; i >= 0; i--) {\r\n            const prevOffset = itemOffsetMap[itemData[i + 1]] || 0;\r\n\r\n            // In some browsers (e.g. Firefox) fast scrolling may skip rows.\r\n            // In this case, our assumptions about last measured indices may be incorrect.\r\n            // Handle this edge case to prevent NaN values from breaking styles.\r\n            // Slow scrolling back over these skipped rows will adjust their sizes.\r\n            const prevSize = itemSizeMap[itemData[i + 1]] || 0;\r\n\r\n            itemOffsetMap[itemData[i]] = prevOffset + prevSize;\r\n            this._listMetaData.totalMeasuredSize += itemSizeMap[itemData[i]] || 0;\r\n\r\n            // Reset cached style to clear stale position.\r\n            delete this._itemStyleCache[itemData[i]];\r\n        }\r\n    };\r\n\r\n    _handleNewMeasurements = (key, newSize, forceScrollCorrection) => {\r\n        const {itemSizeMap} = this._listMetaData;\r\n        const {itemData} = this.props;\r\n        const index = itemData.findIndex((item) => item === key);\r\n\r\n        // In some browsers (e.g. Firefox) fast scrolling may skip rows.\r\n        // In this case, our assumptions about last measured indices may be incorrect.\r\n        // Handle this edge case to prevent NaN values from breaking styles.\r\n        // Slow scrolling back over these skipped rows will adjust their sizes.\r\n        const oldSize = itemSizeMap[key] || 0;\r\n        if (oldSize === newSize) {\r\n            return;\r\n        }\r\n\r\n        itemSizeMap[key] = newSize;\r\n\r\n        if (!this.state.scrolledToInitIndex) {\r\n            this._generateOffsetMeasurements();\r\n            return;\r\n        }\r\n\r\n        const element = this._outerRef;\r\n        const wasAtBottom =\r\n            this.props.height + element.scrollTop >=\r\n            this._listMetaData.totalMeasuredSize - atBottomMargin;\r\n\r\n        if (\r\n            (wasAtBottom || this._keepScrollToBottom) &&\r\n            this.props.correctScrollToBottom\r\n        ) {\r\n            this._generateOffsetMeasurements();\r\n            this.scrollToItem(0, 'end');\r\n            this.forceUpdate();\r\n            return;\r\n        }\r\n\r\n        if (forceScrollCorrection || this._keepScrollPosition) {\r\n            const delta = newSize - oldSize;\r\n            const [, , visibleStartIndex] = this._getRangeToRender(this.state.scrollOffset);\r\n            this._generateOffsetMeasurements();\r\n            if (index < visibleStartIndex + 1) {\r\n                return;\r\n            }\r\n\r\n            this._scrollCorrectionInProgress = true;\r\n\r\n            this.setState(\r\n                (prevState) => {\r\n                    let deltaValue;\r\n                    if (this._mountingCorrections === 0) {\r\n                        deltaValue = delta;\r\n                    } else {\r\n                        deltaValue = prevState.scrollDelta + delta;\r\n                    }\r\n                    this._mountingCorrections++;\r\n                    const newOffset = prevState.scrollOffset + delta;\r\n                    return {\r\n                        scrollOffset: newOffset,\r\n                        scrollDelta: deltaValue,\r\n                    };\r\n                },\r\n                () => {\r\n                    this._correctedInstances++;\r\n                    if (\r\n                        this._mountingCorrections === this._correctedInstances\r\n                    ) {\r\n                        this._correctScroll();\r\n                    }\r\n                },\r\n            );\r\n            return;\r\n        }\r\n\r\n        this._generateOffsetMeasurements();\r\n    };\r\n\r\n    _onItemRowUnmount = (itemId, index) => {\r\n        const {props} = this;\r\n        if (props.itemData[index] === itemId) {\r\n            return;\r\n        }\r\n        const doesItemExist = props.itemData.includes(itemId);\r\n        if (!doesItemExist) {\r\n            delete this._listMetaData.itemSizeMap[itemId];\r\n            delete this._listMetaData.itemOffsetMap[itemId];\r\n            const element = this._outerRef;\r\n\r\n            const atBottom =\r\n                element.offsetHeight + element.scrollTop >=\r\n                this._listMetaData.totalMeasuredSize - atBottomMargin;\r\n\r\n            this._generateOffsetMeasurements();\r\n\r\n            if (atBottom) {\r\n                this.scrollToItem(0, 'end');\r\n            }\r\n\r\n            this.forceUpdate();\r\n        }\r\n    };\r\n\r\n    _onScrollVertical = (event) => {\r\n        if (!this.state.scrolledToInitIndex) {\r\n            return;\r\n        }\r\n        const {scrollTop, scrollHeight} = event.currentTarget;\r\n        if (this._scrollCorrectionInProgress) {\r\n            if (this.state.scrollUpdateWasRequested) {\r\n                this.setState(() => ({\r\n                    scrollUpdateWasRequested: false,\r\n                }));\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (scrollHeight !== this.state.scrollHeight) {\r\n            this.setState({\r\n                scrollHeight,\r\n            });\r\n        }\r\n\r\n        this.setState((prevState) => {\r\n            if (prevState.scrollOffset === scrollTop) {\r\n                // Scroll position may have been updated by cDM/cDU,\r\n                // In which case we don't need to trigger another render,\r\n                return null;\r\n            }\r\n\r\n            return {\r\n                scrollDirection:\r\n                    prevState.scrollOffset < scrollTop ? 'forward' : 'backward',\r\n                scrollOffset: scrollTop,\r\n                scrollUpdateWasRequested: false,\r\n                scrollHeight,\r\n                scrollTop,\r\n                scrollDelta: 0,\r\n            };\r\n        });\r\n    };\r\n\r\n    _outerRefSetter = (ref) => {\r\n        const {outerRef} = this.props;\r\n        this.innerRefWidth = this.props.innerRef.current.clientWidth;\r\n        this._outerRef = ref;\r\n\r\n        if (typeof outerRef === 'function') {\r\n            outerRef(ref);\r\n        } else if (outerRef != null && typeof outerRef === 'object' && Object.prototype.hasOwnProperty.call(outerRef, 'current')) {\r\n            outerRef.current = ref;\r\n        }\r\n    };\r\n\r\n    _renderItems = () => {\r\n        const width = this.innerRefWidth;\r\n        const [startIndex, stopIndex] = this._getRangeToRender();\r\n        const itemCount = this.props.itemData.length;\r\n        const items = [];\r\n        if (itemCount > 0) {\r\n            for (let index = itemCount - 1; index >= 0; index--) {\r\n                const {size} = getItemMetadata(\r\n                    this.props,\r\n                    index,\r\n                    this._listMetaData,\r\n                );\r\n\r\n                const [\r\n                    localOlderPostsToRenderStartIndex,\r\n                    localOlderPostsToRenderStopIndex,\r\n                ] = this.state.localOlderPostsToRender;\r\n\r\n                const isItemInLocalPosts =\r\n                    index >= localOlderPostsToRenderStartIndex &&\r\n                    index < localOlderPostsToRenderStopIndex + 1 &&\r\n                    localOlderPostsToRenderStartIndex === stopIndex + 1;\r\n\r\n                const isLoader = this.props.itemData[index] === this.props.loaderId;\r\n                const isVisible = this.props.itemData[index] === this.props.visibleId;\r\n                const itemId = this.props.itemData[index];\r\n\r\n                // It's important to read style after fetching item metadata.\r\n                // getItemMetadata() will clear stale styles.\r\n                const style = this._getItemStyle(index);\r\n                if (\r\n                    (index >= startIndex && index < stopIndex + 1) ||\r\n                    isItemInLocalPosts ||\r\n                    isLoader ||\r\n                    isVisible\r\n                ) {\r\n                    const item = createElement(this.props.children, {\r\n                        data: this.props.itemData,\r\n                        itemId,\r\n                    });\r\n\r\n                    // Always wrap children in a ItemRow to detect changes in size.\r\n                    items.push(\r\n                        createElement(ListItem, {\r\n                            key: itemId,\r\n                            index,\r\n                            item,\r\n                            itemId,\r\n                            height: size,\r\n                            width,\r\n                            onHeightChange: this._handleNewMeasurements,\r\n                            onUnmount: this._onItemRowUnmount,\r\n                        }),\r\n                    );\r\n                } else {\r\n                    items.push(\r\n                        createElement('div', {\r\n                            key: itemId,\r\n                            style,\r\n                        }),\r\n                    );\r\n                }\r\n            }\r\n        }\r\n        return items;\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            className,\r\n            id,\r\n            innerRef,\r\n            innerTagName,\r\n            outerTagName,\r\n            style,\r\n            innerListStyle,\r\n        } = this.props;\r\n\r\n        const onScroll = this._onScrollVertical;\r\n\r\n        const items = this._renderItems();\r\n\r\n        return createElement(\r\n            outerTagName,\r\n            {\r\n                className,\r\n                id,\r\n                onScroll,\r\n                ref: this._outerRefSetter,\r\n                style: {\r\n                    WebkitOverflowScrolling: 'touch',\r\n                    overflowY: 'auto',\r\n                    overflowAnchor: 'none',\r\n                    willChange: 'transform',\r\n                    width: '100%',\r\n                    ...style,\r\n                },\r\n            },\r\n            createElement(\r\n                innerTagName,\r\n                {\r\n                    ref: innerRef,\r\n                    role: 'list',\r\n                    className: 'innerList',\r\n                    style: innerListStyle,\r\n                },\r\n                items,\r\n            ),\r\n        );\r\n    }\r\n}\r\n\r\nconst getItemMetadata = (props, index, listMetaData) => {\r\n    const {itemOffsetMap, itemSizeMap} = listMetaData;\r\n    const {itemData} = props;\r\n\r\n    // If the specified item has not yet been measured,\r\n    // Just return an estimated size for now.\r\n    if (!itemSizeMap[itemData[index]]) {\r\n        return {\r\n            offset: 0,\r\n            size: 0,\r\n        };\r\n    }\r\n\r\n    const offset = itemOffsetMap[itemData[index]] || 0;\r\n    const size = itemSizeMap[itemData[index]] || 0;\r\n\r\n    return {offset, size};\r\n};\r\n\r\nconst getItemOffset = (props, index, listMetaData) => getItemMetadata(props, index, listMetaData).offset;\r\n\r\nconst getOffsetForIndexAndAlignment = (\r\n    props,\r\n    index,\r\n    align,\r\n    scrollOffset,\r\n    listMetaData,\r\n) => {\r\n    const {height} = props;\r\n    const itemMetadata = getItemMetadata(props, index, listMetaData);\r\n\r\n    // Get estimated total size after ItemMetadata is computed,\r\n    // To ensure it reflects actual measurements instead of just estimates.\r\n    const estimatedTotalSize = listMetaData.totalMeasuredSize;\r\n\r\n    const maxOffset = Math.max(0, (itemMetadata.offset + itemMetadata.size) - height);\r\n    const minOffset = Math.max(0, itemMetadata.offset);\r\n\r\n    switch (align) {\r\n    case 'start':\r\n        return minOffset;\r\n    case 'end':\r\n        return maxOffset;\r\n    case 'center':\r\n        return Math.round(((minOffset - (height / 2)) + (itemMetadata.size / 2)));\r\n    case 'auto':\r\n    default:\r\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\r\n            return estimatedTotalSize - (scrollOffset + height);\r\n        } else if (scrollOffset - minOffset < maxOffset - scrollOffset) {\r\n            return minOffset;\r\n        }\r\n        return maxOffset;\r\n    }\r\n};\r\n\r\nconst findNearestItem = (props, listMetaData, high, low, scrollOffset) => {\r\n    let index = low;\r\n    while (low <= high) {\r\n        var currentOffset = getItemMetadata(props, low, listMetaData).offset;\r\n        if (scrollOffset - currentOffset <= 0) {\r\n            index = low;\r\n        }\r\n\r\n        // eslint-disable-next-line no-param-reassign\r\n        low++;\r\n    }\r\n    return index;\r\n};\r\n\r\nconst getStartIndexForOffset = (props, offset, listMetaData) => {\r\n    const {totalMeasuredSize} = listMetaData;\r\n    const {itemData} = props;\r\n\r\n    // If we've already positioned and measured past this point,\r\n    // Use a binary search to find the closets cell.\r\n    if (offset <= totalMeasuredSize) {\r\n        return findNearestItem(props, listMetaData, itemData.length, 0, offset);\r\n    }\r\n\r\n    // Otherwise render a new batch of items starting from where 0.\r\n    return 0;\r\n};\r\n\r\nconst getStopIndexForStartIndex = (\r\n    props,\r\n    startIndex,\r\n    scrollOffset,\r\n    listMetaData,\r\n) => {\r\n    const {itemData} = props;\r\n\r\n    let stopIndex = startIndex;\r\n    const maxOffset = scrollOffset + props.height;\r\n    const itemMetadata = getItemMetadata(props, stopIndex, listMetaData);\r\n    let offset = itemMetadata.offset + (itemMetadata.size || 0);\r\n\r\n    while (stopIndex > 0 && offset <= maxOffset) {\r\n        const itemMetadata = getItemMetadata(props, stopIndex, listMetaData);\r\n        offset = itemMetadata.offset + itemMetadata.size;\r\n        stopIndex--;\r\n    }\r\n\r\n    if (stopIndex >= itemData.length) {\r\n        return 0;\r\n    }\r\n\r\n    return stopIndex;\r\n};\r\n\r\nconst getItemSize = (props, index, listMetaData) => {\r\n    // Do not hard-code item dimensions.\r\n    // We don't know them initially.\r\n    // Even once we do, changes in item content or list size should reflow.\r\n    return getItemMetadata(props, index, listMetaData).size;\r\n};\r\n\r\nexport default DynamicVirtualizedList;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport * as React from 'react';\r\n\r\ntype SvgProps = {\r\n    width?: number;\r\n    height?: number;\r\n};\r\n\r\nconst PrivateChannelIntroSvg = (props: SvgProps) => (\r\n    <svg\r\n        width={props.width ?? '130'}\r\n        height={props.height ?? '102'}\r\n        viewBox='0 0 130 102'\r\n        fill='none'\r\n        xmlns='http://www.w3.org/2000/svg'\r\n        xmlnsXlink='http://www.w3.org/1999/xlink'\r\n        {...props}\r\n    >\r\n        <g clipPath='url(#clip0_4212_90419)'>\r\n            <path\r\n                d='M2.50001 16L2.5 31L127.5 31L127.5 75L66 75'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.32'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M2.5 69L2.5 42L29 42'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.32'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M18.5 70.5L18.5 56.5L106 56.5'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.32'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 16)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 74)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 16 74)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='71'\r\n                cy='59'\r\n                r='43'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.12'\r\n            />\r\n            <path\r\n                d='M110.748 91.5258L119 100V56C119 54.8954 118.105 54 117 54H76.0005C74.8959 54 74.0005 54.8954 74.0005 56V88.9211C74.0005 90.0256 74.8959 90.9211 76.0005 90.9211H109.316C109.855 90.9211 110.372 91.1391 110.748 91.5258Z'\r\n                fill='#28427B'\r\n            />\r\n            <circle\r\n                opacity='0.48'\r\n                cx='86.831'\r\n                cy='65.831'\r\n                r='5.83099'\r\n                fill='var(--button-color)'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M96 64H112'\r\n                stroke='var(--button-color-rgb)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 79H103.38'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 83H96.2535'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M96 68H110'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 75H93.0141'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M95.6064 75H107.268'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M28.605 67.5638L15 81V12C15 10.8954 15.8954 10 17 10H83C84.1046 10 85 10.8954 85 12V64.9868C85 66.0914 84.1046 66.9868 83 66.9868H30.0103C29.4842 66.9868 28.9793 67.1941 28.605 67.5638Z'\r\n                fill='var(--center-channel-bg)'\r\n            />\r\n            <path\r\n                d='M28.2536 67.2081L15.5 79.8035V12C15.5 11.1716 16.1716 10.5 17 10.5H83C83.8284 10.5 84.5 11.1716 84.5 12V64.9868C84.5 65.8153 83.8284 66.4868 83 66.4868H30.0103C29.3527 66.4868 28.7215 66.746 28.2536 67.2081Z'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n            />\r\n            <circle\r\n                cx='33'\r\n                cy='29'\r\n                r='9'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.4'\r\n            />\r\n            <path\r\n                d='M48 25H64'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 49H62'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 55H47'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M48 31H73'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 43H42'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M46 43H64'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='78'\r\n                cy='19'\r\n                r='19'\r\n                fill='#32539A'\r\n            />\r\n            <path\r\n                d='M98 49L80 49'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M76 49L70 49'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M67 49L65 49'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <circle\r\n                cx='44'\r\n                cy='75'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='52'\r\n                cy='75'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='60'\r\n                cy='75'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <rect\r\n                x='70.5'\r\n                y='15.5'\r\n                width='15'\r\n                height='12'\r\n                rx='1.5'\r\n                stroke='var(--button-color)'\r\n            />\r\n            <path\r\n                d='M73 16V13C73 10.2386 75.2386 8 78 8V8C80.7614 8 83 10.2386 83 13V16'\r\n                stroke='var(--button-color)'\r\n            />\r\n        </g>\r\n        <defs>\r\n            <clipPath id='clip0_4212_90419'>\r\n                <rect\r\n                    width='130'\r\n                    height='102'\r\n                    fill='white'\r\n                />\r\n            </clipPath>\r\n        </defs>\r\n    </svg>\r\n);\r\n\r\nexport default PrivateChannelIntroSvg;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\ntype SvgProps = {\r\n    width?: number;\r\n    height?: number;\r\n};\r\n\r\nconst PublicChannelIntroSvg = (props: SvgProps) => (\r\n    <svg\r\n        width={props.width ?? '130'}\r\n        height={props.height ?? '102'}\r\n        viewBox='0 0 130 102'\r\n        fill='none'\r\n        xmlns='http://www.w3.org/2000/svg'\r\n        xmlnsXlink='http://www.w3.org/1999/xlink'\r\n    >\r\n        <g clipPath='url(#clip0_4212_90121)'>\r\n            <path\r\n                d='M2.50001 16L2.5 31L127.5 31L127.5 75L66 75'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.32)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M2.5 69L2.5 42L29 42'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.32)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M18.5 70.5L18.5 56.5L106 56.5'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.32)'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 16)'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 74)'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 16 74)'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='71'\r\n                cy='59'\r\n                r='43'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.12)'\r\n            />\r\n            <path\r\n                d='M110.748 91.5258L119 100V56C119 54.8954 118.105 54 117 54H76.0005C74.8959 54 74.0005 54.8954 74.0005 56V88.9211C74.0005 90.0256 74.8959 90.9211 76.0005 90.9211H109.316C109.855 90.9211 110.372 91.1391 110.748 91.5258Z'\r\n                fill='#28427B'\r\n            />\r\n            <circle\r\n                opacity='0.48'\r\n                cx='86.831'\r\n                cy='65.831'\r\n                r='5.83099'\r\n                fill='var(--button-color)'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M96 64H112'\r\n                stroke='var(--button-color-rgb)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 79H103.38'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 83H96.2535'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M96 68H110'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 75H93.0141'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M95.6064 75H107.268'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M28.605 67.5638L15 81V12C15 10.8954 15.8954 10 17 10H83C84.1046 10 85 10.8954 85 12V64.9868C85 66.0914 84.1046 66.9868 83 66.9868H30.0103C29.4842 66.9868 28.9793 67.1941 28.605 67.5638Z'\r\n                fill='rgba(var(--center-channel-bg-rgb))'\r\n            />\r\n            <path\r\n                d='M28.2536 67.2081L15.5 79.8035V12C15.5 11.1716 16.1716 10.5 17 10.5H83C83.8284 10.5 84.5 11.1716 84.5 12V64.9868C84.5 65.8153 83.8284 66.4868 83 66.4868H30.0103C29.3527 66.4868 28.7215 66.746 28.2536 67.2081Z'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.8)'\r\n            />\r\n            <circle\r\n                cx='33'\r\n                cy='29'\r\n                r='9'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.4)'\r\n            />\r\n            <path\r\n                d='M48 25H64'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 49H62'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 55H47'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M48 31H73'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 43H42'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M46 43H64'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='78'\r\n                cy='19'\r\n                r='19'\r\n                fill='#32539A'\r\n            />\r\n            <path\r\n                d='M98 49L80 49'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.8)'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M76 49L70 49'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.8)'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M67 49L65 49'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.8)'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <circle\r\n                cx='44'\r\n                cy='75'\r\n                r='2'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='52'\r\n                cy='75'\r\n                r='2'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='60'\r\n                cy='75'\r\n                r='2'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='78'\r\n                cy='19'\r\n                r='9.5'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n            />\r\n            <path\r\n                d='M87.5 20.2525C86.1859 21.8482 82.4292 23 78 23C73.5708 23 69.8141 21.8482 68.5 20.2525'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n            />\r\n            <path\r\n                d='M86.6622 15C84.9331 16.1956 81.7014 17 78 17C74.2986 17 71.0669 16.1956 69.3378 15'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n            />\r\n            <path\r\n                d='M81.5 19C81.5 21.7141 81.059 24.1482 80.3642 25.8854C80.0162 26.7553 79.6144 27.4258 79.1937 27.8706C78.7741 28.3143 78.3705 28.5 78 28.5C77.6295 28.5 77.2259 28.3143 76.8063 27.8706C76.3856 27.4258 75.9838 26.7553 75.6358 25.8854C74.941 24.1482 74.5 21.7141 74.5 19C74.5 16.2859 74.941 13.8518 75.6358 12.1146C75.9838 11.2447 76.3856 10.5742 76.8063 10.1294C77.2259 9.6857 77.6295 9.5 78 9.5C78.3705 9.5 78.7741 9.6857 79.1937 10.1294C79.6144 10.5742 80.0162 11.2447 80.3642 12.1146C81.059 13.8518 81.5 16.2859 81.5 19Z'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n            />\r\n        </g>\r\n        <defs>\r\n            <clipPath id='clip0_4212_90121'>\r\n                <rect\r\n                    width='130'\r\n                    height='102'\r\n                    fill='rgba(var(--center-channel-bg-rgb))'\r\n                />\r\n            </clipPath>\r\n        </defs>\r\n    </svg>\r\n\r\n);\r\n\r\nexport default PublicChannelIntroSvg;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport * as React from 'react';\r\n\r\ntype SvgProps = {\r\n    width?: number;\r\n    height?: number;\r\n};\r\n\r\nconst SvgComponent = (props: SvgProps) => (\r\n    <svg\r\n        width={props.width ?? '130'}\r\n        height={props.height ?? '92'}\r\n        viewBox='0 0 130 92'\r\n        fill='none'\r\n        xmlns='http://www.w3.org/2000/svg'\r\n        xmlnsXlink='http://www.w3.org/1999/xlink'\r\n        {...props}\r\n    >\r\n        <g clipPath='url(#clip0_4210_88396)'>\r\n            <path\r\n                d='M2.50001 6.00001L2.5 21L127.5 21L127.5 65L66 65'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.24'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M2.49999 59L2.49999 32L29 32'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.24'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M18.5 60.5L18.5 46.5L106 46.5'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.24'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 6)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 64)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 16 64)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.4'\r\n            />\r\n            <circle\r\n                cx='71'\r\n                cy='49'\r\n                r='43'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.12'\r\n            />\r\n            <path\r\n                d='M109.748 82.5258L117.999 91V47C117.999 45.8954 117.104 45 115.999 45H74.9998C73.8952 45 72.9998 45.8954 72.9998 47V79.9211C72.9998 81.0256 73.8952 81.9211 74.9998 81.9211H108.315C108.855 81.9211 109.371 82.1391 109.748 82.5258Z'\r\n                fill='#28427B'\r\n            />\r\n            <circle\r\n                opacity='0.48'\r\n                cx='85.8309'\r\n                cy='56.831'\r\n                r='5.83099'\r\n                fill='#FFFFFF'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M94.9999 55H111'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M80.9999 70H102.38'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M80.9999 74H95.2535'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M94.9999 59H109'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M80.9999 66H92.014'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M94.6064 66H106.268'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M28.605 57.5638L15 71V2C15 0.895431 15.8954 0 17 0H83C84.1046 0 85 0.89543 85 2V54.9868C85 56.0914 84.1046 56.9868 83 56.9868H30.0103C29.4842 56.9868 28.9793 57.1941 28.605 57.5638Z'\r\n                fill='var(--center-channel-bg)'\r\n            />\r\n            <path\r\n                d='M28.2536 57.2081L15.5 69.8035V2C15.5 1.17157 16.1716 0.5 17 0.5H83C83.8284 0.5 84.5 1.17157 84.5 2V54.9868C84.5 55.8153 83.8284 56.4868 83 56.4868H30.0103C29.3527 56.4868 28.7215 56.746 28.2536 57.2081Z'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n            />\r\n            <circle\r\n                cx='33'\r\n                cy='19'\r\n                r='9'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.4'\r\n            />\r\n            <path\r\n                d='M48 15H64'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 39H69'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 45H47'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M48 21H73'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 33H42'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M46 33H64'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='44'\r\n                cy='65'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='52'\r\n                cy='65'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='60'\r\n                cy='65'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <path\r\n                d='M101 33L83 33'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M79 33L73 33'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M70 33L68 33'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n        </g>\r\n        <defs>\r\n            <clipPath id='clip0_4210_88396'>\r\n                <rect\r\n                    width='130'\r\n                    height='92'\r\n                    fill='white'\r\n                />\r\n            </clipPath>\r\n        </defs>\r\n    </svg>\r\n);\r\n\r\nexport default SvgComponent;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport AddGroupsToChannelModal from 'components/add_groups_to_channel_modal';\r\nimport ChannelInviteModal from 'components/channel_invite_modal';\r\nimport InvitationModal from 'components/invitation_modal';\r\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\nimport ToggleModalButton from 'components/toggle_modal_button';\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\nimport {Constants, ModalIdentifiers} from 'utils/constants';\r\n\r\nimport './add_members_button.scss';\r\n\r\nexport interface AddMembersButtonProps {\r\n    totalUsers?: number;\r\n    usersLimit: number;\r\n    channel: Channel;\r\n    pluginButtons?: React.ReactNode;\r\n}\r\n\r\nconst AddMembersButton: React.FC<AddMembersButtonProps> = ({totalUsers, usersLimit, channel, pluginButtons}: AddMembersButtonProps) => {\r\n    const currentTeamId = useSelector(getCurrentTeamId);\r\n\r\n    if (!totalUsers) {\r\n        return (<LoadingSpinner/>);\r\n    }\r\n\r\n    const inviteUsers = totalUsers < usersLimit;\r\n\r\n    return (\r\n        <TeamPermissionGate\r\n            teamId={currentTeamId}\r\n            permissions={[Permissions.ADD_USER_TO_TEAM, Permissions.INVITE_GUEST]}\r\n        >\r\n            {inviteUsers ? (\r\n                <LessThanMaxFreeUsers\r\n                    pluginButtons={pluginButtons}\r\n                />\r\n            ) : (\r\n                <MoreThanMaxFreeUsers\r\n                    channel={channel}\r\n                    pluginButtons={pluginButtons}\r\n                />\r\n            )}\r\n        </TeamPermissionGate>\r\n    );\r\n};\r\n\r\nconst LessThanMaxFreeUsers = ({pluginButtons}: {pluginButtons: React.ReactNode}) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <>\r\n            {pluginButtons}\r\n            <div className='LessThanMaxFreeUsers'>\r\n                <ToggleModalButton\r\n                    id='introTextInvite'\r\n                    className='btn btn-sm btn-primary'\r\n                    modalId={ModalIdentifiers.INVITATION}\r\n                    dialogType={InvitationModal}\r\n                    dialogProps={{focusOriginElement: 'browseOrAddChannelMenuButton'}}\r\n                >\r\n                    <i\r\n                        className='icon-email-plus-outline'\r\n                        title={formatMessage({id: 'generic_icons.add', defaultMessage: 'Add Icon'})}\r\n                        aria-hidden='true'\r\n                    />\r\n                    <FormattedMessage\r\n                        id='intro_messages.inviteOthersToWorkspace.button'\r\n                        defaultMessage='Invite others to the workspace'\r\n                    />\r\n                </ToggleModalButton>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nconst MoreThanMaxFreeUsers = ({channel, pluginButtons}: {channel: Channel; pluginButtons: React.ReactNode}) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const modalId = channel.group_constrained ? ModalIdentifiers.ADD_GROUPS_TO_CHANNEL : ModalIdentifiers.CHANNEL_INVITE;\r\n    const modal = channel.group_constrained ? AddGroupsToChannelModal : ChannelInviteModal;\r\n    const channelIsArchived = channel.delete_at !== 0;\r\n    if (channelIsArchived) {\r\n        return null;\r\n    }\r\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\r\n\r\n    return (\r\n        <div className='MoreThanMaxFreeUsersWrapper'>\r\n            <div className='MoreThanMaxFreeUsers'>\r\n                <ChannelPermissionGate\r\n                    channelId={channel.id}\r\n                    teamId={channel.team_id}\r\n                    permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS : Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS]}\r\n                >\r\n                    <ToggleModalButton\r\n                        className='action-button'\r\n                        modalId={modalId}\r\n                        dialogType={modal}\r\n                        dialogProps={{channel}}\r\n                    >\r\n                        <i\r\n                            className='icon-account-plus-outline'\r\n                            title={formatMessage({id: 'generic_icons.add', defaultMessage: 'Add Icon'})}\r\n                            aria-hidden='true'\r\n                        />\r\n                        {channel.group_constrained &&\r\n                            <FormattedMessage\r\n                                id='intro_messages.inviteGropusToChannel.button'\r\n                                defaultMessage='Add groups'\r\n                            />}\r\n                        {!channel.group_constrained &&\r\n                            <FormattedMessage\r\n                                id='intro_messages.inviteMembersToChannel.button'\r\n                                defaultMessage='Add people'\r\n                            />}\r\n                    </ToggleModalButton>\r\n                </ChannelPermissionGate>\r\n            </div>\r\n            {pluginButtons}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(AddMembersButton);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\n\r\nimport {usePluginVisibilityInSharedChannel} from 'components/common/hooks/usePluginVisibilityInSharedChannel';\r\n\r\nimport type {ChannelIntroButtonAction} from 'types/store/plugins';\r\n\r\ntype Props = {\r\n    channel: Channel;\r\n    channelMember?: ChannelMembership;\r\n    pluginButtons: ChannelIntroButtonAction[];\r\n}\r\n\r\nconst PluggableIntroButtons = React.memo(({\r\n    channel,\r\n    pluginButtons,\r\n    channelMember,\r\n}: Props) => {\r\n    const channelIsArchived = channel.delete_at !== 0;\r\n    const pluginItemsVisible = usePluginVisibilityInSharedChannel(channel.id);\r\n\r\n    if (!pluginItemsVisible) {\r\n        return null;\r\n    }\r\n\r\n    if (channelIsArchived || pluginButtons.length === 0 || !channelMember) {\r\n        return null;\r\n    }\r\n\r\n    const buttons = pluginButtons.map((buttonProps) => {\r\n        return (\r\n            <button\r\n                key={buttonProps.id}\r\n                className={'action-button'}\r\n                onClick={() => buttonProps.action?.(channel, channelMember)}\r\n            >\r\n                {buttonProps.icon}\r\n                {buttonProps.text}\r\n            </button>\r\n        );\r\n    });\r\n\r\n    return <>{buttons}</>;\r\n});\r\nPluggableIntroButtons.displayName = 'PluggableIntroButtons';\r\n\r\nexport default PluggableIntroButtons;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {getMyChannelMembership} from 'mattermost-redux/selectors/entities/channels';\r\n\r\nimport {getChannelIntroPluginButtons} from 'selectors/plugins';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport PluggableIntroButtons from './pluggable_intro_buttons';\r\n\r\ntype OwnProps = {\r\n    channel: Channel;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    return {\r\n        channelMember: getMyChannelMembership(state, ownProps.channel.id),\r\n        pluginButtons: getChannelIntroPluginButtons(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(PluggableIntroButtons);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedDate, FormattedMessage, defineMessages} from 'react-intl';\r\n\r\nimport {BellRingOutlineIcon, GlobeIcon, PencilOutlineIcon, StarOutlineIcon, LockOutlineIcon, StarIcon} from '@mattermost/compass-icons/components';\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\nimport type {UserProfile as UserProfileType} from '@mattermost/types/users';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {NotificationLevel} from 'mattermost-redux/constants/channels';\r\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport AddGroupsToTeamModal from 'components/add_groups_to_team_modal';\r\nimport ChannelNotificationsModal from 'components/channel_notifications_modal';\r\nimport ChannelIntroPrivateSvg from 'components/common/svg_images_components/channel_intro_private_svg';\r\nimport ChannelIntroPublicSvg from 'components/common/svg_images_components/channel_intro_public_svg';\r\nimport ChannelIntroTownSquareSvg from 'components/common/svg_images_components/channel_intro_town_square_svg';\r\nimport EditChannelHeaderModal from 'components/edit_channel_header_modal';\r\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\nimport ProfilePicture from 'components/profile_picture';\r\nimport ToggleModalButton from 'components/toggle_modal_button';\r\nimport UserProfile from 'components/user_profile';\r\n\r\nimport {Constants, ModalIdentifiers} from 'utils/constants';\r\nimport {getMonthLong} from 'utils/i18n';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport AddMembersButton from './add_members_button';\r\nimport PluggableIntroButtons from './pluggable_intro_buttons';\r\n\r\ntype Props = {\r\n    currentUserId: string;\r\n    channel?: Channel;\r\n    fullWidth: boolean;\r\n    locale: string;\r\n    channelProfiles: UserProfileType[];\r\n    enableUserCreation?: boolean;\r\n    isReadOnly?: boolean;\r\n    isFavorite: boolean;\r\n    teamIsGroupConstrained?: boolean;\r\n    creatorName: string;\r\n    teammate?: UserProfileType;\r\n    teammateName?: string;\r\n    currentUser: UserProfileType;\r\n    stats: any;\r\n    usersLimit: number;\r\n    channelMember?: ChannelMembership;\r\n    isMobileView: boolean;\r\n    actions: {\r\n        getTotalUsersStats: () => any;\r\n        favoriteChannel: (channelId: string) => any;\r\n        unfavoriteChannel: (channelId: string) => any;\r\n    };\r\n}\r\n\r\nexport default class ChannelIntroMessage extends React.PureComponent<Props> {\r\n    toggleFavorite = () => {\r\n        if (!this.props.channel) {\r\n            return;\r\n        }\r\n\r\n        if (this.props.isFavorite) {\r\n            this.props.actions.unfavoriteChannel(this.props.channel.id);\r\n        } else {\r\n            this.props.actions.favoriteChannel(this.props.channel.id);\r\n        }\r\n    };\r\n\r\n    componentDidMount() {\r\n        if (!this.props.stats?.total_users_count) {\r\n            this.props.actions.getTotalUsersStats();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            currentUserId,\r\n            channel,\r\n            fullWidth,\r\n            locale,\r\n            channelProfiles,\r\n            enableUserCreation,\r\n            isReadOnly,\r\n            isFavorite,\r\n            teamIsGroupConstrained,\r\n            creatorName,\r\n            teammate,\r\n            teammateName,\r\n            currentUser,\r\n            stats,\r\n            usersLimit,\r\n            channelMember,\r\n            isMobileView,\r\n        } = this.props;\r\n\r\n        let centeredIntro = '';\r\n        if (!fullWidth) {\r\n            centeredIntro = 'channel-intro--centered';\r\n        }\r\n\r\n        if (!channel) {\r\n            return null;\r\n        }\r\n\r\n        if (channel.type === Constants.DM_CHANNEL) {\r\n            return createDMIntroMessage(channel, centeredIntro, currentUser, isFavorite, isMobileView, this.toggleFavorite, teammate, teammateName);\r\n        } else if (channel.type === Constants.GM_CHANNEL) {\r\n            return createGMIntroMessage(channel, centeredIntro, isFavorite, isMobileView, this.toggleFavorite, channelProfiles, currentUserId, currentUser, channelMember);\r\n        } else if (channel.name === Constants.DEFAULT_CHANNEL) {\r\n            return createDefaultIntroMessage(channel, centeredIntro, currentUser, isFavorite, isMobileView, this.toggleFavorite, stats, usersLimit, enableUserCreation, isReadOnly, teamIsGroupConstrained);\r\n        } else if (channel.name === Constants.OFFTOPIC_CHANNEL) {\r\n            return createOffTopicIntroMessage(channel, centeredIntro, isFavorite, isMobileView, currentUser, this.toggleFavorite, stats, usersLimit);\r\n        } else if (channel.type === Constants.OPEN_CHANNEL || channel.type === Constants.PRIVATE_CHANNEL) {\r\n            return createStandardIntroMessage(channel, centeredIntro, currentUser, isFavorite, isMobileView, this.toggleFavorite, stats, usersLimit, locale, creatorName);\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\nconst gmIntroMessages = defineMessages({\r\n    muted: {id: 'intro_messages.GM.muted', defaultMessage: 'This group message is currently <b>muted</b>, so you will not be notified.'},\r\n    [NotificationLevel.ALL]: {id: 'intro_messages.GM.all', defaultMessage: 'You\\'ll be notified <b>for all activity</b> in this group message.'},\r\n    [NotificationLevel.DEFAULT]: {id: 'intro_messages.GM.all', defaultMessage: 'You\\'ll be notified <b>for all activity</b> in this group message.'},\r\n    [NotificationLevel.MENTION]: {id: 'intro_messages.GM.mention', defaultMessage: 'You have selected to be notified <b>only when mentioned</b> in this group message.'},\r\n    [NotificationLevel.NONE]: {id: 'intro_messages.GM.none', defaultMessage: 'You have selected to <b>never</b> be notified in this group message.'},\r\n});\r\n\r\nconst getGMIntroMessageSpecificPart = (userProfile: UserProfileType | undefined, membership: ChannelMembership | undefined) => {\r\n    const isMuted = isChannelMuted(membership);\r\n    if (isMuted) {\r\n        return (\r\n            <FormattedMessage\r\n                {...gmIntroMessages.muted}\r\n                values={{\r\n                    b: (chunks) => <b>{chunks}</b>,\r\n                }}\r\n            />\r\n        );\r\n    }\r\n    const channelNotifyProp = membership?.notify_props?.desktop || NotificationLevel.DEFAULT;\r\n    const userNotifyProp = userProfile?.notify_props?.desktop || NotificationLevel.MENTION;\r\n    let notifyLevelToUse = channelNotifyProp;\r\n    if (notifyLevelToUse === NotificationLevel.DEFAULT) {\r\n        notifyLevelToUse = userNotifyProp;\r\n    }\r\n    if (channelNotifyProp === NotificationLevel.DEFAULT && userNotifyProp === NotificationLevel.MENTION) {\r\n        notifyLevelToUse = NotificationLevel.ALL;\r\n    }\r\n\r\n    return (\r\n        <FormattedMessage\r\n            {...gmIntroMessages[notifyLevelToUse]}\r\n            values={{\r\n                b: (chunks) => <b>{chunks}</b>,\r\n            }}\r\n        />\r\n    );\r\n};\r\n\r\nfunction createGMIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    toggleFavorite: () => void,\r\n    profiles: UserProfileType[],\r\n    currentUserId: string,\r\n    currentUser: UserProfileType,\r\n    channelMembership?: ChannelMembership,\r\n) {\r\n    const channelIntroId = 'channelIntro';\r\n\r\n    if (profiles.length > 0) {\r\n        const currentUserProfile = profiles.find((v) => v.id === currentUserId);\r\n\r\n        const pictures = profiles.\r\n            filter((profile) => profile.id !== currentUserId).\r\n            map((profile) => (\r\n                <ProfilePicture\r\n                    key={'introprofilepicture' + profile.id}\r\n                    src={Utils.imageURLForUser(profile.id, profile.last_picture_update)}\r\n                    size='xl-custom-GM'\r\n                    userId={profile.id}\r\n                    username={profile.username}\r\n                />\r\n            ));\r\n\r\n        const actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {createSetHeaderButton(channel)}\r\n                {!isMobileView && createNotificationPreferencesButton(channel, currentUser)}\r\n                <PluggableIntroButtons channel={channel}/>\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <div\r\n                id={channelIntroId}\r\n                className={'channel-intro ' + centeredIntro}\r\n            >\r\n                <div className='post-profile-img__container channel-intro-img channel-intro-img__group'>\r\n                    {pictures}\r\n                </div>\r\n                <h2 className='channel-intro__title'>\r\n                    {channel.display_name}\r\n                </h2>\r\n                <p className='channel-intro__text'>\r\n                    <FormattedMessage\r\n                        id='intro_messages.group_message'\r\n                        defaultMessage={'This is the start of your group message history with these teammates. '}\r\n                    />\r\n                    {getGMIntroMessageSpecificPart(currentUserProfile, channelMembership)}\r\n                </p>\r\n                {actionButtons}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id={channelIntroId}\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            <p className='channel-intro__text'>\r\n                <FormattedMessage\r\n                    id='intro_messages.group_message'\r\n                    defaultMessage='This is the start of your group message history with these teammates. Messages and files shared here are not shown to people outside this area.'\r\n                />\r\n            </p>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createDMIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    currentUser: UserProfileType,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    toggleFavorite: () => void,\r\n    teammate?: UserProfileType,\r\n    teammateName?: string,\r\n) {\r\n    const channelIntroId = 'channelIntro';\r\n    if (teammate) {\r\n        const src = teammate ? Utils.imageURLForUser(teammate.id, teammate.last_picture_update) : '';\r\n\r\n        let pluggableButton = null;\r\n        let setHeaderButton = null;\r\n        if (!teammate?.is_bot) {\r\n            pluggableButton = <PluggableIntroButtons channel={channel}/>;\r\n            setHeaderButton = createSetHeaderButton(channel);\r\n        }\r\n\r\n        const actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {setHeaderButton}\r\n                {pluggableButton}\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <div\r\n                id={channelIntroId}\r\n                className={'channel-intro ' + centeredIntro}\r\n            >\r\n                <div className='post-profile-img__container channel-intro-img'>\r\n                    <ProfilePicture\r\n                        src={src}\r\n                        size='xl-custom-DM'\r\n                        status={teammate.is_bot ? '' : channel.status}\r\n                        userId={teammate?.id}\r\n                        username={teammate?.username}\r\n                    />\r\n                </div>\r\n                <h2 className='channel-intro__title'>\r\n                    <UserProfile\r\n                        userId={teammate?.id}\r\n                    />\r\n                </h2>\r\n                <p className='channel-intro__text'>\r\n                    <FormattedMessage\r\n                        id='intro_messages.DM'\r\n                        defaultMessage='This is the start of your direct message history with {teammate}. Messages and files shared here are not shown to anyone else.'\r\n                        values={{\r\n                            teammate: teammateName,\r\n                        }}\r\n                    />\r\n                </p>\r\n                {actionButtons}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id={channelIntroId}\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            <p className='channel-intro__text'>\r\n                <FormattedMessage\r\n                    id='intro_messages.teammate'\r\n                    defaultMessage='This is the start of your direct message history with this teammate. Messages and files shared here are not shown to anyone else.'\r\n                />\r\n            </p>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createOffTopicIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    currentUser: UserProfileType,\r\n    toggleFavorite: () => void,\r\n    stats: any,\r\n    usersLimit: number,\r\n) {\r\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\r\n    const children = createSetHeaderButton(channel);\r\n    const totalUsers = stats.total_users_count;\r\n    const inviteUsers = totalUsers < usersLimit;\r\n\r\n    let setHeaderButton = null;\r\n    let actionButtons = null;\r\n\r\n    if (children) {\r\n        setHeaderButton = (\r\n            <ChannelPermissionGate\r\n                teamId={channel.team_id}\r\n                channelId={channel.id}\r\n                permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\r\n            >\r\n                {children}\r\n            </ChannelPermissionGate>\r\n        );\r\n    }\r\n\r\n    const channelInviteButton = (\r\n        <AddMembersButton\r\n            totalUsers={totalUsers}\r\n            usersLimit={usersLimit}\r\n            channel={channel}\r\n            pluginButtons={<PluggableIntroButtons channel={channel}/>}\r\n        />\r\n    );\r\n\r\n    if (inviteUsers) {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {actionButtons = channelInviteButton}\r\n            </div>\r\n        );\r\n    } else {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {setHeaderButton}\r\n                {createNotificationPreferencesButton(channel, currentUser)}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id='channelIntro'\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            <ChannelIntroPublicSvg/>\r\n            <h2 className='channel-intro__title'>\r\n                {channel.display_name}\r\n            </h2>\r\n            <p className='channel-intro__text'>\r\n                <FormattedMessage\r\n                    id='intro_messages.offTopic'\r\n                    defaultMessage='This is the start of {display_name}, a channel for non-work-related conversations.'\r\n                    values={{\r\n                        display_name: channel.display_name,\r\n                    }}\r\n                />\r\n            </p>\r\n            {actionButtons}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createDefaultIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    currentUser: UserProfileType,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    toggleFavorite: () => void,\r\n    stats: any,\r\n    usersLimit: number,\r\n    enableUserCreation?: boolean,\r\n    isReadOnly?: boolean,\r\n    teamIsGroupConstrained?: boolean,\r\n) {\r\n    let teamInviteLink = null;\r\n    const totalUsers = stats.total_users_count;\r\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\r\n    const inviteUsers = totalUsers < usersLimit;\r\n\r\n    let setHeaderButton = null;\r\n    let pluginButtons = null;\r\n    let actionButtons = null;\r\n\r\n    if (!isReadOnly) {\r\n        pluginButtons = <PluggableIntroButtons channel={channel}/>;\r\n        const children = createSetHeaderButton(channel);\r\n        if (children) {\r\n            setHeaderButton = (\r\n                <ChannelPermissionGate\r\n                    teamId={channel.team_id}\r\n                    channelId={channel.id}\r\n                    permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\r\n                >\r\n                    {children}\r\n                </ChannelPermissionGate>\r\n            );\r\n        }\r\n    }\r\n\r\n    if (!isReadOnly && enableUserCreation) {\r\n        teamInviteLink = (\r\n            <TeamPermissionGate\r\n                teamId={channel.team_id}\r\n                permissions={[Permissions.INVITE_USER]}\r\n            >\r\n                <TeamPermissionGate\r\n                    teamId={channel.team_id}\r\n                    permissions={[Permissions.ADD_USER_TO_TEAM]}\r\n                >\r\n                    {!teamIsGroupConstrained &&\r\n                        <AddMembersButton\r\n                            totalUsers={totalUsers}\r\n                            usersLimit={usersLimit}\r\n                            channel={channel}\r\n                            pluginButtons={pluginButtons}\r\n                        />\r\n                    }\r\n                    {teamIsGroupConstrained &&\r\n                    <ToggleModalButton\r\n                        className='intro-links color--link'\r\n                        modalId={ModalIdentifiers.ADD_GROUPS_TO_TEAM}\r\n                        dialogType={AddGroupsToTeamModal}\r\n                        dialogProps={{channel}}\r\n                    >\r\n                        <i\r\n                            className='fa fa-user-plus'\r\n                        />\r\n                        <FormattedMessage\r\n                            id='intro_messages.addGroupsToTeam'\r\n                            defaultMessage='Add other groups to this team'\r\n                        />\r\n                    </ToggleModalButton>\r\n                    }\r\n                </TeamPermissionGate>\r\n            </TeamPermissionGate>\r\n        );\r\n    }\r\n\r\n    if (inviteUsers) {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {actionButtons = teamInviteLink}\r\n            </div>\r\n        );\r\n    } else {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {setHeaderButton}\r\n                {createNotificationPreferencesButton(channel, currentUser)}\r\n                {teamIsGroupConstrained && pluginButtons}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id='channelIntro'\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            <ChannelIntroTownSquareSvg/>\r\n            <h2 className='channel-intro__title'>\r\n                {channel.display_name}\r\n            </h2>\r\n            <p className='channel-intro__text'>\r\n                {!isReadOnly &&\r\n                    <FormattedMessage\r\n                        id='intro_messages.default'\r\n                        defaultMessage='Welcome to {display_name}. Post messages here that you want everyone to see. Everyone automatically becomes a member of this channel when they join the team.'\r\n                        values={{\r\n                            display_name: channel.display_name,\r\n                        }}\r\n                    />\r\n                }\r\n                {isReadOnly &&\r\n                    <FormattedMessage\r\n                        id='intro_messages.readonly.default'\r\n                        defaultMessage='Welcome to {display_name}. Messages can only be posted by admins. Everyone automatically becomes a permanent member of this channel when they join the team.'\r\n                        values={{\r\n                            display_name: channel.display_name,\r\n                        }}\r\n                    />\r\n                }\r\n            </p>\r\n            {actionButtons}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createStandardIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    currentUser: UserProfileType,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    toggleFavorite: () => void,\r\n    stats: any,\r\n    usersLimit: number,\r\n    locale: string,\r\n    creatorName: string,\r\n) {\r\n    const uiName = channel.display_name;\r\n    let memberMessage;\r\n    let teamInviteLink = null;\r\n    const channelIsArchived = channel.delete_at !== 0;\r\n    const totalUsers = stats.total_users_count;\r\n    const inviteUsers = totalUsers < usersLimit;\r\n\r\n    if (channelIsArchived) {\r\n        memberMessage = '';\r\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n        memberMessage = (\r\n            <FormattedMessage\r\n                id='intro_messages.onlyInvited'\r\n                defaultMessage='This is the start of {display_name}. Only invited members can see this private channel.'\r\n                values={{\r\n                    display_name: channel.display_name,\r\n                }}\r\n            />\r\n        );\r\n    } else {\r\n        memberMessage = (\r\n            <FormattedMessage\r\n                id='intro_messages.anyMember'\r\n                defaultMessage='This is the start of {display_name}. Any team member can join and read this channel.'\r\n                values={{\r\n                    display_name: channel.display_name,\r\n                }}\r\n            />\r\n        );\r\n    }\r\n\r\n    const date = (\r\n        <FormattedDate\r\n            value={channel.create_at}\r\n            month={getMonthLong(locale)}\r\n            day='2-digit'\r\n            year='numeric'\r\n        />\r\n    );\r\n\r\n    let createMessage;\r\n    if (creatorName === '') {\r\n        if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n            createMessage = (\r\n                <FormattedMessage\r\n                    id='intro_messages.noCreatorPrivate'\r\n                    defaultMessage='Private channel created on {date}.'\r\n                    values={{name: (uiName), date}}\r\n                />\r\n            );\r\n        } else if (channel.type === Constants.OPEN_CHANNEL) {\r\n            createMessage = (\r\n                <FormattedMessage\r\n                    id='intro_messages.noCreator'\r\n                    defaultMessage='Public channel created on {date}.'\r\n                    values={{name: (uiName), date}}\r\n                />\r\n            );\r\n        }\r\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n        createMessage = (\r\n            <span>\r\n                <FormattedMessage\r\n                    id='intro_messages.creatorPrivate'\r\n                    defaultMessage='Private channel created by {creator} on {date}.'\r\n                    values={{\r\n                        name: (uiName),\r\n                        creator: (creatorName),\r\n                        date,\r\n                    }}\r\n                />\r\n            </span>\r\n        );\r\n    } else if (channel.type === Constants.OPEN_CHANNEL) {\r\n        createMessage = (\r\n            <span>\r\n                <FormattedMessage\r\n                    id='intro_messages.creator'\r\n                    defaultMessage='Public channel created by {creator} on {date}.'\r\n                    values={{\r\n                        name: (uiName),\r\n                        creator: (creatorName),\r\n                        date,\r\n                    }}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    let purposeMessage;\r\n    if (channel.purpose && channel.purpose !== '') {\r\n        purposeMessage = (\r\n            <span>\r\n                <FormattedMessage\r\n                    id='intro_messages.purpose'\r\n                    defaultMessage=\" This channel's purpose is: {purpose}\"\r\n                    values={{purpose: channel.purpose}}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\r\n    let setHeaderButton = null;\r\n    let actionButtons = null;\r\n    const children = createSetHeaderButton(channel);\r\n    if (children) {\r\n        setHeaderButton = (\r\n            <ChannelPermissionGate\r\n                teamId={channel.team_id}\r\n                channelId={channel.id}\r\n                permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\r\n            >\r\n                {children}\r\n            </ChannelPermissionGate>\r\n        );\r\n    }\r\n\r\n    teamInviteLink = (\r\n        <AddMembersButton\r\n            totalUsers={totalUsers}\r\n            usersLimit={usersLimit}\r\n            channel={channel}\r\n            pluginButtons={<PluggableIntroButtons channel={channel}/>}\r\n        />\r\n    );\r\n\r\n    if (inviteUsers) {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {actionButtons = teamInviteLink}\r\n            </div>\r\n        );\r\n    } else {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {teamInviteLink}\r\n                {setHeaderButton}\r\n                {!isMobileView && createNotificationPreferencesButton(channel, currentUser)}\r\n                <PluggableIntroButtons channel={channel}/>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id='channelIntro'\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            {isPrivate ? <ChannelIntroPrivateSvg/> : <ChannelIntroPublicSvg/>}\r\n            <h2 className='channel-intro__title'>\r\n                {channel.display_name}\r\n            </h2>\r\n            <div className='channel-intro__created'>\r\n                {isPrivate ? <LockOutlineIcon size={14}/> : <GlobeIcon size={14}/>}\r\n                {createMessage}\r\n            </div>\r\n            <p className='channel-intro__text'>\r\n                {memberMessage}\r\n                {purposeMessage}\r\n            </p>\r\n            {actionButtons}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createSetHeaderButton(channel: Channel) {\r\n    const channelIsArchived = channel.delete_at !== 0;\r\n    if (channelIsArchived) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <ToggleModalButton\r\n            modalId={ModalIdentifiers.EDIT_CHANNEL_HEADER}\r\n            ariaLabel={Utils.localizeMessage({id: 'intro_messages.setHeader', defaultMessage: 'Set header'})}\r\n            className={'action-button'}\r\n            dialogType={EditChannelHeaderModal}\r\n            dialogProps={{channel}}\r\n        >\r\n            <PencilOutlineIcon\r\n                size={24}\r\n            />\r\n            <FormattedMessage\r\n                id='intro_messages.setHeader'\r\n                defaultMessage='Set header'\r\n            />\r\n        </ToggleModalButton>\r\n    );\r\n}\r\n\r\nfunction createFavoriteButton(isFavorite: boolean, toggleFavorite: () => void, classes?: string) {\r\n    let favoriteText;\r\n    if (isFavorite) {\r\n        favoriteText = (\r\n            <FormattedMessage\r\n                id='channel_info_rhs.top_buttons.favorited'\r\n                defaultMessage='Favorited'\r\n            />);\r\n    } else {\r\n        favoriteText = (\r\n            <FormattedMessage\r\n                id='channel_info_rhs.top_buttons.favorite'\r\n                defaultMessage='Favorite'\r\n            />);\r\n    }\r\n    return (\r\n        <button\r\n            id='toggleFavoriteIntroButton'\r\n            className={`action-button ${isFavorite ? 'active' : ''}  ${classes}`}\r\n            onClick={toggleFavorite}\r\n            aria-label={'Favorite'}\r\n        >\r\n            {isFavorite ? <StarIcon size={24}/> : <StarOutlineIcon size={24}/>}\r\n            {favoriteText}\r\n        </button>\r\n    );\r\n}\r\n\r\nfunction createNotificationPreferencesButton(channel: Channel, currentUser: UserProfileType) {\r\n    return (\r\n        <ToggleModalButton\r\n            id='channelIntroNotificationPreferencesButton'\r\n            modalId={ModalIdentifiers.CHANNEL_NOTIFICATIONS}\r\n            ariaLabel={Utils.localizeMessage({id: 'intro_messages.notificationPreferences', defaultMessage: 'Notification Preferences'})}\r\n            className={'action-button'}\r\n            dialogType={ChannelNotificationsModal}\r\n            dialogProps={{channel, currentUser, focusOriginElement: 'channelIntroNotificationPreferencesButton'}}\r\n        >\r\n            <BellRingOutlineIcon size={24}/>\r\n            <FormattedMessage\r\n                id='intro_messages.notificationPreferences'\r\n                defaultMessage='Notifications'\r\n            />\r\n        </ToggleModalButton>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {favoriteChannel, unfavoriteChannel} from 'mattermost-redux/actions/channels';\r\nimport {getTotalUsersStats} from 'mattermost-redux/actions/users';\r\nimport {getCurrentChannel, getDirectTeammate, getMyCurrentChannelMembership, isCurrentChannelFavorite} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser, getProfilesInCurrentChannel, getCurrentUserId, getUser, getTotalUsersStats as getTotalUsersStatsSelector} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {getCurrentLocale} from 'selectors/i18n';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {Preferences} from 'utils/constants';\r\nimport {getDisplayNameByUser} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelIntroMessage from './channel_intro_message';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enableUserCreation = config.EnableUserCreation === 'true';\r\n    const isReadOnly = false;\r\n    const team = getCurrentTeam(state);\r\n    const channel = getCurrentChannel(state);\r\n    const channelMember = getMyCurrentChannelMembership(state);\r\n    const teammate = channel ? getDirectTeammate(state, channel.id) : undefined;\r\n    const currentUser = getCurrentUser(state);\r\n    const creator = channel ? getUser(state, channel.creator_id) : undefined;\r\n\r\n    const usersLimit = 10;\r\n\r\n    const stats = getTotalUsersStatsSelector(state) || {total_users_count: 0};\r\n\r\n    return {\r\n        currentUserId: getCurrentUserId(state),\r\n        channel,\r\n        fullWidth: get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.CHANNEL_DISPLAY_MODE, Preferences.CHANNEL_DISPLAY_MODE_DEFAULT) === Preferences.CHANNEL_DISPLAY_MODE_FULL_SCREEN,\r\n        locale: getCurrentLocale(state),\r\n        channelProfiles: getProfilesInCurrentChannel(state),\r\n        enableUserCreation,\r\n        isReadOnly,\r\n        isFavorite: isCurrentChannelFavorite(state),\r\n        teamIsGroupConstrained: Boolean(team?.group_constrained),\r\n        creatorName: getDisplayNameByUser(state, creator),\r\n        teammate,\r\n        teammateName: getDisplayNameByUser(state, teammate),\r\n        currentUser,\r\n        stats,\r\n        usersLimit,\r\n        channelMember,\r\n        isMobileView: getIsMobileView(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getTotalUsersStats,\r\n            favoriteChannel,\r\n            unfavoriteChannel,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelIntroMessage);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Post} from '@mattermost/types/posts';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport * as PostListUtils from 'mattermost-redux/utils/post_list';\r\n\r\nimport type {emitShortcutReactToLastPostFrom} from 'actions/post_actions';\r\n\r\nimport CenterMessageLock from 'components/center_message_lock';\r\nimport PostComponent from 'components/post';\r\nimport ChannelIntroMessage from 'components/post_view/channel_intro_message/';\r\nimport CombinedUserActivityPost from 'components/post_view/combined_user_activity_post';\r\nimport DateSeparator from 'components/post_view/date_separator';\r\nimport NewMessageSeparator from 'components/post_view/new_message_separator/new_message_separator';\r\n\r\nimport {PostListRowListIds, Locations} from 'utils/constants';\r\nimport {isIdNotPost} from 'utils/post_utils';\r\n\r\nimport type {NewMessagesSeparatorActionComponent} from 'types/store/plugins';\r\n\r\nexport type PostListRowProps = {\r\n    listId: string;\r\n    previousListId?: string;\r\n    fullWidth?: boolean;\r\n    shouldHighlight?: boolean;\r\n    loadOlderPosts: () => void;\r\n    loadNewerPosts: () => void;\r\n    togglePostMenu: (opened: boolean) => void;\r\n    post: Post;\r\n    currentUserId: UserProfile['id'];\r\n\r\n    /**\r\n     * To Check if the current post is last in the list\r\n     */\r\n    isLastPost: boolean;\r\n\r\n    /**\r\n     * To check if the state of emoji for last message and from where it was emitted\r\n     */\r\n    shortcutReactToLastPostEmittedFrom: string;\r\n\r\n    /**\r\n     * is used for hiding animation of loader\r\n     */\r\n    loadingNewerPosts: boolean;\r\n    loadingOlderPosts: boolean;\r\n    exceededLimitChannelId?: string;\r\n    firstInaccessiblePostTime?: number;\r\n    channelId: string;\r\n\r\n    newMessagesSeparatorActions: NewMessagesSeparatorActionComponent[];\r\n\r\n    actions: {\r\n\r\n        /**\r\n          * Function to set or unset emoji picker for last message\r\n          */\r\n        emitShortcutReactToLastPostFrom: typeof emitShortcutReactToLastPostFrom;\r\n    };\r\n}\r\n\r\nexport default class PostListRow extends React.PureComponent<PostListRowProps> {\r\n    blockShortcutReactToLastPostForNonMessages(listId: string) {\r\n        const {actions: {emitShortcutReactToLastPostFrom}} = this.props;\r\n\r\n        if (isIdNotPost(listId)) {\r\n            // This is a good escape hatch as any of the above conditions don't return <Post/> component, Emoji picker is only at Post component\r\n            emitShortcutReactToLastPostFrom(Locations.NO_WHERE);\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: PostListRowProps) {\r\n        const {listId, isLastPost, shortcutReactToLastPostEmittedFrom} = this.props;\r\n\r\n        const shortcutReactToLastPostEmittedFromCenter = prevProps.shortcutReactToLastPostEmittedFrom !== shortcutReactToLastPostEmittedFrom &&\r\n            shortcutReactToLastPostEmittedFrom === Locations.CENTER;\r\n\r\n        // If last post is not a message then we block the shortcut to react to last message, early on\r\n        if (isLastPost && shortcutReactToLastPostEmittedFromCenter) {\r\n            this.blockShortcutReactToLastPostForNonMessages(listId);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const {listId, previousListId, loadingOlderPosts, loadingNewerPosts} = this.props;\r\n        const {\r\n            OLDER_MESSAGES_LOADER,\r\n            NEWER_MESSAGES_LOADER,\r\n            CHANNEL_INTRO_MESSAGE,\r\n            LOAD_OLDER_MESSAGES_TRIGGER,\r\n            LOAD_NEWER_MESSAGES_TRIGGER,\r\n        } = PostListRowListIds;\r\n\r\n        if (PostListUtils.isDateLine(listId)) {\r\n            const date = PostListUtils.getDateForDateLine(listId);\r\n\r\n            return (\r\n                <DateSeparator\r\n                    key={date}\r\n                    date={date}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (PostListUtils.isStartOfNewMessages(listId)) {\r\n            return (\r\n                <NewMessageSeparator\r\n                    separatorId={listId}\r\n                    newMessagesSeparatorActions={this.props.newMessagesSeparatorActions}\r\n                    channelId={this.props.channelId}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (this.props.exceededLimitChannelId) {\r\n            return (\r\n                <CenterMessageLock/>\r\n            );\r\n        }\r\n\r\n        if (listId === CHANNEL_INTRO_MESSAGE) {\r\n            return (\r\n                <ChannelIntroMessage/>\r\n            );\r\n        }\r\n\r\n        if (listId === LOAD_OLDER_MESSAGES_TRIGGER || listId === LOAD_NEWER_MESSAGES_TRIGGER) {\r\n            return (\r\n                <button\r\n                    className='more-messages-text theme style--none color--link'\r\n                    onClick={listId === LOAD_OLDER_MESSAGES_TRIGGER ? this.props.loadOlderPosts : this.props.loadNewerPosts}\r\n                >\r\n                    <FormattedMessage\r\n                        id='posts_view.loadMore'\r\n                        defaultMessage='Load More Messages'\r\n                    />\r\n                </button>\r\n            );\r\n        }\r\n\r\n        const isOlderMessagesLoader = listId === OLDER_MESSAGES_LOADER;\r\n        const isNewerMessagesLoader = listId === NEWER_MESSAGES_LOADER;\r\n        if (isOlderMessagesLoader || isNewerMessagesLoader) {\r\n            const shouldHideAnimation = !loadingOlderPosts && !loadingNewerPosts;\r\n\r\n            return (\r\n                <div\r\n                    className='loading-screen'\r\n                >\r\n                    <div className={classNames('loading__content', {hideAnimation: shouldHideAnimation})}>\r\n                        <div className='round round-1'/>\r\n                        <div className='round round-2'/>\r\n                        <div className='round round-3'/>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const postProps = {\r\n            previousPostId: previousListId,\r\n            shouldHighlight: Boolean(this.props.shouldHighlight),\r\n            togglePostMenu: this.props.togglePostMenu,\r\n            isLastPost: this.props.isLastPost,\r\n        };\r\n\r\n        if (PostListUtils.isCombinedUserActivityPost(listId)) {\r\n            return (\r\n                <CombinedUserActivityPost\r\n                    location={Locations.CENTER}\r\n                    combinedId={listId}\r\n                    {...postProps}\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <PostComponent\r\n                post={this.props.post}\r\n                location={Locations.CENTER}\r\n                {...postProps}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getCurrentChannelId, getCurrentUserId} from 'mattermost-redux/selectors/entities/common';\r\nimport {getLimitedViews, getPost} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {emitShortcutReactToLastPostFrom} from 'actions/post_actions';\r\nimport {getShortcutReactToLastPostEmittedFrom} from 'selectors/emojis';\r\n\r\nimport {PostListRowListIds} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport PostListRow from './post_list_row';\r\nimport type {PostListRowProps} from './post_list_row';\r\n\r\ntype OwnProps = Pick<PostListRowProps, 'listId'>\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const shortcutReactToLastPostEmittedFrom = getShortcutReactToLastPostEmittedFrom(state);\r\n    const post = getPost(state, ownProps.listId);\r\n    const currentUserId = getCurrentUserId(state);\r\n    const newMessagesSeparatorActions = state.plugins.components.NewMessagesSeparatorAction;\r\n\r\n    const props: Pick<\r\n    PostListRowProps,\r\n    'shortcutReactToLastPostEmittedFrom'| 'exceededLimitChannelId' | 'firstInaccessiblePostTime' | 'post' | 'currentUserId' | 'newMessagesSeparatorActions'\r\n    > = {\r\n        shortcutReactToLastPostEmittedFrom,\r\n        post,\r\n        currentUserId,\r\n        newMessagesSeparatorActions,\r\n    };\r\n    if ((ownProps.listId === PostListRowListIds.OLDER_MESSAGES_LOADER || ownProps.listId === PostListRowListIds.CHANNEL_INTRO_MESSAGE)) {\r\n        const currentChannelId = getCurrentChannelId(state);\r\n        const firstInaccessiblePostTime = getLimitedViews(state).channels[currentChannelId];\r\n        const channelLimitExceeded = Boolean(firstInaccessiblePostTime) || firstInaccessiblePostTime === 0;\r\n        if (channelLimitExceeded) {\r\n            props.exceededLimitChannelId = currentChannelId;\r\n            props.firstInaccessiblePostTime = firstInaccessiblePostTime;\r\n        }\r\n    }\r\n    return props;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            emitShortcutReactToLastPostFrom,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PostListRow);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function ScrollToBottomIcon(props: React.HTMLAttributes<HTMLSpanElement>) {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <span {...props}>\r\n            <svg\r\n                x='0px'\r\n                y='0px'\r\n                viewBox='-239 239 21 23'\r\n                enableBackground='new -239 239 21 23'\r\n                role='img'\r\n                aria-label={formatMessage({id: 'generic_icons.arrow.down', defaultMessage: 'Down Arrow Icon'})}\r\n            >\r\n                <path d='M-239,241.4l2.4-2.4l8.1,8.2l8.1-8.2l2.4,2.4l-10.5,10.6L-239,241.4z M-228.5,257.2l8.1-8.2l2.4,2.4l-10.5,10.6l-10.5-10.6 l2.4-2.4L-228.5,257.2z'/>\r\n            </svg>\r\n        </span>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\n\r\nimport ScrollToBottomIcon from 'components/widgets/icons/scroll_to_bottom_icon';\r\n\r\ntype Props = {\r\n    isScrolling: boolean;\r\n    atBottom?: boolean;\r\n    onClick: () => void;\r\n};\r\n\r\nconst ScrollToBottomArrows = ({isScrolling, atBottom, onClick}: Props) => {\r\n    // only show on mobile\r\n    if (window.innerWidth > 768) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={classNames('post-list__arrows', {\r\n                scrolling: isScrolling && atBottom === false,\r\n            })}\r\n            onClick={onClick}\r\n        >\r\n            <ScrollToBottomIcon/>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ScrollToBottomArrows;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport CloseIcon from 'components/widgets/icons/close_icon';\r\n\r\nimport './hint_toast.scss';\r\n\r\nexport const HINT_TOAST_TESTID = 'hint-toast';\r\n\r\ntype Props = {\r\n    children: React.ReactNode;\r\n    onDismiss: () => void;\r\n}\r\n\r\nexport const HintToast: React.FC<Props> = ({children, onDismiss}: Props) => {\r\n    const handleDismiss = () => {\r\n        if (typeof onDismiss === 'function') {\r\n            onDismiss();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div\r\n            data-testid={HINT_TOAST_TESTID}\r\n            className='hint-toast'\r\n        >\r\n            <div\r\n                className='hint-toast__message'\r\n            >\r\n                {children}\r\n            </div>\r\n            <div\r\n                className='hint-toast__dismiss'\r\n                onClick={handleDismiss}\r\n                data-testid='dismissHintToast'\r\n            >\r\n                <CloseIcon\r\n                    className='close-btn'\r\n                    id='dismissHintToast'\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport CloseIcon from 'components/widgets/icons/close_icon';\r\nimport UnreadBelowIcon from 'components/widgets/icons/unread_below_icon';\r\n\r\nimport './scroll_to_bottom_toast.scss';\r\n\r\nexport const SCROLL_TO_BOTTOM_TOAST_TESTID = 'scroll-to-bottom-toast';\r\nexport const SCROLL_TO_BOTTOM_DISMISS_BUTTON_TESTID = 'scroll-to-bottom-toast--dismiss-button';\r\n\r\ntype ScrollToBottomToastProps = {\r\n    onDismiss: () => void;\r\n    onClick: () => void;\r\n}\r\n\r\nexport const ScrollToBottomToast = ({onDismiss, onClick}: ScrollToBottomToastProps) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const jumpToRecentsMessage = formatMessage({\r\n        id: 'postlist.toast.scrollToBottom',\r\n        defaultMessage: 'Jump to recents',\r\n    });\r\n\r\n    const handleScrollToBottom: React.MouseEventHandler<HTMLDivElement> = (e) => {\r\n        e.preventDefault();\r\n        onClick();\r\n    };\r\n\r\n    const handleDismiss: React.MouseEventHandler<HTMLDivElement> = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        onDismiss();\r\n    };\r\n\r\n    return (\r\n        <div\r\n            data-testid={SCROLL_TO_BOTTOM_TOAST_TESTID}\r\n            className='scroll-to-bottom-toast btn btn-primary'\r\n            onClick={handleScrollToBottom}\r\n        >\r\n            <UnreadBelowIcon/>\r\n            {jumpToRecentsMessage}\r\n            <div\r\n                className='scroll-to-bottom-toast__dismiss'\r\n                onClick={handleDismiss}\r\n                data-testid={SCROLL_TO_BOTTOM_DISMISS_BUTTON_TESTID}\r\n            >\r\n                <CloseIcon\r\n                    className='close-btn'\r\n                    id='dismissScrollToBottomToast'\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ScrollToBottomToast;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport ScrollToBottomToast from './scroll_to_bottom_toast';\r\n\r\nexport default ScrollToBottomToast;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {IntlShape, WrappedComponentProps} from 'react-intl';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\n\r\nimport {Preferences} from 'mattermost-redux/constants';\r\nimport {getNewMessagesIndex} from 'mattermost-redux/utils/post_list';\r\n\r\nimport {HintToast} from 'components/hint-toast/hint_toast';\r\nimport ScrollToBottomToast from 'components/scroll_to_bottom_toast';\r\nimport {SearchShortcut} from 'components/search_shortcut';\r\nimport Timestamp, {RelativeRanges} from 'components/timestamp';\r\nimport Toast from 'components/toast/toast';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants from 'utils/constants';\r\nimport {isToday} from 'utils/datetime';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\nimport {isIdNotPost} from 'utils/post_utils';\r\n\r\nimport './toast__wrapper.scss';\r\n\r\nconst TOAST_TEXT_COLLAPSE_WIDTH = 500;\r\n\r\nconst TOAST_REL_RANGES = [\r\n    RelativeRanges.TODAY_YESTERDAY,\r\n];\r\n\r\nexport type Props = WrappedComponentProps & RouteComponentProps<{team: string}> & {\r\n    channelMarkedAsUnread?: boolean;\r\n    postListIds: string[];\r\n    latestPostTimeStamp?: number;\r\n    atBottom: boolean | null;\r\n    lastViewedBottom: number;\r\n    width: number;\r\n    focusedPostId?: string;\r\n    initScrollOffsetFromBottom: number;\r\n    updateNewMessagesAtInChannel: (lastViewedAt?: number) => void;\r\n    scrollToNewMessage: () => void;\r\n    scrollToLatestMessages: () => void;\r\n    scrollToUnreadMessages: () => void;\r\n    updateLastViewedBottomAt: (lastViewedBottom?: number) => void;\r\n    showSearchHintToast: boolean;\r\n    onSearchHintDismiss: () => void;\r\n    showScrollToBottomToast: boolean;\r\n    onScrollToBottomToastDismiss: () => void;\r\n    hideScrollToBottomToast: () => void;\r\n    shouldStartFromBottomWhenUnread: boolean;\r\n    isNewMessageLineReached: boolean;\r\n    rootPosts: Record<string, boolean>;\r\n    lastViewedAt: number;\r\n    newRecentMessagesCount: number;\r\n    unreadScrollPosition: string;\r\n    isCollapsedThreadsEnabled: boolean;\r\n    unreadCountInChannel: number;\r\n    atLatestPost?: boolean;\r\n    channelId: string;\r\n    intl: IntlShape;\r\n    actions: {\r\n        updateToastStatus: (status: boolean) => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    unreadCount: number;\r\n    unreadCountInChannel: number;\r\n    channelMarkedAsUnread?: boolean;\r\n    lastViewedAt?: number;\r\n    showUnreadToast?: boolean;\r\n    showNewMessagesToast?: boolean;\r\n    showMessageHistoryToast?: boolean;\r\n    showUnreadWithBottomStartToast?: boolean;\r\n    showScrollToBottomToast?: boolean;\r\n};\r\n\r\nexport class ToastWrapperClass extends React.PureComponent<Props, State> {\r\n    mounted?: boolean;\r\n    static defaultProps = {\r\n        focusedPostId: '',\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            unreadCountInChannel: props.unreadCountInChannel,\r\n            unreadCount: 0,\r\n        };\r\n    }\r\n\r\n    static countNewMessages = (rootPosts: Record<string, boolean>, isCollapsedThreadsEnabled: boolean, postListIds: string[] = []) => {\r\n        const mark = getNewMessagesIndex(postListIds);\r\n        if (mark <= 0) {\r\n            return 0;\r\n        }\r\n        let newMessages = postListIds.slice(0, mark).filter((id) => !isIdNotPost(id));\r\n        if (isCollapsedThreadsEnabled) { // in collapsed mode we only count root posts\r\n            newMessages = newMessages.filter((id) => rootPosts[id]);\r\n        }\r\n        return newMessages.length;\r\n    };\r\n\r\n    static getDerivedStateFromProps(props: Props, prevState: State) {\r\n        let {showUnreadToast, showNewMessagesToast, showMessageHistoryToast, showUnreadWithBottomStartToast} = prevState;\r\n        let unreadCount;\r\n\r\n        if (props.atLatestPost) {\r\n            if (props.unreadScrollPosition === Preferences.UNREAD_SCROLL_POSITION_START_FROM_NEWEST && prevState.unreadCountInChannel) {\r\n                unreadCount = prevState.unreadCountInChannel + props.newRecentMessagesCount;\r\n            } else {\r\n                unreadCount = ToastWrapperClass.countNewMessages(props.rootPosts, props.isCollapsedThreadsEnabled, props.postListIds);\r\n            }\r\n        } else if (props.channelMarkedAsUnread) {\r\n            if (props.unreadScrollPosition === Preferences.UNREAD_SCROLL_POSITION_START_FROM_NEWEST) {\r\n                unreadCount = props.unreadCountInChannel + props.newRecentMessagesCount;\r\n            } else {\r\n                unreadCount = prevState.unreadCountInChannel;\r\n            }\r\n        } else {\r\n            unreadCount = prevState.unreadCountInChannel + props.newRecentMessagesCount;\r\n        }\r\n\r\n        // show unread toast on mount when channel is not at bottom and unread count greater than 0\r\n        if (typeof showUnreadToast === 'undefined' && props.atBottom !== null) {\r\n            showUnreadToast = unreadCount > 0 && !props.atBottom;\r\n        }\r\n\r\n        if (typeof showMessageHistoryToast === 'undefined' && props.focusedPostId !== '' && props.atBottom !== null) {\r\n            showMessageHistoryToast = props.initScrollOffsetFromBottom > 1000 || !props.atLatestPost;\r\n        }\r\n\r\n        // show unread toast when a channel is marked as unread\r\n        if (props.channelMarkedAsUnread && (props.atBottom === false) && !prevState.channelMarkedAsUnread && !prevState.showUnreadToast) {\r\n            showUnreadToast = true;\r\n        }\r\n\r\n        // show unread toast when a channel is remarked as unread using the change in lastViewedAt\r\n        // lastViewedAt changes only if a channel is remarked as unread in channelMarkedAsUnread state\r\n        if (props.channelMarkedAsUnread && props.lastViewedAt !== prevState.lastViewedAt && (props.atBottom === false)) {\r\n            showUnreadToast = true;\r\n        }\r\n\r\n        if (!showUnreadToast && unreadCount > 0 && (props.atBottom === false) && props.latestPostTimeStamp && (props.lastViewedBottom < props.latestPostTimeStamp)) {\r\n            showNewMessagesToast = true;\r\n        }\r\n\r\n        if (props.unreadScrollPosition === Preferences.UNREAD_SCROLL_POSITION_START_FROM_NEWEST && !props.channelMarkedAsUnread) {\r\n            showUnreadToast = false;\r\n        }\r\n\r\n        if (!unreadCount) {\r\n            showUnreadToast = false;\r\n            showNewMessagesToast = false;\r\n        }\r\n\r\n        if (props.isNewMessageLineReached) {\r\n            showUnreadWithBottomStartToast = false;\r\n        }\r\n\r\n        if (\r\n            typeof showUnreadWithBottomStartToast === 'undefined' &&\r\n            props.lastViewedAt &&\r\n            props.lastViewedAt !== prevState.lastViewedAt &&\r\n            props.shouldStartFromBottomWhenUnread &&\r\n            unreadCount > 0 &&\r\n            !props.isNewMessageLineReached\r\n        ) {\r\n            showUnreadWithBottomStartToast = true;\r\n        }\r\n\r\n        return {\r\n            unreadCount,\r\n            showUnreadToast,\r\n            showNewMessagesToast,\r\n            showUnreadWithBottomStartToast,\r\n            lastViewedAt: props.lastViewedAt,\r\n            atBottom: props.atBottom,\r\n            channelMarkedAsUnread: props.channelMarkedAsUnread,\r\n            showMessageHistoryToast,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.mounted = true;\r\n        const {showUnreadToast, showNewMessagesToast, showMessageHistoryToast, showUnreadWithBottomStartToast} = this.state;\r\n        const toastPresent = Boolean(showUnreadToast || showNewMessagesToast || showMessageHistoryToast || showUnreadWithBottomStartToast);\r\n        document.addEventListener('keydown', this.handleShortcut);\r\n        this.props.actions.updateToastStatus(toastPresent);\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props, prevState: State) {\r\n        const {showUnreadToast, showNewMessagesToast, showMessageHistoryToast, showUnreadWithBottomStartToast} = this.state;\r\n        const {\r\n            atBottom,\r\n            atLatestPost,\r\n            postListIds,\r\n            lastViewedBottom,\r\n            updateNewMessagesAtInChannel,\r\n            actions,\r\n        } = this.props;\r\n\r\n        if (!prevProps.atBottom && atBottom && atLatestPost) {\r\n            this.hideNewMessagesToast(false);\r\n            this.hideUnreadToast();\r\n            this.hideArchiveToast();\r\n        }\r\n\r\n        const prevPostsCount = prevProps.postListIds.length;\r\n        const presentPostsCount = postListIds.length;\r\n        const postsAddedAtBottom = presentPostsCount !== prevPostsCount && postListIds[0] !== prevProps.postListIds[0];\r\n        const notBottomWithLatestPosts = atBottom === false && atLatestPost && presentPostsCount > 0;\r\n\r\n        //Marking existing messages as read based on last time user reached to the bottom\r\n        //This moves the new message indicator to the latest posts and keeping in sync with the toast count\r\n        if (postsAddedAtBottom && notBottomWithLatestPosts && !showUnreadToast) {\r\n            updateNewMessagesAtInChannel(lastViewedBottom);\r\n        }\r\n\r\n        const toastStateChanged = prevState.showUnreadToast !== showUnreadToast ||\r\n                                  prevState.showNewMessagesToast !== showNewMessagesToast ||\r\n                                  prevState.showMessageHistoryToast !== showMessageHistoryToast ||\r\n                                  prevState.showUnreadWithBottomStartToast !== showUnreadWithBottomStartToast;\r\n\r\n        if (toastStateChanged) {\r\n            const toastPresent = Boolean(showUnreadToast || showNewMessagesToast || showMessageHistoryToast || showUnreadWithBottomStartToast);\r\n            actions.updateToastStatus(toastPresent);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.handleShortcut);\r\n    }\r\n\r\n    handleShortcut = (e: KeyboardEvent) => {\r\n        if (isKeyPressed(e, Constants.KeyCodes.ESCAPE)) {\r\n            if (this.state.showUnreadToast) {\r\n                this.hideUnreadToast();\r\n            } else if (this.state.showNewMessagesToast) {\r\n                this.hideNewMessagesToast();\r\n            } else if (this.state.showUnreadWithBottomStartToast) {\r\n                this.hideUnreadWithBottomStartToast();\r\n            } else {\r\n                this.hideArchiveToast();\r\n            }\r\n        }\r\n    };\r\n\r\n    hideUnreadToast = () => {\r\n        if (this.state.showUnreadToast) {\r\n            this.setState({\r\n                showUnreadToast: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    hideArchiveToast = () => {\r\n        if (this.state.showMessageHistoryToast) {\r\n            this.setState({\r\n                showMessageHistoryToast: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    hideNewMessagesToast = (updateLastViewedBottomAt = true) => {\r\n        if (this.state.showNewMessagesToast) {\r\n            this.setState({\r\n                showNewMessagesToast: false,\r\n            });\r\n            if (updateLastViewedBottomAt) {\r\n                this.props.updateLastViewedBottomAt();\r\n            }\r\n        }\r\n    };\r\n\r\n    hideSearchHintToast = () => {\r\n        if (this.props.onSearchHintDismiss) {\r\n            this.props.onSearchHintDismiss();\r\n        }\r\n    };\r\n\r\n    hideUnreadWithBottomStartToast = () => {\r\n        if (this.state.showUnreadWithBottomStartToast) {\r\n            this.setState({\r\n                showUnreadWithBottomStartToast: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    newMessagesToastText = (count: number | undefined, since: number) => {\r\n        if (this.props.width > TOAST_TEXT_COLLAPSE_WIDTH && typeof since !== 'undefined') {\r\n            return (\r\n                <FormattedMessage\r\n                    id='postlist.toast.newMessagesSince'\r\n                    defaultMessage='{count, number} new {count, plural, one {message} other {messages}} {isToday, select, true {} other {since}} {date}'\r\n                    values={{\r\n                        count,\r\n                        isToday: isToday(new Date(since)).toString(),\r\n                        date: (\r\n                            <Timestamp\r\n                                value={since}\r\n                                useTime={false}\r\n                                ranges={TOAST_REL_RANGES}\r\n                            />\r\n                        ),\r\n                    }}\r\n                />\r\n            );\r\n        }\r\n        return (\r\n            <FormattedMessage\r\n                id='postlist.toast.newMessages'\r\n                defaultMessage={'{count, number} new {count, plural, one {message} other {messages}}'}\r\n                values={{count}}\r\n            />\r\n        );\r\n    };\r\n\r\n    archiveToastText = () => {\r\n        return (\r\n            <FormattedMessage\r\n                id='postlist.toast.history'\r\n                defaultMessage='Viewing message history'\r\n            />\r\n        );\r\n    };\r\n\r\n    getSearchHintToastText = () => {\r\n        return (\r\n            <FormattedMessage\r\n                id='postlist.toast.searchHint'\r\n                defaultMessage='Tip: Try {searchShortcut} to search this channel'\r\n                values={{\r\n                    searchShortcut: <SearchShortcut/>,\r\n                }}\r\n            />\r\n        );\r\n    };\r\n\r\n    changeUrlToRemountChannelView = () => {\r\n        const {match} = this.props;\r\n\r\n        // Inorder of mount the channel view we are redirecting to /team url to load the channel again\r\n        // Todo: Can be changed to dispatch if we put focussedPostId in redux state.\r\n        getHistory().replace(`/${match.params.team}`);\r\n    };\r\n\r\n    scrollToNewMessage = () => {\r\n        const {focusedPostId, atLatestPost, scrollToNewMessage, updateLastViewedBottomAt} = this.props;\r\n\r\n        // if latest set of posts are not loaded in the view then we cannot scroll to the message\r\n        // We will be chaging the url to remount the channel view so we can remove the focussedPostId react state\r\n        // if we don't remove the focussedPostId state then scroll tries to correct to that instead of new message line\r\n        if (focusedPostId && !atLatestPost) {\r\n            this.changeUrlToRemountChannelView();\r\n            return;\r\n        }\r\n\r\n        scrollToNewMessage();\r\n        updateLastViewedBottomAt();\r\n        this.hideNewMessagesToast();\r\n    };\r\n\r\n    scrollToLatestMessages = () => {\r\n        const {focusedPostId, atLatestPost, scrollToLatestMessages} = this.props;\r\n\r\n        if (focusedPostId) {\r\n            if (!atLatestPost) {\r\n                this.changeUrlToRemountChannelView();\r\n                return;\r\n            }\r\n            this.hideArchiveToast();\r\n        }\r\n\r\n        scrollToLatestMessages();\r\n        this.hideUnreadToast();\r\n        this.props.hideScrollToBottomToast?.();\r\n    };\r\n\r\n    scrollToUnreadMessages = () => {\r\n        this.props.scrollToUnreadMessages();\r\n        this.hideUnreadWithBottomStartToast();\r\n    };\r\n\r\n    getToastToRender() {\r\n        const {atLatestPost, atBottom, width, lastViewedAt, showSearchHintToast, showScrollToBottomToast} = this.props;\r\n        const {showUnreadToast, showNewMessagesToast, showMessageHistoryToast, showUnreadWithBottomStartToast, unreadCount} = this.state;\r\n\r\n        const unreadToastProps = {\r\n            show: true,\r\n            width,\r\n            onDismiss: this.hideUnreadToast,\r\n            onClick: this.scrollToLatestMessages,\r\n            onClickMessage: (\r\n                <FormattedMessage\r\n                    id='postlist.toast.scrollToBottom'\r\n                    defaultMessage='Jump to recents'\r\n                />\r\n            ),\r\n            showActions: !atLatestPost || (atLatestPost && (atBottom === false)),\r\n        };\r\n\r\n        if (showUnreadToast && unreadCount > 0) {\r\n            return (\r\n                <Toast {...unreadToastProps}>\r\n                    {this.newMessagesToastText(unreadCount, lastViewedAt)}\r\n                </Toast>\r\n            );\r\n        }\r\n\r\n        const unreadWithBottomStartToastProps = {\r\n            show: true,\r\n            width,\r\n            onDismiss: this.hideUnreadWithBottomStartToast,\r\n            onClick: this.scrollToUnreadMessages,\r\n            onClickMessage: (\r\n                <FormattedMessage\r\n                    id='postlist.toast.scrollToUnread'\r\n                    defaultMessage='Jump to unreads'\r\n                />\r\n            ),\r\n            showActions: true,\r\n            jumpDirection: 'up' as const,\r\n        };\r\n\r\n        if (showUnreadWithBottomStartToast && unreadCount > 0) {\r\n            return (\r\n                <Toast {...unreadWithBottomStartToastProps}>\r\n                    {this.newMessagesToastText(unreadCount, lastViewedAt)}\r\n                </Toast>\r\n            );\r\n        }\r\n\r\n        if (showNewMessagesToast) {\r\n            const showNewMessagesToastOverrides = {\r\n                onDismiss: this.hideNewMessagesToast,\r\n                onClick: this.scrollToNewMessage,\r\n                onClickMessage: (\r\n                    <FormattedMessage\r\n                        id='postlist.toast.scrollToLatest'\r\n                        defaultMessage='Jump to new messages'\r\n                    />\r\n                ),\r\n            };\r\n\r\n            return (\r\n                <Toast\r\n                    {...unreadToastProps}\r\n                    {...showNewMessagesToastOverrides}\r\n                >\r\n                    {this.newMessagesToastText(unreadCount, lastViewedAt)}\r\n                </Toast>\r\n            );\r\n        }\r\n\r\n        if (showMessageHistoryToast) {\r\n            const archiveToastProps = {\r\n                show: true,\r\n                width,\r\n                onDismiss: this.hideArchiveToast,\r\n                onClick: this.scrollToLatestMessages,\r\n                onClickMessage: (\r\n                    <FormattedMessage\r\n                        id='postlist.toast.scrollToBottom'\r\n                        defaultMessage='Jump to recents'\r\n                    />\r\n                ),\r\n                showActions: true,\r\n                extraClasses: 'toast__history',\r\n            };\r\n\r\n            return (\r\n                <Toast {...archiveToastProps}>\r\n                    {this.archiveToastText()}\r\n                </Toast>\r\n            );\r\n        }\r\n\r\n        const toasts = [];\r\n        if (showScrollToBottomToast) {\r\n            toasts.push(\r\n                <ScrollToBottomToast\r\n                    key='scroll-to-bottom-toast'\r\n                    onClick={this.scrollToLatestMessages}\r\n                    onDismiss={this.props.onScrollToBottomToastDismiss}\r\n                />,\r\n            );\r\n        }\r\n\r\n        if (showSearchHintToast) {\r\n            toasts.push(\r\n                <HintToast\r\n                    key='search-hint-toast'\r\n                    onDismiss={this.hideSearchHintToast}\r\n                >\r\n                    {this.getSearchHintToastText()}\r\n                </HintToast>,\r\n            );\r\n        }\r\n\r\n        if (toasts.length > 0) {\r\n            return (\r\n                <div className='toasts-wrapper'>\r\n                    {toasts}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    render() {\r\n        const toastToRender = this.getToastToRender();\r\n\r\n        return (\r\n            <>\r\n                {toastToRender}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(ToastWrapperClass);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {Posts} from 'mattermost-redux/constants';\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getCurrentChannel, countCurrentChannelUnreadMessages, isManuallyUnread} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getAllPosts, getPostIdsInChannel} from 'mattermost-redux/selectors/entities/posts';\r\nimport {getUnreadScrollPositionPreference, isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\nimport {makePreparePostIdsForPostList} from 'mattermost-redux/utils/post_list';\r\n\r\nimport {updateToastStatus} from 'actions/views/channel';\r\n\r\nimport type {GlobalState} from 'types/store/index';\r\n\r\nimport ToastWrapper from './toast_wrapper';\r\n\r\ninterface OwnProps {\r\n    atLatestPost?: boolean;\r\n    channelId: string;\r\n}\r\n\r\nexport function makeGetRootPosts() {\r\n    return createSelector(\r\n        'makeGetRootPosts',\r\n        getAllPosts,\r\n        getCurrentUserId,\r\n        getCurrentChannel,\r\n        (allPosts, currentUserId, channel) => {\r\n            // Count the number of new posts that haven't been deleted and are root posts\r\n            return Object.values(allPosts).filter((post) => {\r\n                return (\r\n                    post.root_id === '' &&\r\n                    post.channel_id === channel?.id &&\r\n                    post.state !== Posts.POST_DELETED\r\n                );\r\n            }).reduce((map: Record<string, boolean>, obj) => {\r\n                map[obj.id] = true;\r\n                return map;\r\n            }, {});\r\n        },\r\n    );\r\n}\r\n\r\nexport function makeCountUnreadsBelow() {\r\n    return createSelector(\r\n        'makeCountUnreadsBelow',\r\n        getAllPosts,\r\n        getCurrentUserId,\r\n        (state: GlobalState, postIds: string[]) => postIds,\r\n        (state: GlobalState, postIds, lastViewedBottom: number) => lastViewedBottom,\r\n        isCollapsedThreadsEnabled,\r\n        (allPosts, currentUserId, postIds, lastViewedBottom, isCollapsed) => {\r\n            if (!postIds) {\r\n                return 0;\r\n            }\r\n\r\n            // Count the number of new posts made by other users that haven't been deleted\r\n            return postIds.map((id) => allPosts[id]).filter((post) => {\r\n                return post &&\r\n                    post.user_id !== currentUserId &&\r\n                    post.state !== Posts.POST_DELETED &&\r\n                    post.create_at > lastViewedBottom &&\r\n                    (isCollapsed ? post.root_id === '' : true); // in collapsed threads mode, only count root posts\r\n            }).length;\r\n        },\r\n    );\r\n}\r\n\r\n/* This connected component is written mainly for maintaining the unread count to be passed to the toast\r\n   Unread count logic:\r\n   * If channel is at the latest set of posts:\r\n      Unread count is the Number of posts below new message line\r\n   * if channel is not at the latest set of posts:\r\n      1. UnreadCount + any recent messages in the latest chunk.\r\n      2. If channel was marked as unread.\r\n        * Unread count of channel alone.\r\n*/\r\n\r\nfunction makeMapStateToProps() {\r\n    const countUnreadsBelow = makeCountUnreadsBelow();\r\n    const getRootPosts = makeGetRootPosts();\r\n    const preparePostIdsForPostList = makePreparePostIdsForPostList();\r\n    return function mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n        let newRecentMessagesCount = 0;\r\n        const channelMarkedAsUnread = isManuallyUnread(state, ownProps.channelId);\r\n        const lastViewedAt = state.views.channel.lastChannelViewTime[ownProps.channelId];\r\n        const unreadScrollPosition = getUnreadScrollPositionPreference(state);\r\n        if (!ownProps.atLatestPost) {\r\n            let postIds = getPostIdsInChannel(state, ownProps.channelId) || [];\r\n            if (postIds) {\r\n                postIds = preparePostIdsForPostList(state, {postIds, lastViewedAt});\r\n            }\r\n            newRecentMessagesCount = countUnreadsBelow(state, postIds, lastViewedAt);\r\n        }\r\n        return {\r\n            rootPosts: getRootPosts(state),\r\n            lastViewedAt,\r\n            newRecentMessagesCount,\r\n            unreadScrollPosition,\r\n            isCollapsedThreadsEnabled: isCollapsedThreadsEnabled(state),\r\n            unreadCountInChannel: countCurrentChannelUnreadMessages(state),\r\n            channelMarkedAsUnread,\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            updateToastStatus,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(makeMapStateToProps, mapDispatchToProps)(ToastWrapper));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useMemo} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {getLatestPostId, usePostAriaLabel} from 'utils/post_utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\ninterface Props {\r\n    postIds?: string[];\r\n}\r\n\r\nconst LatestPostReader = (props: Props): JSX.Element => {\r\n    const {postIds} = props;\r\n    const latestPostId = useMemo(() => getLatestPostId(postIds || []), [postIds]);\r\n    const latestPost = useSelector<GlobalState, Post>((state) => getPost(state, latestPostId));\r\n\r\n    const ariaLabel = usePostAriaLabel(latestPost);\r\n\r\n    return (\r\n        <span\r\n            className='sr-only'\r\n            aria-live='polite'\r\n        >\r\n            {ariaLabel}\r\n        </span>\r\n    );\r\n};\r\n\r\nexport default LatestPostReader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport AutoSizer from 'react-virtualized-auto-sizer';\r\n\r\nimport EventEmitter from 'mattermost-redux/utils/event_emitter';\r\nimport {getNewMessagesIndex, isDateLine, isStartOfNewMessages} from 'mattermost-redux/utils/post_list';\r\n\r\nimport type {updateNewMessagesAtInChannel} from 'actions/global_actions';\r\nimport type {CanLoadMorePosts} from 'actions/views/channel';\r\n\r\nimport {DynamicVirtualizedList} from 'components/dynamic_virtualized_list';\r\nimport type {OnItemsRenderedArgs} from 'components/dynamic_virtualized_list';\r\nimport FloatingTimestamp from 'components/post_view/floating_timestamp';\r\nimport PostListRow from 'components/post_view/post_list_row';\r\nimport ScrollToBottomArrows from 'components/post_view/scroll_to_bottom_arrows';\r\nimport ToastWrapper from 'components/toast_wrapper';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport Constants, {PostListRowListIds, EventTypes, PostRequestTypes} from 'utils/constants';\r\nimport DelayedAction from 'utils/delayed_action';\r\nimport {getPreviousPostId, getLatestPostId} from 'utils/post_utils';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport LatestPostReader from './latest_post_reader';\r\n\r\nconst OVERSCAN_COUNT_BACKWARD = 80;\r\nconst OVERSCAN_COUNT_FORWARD = 80;\r\nconst HEIGHT_TRIGGER_FOR_MORE_POSTS = 1000;\r\nconst BUFFER_TO_BE_CONSIDERED_BOTTOM = 10;\r\n\r\nconst MAXIMUM_POSTS_FOR_SLICING = {\r\n    channel: 50,\r\n    permalink: 100,\r\n};\r\n\r\nconst postListStyle = {\r\n    padding: '14px 0px 7px',\r\n};\r\n\r\nconst virtListStyles = {\r\n    position: 'absolute',\r\n    bottom: '0',\r\n    maxHeight: '100%',\r\n};\r\n\r\nconst OFFSET_TO_SHOW_TOAST = -50;\r\n\r\ntype Props = {\r\n\r\n    /*\r\n     * Array of Ids in the channel including date separators, new message indicator, more messages loader,\r\n     * manual load messages trigger and postId in the order of newest to oldest for populating virtual list rows\r\n     */\r\n    postListIds?: string[];\r\n\r\n    /*\r\n     * The current channel id\r\n     */\r\n    channelId: string;\r\n\r\n    /*\r\n     * Used for disabling auto retry of posts and enabling manual link for loading posts\r\n     */\r\n    autoRetryEnable: boolean;\r\n\r\n    /*\r\n     * Used in passing to post row for enabling animation when loading posts\r\n     */\r\n    loadingNewerPosts: boolean;\r\n    loadingOlderPosts: boolean;\r\n\r\n    isMobileView: boolean;\r\n\r\n    /*\r\n     * Used for populating header, scroll correction and disabling triggering loadOlderPosts\r\n     */\r\n    atOldestPost?: boolean;\r\n\r\n    /*\r\n     * Used for disabling triggering loadNewerPosts\r\n     */\r\n    atLatestPost?: boolean;\r\n\r\n    latestPostTimeStamp?: number;\r\n    lastViewedAt: number;\r\n\r\n    /*\r\n     * Set to focus this post\r\n     */\r\n    focusedPostId?: string;\r\n\r\n    shouldStartFromBottomWhenUnread: boolean;\r\n\r\n    actions: {\r\n\r\n        /*\r\n         * Function to get older posts in the channel\r\n         */\r\n        loadOlderPosts: () => Promise<void>;\r\n\r\n        /*\r\n         * Function to get newer posts in the channel\r\n         */\r\n        loadNewerPosts: () => Promise<void>;\r\n\r\n        /*\r\n         * Function used for autoLoad of posts incase screen is not filled with posts\r\n         */\r\n        canLoadMorePosts: (type: CanLoadMorePosts) => Promise<void>;\r\n\r\n        /*\r\n         * Function to change the post selected for postList\r\n         */\r\n        changeUnreadChunkTimeStamp: (lastViewedAt: number) => void;\r\n\r\n        updateNewMessagesAtInChannel: typeof updateNewMessagesAtInChannel;\r\n\r\n        toggleShouldStartFromBottomWhenUnread: () => void;\r\n    };\r\n}\r\n\r\ntype State = {\r\n    isScrolling: boolean;\r\n\r\n    // Intentionally setting null so that toast can determine when the first time this state is defined\r\n    atBottom: boolean | null;\r\n    lastViewedBottom: number;\r\n    postListIds: string[];\r\n    topPostId: string;\r\n    postMenuOpened: boolean;\r\n    dynamicListStyle: {\r\n        willChange: string;\r\n    };\r\n    initScrollCompleted: boolean;\r\n    initScrollOffsetFromBottom: number;\r\n    showSearchHint: boolean;\r\n    isSearchHintDismissed: boolean;\r\n    isMobileView?: boolean;\r\n    isNewMessageLineReached: boolean;\r\n    showScrollToBottomToast: boolean;\r\n    isScrollToBottomDismissed: boolean;\r\n}\r\n\r\nexport default class PostList extends React.PureComponent<Props, State> {\r\n    listRef: React.RefObject<DynamicVirtualizedList>;\r\n    postListRef: React.RefObject<HTMLDivElement>;\r\n    scrollStopAction: DelayedAction | null = null;\r\n    initRangeToRender: number[];\r\n    showSearchHintThreshold: number;\r\n    mounted: boolean;\r\n    newMessageLineIndex: number;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        const channelIntroMessage = PostListRowListIds.CHANNEL_INTRO_MESSAGE;\r\n        this.mounted = true;\r\n\r\n        this.state = {\r\n            isScrolling: false,\r\n\r\n            // Intentionally setting null so that toast can determine when the first time this state is defined\r\n            atBottom: null,\r\n            lastViewedBottom: Date.now(),\r\n            postListIds: [channelIntroMessage],\r\n            topPostId: '',\r\n            postMenuOpened: false,\r\n            dynamicListStyle: {\r\n                willChange: 'transform',\r\n            },\r\n            initScrollCompleted: false,\r\n            initScrollOffsetFromBottom: 0,\r\n            showSearchHint: false,\r\n            isSearchHintDismissed: false,\r\n            isNewMessageLineReached: false,\r\n            showScrollToBottomToast: false,\r\n            isScrollToBottomDismissed: false,\r\n        };\r\n\r\n        this.listRef = React.createRef();\r\n        this.postListRef = React.createRef();\r\n        if (this.props.isMobileView) {\r\n            this.scrollStopAction = new DelayedAction(this.handleScrollStop);\r\n        }\r\n\r\n        this.initRangeToRender = this.props.focusedPostId ? [0, MAXIMUM_POSTS_FOR_SLICING.permalink] : [0, MAXIMUM_POSTS_FOR_SLICING.channel];\r\n\r\n        let postIndex = 0;\r\n        if (props.focusedPostId) {\r\n            postIndex = (this.props.postListIds || []).findIndex((postId) => postId === this.props.focusedPostId);\r\n        } else {\r\n            postIndex = getNewMessagesIndex(props.postListIds || []);\r\n        }\r\n        this.newMessageLineIndex = getNewMessagesIndex(props.postListIds || []);\r\n\r\n        const maxPostsForSlicing = props.focusedPostId ? MAXIMUM_POSTS_FOR_SLICING.permalink : MAXIMUM_POSTS_FOR_SLICING.channel;\r\n        this.initRangeToRender = [\r\n            Math.max(postIndex - 30, 0),\r\n            Math.max(postIndex + 30, Math.min((props.postListIds || []).length - 1, maxPostsForSlicing)),\r\n        ];\r\n        this.showSearchHintThreshold = this.getShowSearchHintThreshold();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.mounted = true;\r\n\r\n        window.addEventListener('resize', this.handleWindowResize);\r\n        EventEmitter.addListener(EventTypes.POST_LIST_SCROLL_TO_BOTTOM, this.scrollToLatestMessages);\r\n    }\r\n\r\n    getSnapshotBeforeUpdate(prevProps: Props) {\r\n        if (this.postListRef && this.postListRef.current) {\r\n            const postsAddedAtTop = this.props.postListIds && this.props.postListIds.length !== (prevProps.postListIds || []).length && this.props.postListIds[0] === (prevProps.postListIds || [])[0];\r\n            const channelHeaderAdded = this.props.atOldestPost !== prevProps.atOldestPost;\r\n            if ((postsAddedAtTop || channelHeaderAdded) && this.state.atBottom === false) {\r\n                const postListNode = this.postListRef.current;\r\n                const previousScrollTop = postListNode.parentElement?.scrollTop;\r\n                const previousScrollHeight = postListNode.scrollHeight;\r\n\r\n                return {\r\n                    previousScrollTop,\r\n                    previousScrollHeight,\r\n                };\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props, _prevState: State, snapshot: {previousScrollTop: number; previousScrollHeight: number}) {\r\n        if (this.props.isMobileView && !prevProps.isMobileView) {\r\n            this.scrollStopAction = new DelayedAction(this.handleScrollStop);\r\n        }\r\n\r\n        if (!this.postListRef.current) {\r\n            return;\r\n        }\r\n        const prevPostsCount = (prevProps.postListIds || []).length;\r\n        const presentPostsCount = (this.props.postListIds || []).length;\r\n\r\n        this.newMessageLineIndex = getNewMessagesIndex(this.props.postListIds || []);\r\n\r\n        if (snapshot) {\r\n            const postlistScrollHeight = this.postListRef.current.scrollHeight;\r\n            const postsAddedAtTop = presentPostsCount !== prevPostsCount && (this.props.postListIds || [])[0] === (prevProps.postListIds || [])[0];\r\n            const channelHeaderAdded = this.props.atOldestPost !== prevProps.atOldestPost;\r\n            if ((postsAddedAtTop || channelHeaderAdded) && !this.state.atBottom && snapshot) {\r\n                const scrollValue = snapshot.previousScrollTop + (postlistScrollHeight - snapshot.previousScrollHeight);\r\n                if (scrollValue !== 0 && (scrollValue - snapshot.previousScrollTop) !== 0) {\r\n                    //true as third param so chrome can use animationFrame when correcting scroll\r\n                    this.listRef.current?.scrollTo(scrollValue, scrollValue - snapshot.previousScrollTop, true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.mounted = false;\r\n        window.removeEventListener('resize', this.handleWindowResize);\r\n        EventEmitter.removeListener(EventTypes.POST_LIST_SCROLL_TO_BOTTOM, this.scrollToLatestMessages);\r\n    }\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        const postListIds = props.postListIds || [];\r\n        let newPostListIds;\r\n\r\n        if (props.atOldestPost) {\r\n            newPostListIds = [...postListIds, PostListRowListIds.CHANNEL_INTRO_MESSAGE];\r\n        } else if (props.autoRetryEnable) {\r\n            newPostListIds = [...postListIds, PostListRowListIds.OLDER_MESSAGES_LOADER];\r\n        } else {\r\n            newPostListIds = [...postListIds, PostListRowListIds.LOAD_OLDER_MESSAGES_TRIGGER];\r\n        }\r\n\r\n        if (!props.atLatestPost) {\r\n            if (props.autoRetryEnable) {\r\n                newPostListIds = [PostListRowListIds.NEWER_MESSAGES_LOADER, ...newPostListIds];\r\n            } else {\r\n                newPostListIds = [PostListRowListIds.LOAD_NEWER_MESSAGES_TRIGGER, ...newPostListIds];\r\n            }\r\n        }\r\n\r\n        const nextState: Partial<State> = {\r\n            postListIds: newPostListIds,\r\n        };\r\n\r\n        if (props.isMobileView !== state.isMobileView) {\r\n            nextState.isMobileView = props.isMobileView;\r\n\r\n            const dynamicListStyle = state.dynamicListStyle;\r\n            if (state.postMenuOpened) {\r\n                if (!props.isMobileView && dynamicListStyle.willChange === 'unset') {\r\n                    nextState.dynamicListStyle = {\r\n                        ...dynamicListStyle,\r\n                        willChange: 'transform',\r\n                    };\r\n                } else if (props.isMobileView && dynamicListStyle.willChange === 'transform') {\r\n                    nextState.dynamicListStyle = {\r\n                        ...dynamicListStyle,\r\n                        willChange: 'unset',\r\n                    };\r\n                }\r\n            }\r\n        }\r\n\r\n        return nextState;\r\n    }\r\n\r\n    handleWindowResize = () => {\r\n        this.showSearchHintThreshold = this.getShowSearchHintThreshold();\r\n    };\r\n\r\n    togglePostMenu = (opened: boolean) => {\r\n        let dynamicListStyle = this.state.dynamicListStyle;\r\n        if (this.props.isMobileView) {\r\n            dynamicListStyle = {\r\n                ...dynamicListStyle,\r\n                willChange: opened ? 'unset' : 'transform',\r\n            };\r\n        }\r\n\r\n        this.setState({\r\n            postMenuOpened: opened,\r\n            dynamicListStyle,\r\n        });\r\n    };\r\n\r\n    onNewMessageLineReached = () => {\r\n        this.setState({\r\n            isNewMessageLineReached: true,\r\n        });\r\n    };\r\n\r\n    renderRow = ({data, itemId, style}: {data: string[]; itemId: string; style: Record<string, string>}) => {\r\n        const index = data.indexOf(itemId);\r\n        let className = '';\r\n        const basePaddingClass = 'post-row__padding';\r\n        const previousItemId = (index !== -1 && index < data.length - 1) ? data[index + 1] : '';\r\n        const nextItemId = (index > 0 && index < data.length) ? data[index - 1] : '';\r\n\r\n        if (isDateLine(nextItemId) || isStartOfNewMessages(nextItemId)) {\r\n            className += basePaddingClass + ' bottom';\r\n        }\r\n\r\n        if (isDateLine(previousItemId) || isStartOfNewMessages(previousItemId)) {\r\n            if (className.includes(basePaddingClass)) {\r\n                className += ' top';\r\n            } else {\r\n                className += basePaddingClass + ' top';\r\n            }\r\n        }\r\n\r\n        // Since the first in the list is the latest message\r\n        const isLastPost = itemId === this.state.postListIds[0];\r\n\r\n        return (\r\n            <div\r\n                style={style}\r\n                className={className}\r\n            >\r\n                <PostListRow\r\n                    listId={itemId}\r\n                    previousListId={getPreviousPostId(data, index)}\r\n                    shouldHighlight={itemId === this.props.focusedPostId}\r\n                    loadOlderPosts={this.props.actions.loadOlderPosts}\r\n                    loadNewerPosts={this.props.actions.loadNewerPosts}\r\n                    togglePostMenu={this.togglePostMenu}\r\n                    isLastPost={isLastPost}\r\n                    loadingNewerPosts={this.props.loadingNewerPosts}\r\n                    loadingOlderPosts={this.props.loadingOlderPosts}\r\n                    channelId={this.props.channelId}\r\n                />\r\n            </div>\r\n        );\r\n    };\r\n\r\n    scrollToFailed = (index: number) => {\r\n        if (index === 0) {\r\n            this.props.actions.changeUnreadChunkTimeStamp(0);\r\n        } else {\r\n            this.props.actions.changeUnreadChunkTimeStamp(this.props.lastViewedAt);\r\n        }\r\n    };\r\n\r\n    onScroll = ({\r\n        scrollDirection,\r\n        scrollOffset,\r\n        scrollUpdateWasRequested,\r\n        clientHeight,\r\n        scrollHeight}:\r\n    {\r\n        scrollDirection: string;\r\n        scrollOffset: number;\r\n        scrollUpdateWasRequested: boolean;\r\n        clientHeight: number;\r\n        scrollHeight: number;\r\n    }) => {\r\n        if (scrollHeight <= 0) {\r\n            return;\r\n        }\r\n\r\n        const didUserScrollBackwards = scrollDirection === 'backward' && !scrollUpdateWasRequested;\r\n        const didUserScrollForwards = scrollDirection === 'forward' && !scrollUpdateWasRequested;\r\n        const isOffsetWithInRange = scrollOffset < HEIGHT_TRIGGER_FOR_MORE_POSTS;\r\n        const offsetFromBottom = this.getOffsetFromBottom(scrollOffset, scrollHeight, clientHeight);\r\n        const shouldLoadNewPosts = offsetFromBottom < HEIGHT_TRIGGER_FOR_MORE_POSTS;\r\n\r\n        if (didUserScrollBackwards && isOffsetWithInRange && !this.props.atOldestPost) {\r\n            this.props.actions.loadOlderPosts();\r\n        } else if (didUserScrollForwards && shouldLoadNewPosts && !this.props.atLatestPost) {\r\n            this.props.actions.loadNewerPosts();\r\n        }\r\n\r\n        if (this.props.isMobileView) {\r\n            if (!this.state.isScrolling) {\r\n                this.setState({\r\n                    isScrolling: true,\r\n                });\r\n            }\r\n\r\n            if (this.scrollStopAction) {\r\n                this.scrollStopAction.fireAfter(Constants.SCROLL_DELAY);\r\n            }\r\n        }\r\n\r\n        this.checkBottom(scrollOffset, scrollHeight, clientHeight);\r\n\r\n        if (scrollUpdateWasRequested) { //if scroll change is programatically requested i.e by calling scrollTo\r\n            //This is a private method on virtlist\r\n            const postsRenderedRange = this.listRef.current?._getRangeToRender(); //eslint-disable-line no-underscore-dangle\r\n\r\n            // postsRenderedRange[3] is the visibleStopIndex which is post at the bottom of the screen\r\n            if (postsRenderedRange && postsRenderedRange[3] <= 1 && !this.props.atLatestPost) {\r\n                this.props.actions.canLoadMorePosts(PostRequestTypes.AFTER_ID);\r\n            }\r\n\r\n            if (!this.state.atBottom && scrollHeight) {\r\n                this.setState({\r\n                    initScrollOffsetFromBottom: offsetFromBottom,\r\n                });\r\n            }\r\n        }\r\n\r\n        if (this.props.isMobileView && this.state.showSearchHint) {\r\n            this.setState({\r\n                showSearchHint: false,\r\n            });\r\n        }\r\n\r\n        if (!this.props.isMobileView && !this.state.isSearchHintDismissed) {\r\n            this.setState({\r\n                showSearchHint: offsetFromBottom > this.showSearchHintThreshold,\r\n            });\r\n        }\r\n\r\n        this.updateScrollToBottomToastVisibility(scrollOffset, scrollHeight, clientHeight);\r\n    };\r\n\r\n    getShowSearchHintThreshold = () => {\r\n        return window.screen.height * 3;\r\n    };\r\n\r\n    checkBottom = (scrollOffset: number, scrollHeight: number, clientHeight: number) => {\r\n        this.updateAtBottom(this.isAtBottom(scrollOffset, scrollHeight, clientHeight));\r\n    };\r\n\r\n    // Calculate how far the post list is from being scrolled to the bottom\r\n    getOffsetFromBottom = (scrollOffset: number, scrollHeight: number, clientHeight: number) => scrollHeight - clientHeight - scrollOffset;\r\n\r\n    isAtBottom = (scrollOffset: number, scrollHeight: number, clientHeight: number) => {\r\n        const offsetFromBottom = this.getOffsetFromBottom(scrollOffset, scrollHeight, clientHeight);\r\n\r\n        return offsetFromBottom <= BUFFER_TO_BE_CONSIDERED_BOTTOM && scrollHeight > 0;\r\n    };\r\n\r\n    updateAtBottom = (atBottom: boolean) => {\r\n        if (atBottom !== this.state.atBottom) {\r\n            // Update lastViewedBottom when the list reaches or leaves the bottom\r\n            let lastViewedBottom = Date.now();\r\n            if (this.props.latestPostTimeStamp && this.props.latestPostTimeStamp > lastViewedBottom) {\r\n                lastViewedBottom = this.props.latestPostTimeStamp;\r\n            }\r\n\r\n            // if we hit the bottom, we haven't just landed on the unread channel\r\n            this.setState({\r\n                atBottom,\r\n                lastViewedBottom,\r\n            });\r\n        }\r\n    };\r\n\r\n    updateLastViewedBottomAt = (lastViewedBottom = Date.now()) => {\r\n        this.setState({\r\n            lastViewedBottom,\r\n        });\r\n    };\r\n\r\n    handleScrollStop = () => {\r\n        if (this.mounted) {\r\n            this.setState({\r\n                isScrolling: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    handleSearchHintDismiss = () => {\r\n        this.setState({\r\n            showSearchHint: false,\r\n            isSearchHintDismissed: true,\r\n        });\r\n    };\r\n\r\n    handleScrollToBottomToastDismiss = () => {\r\n        this.setState({\r\n            showScrollToBottomToast: false,\r\n            isScrollToBottomDismissed: true,\r\n        });\r\n    };\r\n\r\n    hideScrollToBottomToast = () => {\r\n        this.setState({\r\n            showScrollToBottomToast: false,\r\n        });\r\n    };\r\n\r\n    /*\r\n     * - Show the scroll-to-bottom toast at the same time as the search-hint toast.\r\n     * - Only show if the user hasn't dismissed it before, within a session.\r\n     * - Hide it if the user is at the bottom of the list.\r\n     */\r\n    updateScrollToBottomToastVisibility = (scrollOffset: number, scrollHeight: number, clientHeight: number) => {\r\n        if (this.state.showScrollToBottomToast && this.state.atBottom) {\r\n            this.setState({\r\n                showScrollToBottomToast: false,\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (!this.state.isScrollToBottomDismissed) {\r\n            const offsetFromBottom = this.getOffsetFromBottom(scrollOffset, scrollHeight, clientHeight);\r\n            this.setState({\r\n                showScrollToBottomToast: offsetFromBottom > this.showSearchHintThreshold,\r\n            });\r\n        }\r\n    };\r\n\r\n    updateFloatingTimestamp = (visibleTopItem: number) => {\r\n        if (!this.props.isMobileView) {\r\n            return;\r\n        }\r\n\r\n        if (!this.props.postListIds) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            topPostId: getLatestPostId(this.props.postListIds.slice(visibleTopItem)),\r\n        });\r\n    };\r\n\r\n    onItemsRendered = ({visibleStartIndex, visibleStopIndex}: Pick<OnItemsRenderedArgs, 'visibleStartIndex' | 'visibleStopIndex'>) => {\r\n        this.updateFloatingTimestamp(visibleStartIndex);\r\n\r\n        if (\r\n            this.newMessageLineIndex > 0 &&\r\n             !this.state.isNewMessageLineReached &&\r\n             this.newMessageLineIndex <= visibleStartIndex &&\r\n             this.newMessageLineIndex >= visibleStopIndex\r\n        ) {\r\n            this.onNewMessageLineReached();\r\n        }\r\n    };\r\n\r\n    initScrollToIndex = () => {\r\n        if (this.props.focusedPostId) {\r\n            const index = this.state.postListIds.findIndex(\r\n                (item) => item === this.props.focusedPostId,\r\n            );\r\n            return {\r\n                index,\r\n                position: 'center',\r\n            };\r\n        }\r\n\r\n        if (this.props.shouldStartFromBottomWhenUnread) {\r\n            return {\r\n                index: 0,\r\n                position: 'end',\r\n            };\r\n        }\r\n\r\n        const newMessagesSeparatorIndex = getNewMessagesIndex(this.state.postListIds);\r\n\r\n        if (newMessagesSeparatorIndex > 0) {\r\n            // if there is a dateLine above START_OF_NEW_MESSAGES then scroll to date line\r\n            if (isDateLine(this.state.postListIds[newMessagesSeparatorIndex + 1])) {\r\n                return {\r\n                    index: newMessagesSeparatorIndex + 1,\r\n                    position: 'start',\r\n                    offset: OFFSET_TO_SHOW_TOAST,\r\n                };\r\n            }\r\n            return {\r\n                index: newMessagesSeparatorIndex,\r\n                position: 'start',\r\n                offset: OFFSET_TO_SHOW_TOAST,\r\n            };\r\n        }\r\n\r\n        return {\r\n            index: 0,\r\n            position: 'end',\r\n        };\r\n    };\r\n\r\n    scrollToLatestMessages = () => {\r\n        if (this.props.atLatestPost) {\r\n            this.scrollToBottom();\r\n        } else {\r\n            this.updateNewMessagesAtInChannel();\r\n            this.props.actions.changeUnreadChunkTimeStamp(0);\r\n        }\r\n    };\r\n\r\n    scrollToUnreadMessages = () => {\r\n        this.props.actions.toggleShouldStartFromBottomWhenUnread();\r\n    };\r\n\r\n    scrollToBottom = () => {\r\n        this.listRef.current?.scrollToItem(0, 'end');\r\n    };\r\n\r\n    scrollToNewMessage = () => {\r\n        this.listRef.current?.scrollToItem(getNewMessagesIndex(this.state.postListIds), 'start', OFFSET_TO_SHOW_TOAST);\r\n    };\r\n\r\n    updateNewMessagesAtInChannel = (lastViewedAt = Date.now()) => {\r\n        this.props.actions.updateNewMessagesAtInChannel(this.props.channelId, lastViewedAt);\r\n    };\r\n\r\n    renderToasts = (width: number) => {\r\n        return (\r\n            <ToastWrapper\r\n                atLatestPost={this.props.atLatestPost}\r\n                postListIds={this.state.postListIds}\r\n                atBottom={this.state.atBottom}\r\n                width={width}\r\n                lastViewedBottom={this.state.lastViewedBottom}\r\n                latestPostTimeStamp={this.props.latestPostTimeStamp}\r\n                scrollToUnreadMessages={this.scrollToUnreadMessages}\r\n                scrollToNewMessage={this.scrollToNewMessage}\r\n                scrollToLatestMessages={this.scrollToLatestMessages}\r\n                updateNewMessagesAtInChannel={this.updateNewMessagesAtInChannel}\r\n                updateLastViewedBottomAt={this.updateLastViewedBottomAt}\r\n                shouldStartFromBottomWhenUnread={this.props.shouldStartFromBottomWhenUnread}\r\n                isNewMessageLineReached={this.state.isNewMessageLineReached}\r\n                channelId={this.props.channelId}\r\n                focusedPostId={this.props.focusedPostId}\r\n                initScrollOffsetFromBottom={this.state.initScrollOffsetFromBottom}\r\n                onSearchHintDismiss={this.handleSearchHintDismiss}\r\n                showSearchHintToast={this.state.showSearchHint}\r\n                showScrollToBottomToast={this.state.showScrollToBottomToast}\r\n                onScrollToBottomToastDismiss={this.handleScrollToBottomToastDismiss}\r\n                hideScrollToBottomToast={this.hideScrollToBottomToast}\r\n            />\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const {channelId} = this.props;\r\n        const {dynamicListStyle} = this.state;\r\n\r\n        return (\r\n            <div\r\n                className='a11y__region'\r\n                data-a11y-sort-order='1'\r\n                data-a11y-focus-child={true}\r\n                data-a11y-order-reversed={true}\r\n                data-a11y-loop-navigation={false}\r\n                aria-label={Utils.localizeMessage({id: 'accessibility.sections.centerContent', defaultMessage: 'message list main region'})}\r\n            >\r\n                {this.props.isMobileView && (\r\n                    <>\r\n                        <FloatingTimestamp\r\n                            isScrolling={this.state.isScrolling}\r\n                            postId={this.state.topPostId}\r\n                        />\r\n                        <ScrollToBottomArrows\r\n                            isScrolling={this.state.isScrolling}\r\n                            atBottom={Boolean(this.state.atBottom)}\r\n                            onClick={this.scrollToBottom}\r\n                        />\r\n                    </>\r\n                )}\r\n                <div\r\n                    className='post-list-holder-by-time'\r\n                    key={'postlist-' + channelId}\r\n                >\r\n                    <div\r\n                        className='post-list__table'\r\n                    >\r\n                        <div\r\n                            id='postListContent'\r\n                            className='post-list__content'\r\n                        >\r\n                            <LatestPostReader postIds={this.props.postListIds}/>\r\n                            <AutoSizer>\r\n                                {({height, width}) => (\r\n                                    <>\r\n                                        <div>\r\n                                            <Pluggable pluggableName='ChannelToast'/>\r\n\r\n                                            {this.renderToasts(width)}\r\n                                        </div>\r\n\r\n                                        <DynamicVirtualizedList\r\n                                            ref={this.listRef}\r\n                                            id='postListScrollContainer'\r\n                                            className='post-list__dynamic'\r\n                                            height={height}\r\n                                            width={width}\r\n                                            itemData={this.state.postListIds}\r\n                                            overscanCountForward={OVERSCAN_COUNT_FORWARD}\r\n                                            overscanCountBackward={OVERSCAN_COUNT_BACKWARD}\r\n                                            onScroll={this.onScroll}\r\n                                            initScrollToIndex={this.initScrollToIndex}\r\n                                            canLoadMorePosts={this.props.actions.canLoadMorePosts}\r\n                                            innerRef={this.postListRef}\r\n                                            style={{...virtListStyles, ...dynamicListStyle}}\r\n                                            innerListStyle={postListStyle}\r\n                                            initRangeToRender={this.initRangeToRender}\r\n                                            loaderId={PostListRowListIds.OLDER_MESSAGES_LOADER}\r\n                                            correctScrollToBottom={this.props.atLatestPost}\r\n                                            onItemsRendered={this.onItemsRendered}\r\n                                            scrollToFailed={this.scrollToFailed}\r\n                                        >\r\n                                            {this.renderRow}\r\n                                        </DynamicVirtualizedList>\r\n                                    </>\r\n                                )}\r\n                            </AutoSizer>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport type {updateNewMessagesAtInChannel} from 'actions/global_actions';\r\nimport {clearMarks, mark} from 'actions/telemetry_actions.jsx';\r\nimport type {LoadPostsParameters, LoadPostsReturnValue, CanLoadMorePosts} from 'actions/views/channel';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport VirtPostList from 'components/post_view/post_list_virtualized/post_list_virtualized';\r\n\r\nimport {PostRequestTypes, Constants} from 'utils/constants';\r\nimport {Mark, Measure, measureAndReport} from 'utils/performance_telemetry';\r\nimport {getOldestPostId, getLatestPostId} from 'utils/post_utils';\r\n\r\nconst MAX_NUMBER_OF_AUTO_RETRIES = 3;\r\nexport const MAX_EXTRA_PAGES_LOADED = 30;\r\n\r\n// Post loading page sizes\r\nconst USER_SCROLL_POSTS_PER_PAGE = Constants.POST_CHUNK_SIZE / 2; // 30 posts for user scroll\r\nconst AUTO_LOAD_POSTS_PER_PAGE = 200; // Maximum server limit for auto-loading\r\n\r\n// Measures the time between channel or team switch started and the post list component rendering posts.\r\n// Set \"fresh\" to true when the posts have not been loaded before.\r\nfunction markAndMeasureChannelSwitchEnd(fresh = false) {\r\n    mark(Mark.PostListLoaded);\r\n\r\n    // Send new performance metrics to server\r\n    measureAndReport({\r\n        name: Measure.ChannelSwitch,\r\n        startMark: Mark.ChannelLinkClicked,\r\n        endMark: Mark.PostListLoaded,\r\n        labels: {\r\n            fresh: fresh.toString(),\r\n        },\r\n        canFail: true,\r\n    });\r\n    measureAndReport({\r\n        name: Measure.TeamSwitch,\r\n        startMark: Mark.TeamLinkClicked,\r\n        endMark: Mark.PostListLoaded,\r\n        labels: {\r\n            fresh: fresh.toString(),\r\n        },\r\n        canFail: true,\r\n    });\r\n\r\n    // Clear all the metrics so that we can differentiate between a channel and team switch next time this is called\r\n    clearMarks([\r\n        Mark.ChannelLinkClicked,\r\n        Mark.TeamLinkClicked,\r\n        Mark.PostListLoaded,\r\n    ]);\r\n}\r\n\r\nexport interface Props {\r\n\r\n    /**\r\n     *  Array of formatted post ids in the channel\r\n     *  This will be different from postListIds because of grouping and filtering of posts\r\n     *  This array should be used for making Before and After API calls\r\n     */\r\n    formattedPostIds?: string[];\r\n\r\n    /**\r\n     *  Array of post ids in the channel, ordered from newest to oldest\r\n     */\r\n    postListIds?: string[];\r\n\r\n    /**\r\n     * The channel the posts are in\r\n     */\r\n    channelId: string;\r\n\r\n    /*\r\n     * To get posts for perma view\r\n     */\r\n    focusedPostId?: string;\r\n\r\n    /*\r\n     * Used for determining if we are not at the recent most chunk in channel\r\n     */\r\n    atLatestPost: boolean;\r\n\r\n    /*\r\n     * Used for determining if we are at the channels oldest post\r\n     */\r\n    atOldestPost?: boolean;\r\n\r\n    /*\r\n     * Used for loading posts using unread API\r\n     */\r\n    isFirstLoad: boolean;\r\n\r\n    /*\r\n     * Used for syncing posts and is also passed down to virt list for newMessages indicator\r\n     */\r\n    latestPostTimeStamp?: number;\r\n\r\n    /*\r\n     * Used for passing down to virt list so it can change the chunk of posts selected\r\n     */\r\n    changeUnreadChunkTimeStamp: (lastViewedAt: number) => void;\r\n\r\n    /*\r\n     * Used for skipping the call on load\r\n     */\r\n    isPrefetchingInProcess: boolean;\r\n\r\n    isMobileView: boolean;\r\n\r\n    lastViewedAt: number;\r\n\r\n    toggleShouldStartFromBottomWhenUnread: () => void;\r\n    shouldStartFromBottomWhenUnread: boolean;\r\n    hasInaccessiblePosts: boolean;\r\n\r\n    actions: {\r\n\r\n        /*\r\n         * Used for getting permalink view posts\r\n         */\r\n        loadPostsAround: (channelId: string, focusedPostId: string) => Promise<ActionResult>;\r\n\r\n        /*\r\n         * Used for geting unreads posts\r\n         */\r\n        loadUnreads: (channelId: string) => Promise<ActionResult>;\r\n\r\n        /*\r\n         * Used for getting posts using BEFORE_ID and AFTER_ID\r\n         */\r\n        loadPosts: (parameters: LoadPostsParameters) => Promise<LoadPostsReturnValue>;\r\n\r\n        /*\r\n         * Used to loading posts since a timestamp to sync the posts\r\n         */\r\n        syncPostsInChannel: (channelId: string, since: number, prefetch: boolean) => Promise<ActionResult>;\r\n\r\n        /*\r\n         * Used to loading posts if it not first visit, permalink or there exists any postListIds\r\n         * This happens when previous channel visit has a chunk which is not the latest set of posts\r\n         */\r\n        loadLatestPosts: (channelId: string) => Promise<ActionResult>;\r\n\r\n        markChannelAsRead: (channelId: string) => void;\r\n        updateNewMessagesAtInChannel: typeof updateNewMessagesAtInChannel;\r\n    };\r\n}\r\n\r\ninterface State {\r\n    loadingNewerPosts: boolean;\r\n    loadingOlderPosts: boolean;\r\n    autoRetryEnable: boolean;\r\n}\r\n\r\nexport default class PostList extends React.PureComponent<Props, State> {\r\n    private autoRetriesCount: number;\r\n    private actionsForPostList: {\r\n        loadOlderPosts: () => Promise<void>;\r\n        loadNewerPosts: () => Promise<void>;\r\n        canLoadMorePosts: (type: CanLoadMorePosts) => Promise<void>;\r\n        changeUnreadChunkTimeStamp: (lastViewedAt: number) => void;\r\n        updateNewMessagesAtInChannel: typeof updateNewMessagesAtInChannel;\r\n        toggleShouldStartFromBottomWhenUnread: () => void;\r\n    };\r\n    private mounted: boolean | undefined;\r\n\r\n    // public for testing purposes only\r\n    public extraPagesLoaded: number;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            loadingNewerPosts: false,\r\n            loadingOlderPosts: false,\r\n            autoRetryEnable: true,\r\n        };\r\n\r\n        this.extraPagesLoaded = 0;\r\n\r\n        this.autoRetriesCount = 0;\r\n        this.actionsForPostList = {\r\n            loadOlderPosts: this.getPostsBefore,\r\n            loadNewerPosts: this.getPostsAfter,\r\n            canLoadMorePosts: this.canLoadMorePosts,\r\n            changeUnreadChunkTimeStamp: props.changeUnreadChunkTimeStamp,\r\n            toggleShouldStartFromBottomWhenUnread: props.toggleShouldStartFromBottomWhenUnread,\r\n            updateNewMessagesAtInChannel: this.props.actions.updateNewMessagesAtInChannel,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.mounted = true;\r\n        if (this.props.channelId) {\r\n            this.postsOnLoad(this.props.channelId);\r\n            if (this.props.postListIds) {\r\n                markAndMeasureChannelSwitchEnd();\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (this.props.channelId !== prevProps.channelId) {\r\n            this.postsOnLoad(this.props.channelId);\r\n        }\r\n        if (this.props.postListIds != null && prevProps.postListIds == null) {\r\n            markAndMeasureChannelSwitchEnd(true);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.mounted = false;\r\n    }\r\n\r\n    postsOnLoad = async (channelId: string) => {\r\n        const {focusedPostId, isFirstLoad, latestPostTimeStamp, isPrefetchingInProcess, actions} = this.props;\r\n        if (focusedPostId) {\r\n            await actions.loadPostsAround(channelId, focusedPostId);\r\n        } else if (isFirstLoad) {\r\n            if (!isPrefetchingInProcess) {\r\n                await actions.loadUnreads(channelId);\r\n            }\r\n        } else if (latestPostTimeStamp) {\r\n            await actions.syncPostsInChannel(channelId, latestPostTimeStamp, false);\r\n        } else {\r\n            await actions.loadLatestPosts(channelId);\r\n        }\r\n\r\n        if (!focusedPostId) {\r\n            // Posts are marked as read from here to not cause a race when loading posts\r\n            // marking channel as read and viewed after calling for posts in channel\r\n            this.props.actions.markChannelAsRead(channelId);\r\n        }\r\n\r\n        if (this.mounted) {\r\n            this.setState({\r\n                loadingOlderPosts: false,\r\n                loadingNewerPosts: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    callLoadPosts = async (channelId: string, postId: string, type: CanLoadMorePosts, perPage: number) => {\r\n        const {error} = await this.props.actions.loadPosts({\r\n            channelId,\r\n            postId,\r\n            type,\r\n            perPage,\r\n        });\r\n\r\n        if (type === PostRequestTypes.BEFORE_ID) {\r\n            this.setState({loadingOlderPosts: false});\r\n        } else {\r\n            this.setState({loadingNewerPosts: false});\r\n        }\r\n\r\n        if (error) {\r\n            if (this.autoRetriesCount < MAX_NUMBER_OF_AUTO_RETRIES) {\r\n                this.autoRetriesCount++;\r\n                await this.callLoadPosts(channelId, postId, type, perPage);\r\n            } else if (this.mounted) {\r\n                this.setState({autoRetryEnable: false});\r\n            }\r\n        } else {\r\n            if (this.mounted) {\r\n                this.setState({autoRetryEnable: true});\r\n            }\r\n\r\n            if (!this.state.autoRetryEnable) {\r\n                this.autoRetriesCount = 0;\r\n            }\r\n        }\r\n\r\n        return {error};\r\n    };\r\n\r\n    getOldestVisiblePostId = () => {\r\n        return getOldestPostId(this.props.postListIds || []);\r\n    };\r\n\r\n    getLatestVisiblePostId = () => {\r\n        return getLatestPostId(this.props.postListIds || []);\r\n    };\r\n\r\n    canLoadMorePosts = async (type: CanLoadMorePosts = PostRequestTypes.BEFORE_ID) => {\r\n        if (this.props.hasInaccessiblePosts) {\r\n            return;\r\n        }\r\n\r\n        if (!this.props.postListIds) {\r\n            return;\r\n        }\r\n\r\n        if (this.state.loadingOlderPosts || this.state.loadingNewerPosts) {\r\n            return;\r\n        }\r\n\r\n        if (this.extraPagesLoaded > MAX_EXTRA_PAGES_LOADED) {\r\n            // Prevent this from loading a lot of pages in a channel with only hidden messages\r\n            // Enable load more messages manual link\r\n            if (this.state.autoRetryEnable) {\r\n                this.setState({autoRetryEnable: false});\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (!this.props.atOldestPost && type === PostRequestTypes.BEFORE_ID) {\r\n            await this.getPostsBeforeAutoLoad();\r\n        } else if (!this.props.atLatestPost) {\r\n            // if all olderPosts are loaded load new ones\r\n            await this.getPostsAfter();\r\n        }\r\n\r\n        this.extraPagesLoaded += 1;\r\n    };\r\n\r\n    getPostsBefore = async () => {\r\n        if (this.state.loadingOlderPosts) {\r\n            return;\r\n        }\r\n\r\n        // Reset counter after \"Load more\" button click\r\n        if (!this.state.autoRetryEnable) {\r\n            this.extraPagesLoaded = 0;\r\n        }\r\n\r\n        const oldestPostId = this.getOldestVisiblePostId();\r\n        this.setState({loadingOlderPosts: true});\r\n        await this.callLoadPosts(this.props.channelId, oldestPostId, PostRequestTypes.BEFORE_ID, USER_SCROLL_POSTS_PER_PAGE);\r\n    };\r\n\r\n    getPostsAfter = async () => {\r\n        if (this.state.loadingNewerPosts) {\r\n            return;\r\n        }\r\n\r\n        // Reset counter after \"Load more\" button click\r\n        if (!this.state.autoRetryEnable) {\r\n            this.extraPagesLoaded = 0;\r\n        }\r\n\r\n        const latestPostId = this.getLatestVisiblePostId();\r\n        this.setState({loadingNewerPosts: true});\r\n        await this.callLoadPosts(this.props.channelId, latestPostId, PostRequestTypes.AFTER_ID, USER_SCROLL_POSTS_PER_PAGE);\r\n    };\r\n\r\n    getPostsBeforeAutoLoad = async () => {\r\n        if (this.state.loadingOlderPosts) {\r\n            return;\r\n        }\r\n\r\n        const oldestPostId = this.getOldestVisiblePostId();\r\n        this.setState({loadingOlderPosts: true});\r\n        await this.callLoadPosts(this.props.channelId, oldestPostId, PostRequestTypes.BEFORE_ID, AUTO_LOAD_POSTS_PER_PAGE);\r\n    };\r\n\r\n    render() {\r\n        if (!this.props.postListIds) {\r\n            return (\r\n                <LoadingScreen centered={true}/>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div\r\n                className='post-list-holder-by-time'\r\n                key={'postlist-' + this.props.channelId}\r\n            >\r\n                <div className='post-list__table'>\r\n                    <div\r\n                        id='virtualizedPostListContent'\r\n                        className='post-list__content'\r\n                    >\r\n                        <VirtPostList\r\n                            loadingNewerPosts={this.state.loadingNewerPosts}\r\n                            loadingOlderPosts={this.state.loadingOlderPosts}\r\n                            atOldestPost={this.props.atOldestPost}\r\n                            atLatestPost={this.props.atLatestPost}\r\n                            focusedPostId={this.props.focusedPostId}\r\n                            channelId={this.props.channelId}\r\n                            autoRetryEnable={this.state.autoRetryEnable}\r\n                            shouldStartFromBottomWhenUnread={this.props.shouldStartFromBottomWhenUnread}\r\n                            actions={this.actionsForPostList}\r\n                            postListIds={this.props.formattedPostIds}\r\n                            latestPostTimeStamp={this.props.latestPostTimeStamp}\r\n                            isMobileView={this.props.isMobileView}\r\n                            lastViewedAt={this.props.lastViewedAt}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {markChannelAsRead} from 'mattermost-redux/actions/channels';\r\nimport {RequestStatus} from 'mattermost-redux/constants';\r\nimport {getRecentPostsChunkInChannel, makeGetPostsChunkAroundPost, getUnreadPostsChunk, getPost, isPostsChunkIncludingUnreadsPosts, getLimitedViews} from 'mattermost-redux/selectors/entities/posts';\r\nimport {memoizeResult} from 'mattermost-redux/utils/helpers';\r\nimport {makePreparePostIdsForPostList} from 'mattermost-redux/utils/post_list';\r\n\r\nimport {updateNewMessagesAtInChannel} from 'actions/global_actions';\r\nimport {\r\n    loadPosts,\r\n    loadUnreads,\r\n    loadPostsAround,\r\n    syncPostsInChannel,\r\n    loadLatestPosts,\r\n} from 'actions/views/channel';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {getLatestPostId} from 'utils/post_utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport PostList from './post_list';\r\n\r\nconst isFirstLoad = (state: GlobalState, channelId: string) => !state.entities.posts.postsInChannel[channelId];\r\nconst memoizedGetLatestPostId = memoizeResult((postIds: string[]) => getLatestPostId(postIds));\r\n\r\n// This function is added as a fail safe for the channel sync issue we have.\r\n// When the user switches to a team for the first time we show the channel of previous team and then settle for the right channel after that\r\n// This causes the scroll correction etc an issue because post_list is not mounted for new channel instead it is updated\r\n\r\ninterface Props {\r\n    focusedPostId?: string;\r\n    unreadChunkTimeStamp?: number;\r\n    changeUnreadChunkTimeStamp: (lastViewedAt: number) => void;\r\n    channelId: string;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getPostsChunkAroundPost = makeGetPostsChunkAroundPost();\r\n    const preparePostIdsForPostList = makePreparePostIdsForPostList();\r\n\r\n    return function mapStateToProps(state: GlobalState, ownProps: Pick<Props, 'focusedPostId' | 'unreadChunkTimeStamp' | 'channelId'> & {shouldStartFromBottomWhenUnread: boolean}) {\r\n        let latestPostTimeStamp = 0;\r\n        let postIds: string[] | undefined;\r\n        let chunk;\r\n        let atLatestPost = false;\r\n        let atOldestPost = false;\r\n        let formattedPostIds: string[] | undefined;\r\n        const {focusedPostId, unreadChunkTimeStamp, channelId, shouldStartFromBottomWhenUnread} = ownProps;\r\n        const channelViewState = state.views.channel;\r\n        const lastViewedAt = channelViewState.lastChannelViewTime[channelId];\r\n        const isPrefetchingInProcess = channelViewState.channelPrefetchStatus[channelId] === RequestStatus.STARTED;\r\n        const limitedViews = getLimitedViews(state);\r\n        const hasInaccessiblePosts = Boolean(limitedViews.channels[channelId]) || limitedViews.channels[channelId] === 0;\r\n\r\n        const focusedPost = getPost(state, focusedPostId || '');\r\n\r\n        if (focusedPostId && focusedPost !== undefined) {\r\n            chunk = getPostsChunkAroundPost(state, focusedPostId, channelId);\r\n        } else if (unreadChunkTimeStamp && !shouldStartFromBottomWhenUnread) {\r\n            chunk = getUnreadPostsChunk(state, channelId, unreadChunkTimeStamp);\r\n        } else {\r\n            chunk = getRecentPostsChunkInChannel(state, channelId);\r\n        }\r\n\r\n        if (chunk) {\r\n            postIds = chunk.order;\r\n            atLatestPost = Boolean(chunk.recent);\r\n            atOldestPost = Boolean(chunk.oldest);\r\n        }\r\n\r\n        let shouldHideNewMessageIndicator = false;\r\n        if (unreadChunkTimeStamp != null) {\r\n            shouldHideNewMessageIndicator = shouldStartFromBottomWhenUnread && !isPostsChunkIncludingUnreadsPosts(state, chunk!, unreadChunkTimeStamp);\r\n        }\r\n\r\n        if (postIds) {\r\n            formattedPostIds = preparePostIdsForPostList(state, {postIds, lastViewedAt, indicateNewMessages: !shouldHideNewMessageIndicator});\r\n            if (postIds.length) {\r\n                const latestPostId = memoizedGetLatestPostId(postIds);\r\n                const latestPost = getPost(state, latestPostId);\r\n                latestPostTimeStamp = latestPost.create_at;\r\n            }\r\n        }\r\n\r\n        return {\r\n            lastViewedAt,\r\n            isFirstLoad: isFirstLoad(state, channelId),\r\n            formattedPostIds,\r\n            atLatestPost,\r\n            atOldestPost,\r\n            latestPostTimeStamp,\r\n            postListIds: postIds,\r\n            isPrefetchingInProcess,\r\n            shouldStartFromBottomWhenUnread,\r\n            isMobileView: getIsMobileView(state),\r\n            hasInaccessiblePosts,\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadUnreads,\r\n            loadPosts,\r\n            loadLatestPosts,\r\n            loadPostsAround,\r\n            syncPostsInChannel,\r\n            markChannelAsRead,\r\n            updateNewMessagesAtInChannel,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(makeMapStateToProps, mapDispatchToProps)(PostList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {Preferences} from 'utils/constants';\r\n\r\nimport PostList from './post_list';\r\n\r\ntype Props = {\r\n    lastViewedAt?: number;\r\n    channelLoading: boolean;\r\n    channelId: string;\r\n    focusedPostId?: string;\r\n    unreadScrollPosition: string;\r\n};\r\n\r\ninterface State {\r\n    unreadChunkTimeStamp?: number;\r\n    loaderForChangeOfPostsChunk: boolean;\r\n    channelLoading: boolean;\r\n    shouldStartFromBottomWhenUnread: boolean;\r\n}\r\n\r\nexport default class PostView extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        const shouldStartFromBottomWhenUnread = this.props.unreadScrollPosition === Preferences.UNREAD_SCROLL_POSITION_START_FROM_NEWEST;\r\n        this.state = {\r\n            unreadChunkTimeStamp: props.lastViewedAt,\r\n            shouldStartFromBottomWhenUnread,\r\n            loaderForChangeOfPostsChunk: false,\r\n            channelLoading: props.channelLoading,\r\n        };\r\n    }\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        if (state.unreadChunkTimeStamp === null && props.lastViewedAt) {\r\n            return {\r\n                unreadChunkTimeStamp: props.lastViewedAt,\r\n            };\r\n        }\r\n        if (props.channelLoading !== state.channelLoading) {\r\n            return {\r\n                unreadChunkTimeStamp: props.lastViewedAt,\r\n                channelLoading: props.channelLoading,\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    changeUnreadChunkTimeStamp = (unreadChunkTimeStamp: number) => {\r\n        this.setState({\r\n            unreadChunkTimeStamp,\r\n            loaderForChangeOfPostsChunk: true,\r\n        }, () => {\r\n            window.requestAnimationFrame(() => {\r\n                this.setState({\r\n                    loaderForChangeOfPostsChunk: false,\r\n                });\r\n            });\r\n        });\r\n    };\r\n\r\n    toggleShouldStartFromBottomWhenUnread = () => {\r\n        this.setState((state) => ({\r\n            loaderForChangeOfPostsChunk: true,\r\n            shouldStartFromBottomWhenUnread: !state.shouldStartFromBottomWhenUnread,\r\n        }), () => {\r\n            window.requestAnimationFrame(() => {\r\n                this.setState({\r\n                    loaderForChangeOfPostsChunk: false,\r\n                });\r\n            });\r\n        });\r\n    };\r\n\r\n    render() {\r\n        if (this.props.channelLoading || this.state.loaderForChangeOfPostsChunk) {\r\n            return (\r\n                <div id='post-list'>\r\n                    <LoadingScreen centered={true}/>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div\r\n                id='post-list'\r\n                role='main'\r\n            >\r\n                <PostList\r\n                    unreadChunkTimeStamp={this.state.unreadChunkTimeStamp}\r\n                    channelId={this.props.channelId}\r\n                    changeUnreadChunkTimeStamp={this.changeUnreadChunkTimeStamp}\r\n                    shouldStartFromBottomWhenUnread={this.state.shouldStartFromBottomWhenUnread}\r\n                    toggleShouldStartFromBottomWhenUnread={this.toggleShouldStartFromBottomWhenUnread}\r\n                    focusedPostId={this.props.focusedPostId}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Team, TeamMembership} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getUnreadScrollPositionPreference} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getTeamByName, getTeamMemberships} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport PostView from './post_view';\r\n\r\nexport const isChannelLoading = (params: RouteViewParams, channel?: Channel, team?: Team, teammate?: UserProfile, teamMemberships?: Record<string, TeamMembership>) => {\r\n    if (params.postid) {\r\n        return false;\r\n    }\r\n\r\n    const identifier = params.identifier?.toLowerCase();\r\n\r\n    if (channel && team) {\r\n        if (channel.type !== Constants.DM_CHANNEL && channel.name !== identifier) {\r\n            return true;\r\n        } else if (channel.type === Constants.DM_CHANNEL && teammate && identifier !== `@${teammate.username}`) {\r\n            return true;\r\n        }\r\n\r\n        const teamId = team.id;\r\n        if ((channel.team_id && channel.team_id !== teamId) || (teamMemberships && !teamMemberships[teamId])) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n};\r\n\r\ntype RouteViewParams = {\r\n    team?: string;\r\n    identifier?: string;\r\n    postid?: string;\r\n};\r\n\r\ntype Props = {channelId: string} & RouteComponentProps<RouteViewParams>\r\n\r\nfunction makeMapStateToProps() {\r\n    return function mapStateToProps(state: GlobalState, ownProps: Props) {\r\n        const params = ownProps.match?.params;\r\n        const team = getTeamByName(state, params?.team || '');\r\n        let teammate;\r\n\r\n        const channel = getChannel(state, ownProps.channelId);\r\n        let lastViewedAt = state.views.channel.lastChannelViewTime[ownProps.channelId];\r\n        if (channel) {\r\n            if (channel.type === Constants.DM_CHANNEL && channel.teammate_id) {\r\n                teammate = getUser(state, channel.teammate_id);\r\n            }\r\n            lastViewedAt = channel.last_post_at ? lastViewedAt : channel.last_post_at;\r\n        }\r\n\r\n        const teamMemberships = getTeamMemberships(state);\r\n        const channelLoading = isChannelLoading(params!, channel, team, teammate, teamMemberships);\r\n        const unreadScrollPosition = getUnreadScrollPositionPreference(state);\r\n        return {\r\n            unreadScrollPosition,\r\n            lastViewedAt,\r\n            channelLoading,\r\n        };\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(makeMapStateToProps)(PostView));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nconst onClickRefresh = () => {\r\n    location.reload();\r\n};\r\n\r\nconst TIME_TO_SHOW = 5000;\r\nconst TIME_TO_DISMISS = 2000;\r\n\r\ntype Props = {\r\n    updateWaitForLoader: (v: boolean) => void;\r\n}\r\n\r\nconst InputLoading = ({\r\n    updateWaitForLoader,\r\n}: Props) => {\r\n    const [showMessage, setShowMessage] = useState(false);\r\n\r\n    useEffect(() => {\r\n        let timeout = setTimeout(() => {\r\n            setShowMessage(true);\r\n            updateWaitForLoader(true);\r\n            timeout = setTimeout(() => {\r\n                updateWaitForLoader(false);\r\n            }, TIME_TO_DISMISS);\r\n        }, TIME_TO_SHOW);\r\n\r\n        return () => {\r\n            clearTimeout(timeout);\r\n            updateWaitForLoader(false);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div\r\n            className='AdvancedTextEditor__skeleton'\r\n        >\r\n            {showMessage && (\r\n                <>\r\n                    <FormattedMessage\r\n                        id='center_panel.input.cannot_load_component'\r\n                        defaultMessage='Something went wrong while loading the component. Please wait a moment, or try reloading the app.'\r\n                    />\r\n                    <button\r\n                        className='btn btn-tertiary channel-archived__close-btn'\r\n                        onClick={onClickRefresh}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='center_panel.reloadPage'\r\n                            defaultMessage='Reload'\r\n                        />\r\n                    </button>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InputLoading;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {lazy} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport deferComponentRender from 'components/deferComponentRender';\r\nimport {DropOverlayIdCenterChannel} from 'components/file_upload_overlay/file_upload_overlay';\r\nimport PostView from 'components/post_view';\r\n\r\nimport WebSocketClient from 'client/web_websocket_client';\r\n\r\nimport InputLoading from './input_loading';\r\n\r\nimport type {PropsFromRedux} from './index';\r\n\r\nconst ChannelHeader = makeAsyncComponent('ChannelHeader', lazy(() => import('components/channel_header')));\r\nconst FileUploadOverlay = makeAsyncComponent('FileUploadOverlay', lazy(() => import('components/file_upload_overlay')));\r\nconst ChannelBookmarks = makeAsyncComponent('ChannelBookmarks', lazy(() => import('components/channel_bookmarks')));\r\nconst AdvancedCreatePost = makeAsyncComponent('AdvancedCreatePost', lazy(() => import('components/advanced_create_post')));\r\nconst ChannelBanner = makeAsyncComponent('ChannelBanner', lazy(() => import('components/channel_banner/channel_banner')));\r\n\r\nexport type Props = PropsFromRedux & RouteComponentProps<{\r\n    postid?: string;\r\n}>;\r\n\r\ntype State = {\r\n    channelId: string;\r\n    url: string;\r\n    focusedPostId?: string;\r\n    deferredPostView: any;\r\n    waitForLoader: boolean;\r\n};\r\n\r\nexport default class ChannelView extends React.PureComponent<Props, State> {\r\n    public static createDeferredPostView = () => {\r\n        return deferComponentRender(\r\n            PostView,\r\n            <div\r\n                id='post-list'\r\n                className='a11y__region'\r\n                data-a11y-sort-order='1'\r\n                data-a11y-focus-child={true}\r\n                data-a11y-order-reversed={true}\r\n            />,\r\n        );\r\n    };\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        let updatedState = {};\r\n        const focusedPostId = props.match.params.postid;\r\n\r\n        if (props.match.url !== state.url && props.channelId !== state.channelId) {\r\n            updatedState = {deferredPostView: ChannelView.createDeferredPostView(), url: props.match.url, focusedPostId};\r\n        }\r\n\r\n        if (props.channelId !== state.channelId) {\r\n            updatedState = {...updatedState, channelId: props.channelId, focusedPostId};\r\n        }\r\n\r\n        if (focusedPostId && focusedPostId !== state.focusedPostId) {\r\n            updatedState = {...updatedState, focusedPostId};\r\n        }\r\n\r\n        if (Object.keys(updatedState).length) {\r\n            return updatedState;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    channelViewRef: React.RefObject<HTMLDivElement>;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            url: props.match.url,\r\n            channelId: props.channelId,\r\n            focusedPostId: props.match.params.postid,\r\n            deferredPostView: ChannelView.createDeferredPostView(),\r\n            waitForLoader: false,\r\n        };\r\n\r\n        this.channelViewRef = React.createRef();\r\n    }\r\n\r\n    onClickCloseChannel = () => {\r\n        this.props.goToLastViewedChannel();\r\n    };\r\n\r\n    onUpdateInputShowLoader = (v: boolean) => {\r\n        this.setState({waitForLoader: v});\r\n    };\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        // TODO: debounce\r\n        if (prevProps.channelId !== this.props.channelId && this.props.enableWebSocketEventScope) {\r\n            WebSocketClient.updateActiveChannel(this.props.channelId);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let createPost;\r\n        if (this.props.deactivatedChannel) {\r\n            createPost = (\r\n                <div\r\n                    className='post-create__container AdvancedTextEditor__ctr'\r\n                    id='post-create'\r\n                >\r\n                    <div\r\n                        className='channel-archived__message'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='channelView.archivedChannelWithDeactivatedUser'\r\n                            defaultMessage='You are viewing an archived channel with a <b>deactivated user</b>. New messages cannot be posted.'\r\n                            values={{\r\n                                b: (chunks: string) => <b>{chunks}</b>,\r\n                            }}\r\n                        />\r\n                        <button\r\n                            className='btn btn-primary channel-archived__close-btn'\r\n                            onClick={this.onClickCloseChannel}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='center_panel.archived.closeChannel'\r\n                                defaultMessage='Close Channel'\r\n                            />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } else if (this.props.channelIsArchived) {\r\n            createPost = (\r\n                <div\r\n                    className='post-create__container'\r\n                    id='post-create'\r\n                >\r\n                    <div\r\n                        id='channelArchivedMessage'\r\n                        className='channel-archived__message'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='channelView.archivedChannel'\r\n                            defaultMessage='You are viewing an <b>archived channel</b>. New messages cannot be posted.'\r\n                            values={{\r\n                                b: (chunks: string) => <b>{chunks}</b>,\r\n                            }}\r\n                        />\r\n                        <button\r\n                            className='btn btn-primary channel-archived__close-btn'\r\n                            onClick={this.onClickCloseChannel}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='center_panel.archived.closeChannel'\r\n                                defaultMessage='Close Channel'\r\n                            />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } else if (this.props.missingChannelRole || this.state.waitForLoader) {\r\n            createPost = <InputLoading updateWaitForLoader={this.onUpdateInputShowLoader}/>;\r\n        } else {\r\n            createPost = (\r\n                <div\r\n                    id='post-create'\r\n                    data-testid='post-create'\r\n                    className='post-create__container AdvancedTextEditor__ctr'\r\n                >\r\n                    <AdvancedCreatePost/>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const DeferredPostView = this.state.deferredPostView;\r\n\r\n        return (\r\n            <div\r\n                ref={this.channelViewRef}\r\n                id='app-content'\r\n                className='app__content'\r\n            >\r\n                <FileUploadOverlay\r\n                    overlayType='center'\r\n                    id={DropOverlayIdCenterChannel}\r\n                />\r\n                <ChannelHeader {...this.props}/>\r\n                {this.props.isChannelBookmarksEnabled && <ChannelBookmarks channelId={this.props.channelId}/>}\r\n                <ChannelBanner channelId={this.props.channelId}/>\r\n                <DeferredPostView\r\n                    channelId={this.props.channelId}\r\n                    focusedPostId={this.state.focusedPostId}\r\n                />\r\n                {createPost}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {\r\n    getCurrentChannel,\r\n    getMyChannelMembership,\r\n    isDeactivatedDirectChannel,\r\n} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\r\nimport {getRoles} from 'mattermost-redux/selectors/entities/roles_helpers';\r\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\r\nimport {isFirstAdmin} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {goToLastViewedChannel} from 'actions/views/channel';\r\n\r\nimport {getIsChannelBookmarksEnabled} from 'components/channel_bookmarks/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelView from './channel_view';\r\n\r\nfunction isMissingChannelRoles(state: GlobalState, channel?: Channel) {\r\n    const channelRoles = channel ? getMyChannelMembership(state, channel.id)?.roles || '' : '';\r\n    return !channelRoles.split(' ').some((v) => Boolean(getRoles(state)[v]));\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const channel = getCurrentChannel(state);\r\n\r\n    const config = getConfig(state);\r\n\r\n    const enableOnboardingFlow = config.EnableOnboardingFlow === 'true';\r\n    const enableWebSocketEventScope = config.FeatureFlagWebSocketEventScope === 'true';\r\n\r\n    const missingChannelRole = isMissingChannelRoles(state, channel);\r\n\r\n    return {\r\n        channelId: channel ? channel.id : '',\r\n        deactivatedChannel: channel ? isDeactivatedDirectChannel(state, channel.id) : false,\r\n        enableOnboardingFlow,\r\n        channelIsArchived: channel ? channel.delete_at !== 0 : false,\r\n        isCloud: getLicense(state).Cloud === 'true',\r\n        teamUrl: getCurrentRelativeTeamUrl(state),\r\n        isFirstAdmin: isFirstAdmin(state),\r\n        enableWebSocketEventScope,\r\n        isChannelBookmarksEnabled: getIsChannelBookmarksEnabled(state),\r\n        missingChannelRole,\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = ({\r\n    goToLastViewedChannel,\r\n});\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default withRouter(connector(ChannelView));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport ChannelView from 'components/channel_view/index';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants from 'utils/constants';\r\n\r\nexport interface Match {\r\n    params: {\r\n        identifier: string;\r\n        team: string;\r\n        postid?: string;\r\n        path: string;\r\n    };\r\n    url: string;\r\n}\r\n\r\nexport type MatchAndHistory = Pick<Props, 'match' | 'history'>\r\n\r\ntype Props = {\r\n    match: Match;\r\n    actions: {\r\n        onChannelByIdentifierEnter: (props: MatchAndHistory) => any;\r\n    };\r\n    history: any;\r\n};\r\n\r\nexport default class ChannelIdentifierRouter extends React.PureComponent<Props> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            prevProps: props,\r\n        };\r\n    }\r\n\r\n    private replaceUrlTimeout!: NodeJS.Timeout;\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (this.props.match.params.team !== prevProps.match.params.team ||\r\n            this.props.match.params.identifier !== prevProps.match.params.identifier) {\r\n            clearTimeout(this.replaceUrlTimeout);\r\n            this.props.actions.onChannelByIdentifierEnter(this.props);\r\n            this.replaceUrlIfPermalink();\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        this.props.actions.onChannelByIdentifierEnter(this.props);\r\n        this.replaceUrlIfPermalink();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        clearTimeout(this.replaceUrlTimeout);\r\n    }\r\n\r\n    replaceUrlIfPermalink = () => {\r\n        if (this.props.match.params.postid) {\r\n            this.replaceUrlTimeout = setTimeout(() => {\r\n                const channelUrl = this.props.match.url.split('/').slice(0, -1).join('/');\r\n                getHistory().replace(channelUrl);\r\n            }, Constants.PERMALINK_FADEOUT);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        return <ChannelView/>;\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {onChannelByIdentifierEnter} from './actions';\r\nimport ChannelIdentifierRouter from './channel_identifier_router';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            onChannelByIdentifierEnter,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(null, mapDispatchToProps)(ChannelIdentifierRouter));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {lazy} from 'react';\r\nimport {Route, Switch, Redirect} from 'react-router-dom';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport ChannelIdentifierRouter from 'components/channel_layout/channel_identifier_router';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {SCHEDULED_POST_URL_SUFFIX} from 'utils/constants';\r\nimport {IDENTIFIER_PATH_PATTERN, ID_PATH_PATTERN, TEAM_NAME_PATH_PATTERN} from 'utils/path';\r\n\r\nimport type {OwnProps, PropsFromRedux} from './index';\r\n\r\nconst MobileChannelHeader = makeAsyncComponent('MobileChannelHeader', lazy(() => import('components/mobile_channel_header')));\r\nconst GlobalThreads = makeAsyncComponent('GlobalThreads', lazy(() => import('components/threading/global_threads')),\r\n    (\r\n        <div className='app__content'>\r\n            <LoadingScreen/>\r\n        </div>\r\n    ),\r\n);\r\nconst Drafts = makeAsyncComponent('Drafts', lazy(() => import('components/drafts')),\r\n    (\r\n        <div className='app__content'>\r\n            <LoadingScreen/>\r\n        </div>\r\n    ),\r\n);\r\nconst PermalinkView = makeAsyncComponent('PermalinkView', lazy(() => import('components/permalink_view')));\r\nconst PlaybookRunner = makeAsyncComponent('PlaybookRunner', lazy(() => import('components/channel_layout/playbook_runner')));\r\n\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\ntype State = {\r\n    returnTo: string;\r\n    lastReturnTo: string;\r\n};\r\n\r\nexport default class CenterChannel extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            returnTo: '',\r\n            lastReturnTo: '',\r\n        };\r\n    }\r\n\r\n    static getDerivedStateFromProps(nextProps: Props, prevState: State) {\r\n        if (prevState.lastReturnTo !== nextProps.location.pathname && nextProps.location.pathname.includes('/pl/')) {\r\n            return {\r\n                lastReturnTo: nextProps.location.pathname,\r\n                returnTo: prevState.lastReturnTo,\r\n            };\r\n        }\r\n        return {lastReturnTo: nextProps.location.pathname};\r\n    }\r\n\r\n    async componentDidMount() {\r\n        const {actions} = this.props;\r\n        await actions.getProfiles();\r\n    }\r\n\r\n    render() {\r\n        const {lastChannelPath, isCollapsedThreadsEnabled, isMobileView} = this.props;\r\n        const url = this.props.match.url;\r\n\r\n        return (\r\n            <div\r\n                key='inner-wrap'\r\n                className={classNames('inner-wrap', 'channel__wrap', {\r\n                    'move--right': this.props.lhsOpen,\r\n                    'move--left': this.props.rhsOpen,\r\n                    'move--left-small': this.props.rhsMenuOpen,\r\n                })}\r\n            >\r\n                {isMobileView && <MobileChannelHeader/>}\r\n                <div className='row main'>\r\n                    <Switch>\r\n                        <Route\r\n                            path={`${url}/pl/:postid(${ID_PATH_PATTERN})`}\r\n                            render={(props) => (\r\n                                <PermalinkView\r\n                                    {...props}\r\n                                    returnTo={this.state.returnTo}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            path={`/:team(${TEAM_NAME_PATH_PATTERN})/:path(channels|messages)/:identifier(${IDENTIFIER_PATH_PATTERN})/:postid(${ID_PATH_PATTERN})?`}\r\n                            component={ChannelIdentifierRouter}\r\n                        />\r\n                        <Route\r\n                            path={`/:team(${TEAM_NAME_PATH_PATTERN})/_playbooks/:playbookId(${ID_PATH_PATTERN})/run`}\r\n                        >\r\n                            <PlaybookRunner/>\r\n                        </Route>\r\n                        {isCollapsedThreadsEnabled ? (\r\n                            <Route\r\n                                path={`/:team(${TEAM_NAME_PATH_PATTERN})/threads/:threadIdentifier(${ID_PATH_PATTERN})?`}\r\n                                component={GlobalThreads}\r\n                            />\r\n                        ) : null}\r\n                        <Route\r\n                            path={`/:team(${TEAM_NAME_PATH_PATTERN})/drafts`}\r\n                            component={Drafts}\r\n                        />\r\n                        <Route\r\n                            path={`/:team(${TEAM_NAME_PATH_PATTERN})/${SCHEDULED_POST_URL_SUFFIX}`}\r\n                            component={Drafts}\r\n                        />\r\n\r\n                        <Redirect to={lastChannelPath}/>\r\n                    </Switch>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getProfiles} from 'mattermost-redux/actions/users';\r\nimport {getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getTeamByName} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {getIsLhsOpen} from 'selectors/lhs';\r\nimport {getLastViewedChannelNameByTeamName, getLastViewedTypeByTeamName, getPreviousTeamId, getPreviousTeamLastViewedType} from 'selectors/local_storage';\r\nimport {getIsRhsOpen, getIsRhsMenuOpen} from 'selectors/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {PreviousViewedTypes} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport CenterChannel from './center_channel';\r\n\r\ntype Params = {\r\n    team: string;\r\n}\r\n\r\nexport type OwnProps = RouteComponentProps<Params>;\r\n\r\nconst mapStateToProps = (state: GlobalState, ownProps: OwnProps) => {\r\n    const lastViewedType = getLastViewedTypeByTeamName(state, ownProps.match.params.team);\r\n    let channelName = getLastViewedChannelNameByTeamName(state, ownProps.match.params.team);\r\n\r\n    const previousTeamId = getPreviousTeamId(state);\r\n    const team = getTeamByName(state, ownProps.match.params.team);\r\n\r\n    let previousTeamLastViewedType;\r\n\r\n    if (previousTeamId !== team?.id) {\r\n        previousTeamLastViewedType = getPreviousTeamLastViewedType(state);\r\n    }\r\n\r\n    if (!channelName) {\r\n        channelName = getRedirectChannelNameForTeam(state, team!.id);\r\n    }\r\n\r\n    let lastChannelPath;\r\n    if (isCollapsedThreadsEnabled(state) && (previousTeamLastViewedType === PreviousViewedTypes.THREADS || lastViewedType === PreviousViewedTypes.THREADS)) {\r\n        lastChannelPath = `${ownProps.match.url}/threads`;\r\n    } else {\r\n        lastChannelPath = `${ownProps.match.url}/channels/${channelName}`;\r\n    }\r\n\r\n    return {\r\n        lastChannelPath,\r\n        lhsOpen: getIsLhsOpen(state),\r\n        rhsOpen: getIsRhsOpen(state),\r\n        rhsMenuOpen: getIsRhsMenuOpen(state),\r\n        isCollapsedThreadsEnabled: isCollapsedThreadsEnabled(state),\r\n        currentUserId: getCurrentUserId(state),\r\n        isMobileView: getIsMobileView(state),\r\n    };\r\n};\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getProfiles,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default withRouter(connector(CenterChannel));\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useEffect} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\nimport {useHistory, useLocation} from 'react-router-dom';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport InvitationModal from 'components/invitation_modal';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\ninterface ActionMap {\r\n    [key: string]: ModalData<any>;\r\n}\r\n\r\nfunction QueryParamActionController() {\r\n    const location = useLocation();\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n\r\n    const actionMap: ActionMap = {\r\n        open_invitation_modal: {\r\n            modalId: ModalIdentifiers.INVITATION,\r\n            dialogType: InvitationModal,\r\n        },\r\n    };\r\n\r\n    useEffect(() => {\r\n        const searchParams = new URLSearchParams(location.search);\r\n        const action = searchParams.get('action');\r\n\r\n        if (action && actionMap[action]) {\r\n            dispatch(openModal(actionMap[action]));\r\n\r\n            // Delete the action after it's been invoked so that it's not locked for subsequent refreshes\r\n            searchParams.delete('action');\r\n            history.replace({\r\n                search: searchParams.toString(),\r\n            });\r\n        }\r\n    }, [location, actionMap]);\r\n\r\n    return null;\r\n}\r\n\r\nexport default QueryParamActionController;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\r\nimport {memoizeResult} from 'mattermost-redux/utils/helpers';\r\n\r\nenum Priority {\r\n    high = 1,\r\n    medium,\r\n    low\r\n}\r\n\r\nenum PrefetchLimits {\r\n    mentionMax = 10,\r\n    unreadMax = 20,\r\n}\r\n\r\n// function to return a queue obj with priotiy as key and array of channelIds as values.\r\n// high priority has channels with mentions\r\n// medium priority has channels with unreads\r\n// <10 unread channels. Prefetch everything.\r\n// 10-20 unread. Prefetch only mentions, capped to 10.\r\n// >20 unread. Don't prefetch anything.\r\nexport const prefetchQueue = memoizeResult((\r\n    unreadChannels: Channel[],\r\n    memberships: RelationOneToOne<Channel, ChannelMembership>,\r\n    collapsedThreads: boolean,\r\n) => {\r\n    const unreadChannelsCount = unreadChannels.length;\r\n    let result: {\r\n        1: string[];\r\n        2: string[];\r\n        3: string[];\r\n    } = {\r\n        [Priority.high]: [], // 1 being high priority requests\r\n        [Priority.medium]: [],\r\n        [Priority.low]: [], //TODO: add chanenls such as fav.\r\n    };\r\n    if (!unreadChannelsCount || unreadChannelsCount > PrefetchLimits.unreadMax) {\r\n        return result;\r\n    }\r\n    for (const channel of unreadChannels) {\r\n        const channelId = channel.id;\r\n        const membership = memberships[channelId];\r\n\r\n        if (unreadChannelsCount >= PrefetchLimits.mentionMax && result[Priority.high].length >= PrefetchLimits.mentionMax) {\r\n            break;\r\n        }\r\n\r\n        // TODO We check for muted channels 3 times here: getUnreadChannels checks it, this checks it, and the mark_unread\r\n        // check below is equivalent to checking if its muted.\r\n        if (membership && !isChannelMuted(membership)) {\r\n            if (collapsedThreads ? membership.mention_count_root : membership.mention_count) {\r\n                result = {\r\n                    ...result,\r\n                    [Priority.high]: [...result[Priority.high], channelId],\r\n                };\r\n            } else if (\r\n                membership.notify_props &&\r\n                membership.notify_props.mark_unread !== 'mention' &&\r\n                unreadChannelsCount < PrefetchLimits.mentionMax\r\n            ) {\r\n                result = {\r\n                    ...result,\r\n                    [Priority.medium]: [...result[Priority.medium], channelId],\r\n                };\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n});\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport PQueue from 'p-queue';\r\nimport React from 'react';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport {loadProfilesForSidebar} from 'actions/user_actions';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nconst queue = new PQueue({concurrency: 2});\r\n\r\ntype Props = {\r\n    currentChannelId: string;\r\n    prefetchQueueObj: Record<string, string[]>;\r\n    prefetchRequestStatus: Record<string, string>;\r\n\r\n    // Whether or not the categories in the sidebar have been loaded for the current team\r\n    sidebarLoaded: boolean;\r\n\r\n    unreadChannels: Channel[];\r\n\r\n    actions: {\r\n        prefetchChannelPosts: (channelId: string, delay?: number) => Promise<ActionResult>;\r\n    };\r\n}\r\n\r\n/*\r\n    This component is responsible for prefetching data. As of now component only fetches for channel posts based on the below set of rules.\r\n    * Priority order:\r\n        Fetches channel posts 2 at a time, with mentions followed channels with unreads.\r\n\r\n    * Conditions for prefetching posts:\r\n        On load of webapp\r\n        On socket reconnect or system comes from sleep\r\n        On new message in a channel where user has not visited in the present session\r\n        On addition of user to a channel/GM\r\n        On Team switch\r\n\r\n        In order to solve the above conditions the component looks for changes in selector unread channels.\r\n        if there is a change in unreads selector, then component clears existing queue as it can be obselete\r\n        i.e there can be new mentions and we need to prioritise instead of unreads so, contructs a new queue\r\n        with dispacthes of unreads posts for channels which do not have prefetched requests.\r\n\r\n    * other changes:\r\n        Adds current channel posts requests to be dispatched as soon as it is set in redux state instead of dispatching it from actions down the hierarchy. Otherwise couple of prefetching requests are sent before the postlist makes a request for posts.\r\n        Add a jitter(0-1sec) for delaying post requests in case of a new message in open/private channels. This is to prevent a case when all clients request messages when new post is made in a channel with thousands of users.\r\n*/\r\nexport default class DataPrefetch extends React.PureComponent<Props> {\r\n    private prefetchTimeout?: number;\r\n\r\n    async componentDidUpdate(prevProps: Props) {\r\n        const {currentChannelId, prefetchQueueObj, sidebarLoaded} = this.props;\r\n        if (sidebarLoaded && !prevProps.sidebarLoaded) {\r\n            loadProfilesForSidebar();\r\n        }\r\n\r\n        if (currentChannelId && sidebarLoaded && (!prevProps.currentChannelId || !prevProps.sidebarLoaded)) {\r\n            queue.add(async () => this.prefetchPosts(currentChannelId));\r\n            this.prefetchData();\r\n        } else if (prevProps.prefetchQueueObj !== prefetchQueueObj) {\r\n            clearTimeout(this.prefetchTimeout);\r\n            await queue.clear();\r\n            this.prefetchData();\r\n        }\r\n    }\r\n\r\n    public prefetchPosts = (channelId: string) => {\r\n        let delay;\r\n        const channel = this.props.unreadChannels.find((unreadChannel) => channelId === unreadChannel.id);\r\n        if (channel && (channel.type === Constants.PRIVATE_CHANNEL || channel.type === Constants.OPEN_CHANNEL)) {\r\n            const isLatestPostInLastMin = (Date.now() - channel.last_post_at) <= 1000;\r\n            if (isLatestPostInLastMin) {\r\n                delay = Math.random() * 1000; // 1ms - 1000ms random wait to not choke server\r\n            }\r\n        }\r\n        return this.props.actions.prefetchChannelPosts(channelId, delay);\r\n    };\r\n\r\n    private prefetchData = () => {\r\n        const {prefetchRequestStatus, prefetchQueueObj} = this.props;\r\n        for (const priority in prefetchQueueObj) {\r\n            if (!Object.hasOwn(prefetchQueueObj, priority)) {\r\n                continue;\r\n            }\r\n\r\n            const priorityQueue = prefetchQueueObj[priority];\r\n            for (const channelId of priorityQueue) {\r\n                if (!Object.hasOwn(prefetchRequestStatus, channelId)) {\r\n                    queue.add(async () => this.prefetchPosts(channelId));\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getCurrentChannelId, getUnreadChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getMyChannelMemberships} from 'mattermost-redux/selectors/entities/common';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport {prefetchChannelPosts} from 'actions/views/channel';\r\nimport {getCategoriesForCurrentTeam} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport {prefetchQueue} from './actions';\r\nimport DataPrefetch from './data_prefetch';\r\n\r\nfunction isSidebarLoaded(state: GlobalState) {\r\n    return getCategoriesForCurrentTeam(state).length > 0;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const lastUnreadChannel = state.views.channel.lastUnreadChannel;\r\n    const memberships = getMyChannelMemberships(state);\r\n    const unreadChannels = getUnreadChannels(state, lastUnreadChannel);\r\n    const prefetchQueueObj = prefetchQueue(unreadChannels, memberships, isCollapsedThreadsEnabled(state));\r\n    const prefetchRequestStatus = state.views.channel.channelPrefetchStatus;\r\n\r\n    return {\r\n        currentChannelId: getCurrentChannelId(state),\r\n        prefetchQueueObj,\r\n        prefetchRequestStatus,\r\n        sidebarLoaded: isSidebarLoaded(state),\r\n        unreadChannels,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            prefetchChannelPosts,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataPrefetch);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {HTMLAttributes} from 'react';\r\nimport React, {useRef} from 'react';\r\n\r\nimport {DEFAULT_LHS_WIDTH, CssVarKeyForResizable, ResizeDirection} from '../constants';\r\nimport ResizableDivider from '../resizable_divider';\r\n\r\ninterface Props extends HTMLAttributes<'div'> {\r\n    children: React.ReactNode;\r\n}\r\n\r\nfunction ResizableLhs({\r\n    children,\r\n    id,\r\n    className,\r\n}: Props) {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    return (\r\n        <div\r\n            id={id}\r\n            className={className}\r\n            ref={containerRef}\r\n        >\r\n            {children}\r\n            <ResizableDivider\r\n                name={'lhsResizeHandle'}\r\n                globalCssVar={CssVarKeyForResizable.LHS}\r\n                defaultWidth={DEFAULT_LHS_WIDTH}\r\n                dir={ResizeDirection.LEFT}\r\n                containerRef={containerRef}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ResizableLhs;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport {\r\n    LightbulbOutlineIcon,\r\n    AccountPlusOutlineIcon,\r\n    AccountMultiplePlusOutlineIcon,\r\n    SettingsOutlineIcon,\r\n    AccountMultipleOutlineIcon,\r\n    ExitToAppIcon,\r\n    MessagePlusOutlineIcon,\r\n    PlusIcon,\r\n    MonitorAccountIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getCloudSubscription, getSubscriptionProduct} from 'mattermost-redux/selectors/entities/cloud';\r\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveICurrentTeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles_helpers';\r\nimport {getJoinableTeamIds} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\nimport {getMainMenuPluginComponents} from 'selectors/plugins';\r\n\r\nimport AddGroupsToTeamModal from 'components/add_groups_to_team_modal';\r\nimport useGetUsageDeltas from 'components/common/hooks/useGetUsageDeltas';\r\nimport InvitationModal from 'components/invitation_modal';\r\nimport LeaveTeamModal from 'components/leave_team_modal';\r\nimport * as Menu from 'components/menu';\r\nimport TeamGroupsManageModal from 'components/team_groups_manage_modal';\r\nimport TeamMembersModal from 'components/team_members_modal';\r\nimport TeamSettingsModal from 'components/team_settings_modal';\r\nimport RestrictedIndicator from 'components/widgets/menu/menu_items/restricted_indicator';\r\n\r\nimport {FREEMIUM_TO_ENTERPRISE_TRIAL_LENGTH_DAYS} from 'utils/cloud_utils';\r\nimport {LicenseSkus, ModalIdentifiers, MattermostFeatures, CloudProducts} from 'utils/constants';\r\nimport {isCloudLicense} from 'utils/license_utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\ninterface Props {\r\n    currentTeam: Team;\r\n}\r\n\r\nexport default function SidebarTeamMenu(props: Props) {\r\n    const license = useSelector(getLicense);\r\n    const config = useSelector(getConfig);\r\n\r\n    const havePermissionToCreateTeam = useSelector((state: GlobalState) => haveISystemPermission(state, {permission: Permissions.CREATE_TEAM}));\r\n    const havePermissionToManageTeam = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.MANAGE_TEAM));\r\n    const havePermissionToAddUserToTeam = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.ADD_USER_TO_TEAM));\r\n    const havePermissionToInviteGuest = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.INVITE_GUEST));\r\n    const isCloud = isCloudLicense(license);\r\n    const isGuestAccessEnabled = config?.EnableGuestAccounts === 'true';\r\n    const isTeamGroupConstrained = Boolean(props.currentTeam?.group_constrained);\r\n    const isLicensedForLDAPGroups = license?.LDAPGroups === 'true';\r\n    const experimentalPrimaryTeam = config.ExperimentalPrimaryTeam;\r\n    const joinableTeams = useSelector(getJoinableTeamIds);\r\n    const haveMoreJoinableTeams = joinableTeams?.length > 0;\r\n    const canJoinAnotherTeam = !experimentalPrimaryTeam && haveMoreJoinableTeams;\r\n\r\n    const tooltipText = props.currentTeam.description ? props.currentTeam.description : props.currentTeam.display_name;\r\n\r\n    return (\r\n        <Menu.Container\r\n            menuButton={{\r\n                id: 'sidebarTeamMenuButton',\r\n                class: 'btn btn-sm btn-quaternary btn-inverted',\r\n                children: (\r\n                    <>\r\n                        <span>{props.currentTeam.display_name}</span>\r\n                        <i className='icon icon-chevron-down'/>\r\n                    </>\r\n                ),\r\n            }}\r\n            menuButtonTooltip={{\r\n                text: tooltipText,\r\n            }}\r\n            menu={{\r\n                id: 'sidebarTeamMenu',\r\n            }}\r\n        >\r\n            {((isGuestAccessEnabled && havePermissionToInviteGuest) || havePermissionToAddUserToTeam) && (\r\n                <InvitePeopleMenuItem/>\r\n            )}\r\n            {isTeamGroupConstrained && isLicensedForLDAPGroups && havePermissionToManageTeam && (\r\n                <AddGroupsToTeamMenuItem/>\r\n            )}\r\n            {havePermissionToManageTeam && (\r\n                <TeamSettingsMenuItem/>\r\n            )}\r\n            <ManageViewMembersMenuItem/>\r\n            {(isTeamGroupConstrained && isLicensedForLDAPGroups && havePermissionToManageTeam) && (\r\n                <ManageGroupsMenuItem\r\n                    teamID={props.currentTeam.id}\r\n                />\r\n            )}\r\n            {(!isTeamGroupConstrained && experimentalPrimaryTeam !== props.currentTeam.name) && (\r\n                <LeaveTeamMenuItem/>\r\n            )}\r\n            {(canJoinAnotherTeam || havePermissionToCreateTeam) && <Menu.Separator/>}\r\n            {canJoinAnotherTeam &&\r\n                <JoinAnotherTeamMenuItem/>\r\n            }\r\n            {havePermissionToCreateTeam && (\r\n                <CreateTeamMenuItem\r\n                    isCloud={isCloud}\r\n                />\r\n            )}\r\n            <Menu.Separator/>\r\n            <LearnAboutTeamsMenuItem/>\r\n            <PluginMenuItems/>\r\n        </Menu.Container>\r\n    );\r\n}\r\n\r\nfunction InvitePeopleMenuItem(props: Menu.FirstMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.INVITATION,\r\n            dialogType: InvitationModal,\r\n            dialogProps: {\r\n                focusOriginElement: 'sidebarTeamMenuButton',\r\n            },\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            onClick={handleClick}\r\n            leadingElement={(\r\n                <AccountMultiplePlusOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            labels={(\r\n                <>\r\n                    <FormattedMessage\r\n                        id='sidebarLeft.teamMenu.invitePeopleMenuItem.primaryLabel'\r\n                        defaultMessage='Invite people'\r\n                    />\r\n                    <FormattedMessage\r\n                        id='sidebarLeft.teamMenu.invitePeopleMenuItem.secondaryLabel'\r\n                        defaultMessage='Add or invite people to the team'\r\n                    />\r\n                </>\r\n            )}\r\n            aria-haspopup='dialog'\r\n            {...props}\r\n        />\r\n    );\r\n}\r\n\r\nfunction AddGroupsToTeamMenuItem(props: Menu.FirstMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.ADD_GROUPS_TO_TEAM,\r\n            dialogType: AddGroupsToTeamModal,\r\n            dialogProps: {\r\n                focusOriginElement: 'sidebarTeamMenuButton',\r\n            },\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            onClick={handleClick}\r\n            leadingElement={(\r\n                <AccountPlusOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.addGroupsToTeamMenuItem.primaryLabel'\r\n                    defaultMessage='Add groups'\r\n                />\r\n            )}\r\n            aria-haspopup='dialog'\r\n            {...props}\r\n        />\r\n    );\r\n}\r\n\r\nfunction TeamSettingsMenuItem(props: Menu.FirstMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.TEAM_SETTINGS,\r\n            dialogType: TeamSettingsModal,\r\n            dialogProps: {\r\n                focusOriginElement: 'sidebarTeamMenuButton',\r\n            },\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <SettingsOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.teamSettingsMenuItem.primaryLabel'\r\n                    defaultMessage='Team settings'\r\n                />\r\n            )}\r\n            aria-haspopup='dialog'\r\n            {...props}\r\n        />\r\n    );\r\n}\r\n\r\nfunction ManageViewMembersMenuItem(props: Menu.FirstMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const havePermissionToRemoveUserFromTeam = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.REMOVE_USER_FROM_TEAM));\r\n    const havePermissionToManageTeamRoles = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.MANAGE_TEAM_ROLES));\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.TEAM_MEMBERS,\r\n            dialogType: TeamMembersModal,\r\n            dialogProps: {\r\n                focusOriginElement: 'sidebarTeamMenuButton',\r\n            },\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    let label = (\r\n        <FormattedMessage\r\n            id='sidebarLeft.teamMenu.viewMembersMenuItem.primaryLabel'\r\n            defaultMessage='View members'\r\n        />\r\n    );\r\n    if (havePermissionToRemoveUserFromTeam && havePermissionToManageTeamRoles) {\r\n        label = (\r\n            <FormattedMessage\r\n                id='sidebarLeft.teamMenu.manageMembersMenuItem.primaryLabel'\r\n                defaultMessage='Manage members'\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <AccountMultipleOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={label}\r\n            aria-haspopup='dialog'\r\n            {...props}\r\n        />\r\n    );\r\n}\r\n\r\ninterface ManageGroupsMenuItemProps {\r\n    teamID: Team['id'];\r\n}\r\n\r\nfunction ManageGroupsMenuItem({teamID}: ManageGroupsMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.MANAGE_TEAM_GROUPS,\r\n            dialogType: TeamGroupsManageModal,\r\n            dialogProps: {\r\n                teamID,\r\n            },\r\n        }));\r\n    }, [dispatch, teamID]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <MonitorAccountIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.manageGroupsMenuItem.primaryLabel'\r\n                    defaultMessage='Manage groups'\r\n                />\r\n            )}\r\n            aria-haspopup='dialog'\r\n        />\r\n    );\r\n}\r\n\r\nfunction LeaveTeamMenuItem() {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.LEAVE_TEAM,\r\n            dialogType: LeaveTeamModal,\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <ExitToAppIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            isDestructive={true}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.leaveTeamMenuItem.primaryLabel'\r\n                    defaultMessage='Leave team'\r\n                />\r\n            )}\r\n            aria-haspopup='dialog'\r\n        />\r\n    );\r\n}\r\n\r\nfunction JoinAnotherTeamMenuItem() {\r\n    const history = useHistory();\r\n\r\n    const handleClick = useCallback(() => {\r\n        history.push('/select_team');\r\n    }, [history]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <MessagePlusOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.joinAnotherTeamMenuItem.primaryLabel'\r\n                    defaultMessage='Join another team'\r\n                />\r\n            )}\r\n        />\r\n    );\r\n}\r\n\r\ninterface CreateTeamMenuItemProps {\r\n    isCloud: boolean;\r\n}\r\n\r\nfunction CreateTeamMenuItem({isCloud}: CreateTeamMenuItemProps) {\r\n    const history = useHistory();\r\n\r\n    const cloudSubscription = useSelector(getCloudSubscription);\r\n    const subscriptionProduct = useSelector(getSubscriptionProduct);\r\n    const isFreeTrial = isCloud && cloudSubscription?.is_free_trial === 'true';\r\n    const isStarterFree = isCloud && subscriptionProduct?.sku === CloudProducts.STARTER;\r\n    const usageDeltas = useGetUsageDeltas();\r\n    const isTeamsLimitReached = isStarterFree && !isFreeTrial && usageDeltas.teams.active >= 0;\r\n    const isTeamCreateRestricted = isCloud && (isFreeTrial || isTeamsLimitReached);\r\n\r\n    const handleClick = useCallback(() => {\r\n        if (isTeamsLimitReached || isTeamCreateRestricted) {\r\n            return;\r\n        }\r\n\r\n        history.push('/create_team');\r\n    }, [history, isTeamsLimitReached]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <PlusIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.createTeamMenuItem.primaryLabel'\r\n                    defaultMessage='Create a team'\r\n                />\r\n            )}\r\n            trailingElements={isTeamCreateRestricted && <RestrictedIndicatorForCreateTeam isFreeTrial={isFreeTrial}/>}\r\n        />\r\n    );\r\n}\r\n\r\nfunction RestrictedIndicatorForCreateTeam({isFreeTrial}: {isFreeTrial: boolean}) {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <RestrictedIndicator\r\n            feature={MattermostFeatures.CREATE_MULTIPLE_TEAMS}\r\n            minimumPlanRequiredForFeature={LicenseSkus.Professional}\r\n            blocked={!isFreeTrial}\r\n            tooltipMessage={formatMessage({\r\n                id: 'navbar_dropdown.create.tooltip.cloudFreeTrial',\r\n                defaultMessage: 'During your trial you are able to create multiple teams. These teams will be archived after your trial.',\r\n            })}\r\n            titleAdminPreTrial={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.titleAdminPreTrial',\r\n                defaultMessage: 'Try unlimited teams with a free trial',\r\n            })}\r\n            messageAdminPreTrial={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.messageAdminPreTrial',\r\n                defaultMessage: 'Create unlimited teams with one of our paid plans. Get the full experience of Enterprise when you start a free, {trialLength} day trial.',\r\n            },\r\n            {\r\n                trialLength: FREEMIUM_TO_ENTERPRISE_TRIAL_LENGTH_DAYS,\r\n            },\r\n            )}\r\n            titleAdminPostTrial={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.titleAdminPostTrial',\r\n                defaultMessage: 'Upgrade to create unlimited teams',\r\n            })}\r\n            messageAdminPostTrial={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.messageAdminPostTrial',\r\n                defaultMessage: \"Multiple teams allow for context-specific spaces that are more attuned to your and your teams' needs. Upgrade to the Professional plan to create unlimited teams.\",\r\n            })}\r\n            titleEndUser={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.titleEndUser',\r\n                defaultMessage: 'Multiple teams available in paid plans',\r\n            })}\r\n            messageEndUser={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.messageEndUser',\r\n                defaultMessage: \"Multiple teams allow for context-specific spaces that are more attuned to your teams' needs.\",\r\n            })}\r\n        />\r\n    );\r\n}\r\n\r\nconst MATTERMOST_ACADEMY_TEAM_TRAINING_LINK = 'https://mattermost.com/pl/mattermost-academy-team-training';\r\n\r\nfunction LearnAboutTeamsMenuItem() {\r\n    const handleClick = useCallback(() => {\r\n        window.open(MATTERMOST_ACADEMY_TEAM_TRAINING_LINK, '_blank', 'noopener noreferrer');\r\n    }, []);\r\n\r\n    return (\r\n        <Menu.Item\r\n            className='learnAboutTeamsMenuItem'\r\n            onClick={handleClick}\r\n            leadingElement={(\r\n                <LightbulbOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.learnAboutTeamsMenuItem.primaryLabel'\r\n                    defaultMessage='Learn about teams'\r\n                />\r\n            )}\r\n        />\r\n    );\r\n}\r\n\r\nfunction PluginMenuItems() {\r\n    const pluginInMainMenu = useSelector(getMainMenuPluginComponents);\r\n\r\n    if (pluginInMainMenu.length > 0) {\r\n        const pluginMenuItems = pluginInMainMenu.map((plugin) => {\r\n            function handleClick() {\r\n                if (plugin.action) {\r\n                    plugin.action();\r\n                }\r\n            }\r\n\r\n            return (\r\n                <Menu.Item\r\n                    id={`${plugin.id}_pluginmenuitem`}\r\n                    key={plugin.id}\r\n                    onClick={handleClick}\r\n                    labels={<span>{plugin.text}</span>}\r\n                />\r\n            );\r\n        });\r\n\r\n        return (\r\n            <>\r\n                <Menu.Separator/>\r\n                {pluginMenuItems}\r\n            </>\r\n        );\r\n    }\r\n\r\n    return null;\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport SidebarBrowseOrAddChannelMenu from './sidebar_browse_or_add_channel_menu';\r\nimport SidebarTeamMenu from './sidebar_team_menu';\r\n\r\nimport './sidebar_header.scss';\r\n\r\nexport type Props = {\r\n    showNewChannelModal: () => void;\r\n    showMoreChannelsModal: () => void;\r\n    showCreateUserGroupModal: () => void;\r\n    invitePeopleModal: () => void;\r\n    showCreateCategoryModal: () => void;\r\n    canCreateChannel: boolean;\r\n    canJoinPublicChannel: boolean;\r\n    handleOpenDirectMessagesModal: () => void;\r\n    unreadFilterEnabled: boolean;\r\n    canCreateCustomGroups: boolean;\r\n}\r\n\r\nconst SidebarHeader = (props: Props) => {\r\n    const currentTeam = useSelector(getCurrentTeam);\r\n\r\n    if (!currentTeam) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className='sidebarHeaderContainer'>\r\n            <SidebarTeamMenu currentTeam={currentTeam}/>\r\n            {(props.canCreateChannel || props.canJoinPublicChannel) && (\r\n                <SidebarBrowseOrAddChannelMenu\r\n                    canCreateChannel={props.canCreateChannel}\r\n                    onCreateNewChannelClick={props.showNewChannelModal}\r\n                    canJoinPublicChannel={props.canJoinPublicChannel}\r\n                    onBrowseChannelClick={props.showMoreChannelsModal}\r\n                    onOpenDirectMessageClick={props.handleOpenDirectMessagesModal}\r\n                    canCreateCustomGroups={props.canCreateCustomGroups}\r\n                    onCreateNewUserGroupClick={props.showCreateUserGroupModal}\r\n                    unreadFilterEnabled={props.unreadFilterEnabled}\r\n                    onCreateNewCategoryClick={props.showCreateCategoryModal}\r\n                    onInvitePeopleClick={props.invitePeopleModal}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SidebarHeader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport SidebarHeader from './sidebar_header';\r\n\r\nexport default SidebarHeader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {WrappedComponentProps} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport NoResultsIndicator from 'components/no_results_indicator/no_results_indicator';\r\nimport {NoResultsVariant} from 'components/no_results_indicator/types';\r\nimport SuggestionBox from 'components/suggestion/suggestion_box';\r\nimport type SuggestionBoxComponent from 'components/suggestion/suggestion_box/suggestion_box';\r\nimport SuggestionList from 'components/suggestion/suggestion_list';\r\nimport {flattenItems, isItemLoaded, type SuggestionResults} from 'components/suggestion/suggestion_results';\r\nimport SwitchChannelProvider from 'components/suggestion/switch_channel_provider';\r\n\r\nimport {focusElement} from 'utils/a11y_utils';\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants, {RHSStates} from 'utils/constants';\r\nimport * as UserAgent from 'utils/user_agent';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nconst CHANNEL_MODE = 'channel';\r\n\r\nexport type Props = WrappedComponentProps & {\r\n    onExited: () => void;\r\n\r\n    isMobileView: boolean;\r\n    rhsState?: RhsState;\r\n    rhsOpen?: boolean;\r\n\r\n    actions: {\r\n        joinChannelById: (channelId: string) => Promise<ActionResult>;\r\n        switchToChannel: (channel: Channel) => Promise<ActionResult>;\r\n        closeRightHandSide: () => void;\r\n    };\r\n    focusOriginElement: string;\r\n};\r\n\r\ntype State = {\r\n    text: string;\r\n    mode: string | null;\r\n    hasSuggestions: boolean;\r\n    shouldShowLoadingSpinner: boolean;\r\n    pretext: string;\r\n};\r\n\r\nexport class QuickSwitchModal extends React.PureComponent<Props, State> {\r\n    private channelProviders: SwitchChannelProvider[];\r\n    private switchBox: SuggestionBoxComponent | null;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.channelProviders = [new SwitchChannelProvider()];\r\n        this.switchBox = null;\r\n\r\n        this.state = {\r\n            text: '',\r\n            mode: CHANNEL_MODE,\r\n            hasSuggestions: true,\r\n            shouldShowLoadingSpinner: true,\r\n            pretext: '',\r\n        };\r\n    }\r\n\r\n    private focusTextbox = (): void => {\r\n        if (this.switchBox === null) {\r\n            return;\r\n        }\r\n        const textbox = this.switchBox.getTextbox();\r\n        if (document.activeElement !== textbox) {\r\n            textbox.focus();\r\n            Utils.placeCaretAtEnd(textbox);\r\n        }\r\n    };\r\n\r\n    private setSwitchBoxRef = (input: SuggestionBoxComponent): void => {\r\n        this.switchBox = input;\r\n        this.focusTextbox();\r\n    };\r\n\r\n    private hideOnSelect = (): void => {\r\n        this.focusPostTextbox();\r\n        this.setState({\r\n            text: '',\r\n        });\r\n        this.props.onExited();\r\n    };\r\n\r\n    private focusPostTextbox = (): void => {\r\n        if (!UserAgent.isMobile()) {\r\n            setTimeout(() => {\r\n                const textbox = document.querySelector('#post_textbox') as HTMLElement;\r\n                if (textbox) {\r\n                    textbox.focus();\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    private hideOnCancel = () => {\r\n        this.props.onExited?.();\r\n        focusElement(this.props.focusOriginElement, true);\r\n    };\r\n\r\n    private onChange = (e: React.ChangeEvent<HTMLInputElement>): void => {\r\n        this.setState({text: e.target.value, shouldShowLoadingSpinner: true});\r\n    };\r\n\r\n    public handleSubmit = async (selected?: any): Promise<void> => {\r\n        if (!selected) {\r\n            return;\r\n        }\r\n\r\n        if (this.props.rhsOpen && this.props.rhsState === RHSStates.EDIT_HISTORY) {\r\n            this.props.actions.closeRightHandSide();\r\n        }\r\n\r\n        if (this.state.mode === CHANNEL_MODE) {\r\n            const {joinChannelById, switchToChannel} = this.props.actions;\r\n            const selectedChannel = selected.channel;\r\n\r\n            if (selected.type === Constants.MENTION_MORE_CHANNELS && selectedChannel.type === Constants.OPEN_CHANNEL) {\r\n                await joinChannelById(selectedChannel.id);\r\n            }\r\n            switchToChannel(selectedChannel).then((result: ActionResult) => {\r\n                if ('data' in result) {\r\n                    this.hideOnSelect();\r\n                }\r\n            });\r\n        } else {\r\n            getHistory().push('/' + selected.name);\r\n            this.hideOnSelect();\r\n        }\r\n    };\r\n\r\n    private handleSuggestionsReceived = (suggestions: SuggestionResults): void => {\r\n        const suggestionItems = flattenItems(suggestions);\r\n        const loadingPropPresent = suggestionItems.some((item) => !isItemLoaded(item));\r\n        this.setState({\r\n            shouldShowLoadingSpinner: loadingPropPresent,\r\n            pretext: suggestions.matchedPretext,\r\n            hasSuggestions: suggestionItems.length > 0,\r\n        });\r\n    };\r\n\r\n    public render = (): JSX.Element => {\r\n        const providers: SwitchChannelProvider[] = this.channelProviders;\r\n\r\n        const header = (\r\n            <h2 id='quickSwitchHeader'>\r\n                <FormattedMessage\r\n                    id='quick_switch_modal.switchChannels'\r\n                    defaultMessage='Find Channels'\r\n                />\r\n            </h2>\r\n        );\r\n\r\n        let help: React.ReactNode;\r\n        if (this.props.isMobileView) {\r\n            help = (\r\n                <FormattedMessage\r\n                    id='quick_switch_modal.help_mobile'\r\n                    defaultMessage='Type to find a channel.'\r\n                />\r\n            );\r\n        } else {\r\n            help = (\r\n                <FormattedMessage\r\n                    id='quickSwitchModal.help_no_team'\r\n                    defaultMessage='Type to find a channel. Use <b>UP/DOWN</b> to browse, <b>ENTER</b> to select, <b>ESC</b> to dismiss.'\r\n                    values={{\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n            );\r\n        }\r\n\r\n        const modalHeaderText = (\r\n            <div className='channel-switcher__header'>\r\n                {header}\r\n            </div>\r\n        );\r\n\r\n        const modalSubheaderText = (\r\n            <div\r\n                className='channel-switcher__hint'\r\n                id='quickSwitchHint'\r\n            >\r\n                {help}\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <GenericModal\r\n                className='a11y__modal channel-switcher'\r\n                id='quickSwitchModal'\r\n                show={true}\r\n                bodyPadding={false}\r\n                enforceFocus={false}\r\n                onExited={this.hideOnCancel}\r\n                onHide={this.hideOnCancel}\r\n                ariaLabel={this.props.intl.formatMessage({id: 'quick_switch_modal.switchChannels', defaultMessage: 'Find Channels'})}\r\n                modalHeaderText={modalHeaderText}\r\n                modalSubheaderText={modalSubheaderText}\r\n                compassDesign={true}\r\n            >\r\n                <div className='channel-switcher__suggestion-box'>\r\n                    <i className='icon icon-magnify icon-16'/>\r\n                    <SuggestionBox\r\n                        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n                        // @ts-ignore\r\n                        ref={this.setSwitchBoxRef}\r\n                        id='quickSwitchInput'\r\n                        aria-label={this.props.intl.formatMessage({id: 'quick_switch_modal.input', defaultMessage: 'quick switch input'})}\r\n                        className='form-control focused'\r\n                        onChange={this.onChange}\r\n                        value={this.state.text}\r\n                        onItemSelected={this.handleSubmit}\r\n                        listComponent={SuggestionList}\r\n                        listPosition='bottom'\r\n                        maxLength='64'\r\n                        providers={providers}\r\n                        completeOnTab={false}\r\n                        spellCheck='false'\r\n                        delayInputUpdate={true}\r\n                        openWhenEmpty={true}\r\n                        onSuggestionsReceived={this.handleSuggestionsReceived}\r\n                        forceSuggestionsWhenBlur={true}\r\n                        shouldSearchCompleteText={true}\r\n                    />\r\n                    {\r\n                        !this.state.shouldShowLoadingSpinner &&\r\n                        !this.state.hasSuggestions &&\r\n                        this.state.text &&\r\n                        (\r\n                            <NoResultsIndicator\r\n                                variant={NoResultsVariant.Search}\r\n                                titleValues={{channelName: `${this.state.pretext}`}}\r\n                            />\r\n                        )\r\n                    }\r\n                </div>\r\n            </GenericModal>\r\n        );\r\n    };\r\n}\r\n\r\nexport default injectIntl(QuickSwitchModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {joinChannelById, switchToChannel} from 'actions/views/channel';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport QuickSwitchModal from './quick_switch_modal';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        isMobileView: getIsMobileView(state),\r\n        rhsState: getRhsState(state),\r\n        rhsOpen: getIsRhsOpen(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            joinChannelById,\r\n            switchToChannel,\r\n            closeRightHandSide,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(QuickSwitchModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {defineMessages, injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\nimport {ShortcutKeys} from 'components/with_tooltip/tooltip_shortcut';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\n\r\nconst messages = defineMessages({\r\n    disableTooltip: {\r\n        id: 'sidebar_left.channel_filter.showAllChannels',\r\n        defaultMessage: 'Show all channels',\r\n    },\r\n    enableTooltip: {\r\n        id: 'sidebar_left.channel_filter.filterByUnread',\r\n        defaultMessage: 'Filter by unread',\r\n    },\r\n});\r\n\r\nconst shortcut = {\r\n    default: [ShortcutKeys.ctrl, ShortcutKeys.shift, 'U'],\r\n    mac: [ShortcutKeys.cmd, ShortcutKeys.shift, 'U'],\r\n};\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    unreadFilterEnabled: boolean;\r\n    actions: {\r\n        setUnreadFilterEnabled: (enabled: boolean) => void;\r\n    };\r\n};\r\n\r\nexport class ChannelFilter extends React.PureComponent<Props> {\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.handleUnreadFilterKeyPress);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.handleUnreadFilterKeyPress);\r\n    }\r\n\r\n    handleUnreadFilterClick = (e?: React.MouseEvent) => {\r\n        e?.preventDefault();\r\n        e?.stopPropagation();\r\n        this.toggleUnreadFilter();\r\n    };\r\n\r\n    handleUnreadFilterKeyPress = (e: KeyboardEvent) => {\r\n        if (Keyboard.cmdOrCtrlPressed(e) && e.shiftKey && Keyboard.isKeyPressed(e, Constants.KeyCodes.U)) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this.toggleUnreadFilter();\r\n        }\r\n    };\r\n\r\n    toggleUnreadFilter = () => {\r\n        const {unreadFilterEnabled} = this.props;\r\n\r\n        this.props.actions.setUnreadFilterEnabled(!unreadFilterEnabled);\r\n    };\r\n\r\n    render() {\r\n        const {intl, unreadFilterEnabled} = this.props;\r\n\r\n        const unreadsAriaLabel = intl.formatMessage({id: 'sidebar_left.channel_filter.filterUnreadAria', defaultMessage: 'unreads filter'});\r\n\r\n        return (\r\n            <div className='SidebarFilters'>\r\n                <WithTooltip\r\n                    title={unreadFilterEnabled ? messages.disableTooltip : messages.enableTooltip}\r\n                    shortcut={shortcut}\r\n                >\r\n                    <a\r\n                        href='#'\r\n                        className={classNames('SidebarFilters_filterButton', {\r\n                            active: unreadFilterEnabled,\r\n                        })}\r\n                        onClick={this.toggleUnreadFilter}\r\n                        aria-label={unreadsAriaLabel}\r\n                    >\r\n                        <i className='icon icon-filter-variant'/>\r\n                    </a>\r\n                </WithTooltip>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(ChannelFilter);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getMyTeams} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {setUnreadFilterEnabled} from 'actions/views/channel_sidebar';\r\nimport {isUnreadFilterEnabled} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelFilter from './channel_filter';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const teams = getMyTeams(state);\r\n\r\n    return {\r\n        hasMultipleTeams: teams && teams.length > 1,\r\n        unreadFilterEnabled: isUnreadFilterEnabled(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            setUnreadFilterEnabled,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelFilter);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {WrappedComponentProps} from 'react-intl';\r\n\r\nimport QuickSwitchModal from 'components/quick_switch_modal';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\nimport * as UserAgent from 'utils/user_agent';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\nimport ChannelFilter from '../channel_filter';\r\n\r\nexport type Props = WrappedComponentProps & {\r\n    showUnreadsCategory: boolean;\r\n    isQuickSwitcherOpen: boolean;\r\n    actions: {\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n        closeModal: (modalId: string) => void;\r\n    };\r\n};\r\n\r\nclass ChannelNavigator extends React.PureComponent<Props> {\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.handleShortcut);\r\n        document.addEventListener('keydown', this.handleQuickSwitchKeyPress);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.handleShortcut);\r\n        document.removeEventListener('keydown', this.handleQuickSwitchKeyPress);\r\n    }\r\n\r\n    openQuickSwitcher = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n        e.preventDefault();\r\n\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.QUICK_SWITCH,\r\n            dialogType: QuickSwitchModal,\r\n            dialogProps: {focusOriginElement: 'SidebarChannelNavigatorButton'},\r\n        });\r\n    };\r\n\r\n    handleShortcut = (e: KeyboardEvent) => {\r\n        const {actions: {closeModal}} = this.props;\r\n\r\n        if (Keyboard.cmdOrCtrlPressed(e) && e.shiftKey) {\r\n            if (Keyboard.isKeyPressed(e, Constants.KeyCodes.M)) {\r\n                e.preventDefault();\r\n                closeModal(ModalIdentifiers.QUICK_SWITCH);\r\n            }\r\n            if (Keyboard.isKeyPressed(e, Constants.KeyCodes.L)) {\r\n                // just close the modal if it's open, but let someone else handle the shortcut\r\n                closeModal(ModalIdentifiers.QUICK_SWITCH);\r\n            }\r\n        }\r\n    };\r\n\r\n    handleQuickSwitchKeyPress = (e: KeyboardEvent) => {\r\n        if (Keyboard.cmdOrCtrlPressed(e) && !e.shiftKey && Keyboard.isKeyPressed(e, Constants.KeyCodes.K)) {\r\n            if (!e.altKey && !Utils.isTextSelectedInPostOrReply(e)) {\r\n                e.preventDefault();\r\n                this.toggleQuickSwitchModal();\r\n            }\r\n        }\r\n    };\r\n\r\n    toggleQuickSwitchModal = () => {\r\n        const {isQuickSwitcherOpen, actions: {openModal, closeModal}} = this.props;\r\n\r\n        if (isQuickSwitcherOpen) {\r\n            closeModal(ModalIdentifiers.QUICK_SWITCH);\r\n        } else {\r\n            openModal({\r\n                modalId: ModalIdentifiers.QUICK_SWITCH,\r\n                dialogType: QuickSwitchModal,\r\n                dialogProps: {focusOriginElement: 'SidebarChannelNavigatorButton'},\r\n            });\r\n        }\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className={'SidebarChannelNavigator webapp'}>\r\n                {!this.props.showUnreadsCategory && <ChannelFilter/>}\r\n                <button\r\n                    className={'SidebarChannelNavigator_jumpToButton'}\r\n                    onClick={this.openQuickSwitcher}\r\n                    aria-label={this.props.intl.formatMessage({id: 'sidebar_left.channel_navigator.channelSwitcherLabel', defaultMessage: 'Channel Switcher'})}\r\n                    aria-haspopup='dialog'\r\n                    data-testid='SidebarChannelNavigatorButton'\r\n                    id='SidebarChannelNavigatorButton'\r\n                >\r\n                    <i className='icon icon-magnify'/>\r\n                    <FormattedMessage\r\n                        id='sidebar_left.channel_navigator.jumpTo'\r\n                        defaultMessage='Find channel'\r\n                    />\r\n                    <div className={'SidebarChannelNavigator_shortcutText'}>\r\n                        {`${UserAgent.isMac() ? '' : 'Ctrl+'}K`}\r\n                    </div>\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(ChannelNavigator);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {shouldShowUnreadsCategory} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport {openModal, closeModal} from 'actions/views/modals';\r\nimport {isModalOpen} from 'selectors/views/modals';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelNavigator from './channel_navigator';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        showUnreadsCategory: shouldShowUnreadsCategory(state),\r\n        isQuickSwitcherOpen: isModalOpen(state, ModalIdentifiers.QUICK_SWITCH),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            openModal,\r\n            closeModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelNavigator);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage, defineMessages, useIntl} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\n\r\nimport '../category_modal.scss';\r\n\r\ntype Props = {\r\n    category: ChannelCategory;\r\n    onExited: () => void;\r\n    actions: {\r\n        deleteCategory: (categoryId: string) => void;\r\n    };\r\n};\r\n\r\nexport default function DeleteCategoryModal(props: Props) {\r\n    const intl = useIntl();\r\n\r\n    const handleConfirm = useCallback(() => {\r\n        props.actions.deleteCategory(props.category.id);\r\n    }, [props.actions.deleteCategory, props.category]);\r\n\r\n    return (\r\n        <GenericModal\r\n            compassDesign={true}\r\n            ariaLabel={intl.formatMessage({id: 'delete_category_modal.deleteCategory', defaultMessage: 'Delete this category?'})}\r\n            onExited={props.onExited}\r\n            modalHeaderText={(\r\n                <FormattedMessage\r\n                    id='delete_category_modal.deleteCategory'\r\n                    defaultMessage='Delete this category?'\r\n                />\r\n            )}\r\n            handleCancel={props.onExited}\r\n            handleConfirm={handleConfirm}\r\n            confirmButtonText={(\r\n                <FormattedMessage\r\n                    id='delete_category_modal.delete'\r\n                    defaultMessage='Delete'\r\n                />\r\n            )}\r\n            confirmButtonClassName={'delete'}\r\n        >\r\n            <span className='delete-category__helpText'>\r\n                <FormattedMessage\r\n                    id='delete_category_modal.helpText'\r\n                    defaultMessage=\"Channels in <b>{category_name}</b> will move back to the Channels and Direct messages categories. You're not removed from any channels.\"\r\n                    values={{\r\n                        category_name: props.category.display_name,\r\n                        b: (chunks: string) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n            </span>\r\n        </GenericModal>\r\n    );\r\n}\r\n\r\n// TODO MM-52680 These strings are properly defined in @mattermost/components, but the i18n tooling currently can't\r\n// find them there, so we've had to redefine them here\r\ndefineMessages({\r\n    cancel: {\r\n        id: 'generic_modal.cancel',\r\n        defaultMessage: 'Cancel',\r\n    },\r\n    confirm: {\r\n        id: 'generic_modal.confirm',\r\n        defaultMessage: 'Confirm',\r\n    },\r\n    paginationCount: {\r\n        id: 'footer_pagination.count',\r\n        defaultMessage: 'Showing {startCount, number}-{endCount, number} of {total, number}',\r\n    },\r\n    paginationNext: {\r\n        id: 'footer_pagination.next',\r\n        defaultMessage: 'Next',\r\n    },\r\n    paginationPrev: {\r\n        id: 'footer_pagination.prev',\r\n        defaultMessage: 'Previous',\r\n    },\r\n});\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {deleteCategory} from 'mattermost-redux/actions/channel_categories';\r\n\r\nimport DeleteCategoryModal from './delete_category_modal';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            deleteCategory,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(DeleteCategoryModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback, useMemo} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {\r\n    BellOutlineIcon,\r\n    TrashCanOutlineIcon,\r\n    PencilOutlineIcon,\r\n    FormatListBulletedIcon,\r\n    SortAlphabeticalAscendingIcon,\r\n    ClockOutlineIcon,\r\n    ChevronRightIcon,\r\n    CheckIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport {CategorySorting} from '@mattermost/types/channel_categories';\r\n\r\nimport {setCategoryMuted, setCategorySorting} from 'mattermost-redux/actions/channel_categories';\r\nimport {readMultipleChannels} from 'mattermost-redux/actions/channels';\r\nimport {CategoryTypes} from 'mattermost-redux/constants/channel_categories';\r\nimport {shouldShowUnreadsCategory} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\nimport {makeGetUnreadIdsForCategory} from 'selectors/views/channel_sidebar';\r\n\r\nimport DeleteCategoryModal from 'components/delete_category_modal';\r\nimport EditCategoryModal from 'components/edit_category_modal';\r\nimport * as Menu from 'components/menu';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport CreateNewCategoryMenuItem from './create_new_category_menu_item';\r\nimport MarkAsReadMenuItem from './mark_as_read_menu_item';\r\nimport SidebarCategoryGenericMenu from './sidebar_category_generic_menu';\r\n\r\ntype Props = {\r\n    category: ChannelCategory;\r\n};\r\n\r\nconst SidebarCategoryMenu = ({\r\n    category,\r\n}: Props) => {\r\n    const dispatch = useDispatch();\r\n    const showUnreadsCategory = useSelector(shouldShowUnreadsCategory);\r\n    const getUnreadsIdsForCategory = useMemo(makeGetUnreadIdsForCategory, [category]);\r\n    const unreadsIds = useSelector((state: GlobalState) => getUnreadsIdsForCategory(state, category));\r\n    const {formatMessage} = useIntl();\r\n\r\n    let muteUnmuteCategoryMenuItem: JSX.Element | null = null;\r\n    if (category.type !== CategoryTypes.DIRECT_MESSAGES) {\r\n        function toggleCategoryMute() {\r\n            dispatch(setCategoryMuted(category.id, !category.muted));\r\n        }\r\n\r\n        muteUnmuteCategoryMenuItem = (\r\n            <Menu.Item\r\n                id={`mute-${category.id}`}\r\n                onClick={toggleCategoryMute}\r\n                leadingElement={<BellOutlineIcon size={18}/>}\r\n                labels={\r\n                    category.muted ? (\r\n                        <FormattedMessage\r\n                            id='sidebar_left.sidebar_category_menu.unmuteCategory'\r\n                            defaultMessage='Unmute Category'\r\n                        />\r\n                    ) : (\r\n                        <FormattedMessage\r\n                            id='sidebar_left.sidebar_category_menu.muteCategory'\r\n                            defaultMessage='Mute Category'\r\n                        />\r\n                    )\r\n                }\r\n            />\r\n        );\r\n    }\r\n\r\n    let deleteCategoryMenuItem: JSX.Element | null = null;\r\n    let renameCategoryMenuItem: JSX.Element | null = null;\r\n    if (category.type === CategoryTypes.CUSTOM) {\r\n        function handleDeleteCategory() {\r\n            dispatch(openModal({\r\n                modalId: ModalIdentifiers.DELETE_CATEGORY,\r\n                dialogType: DeleteCategoryModal,\r\n                dialogProps: {\r\n                    category,\r\n                },\r\n            }));\r\n        }\r\n\r\n        deleteCategoryMenuItem = (\r\n            <Menu.Item\r\n                id={`delete-${category.id}`}\r\n                isDestructive={true}\r\n                aria-haspopup={true}\r\n                onClick={handleDeleteCategory}\r\n                leadingElement={<TrashCanOutlineIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_category_menu.deleteCategory'\r\n                        defaultMessage='Delete Category'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n\r\n        function handleRenameCategory() {\r\n            dispatch(openModal({\r\n                modalId: ModalIdentifiers.EDIT_CATEGORY,\r\n                dialogType: EditCategoryModal,\r\n                dialogProps: {\r\n                    categoryId: category.id,\r\n                    initialCategoryName: category.display_name,\r\n                },\r\n            }));\r\n        }\r\n\r\n        renameCategoryMenuItem = (\r\n            <Menu.Item\r\n                id={`rename-${category.id}`}\r\n                onClick={handleRenameCategory}\r\n                aria-haspopup={true}\r\n                leadingElement={<PencilOutlineIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_category_menu.renameCategory'\r\n                        defaultMessage='Rename Category'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    function handleSortChannels(sorting: CategorySorting) {\r\n        dispatch(setCategorySorting(category.id, sorting));\r\n    }\r\n\r\n    let sortChannelsSelectedValue = (\r\n        <FormattedMessage\r\n            id='sidebar.sortedManually'\r\n            defaultMessage='Manually'\r\n        />\r\n    );\r\n    let sortChannelsIcon = <FormatListBulletedIcon size={18}/>;\r\n    if (category.sorting === CategorySorting.Alphabetical) {\r\n        sortChannelsSelectedValue = (\r\n            <FormattedMessage\r\n                id='user.settings.sidebar.sortAlpha'\r\n                defaultMessage='Alphabetically'\r\n            />\r\n        );\r\n        sortChannelsIcon = <SortAlphabeticalAscendingIcon size={18}/>;\r\n    } else if (category.sorting === CategorySorting.Recency) {\r\n        sortChannelsSelectedValue = (\r\n            <FormattedMessage\r\n                id='user.settings.sidebar.recent'\r\n                defaultMessage='Recent Activity'\r\n            />\r\n        );\r\n        sortChannelsIcon = <ClockOutlineIcon size={18}/>;\r\n    }\r\n\r\n    const sortChannelsMenuItem = (\r\n        <Menu.SubMenu\r\n            id={`sortChannels-${category.id}`}\r\n            leadingElement={sortChannelsIcon}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar.sort'\r\n                    defaultMessage='Sort'\r\n                />\r\n            )}\r\n            trailingElements={(\r\n                <>\r\n                    {sortChannelsSelectedValue}\r\n                    <ChevronRightIcon size={16}/>\r\n                </>\r\n            )}\r\n            menuId={`sortChannels-${category.id}-menu`}\r\n            menuAriaLabel={formatMessage({id: 'sidebar_left.sidebar_category_menu.sort.dropdownAriaLabel', defaultMessage: 'Sort submenu'})}\r\n        >\r\n            <Menu.Item\r\n                id={`sortAplhabetical-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='user.settings.sidebar.sortAlpha'\r\n                        defaultMessage='Alphabetically'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortChannels(CategorySorting.Alphabetical)}\r\n                trailingElements={category.sorting === CategorySorting.Alphabetical ? <CheckIcon size={16}/> : null}\r\n            />\r\n            <Menu.Item\r\n                id={`sortByMostRecent-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar.sortedByRecencyLabel'\r\n                        defaultMessage='Recent Activity'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortChannels(CategorySorting.Recency)}\r\n                trailingElements={category.sorting === CategorySorting.Recency ? <CheckIcon size={16}/> : null}\r\n            />\r\n            <Menu.Item\r\n                id={`sortManual-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar.sortedManually'\r\n                        defaultMessage='Manually'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortChannels(CategorySorting.Manual)}\r\n                trailingElements={category.sorting === CategorySorting.Manual ? <CheckIcon size={16}/> : null}\r\n            />\r\n        </Menu.SubMenu>\r\n    );\r\n\r\n    const handleViewCategory = useCallback(() => {\r\n        dispatch(readMultipleChannels(unreadsIds));\r\n    }, [dispatch, unreadsIds]);\r\n\r\n    const markAsReadMenuItem = showUnreadsCategory === false ? (\r\n        <MarkAsReadMenuItem\r\n            id={category.id}\r\n            handleViewCategory={handleViewCategory}\r\n            numChannels={unreadsIds.length}\r\n        />\r\n    ) : null;\r\n\r\n    return (\r\n        <SidebarCategoryGenericMenu\r\n            id={category.id}\r\n            name={category.display_name}\r\n        >\r\n            {markAsReadMenuItem}\r\n            {markAsReadMenuItem && <Menu.Separator/>}\r\n            {muteUnmuteCategoryMenuItem}\r\n            {renameCategoryMenuItem}\r\n            {deleteCategoryMenuItem}\r\n            <Menu.Separator/>\r\n            {sortChannelsMenuItem}\r\n            <Menu.Separator/>\r\n            <CreateNewCategoryMenuItem id={category.id}/>\r\n        </SidebarCategoryGenericMenu>\r\n    );\r\n};\r\n\r\nexport default memo(SidebarCategoryMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {memo, useState} from 'react';\r\nimport type {MouseEvent, KeyboardEvent} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {\r\n    SortAlphabeticalAscendingIcon,\r\n    ClockOutlineIcon,\r\n    AccountMultipleOutlineIcon,\r\n    AccountPlusOutlineIcon,\r\n    DotsVerticalIcon,\r\n    ChevronRightIcon,\r\n    CheckIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport {CategorySorting} from '@mattermost/types/channel_categories';\r\n\r\nimport {setCategorySorting} from 'mattermost-redux/actions/channel_categories';\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {Preferences} from 'mattermost-redux/constants';\r\nimport {getVisibleDmGmLimit} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    category: ChannelCategory;\r\n    handleOpenDirectMessagesModal: (e: MouseEvent<HTMLLIElement> | KeyboardEvent<HTMLLIElement>) => void;\r\n};\r\n\r\nconst SidebarCategorySortingMenu = ({\r\n    category,\r\n    handleOpenDirectMessagesModal,\r\n}: Props) => {\r\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n    const {formatMessage} = useIntl();\r\n\r\n    const dispatch = useDispatch();\r\n    const selectedDmNumber = useSelector(getVisibleDmGmLimit);\r\n    const currentUserId = useSelector(getCurrentUserId);\r\n\r\n    function handleSortDirectMessages(sorting: CategorySorting) {\r\n        dispatch(setCategorySorting(category.id, sorting));\r\n    }\r\n\r\n    let sortDirectMessagesIcon = <ClockOutlineIcon size={18}/>;\r\n    let sortDirectMessagesSelectedValue = (\r\n        <FormattedMessage\r\n            id='user.settings.sidebar.recent'\r\n            defaultMessage='Recent Activity'\r\n        />\r\n    );\r\n    if (category.sorting === CategorySorting.Alphabetical) {\r\n        sortDirectMessagesSelectedValue = (\r\n            <FormattedMessage\r\n                id='user.settings.sidebar.sortAlpha'\r\n                defaultMessage='Alphabetically'\r\n            />\r\n        );\r\n        sortDirectMessagesIcon = <SortAlphabeticalAscendingIcon size={18}/>;\r\n    }\r\n\r\n    const sortDirectMessagesMenuItem = (\r\n        <Menu.SubMenu\r\n            id={`sortDirectMessages-${category.id}`}\r\n            leadingElement={sortDirectMessagesIcon}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar.sort'\r\n                    defaultMessage='Sort'\r\n                />\r\n            )}\r\n            trailingElements={\r\n                <>\r\n                    {sortDirectMessagesSelectedValue}\r\n                    <ChevronRightIcon size={16}/>\r\n                </>\r\n            }\r\n            menuId={`sortDirectMessages-${category.id}-menu`}\r\n        >\r\n            <Menu.Item\r\n                id={`sortAlphabetical-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='user.settings.sidebar.sortAlpha'\r\n                        defaultMessage='Alphabetically'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortDirectMessages(CategorySorting.Alphabetical)}\r\n                trailingElements={category.sorting === CategorySorting.Alphabetical ? <CheckIcon size={16}/> : null}\r\n            />\r\n            <Menu.Item\r\n                id={`sortByMostRecent-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar.sortedByRecencyLabel'\r\n                        defaultMessage='Recent Activity'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortDirectMessages(CategorySorting.Recency)}\r\n                trailingElements={category.sorting === CategorySorting.Recency ? <CheckIcon size={16}/> : null}\r\n            />\r\n        </Menu.SubMenu>\r\n\r\n    );\r\n\r\n    function handlelimitVisibleDMsGMs(number: number) {\r\n        dispatch(savePreferences(currentUserId, [{\r\n            user_id: currentUserId,\r\n            category: Constants.Preferences.CATEGORY_SIDEBAR_SETTINGS,\r\n            name: Preferences.LIMIT_VISIBLE_DMS_GMS,\r\n            value: number.toString(),\r\n        }]));\r\n    }\r\n\r\n    let showMessagesCountSelectedValue = <span>{selectedDmNumber}</span>;\r\n    if (selectedDmNumber === 10000) {\r\n        showMessagesCountSelectedValue = (\r\n            <FormattedMessage\r\n                id='channel_notifications.levels.all'\r\n                defaultMessage='All'\r\n            />\r\n        );\r\n    }\r\n\r\n    const showMessagesCountMenuItem = (\r\n        <Menu.SubMenu\r\n            id={`showMessagesCount-${category.id}`}\r\n            leadingElement={<AccountMultipleOutlineIcon size={18}/>}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar.show'\r\n                    defaultMessage='Show'\r\n                />\r\n            )}\r\n            trailingElements={(\r\n                <>\r\n                    {showMessagesCountSelectedValue}\r\n                    <ChevronRightIcon size={16}/>\r\n                </>\r\n            )}\r\n            menuId={`showMessagesCount-${category.id}-menu`}\r\n        >\r\n            {Constants.DM_AND_GM_SHOW_COUNTS.map((dmGmShowCount) => (\r\n                <Menu.Item\r\n                    id={`showDmCount-${category.id}-${dmGmShowCount}`}\r\n                    key={`showDmCount-${category.id}-${dmGmShowCount}`}\r\n                    labels={<span>{dmGmShowCount}</span>}\r\n                    onClick={() => handlelimitVisibleDMsGMs(dmGmShowCount)}\r\n                    trailingElements={selectedDmNumber === dmGmShowCount ? <CheckIcon size={16}/> : null}\r\n                />\r\n            ))}\r\n        </Menu.SubMenu>\r\n\r\n    );\r\n\r\n    const openDirectMessageMenuItem = (\r\n        <Menu.Item\r\n            id={`openDirectMessage-${category.id}`}\r\n            onClick={handleOpenDirectMessagesModal}\r\n            leadingElement={<AccountPlusOutlineIcon size={18}/>}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar.openDirectMessage'\r\n                    defaultMessage='Open a direct message'\r\n                />\r\n            )}\r\n        />\r\n    );\r\n\r\n    function handleMenuToggle(isOpen: boolean) {\r\n        setIsMenuOpen(isOpen);\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={classNames(\r\n                'SidebarMenu',\r\n                'MenuWrapper',\r\n                {menuOpen: isMenuOpen},\r\n                {'MenuWrapper--open': isMenuOpen},\r\n            )}\r\n        >\r\n            <Menu.Container\r\n                menuButton={{\r\n                    id: `SidebarCategorySortingMenu-Button-${category.id}`,\r\n                    'aria-label': formatMessage({id: 'sidebar_left.sidebar_category_menu.editCategory', defaultMessage: 'Category options'}, {name: category.display_name}),\r\n                    class: 'SidebarMenu_menuButton sortingMenu',\r\n                    children: <DotsVerticalIcon size={16}/>,\r\n                }}\r\n                menuButtonTooltip={{\r\n                    text: formatMessage({id: 'sidebar_left.sidebar_category_menu.editCategory', defaultMessage: 'Category options'}, {name: category.display_name}),\r\n                    class: 'hidden-xs',\r\n                }}\r\n                menu={{\r\n                    id: `SidebarCategorySortingMenu-MenuList-${category.id}`,\r\n                    'aria-label': formatMessage({id: 'sidebar_left.sidebar_category_menu.dropdownAriaLabel', defaultMessage: 'Edit category menu'}),\r\n                    onToggle: handleMenuToggle,\r\n                }}\r\n            >\r\n                {sortDirectMessagesMenuItem}\r\n                {showMessagesCountMenuItem}\r\n                <Menu.Separator/>\r\n                {openDirectMessageMenuItem}\r\n            </Menu.Container>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(SidebarCategorySortingMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nexport function isAddChannelCtaDropdownOpen(state: GlobalState) {\r\n    return state.views.addChannelCtaDropdown.isOpen;\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\n\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/common';\r\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {haveICurrentChannelPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {setAddChannelCtaDropdown} from 'actions/views/add_channel_dropdown';\r\nimport {openModal} from 'actions/views/modals';\r\nimport {isAddChannelCtaDropdownOpen} from 'selectors/views/add_channel_dropdown';\r\n\r\nimport BrowseChannels from 'components/browse_channels';\r\nimport NewChannelModal from 'components/new_channel_modal/new_channel_modal';\r\nimport Menu from 'components/widgets/menu/menu';\r\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\r\n\r\nimport {ModalIdentifiers, Preferences, Touched} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nconst AddChannelsCtaButton = (): JSX.Element | null => {\r\n    const dispatch = useDispatch();\r\n    const currentTeamId = useSelector(getCurrentTeamId);\r\n    const intl = useIntl();\r\n    const touchedAddChannelsCtaButton = useSelector((state: GlobalState) => getBool(state, Preferences.TOUCHED, Touched.ADD_CHANNELS_CTA));\r\n\r\n    const canCreatePublicChannel = useSelector((state: GlobalState) => haveICurrentChannelPermission(state, Permissions.CREATE_PUBLIC_CHANNEL));\r\n    const canCreatePrivateChannel = useSelector((state: GlobalState) => haveICurrentChannelPermission(state, Permissions.CREATE_PRIVATE_CHANNEL));\r\n    const canCreateChannel = canCreatePrivateChannel || canCreatePublicChannel;\r\n    const canJoinPublicChannel = useSelector((state: GlobalState) => haveICurrentChannelPermission(state, Permissions.JOIN_PUBLIC_CHANNELS));\r\n    const isAddChannelCtaOpen = useSelector(isAddChannelCtaDropdownOpen);\r\n    const currentUserId = useSelector(getCurrentUserId);\r\n    const openAddChannelsCtaOpen = useCallback((open: boolean) => {\r\n        dispatch(setAddChannelCtaDropdown(open));\r\n    }, []);\r\n\r\n    let buttonClass = 'SidebarChannelNavigator__addChannelsCtaLhsButton';\r\n\r\n    if (!touchedAddChannelsCtaButton) {\r\n        buttonClass += ' SidebarChannelNavigator__addChannelsCtaLhsButton--untouched';\r\n    }\r\n\r\n    if ((!canCreateChannel && !canJoinPublicChannel) || !currentTeamId) {\r\n        return null;\r\n    }\r\n\r\n    const showMoreChannelsModal = () => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.MORE_CHANNELS,\r\n            dialogType: BrowseChannels,\r\n        }));\r\n    };\r\n\r\n    const showNewChannelModal = () => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.NEW_CHANNEL_MODAL,\r\n            dialogType: NewChannelModal,\r\n        }));\r\n    };\r\n\r\n    const renderDropdownItems = () => {\r\n        let joinPublicChannel;\r\n        if (canJoinPublicChannel) {\r\n            joinPublicChannel = (\r\n                <Menu.ItemAction\r\n                    id='showMoreChannels'\r\n                    onClick={showMoreChannelsModal}\r\n                    icon={<i className='icon-globe'/>}\r\n                    text={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.browseChannels', defaultMessage: 'Browse channels'})}\r\n                />\r\n            );\r\n        }\r\n\r\n        let createChannel;\r\n        if (canCreateChannel) {\r\n            createChannel = (\r\n                <Menu.ItemAction\r\n                    id='showNewChannel'\r\n                    onClick={showNewChannelModal}\r\n                    icon={<i className='icon-plus'/>}\r\n                    text={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.createNewChannel', defaultMessage: 'Create new channel'})}\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <>\r\n                <Menu.Group>\r\n                    {createChannel}\r\n                    {joinPublicChannel}\r\n                </Menu.Group>\r\n            </>\r\n        );\r\n    };\r\n\r\n    const addChannelsButton = (btnCallback?: () => void) => {\r\n        const handleClick = () => btnCallback?.();\r\n        return (\r\n            <button\r\n                className={buttonClass}\r\n                id={'addChannelsCta'}\r\n                aria-label={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.dropdownAriaLabel', defaultMessage: 'Add Channel Dropdown'})}\r\n                onClick={handleClick}\r\n            >\r\n                <div\r\n                    aria-label={intl.formatMessage({id: 'sidebar_left.sidebar_channel_navigator.addChannelsCta', defaultMessage: 'Add channels'})}\r\n                >\r\n                    <i className='icon-plus-box'/>\r\n                    <span>\r\n                        {intl.formatMessage({id: 'sidebar_left.addChannelsCta', defaultMessage: 'Add Channels'})}\r\n                    </span>\r\n                </div>\r\n            </button>\r\n        );\r\n    };\r\n\r\n    const storePreferencesAndTrackEvent = () => {\r\n        if (!touchedAddChannelsCtaButton) {\r\n            dispatch(savePreferences(\r\n                currentUserId,\r\n                [{\r\n                    category: Preferences.TOUCHED,\r\n                    user_id: currentUserId,\r\n                    name: Touched.ADD_CHANNELS_CTA,\r\n                    value: 'true',\r\n                }],\r\n            ));\r\n        }\r\n    };\r\n\r\n    const trackOpen = (opened: boolean) => {\r\n        openAddChannelsCtaOpen(opened);\r\n        storePreferencesAndTrackEvent();\r\n    };\r\n\r\n    if (!canCreateChannel) {\r\n        const browseChannelsAction = () => {\r\n            showMoreChannelsModal();\r\n            storePreferencesAndTrackEvent();\r\n        };\r\n        return addChannelsButton(browseChannelsAction);\r\n    }\r\n\r\n    return (\r\n        <MenuWrapper\r\n            className='AddChannelsCtaDropdown'\r\n            onToggle={trackOpen}\r\n            open={isAddChannelCtaOpen}\r\n        >\r\n            {addChannelsButton()}\r\n            <Menu\r\n                id='AddChannelCtaDropdown'\r\n                ariaLabel={intl.formatMessage({id: 'sidebar_left.add_channel_cta_dropdown.dropdownAriaLabel', defaultMessage: 'Add Channels Dropdown'})}\r\n            >\r\n                {renderDropdownItems()}\r\n            </Menu>\r\n        </MenuWrapper>\r\n    );\r\n};\r\n\r\nexport default AddChannelsCtaButton;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {ActionTypes} from 'utils/constants';\r\n\r\nexport function setAddChannelCtaDropdown(open: boolean) {\r\n    return {\r\n        type: ActionTypes.ADD_CHANNEL_CTA_DROPDOWN_TOGGLE,\r\n        open,\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl, FormattedMessage} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport InvitationModal from 'components/invitation_modal';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\nimport ToggleModalButton from 'components/toggle_modal_button';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\ntype Props = {\r\n    className?: string;\r\n}\r\n\r\nconst InviteMembersButton = (props: Props): JSX.Element | null => {\r\n    const intl = useIntl();\r\n    const currentTeamId = useSelector(getCurrentTeamId);\r\n\r\n    if (!currentTeamId) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <TeamPermissionGate\r\n            teamId={currentTeamId}\r\n            permissions={[Permissions.ADD_USER_TO_TEAM, Permissions.INVITE_GUEST]}\r\n        >\r\n            <ToggleModalButton\r\n                ariaLabel={intl.formatMessage({id: 'sidebar_left.inviteMembers', defaultMessage: 'Invite Members'})}\r\n                id='inviteMembersButton'\r\n                className={`intro-links color--link cursor--pointer${props.className ? ` ${props.className}` : ''}`}\r\n                modalId={ModalIdentifiers.INVITATION}\r\n                dialogType={InvitationModal}\r\n                dialogProps={{focusOriginElement: 'inviteMembersButton'}}\r\n            >\r\n                <div\r\n                    className='SidebarChannelNavigator__inviteMembersLhsButton'\r\n                    aria-label={intl.formatMessage({id: 'sidebar_left.sidebar_channel_navigator.inviteUsers', defaultMessage: 'Invite Members'})}\r\n                >\r\n                    <i\r\n                        className='icon-plus-box'\r\n                        aria-hidden='true'\r\n                    />\r\n                    <FormattedMessage\r\n                        id={'sidebar_left.inviteMembers'}\r\n                        defaultMessage='Invite Members'\r\n                    />\r\n                </div>\r\n            </ToggleModalButton>\r\n        </TeamPermissionGate>\r\n    );\r\n};\r\n\r\nexport default InviteMembersButton;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport type {MouseEvent, KeyboardEvent} from 'react';\r\nimport {Draggable, Droppable} from 'react-beautiful-dnd';\r\nimport {FormattedMessage, defineMessages} from 'react-intl';\r\n\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport {CategorySorting} from '@mattermost/types/channel_categories';\r\nimport type {PreferenceType} from '@mattermost/types/preferences';\r\n\r\nimport {CategoryTypes} from 'mattermost-redux/constants/channel_categories';\r\nimport {localizeMessage} from 'mattermost-redux/utils/i18n_utils';\r\n\r\nimport KeyboardShortcutSequence, {\r\n    KEYBOARD_SHORTCUTS,\r\n} from 'components/keyboard_shortcuts/keyboard_shortcuts_sequence';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport Constants, {A11yCustomEventTypes, DraggingStateTypes, DraggingStates} from 'utils/constants';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\n\r\nimport type {DraggingState} from 'types/store';\r\n\r\nimport SidebarCategoryMenu from './sidebar_category_menu';\r\nimport SidebarCategorySortingMenu from './sidebar_category_sorting_menu';\r\n\r\nimport AddChannelsCtaButton from '../add_channels_cta_button';\r\nimport InviteMembersButton from '../invite_members_button';\r\nimport {SidebarCategoryHeader} from '../sidebar_category_header';\r\nimport SidebarChannel from '../sidebar_channel';\r\n\r\ntype Props = {\r\n    category: ChannelCategory;\r\n    categoryIndex: number;\r\n    channelIds: string[];\r\n    setChannelRef: (channelId: string, ref: HTMLLIElement) => void;\r\n    handleOpenMoreDirectChannelsModal: (e: Event) => void;\r\n    isNewCategory: boolean;\r\n    draggingState: DraggingState;\r\n    currentUserId: string;\r\n    isAdmin: boolean;\r\n    actions: {\r\n        setCategoryCollapsed: (categoryId: string, collapsed: boolean) => void;\r\n        setCategorySorting: (categoryId: string, sorting: CategorySorting) => void;\r\n        savePreferences: (userId: string, preferences: PreferenceType[]) => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    isMenuOpen: boolean;\r\n}\r\n\r\nexport default class SidebarCategory extends React.PureComponent<Props, State> {\r\n    categoryTitleRef: React.RefObject<HTMLButtonElement>;\r\n    newDropBoxRef: React.RefObject<HTMLDivElement>;\r\n\r\n    a11yKeyDownRegistered: boolean;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.categoryTitleRef = React.createRef();\r\n        this.newDropBoxRef = React.createRef();\r\n\r\n        this.state = {\r\n            isMenuOpen: false,\r\n        };\r\n\r\n        this.a11yKeyDownRegistered = false;\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (this.props.category.collapsed !== prevProps.category.collapsed && this.newDropBoxRef.current) {\r\n            this.newDropBoxRef.current.classList.add('animating');\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.categoryTitleRef.current?.addEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\r\n        this.categoryTitleRef.current?.addEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.categoryTitleRef.current?.removeEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\r\n        this.categoryTitleRef.current?.removeEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\r\n\r\n        if (this.a11yKeyDownRegistered) {\r\n            this.handleA11yDeactivateEvent();\r\n        }\r\n    }\r\n\r\n    handleA11yActivateEvent = () => {\r\n        this.categoryTitleRef.current?.addEventListener('keydown', this.handleA11yKeyDown);\r\n\r\n        this.a11yKeyDownRegistered = true;\r\n    };\r\n\r\n    handleA11yDeactivateEvent = () => {\r\n        this.categoryTitleRef.current?.removeEventListener('keydown', this.handleA11yKeyDown);\r\n\r\n        this.a11yKeyDownRegistered = false;\r\n    };\r\n\r\n    handleA11yKeyDown = (e: KeyboardEvent<HTMLButtonElement>['nativeEvent']) => {\r\n        if (isKeyPressed(e, Constants.KeyCodes.ENTER)) {\r\n            e.preventDefault();\r\n            this.handleCollapse();\r\n        }\r\n    };\r\n\r\n    renderChannel = (channelId: string, index: number) => {\r\n        const {setChannelRef, category, draggingState} = this.props;\r\n        return (\r\n            <SidebarChannel\r\n                key={channelId}\r\n                channelIndex={index}\r\n                channelId={channelId}\r\n                isDraggable={true}\r\n                setChannelRef={setChannelRef}\r\n                isCategoryCollapsed={category.collapsed}\r\n                isCategoryDragged={draggingState.type === DraggingStateTypes.CATEGORY && draggingState.id === category.id}\r\n                isAutoSortedCategory={category.sorting === CategorySorting.Alphabetical || category.sorting === CategorySorting.Recency}\r\n            />\r\n        );\r\n    };\r\n\r\n    handleCollapse = () => {\r\n        const {category} = this.props;\r\n\r\n        this.props.actions.setCategoryCollapsed(category.id, !category.collapsed);\r\n    };\r\n\r\n    removeAnimation = () => {\r\n        if (this.newDropBoxRef.current) {\r\n            this.newDropBoxRef.current.classList.remove('animating');\r\n        }\r\n    };\r\n\r\n    handleOpenDirectMessagesModal = (event: MouseEvent<HTMLLIElement | HTMLButtonElement> | KeyboardEvent<HTMLLIElement | HTMLButtonElement>) => {\r\n        event.preventDefault();\r\n\r\n        this.props.handleOpenMoreDirectChannelsModal(event.nativeEvent);\r\n    };\r\n\r\n    isDropDisabled = () => {\r\n        const {draggingState, category} = this.props;\r\n\r\n        if (category.type === CategoryTypes.DIRECT_MESSAGES) {\r\n            return draggingState.type === DraggingStateTypes.CHANNEL;\r\n        } else if (category.type === CategoryTypes.CHANNELS) {\r\n            return draggingState.type === DraggingStateTypes.DM;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    renderNewDropBox = (isDraggingOver: boolean) => {\r\n        const {draggingState, category, isNewCategory, channelIds} = this.props;\r\n\r\n        if (!isNewCategory || channelIds?.length) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <>\r\n                <Draggable\r\n                    draggableId={`NEW_CHANNEL_SPACER__${category.id}`}\r\n                    isDragDisabled={true}\r\n                    index={0}\r\n                >\r\n                    {(provided) => {\r\n                        // NEW_CHANNEL_SPACER here is used as a spacer to ensure react-beautiful-dnd will not try and place the first channel\r\n                        // on the header. This acts as a space filler for the header so that the first channel dragged in will float below it.\r\n                        return (\r\n                            <li\r\n                                ref={provided.innerRef}\r\n                                draggable='false'\r\n                                className={'SidebarChannel noFloat newChannelSpacer'}\r\n                                {...provided.draggableProps}\r\n                                tabIndex={-1}\r\n                            />\r\n                        );\r\n                    }}\r\n                </Draggable>\r\n                <div className='SidebarCategory_newDropBox'>\r\n                    <div\r\n                        ref={this.newDropBoxRef}\r\n                        className={classNames('SidebarCategory_newDropBox-content', {\r\n                            collapsed: category.collapsed || (draggingState.type === DraggingStateTypes.CATEGORY && draggingState.id === category.id),\r\n                            isDraggingOver,\r\n                        })}\r\n                        onTransitionEnd={this.removeAnimation}\r\n                    >\r\n                        <i className='icon-hand-right'/>\r\n                        <span className='SidebarCategory_newDropBox-label'>\r\n                            <FormattedMessage\r\n                                id='sidebar_left.sidebar_category.newDropBoxLabel'\r\n                                defaultMessage='Drag channels here...'\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </>\r\n        );\r\n    };\r\n\r\n    showPlaceholder = () => {\r\n        const {channelIds, draggingState, category, isNewCategory} = this.props;\r\n\r\n        if (category.sorting === CategorySorting.Alphabetical ||\r\n            category.sorting === CategorySorting.Recency ||\r\n            isNewCategory) {\r\n            // Always show the placeholder if the channel being dragged is from the current category\r\n            if (channelIds.find((id) => id === draggingState.id)) {\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            category,\r\n            categoryIndex,\r\n            channelIds,\r\n            isNewCategory,\r\n        } = this.props;\r\n\r\n        if (!category) {\r\n            return null;\r\n        }\r\n\r\n        if (category.type === CategoryTypes.FAVORITES && !channelIds?.length) {\r\n            return null;\r\n        }\r\n\r\n        const renderedChannels = channelIds.map(this.renderChannel);\r\n\r\n        let categoryMenu: JSX.Element;\r\n        let newLabel: JSX.Element;\r\n        const directMessagesModalButton: JSX.Element | null = null;\r\n        let isCollapsible = true;\r\n        if (isNewCategory) {\r\n            newLabel = (\r\n                <div className='SidebarCategory_newLabel'>\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_category.newLabel'\r\n                        defaultMessage='new'\r\n                    />\r\n                </div>\r\n            );\r\n\r\n            categoryMenu = <SidebarCategoryMenu category={category}/>;\r\n        } else if (category.type === CategoryTypes.DIRECT_MESSAGES) {\r\n            const addHelpLabel = localizeMessage({id: 'sidebar.createDirectMessage', defaultMessage: 'Create new direct message'});\r\n\r\n            categoryMenu = (\r\n                <>\r\n                    <SidebarCategorySortingMenu\r\n                        category={category}\r\n                        handleOpenDirectMessagesModal={this.handleOpenDirectMessagesModal}\r\n                    />\r\n                    <WithTooltip\r\n                        title={\r\n                            <>\r\n                                {addHelpLabel}\r\n                                <KeyboardShortcutSequence\r\n                                    shortcut={KEYBOARD_SHORTCUTS.navDMMenu}\r\n                                    hideDescription={true}\r\n                                    isInsideTooltip={true}\r\n                                />\r\n                            </>\r\n                        }\r\n                    >\r\n                        <button\r\n                            id='newDirectMessageButton'\r\n                            className='SidebarChannelGroupHeader_addButton'\r\n                            onClick={this.handleOpenDirectMessagesModal}\r\n                            aria-label={addHelpLabel}\r\n                        >\r\n                            <i className='icon-plus'/>\r\n                        </button>\r\n                    </WithTooltip>\r\n                </>\r\n            );\r\n\r\n            if (!channelIds || !channelIds.length) {\r\n                isCollapsible = false;\r\n            }\r\n        } else {\r\n            categoryMenu = <SidebarCategoryMenu category={category}/>;\r\n        }\r\n\r\n        let displayName = category.display_name;\r\n        if (category.type !== CategoryTypes.CUSTOM) {\r\n            const message = categoryNames[category.type as keyof typeof categoryNames];\r\n            displayName = localizeMessage({id: message.id, defaultMessage: message.defaultMessage});\r\n        }\r\n\r\n        return (\r\n            <Draggable\r\n                draggableId={category.id}\r\n                index={categoryIndex}\r\n                disableInteractiveElementBlocking={true}\r\n            >\r\n                {(provided, snapshot) => {\r\n                    let inviteMembersButton = null;\r\n                    if (category.type === 'direct_messages' && !category.collapsed) {\r\n                        inviteMembersButton = (\r\n                            <InviteMembersButton\r\n                                className='followingSibling'\r\n                            />\r\n                        );\r\n                    }\r\n\r\n                    let addChannelsCtaButton = null;\r\n                    if (category.type === 'channels' && !category.collapsed) {\r\n                        addChannelsCtaButton = (\r\n                            <AddChannelsCtaButton/>\r\n                        );\r\n                    }\r\n\r\n                    return (\r\n                        <div\r\n                            className={classNames('SidebarChannelGroup a11y__section', {\r\n                                dropDisabled: this.isDropDisabled(),\r\n                                menuIsOpen: this.state.isMenuOpen,\r\n                                capture: this.props.draggingState.state === DraggingStates.CAPTURE,\r\n                                isCollapsed: category.collapsed,\r\n                            })}\r\n                            ref={provided.innerRef}\r\n                            {...provided.draggableProps}\r\n                        >\r\n                            <Droppable\r\n                                droppableId={category.id}\r\n                                type='SIDEBAR_CHANNEL'\r\n                                isDropDisabled={this.isDropDisabled()}\r\n                            >\r\n                                {(droppableProvided, droppableSnapshot) => {\r\n                                    return (\r\n                                        <div\r\n                                            {...droppableProvided.droppableProps}\r\n                                            ref={droppableProvided.innerRef}\r\n                                            className={classNames({\r\n                                                draggingOver: droppableSnapshot.isDraggingOver,\r\n                                            })}\r\n                                        >\r\n                                            <SidebarCategoryHeader\r\n                                                ref={this.categoryTitleRef}\r\n                                                displayName={displayName}\r\n                                                dragHandleProps={provided.dragHandleProps}\r\n                                                isCollapsed={category.collapsed}\r\n                                                isCollapsible={isCollapsible}\r\n                                                isDragging={snapshot.isDragging}\r\n                                                isDraggingOver={droppableSnapshot.isDraggingOver}\r\n                                                muted={category.muted}\r\n                                                onClick={this.handleCollapse}\r\n                                            >\r\n                                                {newLabel}\r\n                                                {directMessagesModalButton}\r\n                                                {categoryMenu}\r\n                                            </SidebarCategoryHeader>\r\n                                            <div\r\n                                                className={classNames('SidebarChannelGroup_content')}\r\n                                            >\r\n                                                <ul\r\n                                                    className='NavGroupContent'\r\n                                                >\r\n                                                    {this.renderNewDropBox(droppableSnapshot.isDraggingOver)}\r\n                                                    {renderedChannels}\r\n                                                    {this.showPlaceholder() ? droppableProvided.placeholder : null}\r\n                                                </ul>\r\n                                            </div>\r\n                                        </div>\r\n                                    );\r\n                                }}\r\n                            </Droppable>\r\n                            {inviteMembersButton}\r\n                            {addChannelsCtaButton}\r\n                        </div>\r\n                    );\r\n                }}\r\n            </Draggable>\r\n        );\r\n    }\r\n}\r\n\r\nconst categoryNames = defineMessages({\r\n    channels: {\r\n        id: 'sidebar.types.channels',\r\n        defaultMessage: 'CHANNELS',\r\n    },\r\n    direct_messages: {\r\n        id: 'sidebar.types.direct_messages',\r\n        defaultMessage: 'DIRECT MESSAGES',\r\n    },\r\n    favorites: {\r\n        id: 'sidebar.types.favorites',\r\n        defaultMessage: 'FAVORITES',\r\n    },\r\n});\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\n\r\nimport {setCategoryCollapsed, setCategorySorting} from 'mattermost-redux/actions/channel_categories';\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {getCurrentUser, getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\nimport {isAdmin} from 'mattermost-redux/utils/user_utils';\r\n\r\nimport {getDraggingState, makeGetFilteredChannelIdsForCategory} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarCategory from './sidebar_category';\r\n\r\ntype OwnProps = {\r\n    category: ChannelCategory;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getChannelIdsForCategory = makeGetFilteredChannelIdsForCategory();\r\n\r\n    return (state: GlobalState, ownProps: OwnProps) => {\r\n        return {\r\n            channelIds: getChannelIdsForCategory(state, ownProps.category),\r\n            draggingState: getDraggingState(state),\r\n            currentUserId: getCurrentUserId(state),\r\n            isAdmin: isAdmin(getCurrentUser(state).roles),\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            setCategoryCollapsed,\r\n            setCategorySorting,\r\n            savePreferences,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SidebarCategory);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport debounce from 'lodash/debounce';\r\nimport React, {lazy} from 'react';\r\nimport {DragDropContext, Droppable} from 'react-beautiful-dnd';\r\nimport type {DropResult, DragStart, BeforeCapture} from 'react-beautiful-dnd';\r\nimport {FormattedMessage, injectIntl, type WrappedComponentProps} from 'react-intl';\r\nimport {SpringSystem} from 'rebound';\r\nimport type {Spring} from 'rebound';\r\n\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {General} from 'mattermost-redux/constants';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport Scrollbars from 'components/common/scrollbars';\r\nimport SidebarCategory from 'components/sidebar/sidebar_category';\r\n\r\nimport {findNextUnreadChannelId} from 'utils/channel_utils';\r\nimport {Constants, DraggingStates, DraggingStateTypes} from 'utils/constants';\r\nimport {isKeyPressed, cmdOrCtrlPressed} from 'utils/keyboard';\r\nimport {mod} from 'utils/utils';\r\n\r\nimport type {DraggingState} from 'types/store';\r\nimport type {StaticPage} from 'types/store/lhs';\r\n\r\nconst DraftsLink = makeAsyncComponent('DraftsLink', lazy(() => import('components/drafts/drafts_link/drafts_link')));\r\nconst GlobalThreadsLink = makeAsyncComponent('GlobalThreadsLink', lazy(() => import('components/threading/global_threads_link')));\r\nconst UnreadChannelIndicator = makeAsyncComponent('UnreadChannelIndicator', lazy(() => import('../unread_channel_indicator')));\r\nconst UnreadChannels = makeAsyncComponent('UnreadChannels', lazy(() => import('../unread_channels')));\r\n\r\ntype Props = WrappedComponentProps & {\r\n    currentTeam?: Team;\r\n    currentChannelId: string;\r\n    categories: ChannelCategory[];\r\n    unreadChannelIds: string[];\r\n    isUnreadFilterEnabled: boolean;\r\n    displayedChannels: Channel[];\r\n    newCategoryIds: string[];\r\n    draggingState: DraggingState;\r\n    multiSelectedChannelIds: string[];\r\n    showUnreadsCategory: boolean;\r\n    collapsedThreads: boolean;\r\n    hasUnreadThreads: boolean;\r\n    currentStaticPageId: string;\r\n    staticPages: StaticPage[];\r\n\r\n    handleOpenMoreDirectChannelsModal: (e: Event) => void;\r\n    onDragStart: (initial: DragStart) => void;\r\n    onDragEnd: (result: DropResult) => void;\r\n\r\n    actions: {\r\n        moveChannelsInSidebar: (categoryId: string, targetIndex: number, draggableChannelId: string) => void;\r\n        moveCategory: (teamId: string, categoryId: string, newIndex: number) => void;\r\n        switchToChannelById: (channelId: string) => void;\r\n        switchToLhsStaticPage: (pageId: string) => void;\r\n        close: () => void;\r\n        setDraggingState: (data: DraggingState) => void;\r\n        stopDragging: () => void;\r\n        clearChannelSelection: () => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    showTopUnread: boolean;\r\n    showBottomUnread: boolean;\r\n};\r\n\r\n// scrollMargin is the margin at the edge of the channel list that we leave when scrolling to a channel.\r\nconst scrollMargin = 10;\r\n\r\n// categoryHeaderHeight is the height of the category header\r\nconst categoryHeaderHeight = 32;\r\n\r\n// scrollMarginWithUnread is the margin that we leave at the edge of the channel list when scrolling to a channel so\r\n// that the channel is not under the unread indicator.\r\nconst scrollMarginWithUnread = 55;\r\n\r\nexport class SidebarList extends React.PureComponent<Props, State> {\r\n    channelRefs: Map<string, HTMLLIElement>;\r\n    scrollbar: React.RefObject<HTMLDivElement>;\r\n    animate: SpringSystem;\r\n    scrollAnimation: Spring;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.channelRefs = new Map();\r\n        this.state = {\r\n            showTopUnread: false,\r\n            showBottomUnread: false,\r\n        };\r\n        this.scrollbar = React.createRef();\r\n\r\n        this.animate = new SpringSystem();\r\n        this.scrollAnimation = this.animate.createSpring();\r\n        this.scrollAnimation.setOvershootClampingEnabled(true); // disables the spring action at the end of animation\r\n        this.scrollAnimation.addListener({onSpringUpdate: this.handleScrollAnimationUpdate});\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.navigateChannelShortcut);\r\n        document.addEventListener('keydown', this.navigateUnreadChannelShortcut);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.navigateChannelShortcut);\r\n        document.removeEventListener('keydown', this.navigateUnreadChannelShortcut);\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (!this.props.currentChannelId || !prevProps.currentChannelId) {\r\n            return;\r\n        }\r\n\r\n        // reset the scrollbar upon switching teams\r\n        if (this.props.currentTeam !== prevProps.currentTeam) {\r\n            this.scrollbar.current!.scrollTo({top: 0});\r\n        }\r\n\r\n        // Scroll to selected channel so it's in view\r\n        if (this.props.currentChannelId !== prevProps.currentChannelId) {\r\n            // This will be re-enabled when we can avoid animating the scroll on first load and team switch\r\n            // this.scrollToChannel(this.props.currentChannelId);\r\n        }\r\n\r\n        // TODO: Copying over so it doesn't get lost, but we don't have a design for the sidebar on mobile yet\r\n        // close the LHS on mobile when you change channels\r\n        if (this.props.currentChannelId !== prevProps.currentChannelId) {\r\n            this.props.actions.close();\r\n        }\r\n\r\n        this.updateUnreadIndicators();\r\n    }\r\n\r\n    getDisplayedChannelIds = () => {\r\n        return this.props.displayedChannels.map((channel) => channel.id);\r\n    };\r\n\r\n    getDisplayedStaticPageIds = () => {\r\n        return this.props.staticPages.map((item) => item.id);\r\n    };\r\n\r\n    setChannelRef = (channelId: string, ref: HTMLLIElement) => {\r\n        if (ref) {\r\n            this.channelRefs.set(channelId, ref);\r\n        } else {\r\n            this.channelRefs.delete(channelId);\r\n        }\r\n    };\r\n\r\n    getFirstUnreadChannelFromChannelIdArray = (channelIds: string[]) => {\r\n        return channelIds.find((channelId) => {\r\n            return channelId !== this.props.currentChannelId && this.props.unreadChannelIds.includes(channelId);\r\n        });\r\n    };\r\n\r\n    handleScrollAnimationUpdate = (spring: Spring) => {\r\n        const val = spring.getCurrentValue();\r\n        this.scrollbar.current!.scrollTo?.({top: val});\r\n    };\r\n\r\n    scrollToFirstUnreadChannel = () => {\r\n        this.scrollToChannel(this.getFirstUnreadChannel(), true);\r\n    };\r\n\r\n    scrollToLastUnreadChannel = () => {\r\n        this.scrollToChannel(this.getLastUnreadChannel(), true);\r\n    };\r\n\r\n    scrollToChannel = (channelId: string | null | undefined, scrollingToUnread = false) => {\r\n        if (!channelId) {\r\n            return;\r\n        }\r\n\r\n        const element = this.channelRefs.get(channelId);\r\n        if (!element) {\r\n            return;\r\n        }\r\n\r\n        const top = element.offsetTop;\r\n        const bottom = top + element.offsetHeight;\r\n\r\n        const scrollTop = this.scrollbar.current!.scrollTop;\r\n        const clientHeight = this.scrollbar.current!.clientHeight;\r\n\r\n        if (top < (scrollTop + categoryHeaderHeight)) {\r\n            // Scroll up to the item\r\n            const margin = (scrollingToUnread || !this.state.showTopUnread) ? scrollMargin : scrollMarginWithUnread;\r\n\r\n            let scrollEnd;\r\n            const displayedChannels = this.getDisplayedChannelIds();\r\n            if (displayedChannels.length > 0 && displayedChannels[0] === channelId) {\r\n                // This is the first channel, so scroll right to the top\r\n                scrollEnd = 0;\r\n            } else {\r\n                scrollEnd = top - margin - categoryHeaderHeight;\r\n            }\r\n\r\n            this.scrollToPosition(scrollEnd);\r\n        } else if (bottom > scrollTop + clientHeight) {\r\n            // Scroll down to the item\r\n            const margin = (scrollingToUnread || !this.state.showBottomUnread) ? scrollMargin : scrollMarginWithUnread;\r\n            const scrollEnd = (bottom - clientHeight) + margin;\r\n\r\n            this.scrollToPosition(scrollEnd);\r\n        }\r\n    };\r\n\r\n    scrollToPosition = (scrollEnd: number) => {\r\n        // Stop the current animation before scrolling\r\n        this.scrollAnimation.setCurrentValue(this.scrollbar.current!.scrollTop).setAtRest();\r\n\r\n        this.scrollAnimation.setEndValue(scrollEnd);\r\n    };\r\n\r\n    updateUnreadIndicators = () => {\r\n        if (this.props.draggingState.state) {\r\n            this.setState({\r\n                showTopUnread: false,\r\n                showBottomUnread: false,\r\n            });\r\n            return;\r\n        }\r\n\r\n        let showTopUnread = false;\r\n        let showBottomUnread = false;\r\n\r\n        // Consider partially obscured channels as above/below\r\n        const firstUnreadChannel = this.getFirstUnreadChannel();\r\n        const lastUnreadChannel = this.getLastUnreadChannel();\r\n\r\n        if (firstUnreadChannel) {\r\n            const firstUnreadElement = this.channelRefs.get(firstUnreadChannel);\r\n\r\n            if (firstUnreadElement && ((firstUnreadElement.offsetTop + firstUnreadElement.offsetHeight) - scrollMargin - categoryHeaderHeight) < this.scrollbar.current!.scrollTop) {\r\n                showTopUnread = true;\r\n            }\r\n        }\r\n\r\n        if (lastUnreadChannel) {\r\n            const lastUnreadElement = this.channelRefs.get(lastUnreadChannel);\r\n\r\n            if (lastUnreadElement && (lastUnreadElement.offsetTop + scrollMargin) > (this.scrollbar.current!.scrollTop + this.scrollbar.current!.clientHeight)) {\r\n                showBottomUnread = true;\r\n            }\r\n        }\r\n\r\n        if (showTopUnread !== this.state.showTopUnread || showBottomUnread !== this.state.showBottomUnread) {\r\n            this.setState({\r\n                showTopUnread,\r\n                showBottomUnread,\r\n            });\r\n        }\r\n    };\r\n\r\n    getFirstUnreadChannel = () => {\r\n        return this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds());\r\n    };\r\n\r\n    getLastUnreadChannel = () => {\r\n        return this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds().reverse());\r\n    };\r\n\r\n    navigateById = (id: string) => {\r\n        if (this.props.staticPages.findIndex((i) => i.id === id) === -1) {\r\n            this.props.actions.switchToChannelById(id);\r\n        } else {\r\n            this.props.actions.switchToLhsStaticPage(id);\r\n        }\r\n    };\r\n\r\n    navigateChannelShortcut = (e: KeyboardEvent) => {\r\n        if (e.altKey && !e.shiftKey && !e.ctrlKey && !e.metaKey && (isKeyPressed(e, Constants.KeyCodes.UP) || isKeyPressed(e, Constants.KeyCodes.DOWN))) {\r\n            e.preventDefault();\r\n\r\n            const staticPageIds = this.getDisplayedStaticPageIds();\r\n            const allIds = [...staticPageIds, ...this.getDisplayedChannelIds()];\r\n\r\n            const curSelectedId = this.props.currentChannelId || this.props.currentStaticPageId;\r\n            const curIndex = allIds.indexOf(curSelectedId);\r\n\r\n            let nextIndex;\r\n            if (isKeyPressed(e, Constants.KeyCodes.DOWN)) {\r\n                nextIndex = curIndex + 1;\r\n            } else {\r\n                nextIndex = curIndex - 1;\r\n            }\r\n\r\n            const nextId = allIds[mod(nextIndex, allIds.length)];\r\n            this.navigateById(nextId);\r\n            if (nextIndex >= staticPageIds.length) {\r\n                this.scrollToChannel(nextId);\r\n            }\r\n        } else if (cmdOrCtrlPressed(e) && e.shiftKey && isKeyPressed(e, Constants.KeyCodes.K)) {\r\n            this.props.handleOpenMoreDirectChannelsModal(e);\r\n        }\r\n    };\r\n\r\n    navigateUnreadChannelShortcut = (e: KeyboardEvent) => {\r\n        if (e.altKey && e.shiftKey && !e.ctrlKey && !e.metaKey && (isKeyPressed(e, Constants.KeyCodes.UP) || isKeyPressed(e, Constants.KeyCodes.DOWN))) {\r\n            e.preventDefault();\r\n\r\n            const allChannelIds = this.getDisplayedChannelIds();\r\n            const unreadChannelIds = [...this.props.unreadChannelIds];\r\n\r\n            if (this.props.collapsedThreads) {\r\n                allChannelIds.unshift('');\r\n\r\n                if (this.props.hasUnreadThreads) {\r\n                    unreadChannelIds.unshift('');\r\n                }\r\n            }\r\n\r\n            let direction = 0;\r\n            if (isKeyPressed(e, Constants.KeyCodes.UP)) {\r\n                direction = -1;\r\n            } else {\r\n                direction = 1;\r\n            }\r\n\r\n            const nextIndex = findNextUnreadChannelId(\r\n                this.props.currentChannelId,\r\n                allChannelIds,\r\n                unreadChannelIds,\r\n                direction,\r\n            );\r\n\r\n            if (nextIndex !== -1) {\r\n                const nextChannelId = allChannelIds[nextIndex];\r\n                this.navigateById(nextChannelId);\r\n                this.scrollToChannel(nextChannelId);\r\n            }\r\n        }\r\n    };\r\n\r\n    renderCategory = (category: ChannelCategory, index: number) => {\r\n        return (\r\n            <SidebarCategory\r\n                key={category.id}\r\n                category={category}\r\n                categoryIndex={index}\r\n                setChannelRef={this.setChannelRef}\r\n                handleOpenMoreDirectChannelsModal={this.props.handleOpenMoreDirectChannelsModal}\r\n                isNewCategory={this.props.newCategoryIds.includes(category.id)}\r\n            />\r\n        );\r\n    };\r\n\r\n    onScroll = debounce(() => {\r\n        this.updateUnreadIndicators();\r\n    }, 100);\r\n\r\n    onTransitionEnd = debounce(() => {\r\n        this.updateUnreadIndicators();\r\n    }, 100);\r\n\r\n    onBeforeCapture = (before: BeforeCapture) => {\r\n        // // Ensure no channels are animating\r\n        this.channelRefs.forEach((ref) => ref.classList.remove('animating'));\r\n\r\n        // Turn off scrolling temporarily so that dimensions can be captured\r\n        const droppable = [...document.querySelectorAll<HTMLDivElement>('[data-rbd-droppable-id*=\"droppable-categories\"]')];\r\n        droppable[0].style.height = `${droppable[0].scrollHeight}px`;\r\n\r\n        if (!this.props.multiSelectedChannelIds.find((id) => before.draggableId === id)) {\r\n            this.props.actions.clearChannelSelection();\r\n        }\r\n\r\n        const draggingState: DraggingState = {\r\n            state: DraggingStates.CAPTURE,\r\n            id: before.draggableId,\r\n        };\r\n\r\n        if (this.props.categories.some((category) => category.id === before.draggableId)) {\r\n            draggingState.type = DraggingStateTypes.CATEGORY;\r\n        } else {\r\n            const draggingChannels = this.props.displayedChannels.filter((channel) => this.props.multiSelectedChannelIds.indexOf(channel.id) !== -1 || channel.id === before.draggableId);\r\n            if (draggingChannels.every((channel) => channel.type === General.DM_CHANNEL || channel.type === General.GM_CHANNEL)) {\r\n                draggingState.type = DraggingStateTypes.DM;\r\n            } else if (draggingChannels.every((channel) => channel.type !== General.DM_CHANNEL && channel.type !== General.GM_CHANNEL)) {\r\n                draggingState.type = DraggingStateTypes.CHANNEL;\r\n            } else {\r\n                draggingState.type = DraggingStateTypes.MIXED_CHANNELS;\r\n            }\r\n        }\r\n\r\n        this.props.actions.setDraggingState(draggingState);\r\n    };\r\n\r\n    onBeforeDragStart = () => {\r\n        this.props.actions.setDraggingState({state: DraggingStates.BEFORE});\r\n    };\r\n\r\n    onDragStart = (initial: DragStart) => {\r\n        this.props.onDragStart(initial);\r\n\r\n        this.props.actions.setDraggingState({state: DraggingStates.DURING});\r\n\r\n        // Re-enable scroll box resizing\r\n        const droppable = [...document.querySelectorAll<HTMLDivElement>('[data-rbd-droppable-id*=\"droppable-categories\"]')];\r\n        droppable[0].style.height = '';\r\n    };\r\n\r\n    onDragEnd = (result: DropResult) => {\r\n        this.props.onDragEnd(result);\r\n\r\n        if (result.reason === 'DROP' && result.destination) {\r\n            if (result.type === 'SIDEBAR_CHANNEL') {\r\n                this.props.actions.moveChannelsInSidebar(result.destination.droppableId, result.destination.index, result.draggableId);\r\n            } else if (result.type === 'SIDEBAR_CATEGORY') {\r\n                this.props.actions.moveCategory(this.props.currentTeam!.id, result.draggableId, result.destination.index);\r\n            }\r\n        }\r\n\r\n        this.props.actions.stopDragging();\r\n    };\r\n\r\n    render() {\r\n        const {categories} = this.props;\r\n\r\n        let channelList: React.ReactNode;\r\n        if (this.props.isUnreadFilterEnabled) {\r\n            channelList = (\r\n                <UnreadChannels\r\n                    setChannelRef={this.setChannelRef}\r\n                />\r\n            );\r\n        } else {\r\n            let unreadsCategory;\r\n            if (this.props.showUnreadsCategory) {\r\n                unreadsCategory = (\r\n                    <UnreadChannels\r\n                        setChannelRef={this.setChannelRef}\r\n                    />\r\n                );\r\n            }\r\n\r\n            const renderedCategories = categories.map(this.renderCategory);\r\n\r\n            channelList = (\r\n                <>\r\n                    {unreadsCategory}\r\n                    <DragDropContext\r\n                        onDragEnd={this.onDragEnd}\r\n                        onBeforeDragStart={this.onBeforeDragStart}\r\n                        onBeforeCapture={this.onBeforeCapture}\r\n                        onDragStart={this.onDragStart}\r\n                    >\r\n                        <Droppable\r\n                            droppableId='droppable-categories'\r\n                            type='SIDEBAR_CATEGORY'\r\n                        >\r\n                            {(provided) => {\r\n                                return (\r\n                                    <div\r\n                                        id={'sidebar-droppable-categories'}\r\n                                        ref={provided.innerRef}\r\n                                        {...provided.droppableProps}\r\n                                    >\r\n                                        {renderedCategories}\r\n                                        {provided.placeholder}\r\n                                    </div>\r\n                                );\r\n                            }}\r\n                        </Droppable>\r\n                    </DragDropContext>\r\n                </>\r\n            );\r\n        }\r\n\r\n        const above = (\r\n            <FormattedMessage\r\n                id='sidebar.unreads'\r\n                defaultMessage='More unreads'\r\n            />\r\n        );\r\n\r\n        const below = (\r\n            <FormattedMessage\r\n                id='sidebar.unreads'\r\n                defaultMessage='More unreads'\r\n            />\r\n        );\r\n\r\n        const ariaLabel = this.props.intl.formatMessage({id: 'accessibility.sections.lhsList', defaultMessage: 'channel sidebar region'});\r\n\r\n        return (\r\n\r\n            // NOTE: id attribute added to temporarily support the desktop app's at-mention DOM scraping of the old sidebar\r\n            <>\r\n                <GlobalThreadsLink/>\r\n                <DraftsLink/>\r\n                <div\r\n                    id='sidebar-left'\r\n                    role='application'\r\n                    aria-label={ariaLabel}\r\n                    className={classNames('SidebarNavContainer a11y__region', {\r\n                        disabled: this.props.isUnreadFilterEnabled,\r\n                    })}\r\n                    data-a11y-disable-nav={Boolean(this.props.draggingState.type)}\r\n                    data-a11y-sort-order='7'\r\n                    onTransitionEnd={this.onTransitionEnd}\r\n                >\r\n                    <UnreadChannelIndicator\r\n                        name='Top'\r\n                        show={this.state.showTopUnread}\r\n                        onClick={this.scrollToFirstUnreadChannel}\r\n                        extraClass='nav-pills__unread-indicator-top'\r\n                        content={above}\r\n                    />\r\n                    <UnreadChannelIndicator\r\n                        name='Bottom'\r\n                        show={this.state.showBottomUnread}\r\n                        onClick={this.scrollToLastUnreadChannel}\r\n                        extraClass='nav-pills__unread-indicator-bottom'\r\n                        content={below}\r\n                    />\r\n                    <Scrollbars\r\n                        ref={this.scrollbar}\r\n                        onScroll={this.onScroll}\r\n                    >\r\n                        {channelList}\r\n                    </Scrollbars>\r\n                </div>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(SidebarList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {moveCategory} from 'mattermost-redux/actions/channel_categories';\r\nimport {getCurrentChannelId, getUnreadChannelIds} from 'mattermost-redux/selectors/entities/channels';\r\nimport {shouldShowUnreadsCategory, isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getThreadCountsInCurrentTeam} from 'mattermost-redux/selectors/entities/threads';\r\n\r\nimport {switchToChannelById} from 'actions/views/channel';\r\nimport {\r\n    moveChannelsInSidebar,\r\n    setDraggingState,\r\n    stopDragging,\r\n    clearChannelSelection,\r\n} from 'actions/views/channel_sidebar';\r\nimport {close, switchToLhsStaticPage} from 'actions/views/lhs';\r\nimport {getCurrentStaticPageId, getVisibleStaticPages} from 'selectors/lhs';\r\nimport {\r\n    getDisplayedChannels,\r\n    getDraggingState,\r\n    getCategoriesForCurrentTeam,\r\n    isUnreadFilterEnabled,\r\n} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarList from './sidebar_list';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const currentTeam = getCurrentTeam(state);\r\n    const collapsedThreads = isCollapsedThreadsEnabled(state);\r\n\r\n    let hasUnreadThreads = false;\r\n    if (collapsedThreads) {\r\n        hasUnreadThreads = Boolean(getThreadCountsInCurrentTeam(state)?.total_unread_threads);\r\n    }\r\n\r\n    return {\r\n        currentTeam,\r\n        currentChannelId: getCurrentChannelId(state),\r\n        categories: getCategoriesForCurrentTeam(state),\r\n        isUnreadFilterEnabled: isUnreadFilterEnabled(state),\r\n        unreadChannelIds: getUnreadChannelIds(state),\r\n        displayedChannels: getDisplayedChannels(state),\r\n        draggingState: getDraggingState(state),\r\n        newCategoryIds: state.views.channelSidebar.newCategoryIds,\r\n        multiSelectedChannelIds: state.views.channelSidebar.multiSelectedChannelIds,\r\n        showUnreadsCategory: shouldShowUnreadsCategory(state),\r\n        collapsedThreads,\r\n        hasUnreadThreads,\r\n        currentStaticPageId: getCurrentStaticPageId(state),\r\n        staticPages: getVisibleStaticPages(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            close,\r\n            switchToChannelById,\r\n            moveChannelsInSidebar,\r\n            moveCategory,\r\n            setDraggingState,\r\n            stopDragging,\r\n            clearChannelSelection,\r\n            switchToLhsStaticPage,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {lazy} from 'react';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport DataPrefetch from 'components/data_prefetch';\r\nimport ResizableLhs from 'components/resizable_sidebar/resizable_lhs';\r\nimport SidebarHeader from 'components/sidebar/sidebar_header';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport Constants, {ModalIdentifiers, RHSStates} from 'utils/constants';\r\nimport {isKeyPressed, cmdOrCtrlPressed} from 'utils/keyboard';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nimport type {ModalData} from 'types/actions';\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nimport ChannelNavigator from './channel_navigator';\r\nimport SidebarList from './sidebar_list';\r\n\r\nconst MobileSidebarHeader = makeAsyncComponent('MobileSidebarHeader', lazy(() => import('./mobile_sidebar_header')));\r\nconst MoreDirectChannels = makeAsyncComponent('MoreDirectChannels', lazy(() => import('components/more_direct_channels')));\r\nconst BrowseChannels = makeAsyncComponent('BrowseChannels', lazy(() => import('components/browse_channels')));\r\nconst EditCategoryModal = makeAsyncComponent('EditCategoryModal', lazy(() => import('components/edit_category_modal')));\r\nconst CreateUserGroupsModal = makeAsyncComponent('CreateUserGroupsModal', lazy(() => import('components/create_user_groups_modal')));\r\nconst InvitationModal = makeAsyncComponent('InvitationModal', lazy(() => import('components/invitation_modal')));\r\nconst KeyboardShortcutsModal = makeAsyncComponent('KeyboardShortcutsModal', lazy(() => import('components/keyboard_shortcuts/keyboard_shortcuts_modal/keyboard_shortcuts_modal')));\r\nconst NewChannelModal = makeAsyncComponent('NewChannelModal', lazy(() => import('components/new_channel_modal/new_channel_modal')));\r\nconst UserSettingsModal = makeAsyncComponent('UserSettingsModal', lazy(() => import('components/user_settings/modal')));\r\n\r\ntype Props = {\r\n    teamId: string;\r\n    canCreatePublicChannel: boolean;\r\n    canCreatePrivateChannel: boolean;\r\n    canJoinPublicChannel: boolean;\r\n    isOpen: boolean;\r\n    actions: {\r\n        fetchMyCategories: (teamId: string) => void;\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n        closeModal: (modalId: string) => void;\r\n        clearChannelSelection: () => void;\r\n        closeRightHandSide: () => void;\r\n    };\r\n    unreadFilterEnabled: boolean;\r\n    isMobileView: boolean;\r\n    isKeyBoardShortcutModalOpen: boolean;\r\n    canCreateCustomGroups: boolean;\r\n    rhsState?: RhsState;\r\n    rhsOpen?: boolean;\r\n};\r\n\r\ntype State = {\r\n    showDirectChannelsModal: boolean;\r\n    isDragging: boolean;\r\n};\r\n\r\nexport default class Sidebar extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            showDirectChannelsModal: false,\r\n            isDragging: false,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.teamId) {\r\n            this.props.actions.fetchMyCategories(this.props.teamId);\r\n        }\r\n\r\n        window.addEventListener('click', this.handleClickClearChannelSelection);\r\n        window.addEventListener('keydown', this.handleKeyDownEvent);\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (this.props.teamId && prevProps.teamId !== this.props.teamId) {\r\n            this.props.actions.fetchMyCategories(this.props.teamId);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        window.removeEventListener('click', this.handleClickClearChannelSelection);\r\n        window.removeEventListener('keydown', this.handleKeyDownEvent);\r\n    }\r\n\r\n    handleClickClearChannelSelection = (event: MouseEvent) => {\r\n        if (event.defaultPrevented) {\r\n            return;\r\n        }\r\n\r\n        this.props.actions.clearChannelSelection();\r\n    };\r\n\r\n    handleKeyDownEvent = (event: KeyboardEvent) => {\r\n        if (isKeyPressed(event, Constants.KeyCodes.ESCAPE)) {\r\n            this.props.actions.clearChannelSelection();\r\n            return;\r\n        }\r\n\r\n        const ctrlOrMetaKeyPressed = cmdOrCtrlPressed(event, true);\r\n\r\n        if (ctrlOrMetaKeyPressed) {\r\n            if (isKeyPressed(event, Constants.KeyCodes.FORWARD_SLASH)) {\r\n                event.preventDefault();\r\n                if (this.props.isKeyBoardShortcutModalOpen) {\r\n                    this.props.actions.closeModal(ModalIdentifiers.KEYBOARD_SHORTCUTS_MODAL);\r\n                } else {\r\n                    this.props.actions.openModal({\r\n                        modalId: ModalIdentifiers.KEYBOARD_SHORTCUTS_MODAL,\r\n                        dialogType: KeyboardShortcutsModal,\r\n                    });\r\n                }\r\n            } else if (isKeyPressed(event, Constants.KeyCodes.A) && event.shiftKey) {\r\n                event.preventDefault();\r\n\r\n                this.props.actions.openModal({\r\n                    modalId: ModalIdentifiers.USER_SETTINGS,\r\n                    dialogType: UserSettingsModal,\r\n                    dialogProps: {\r\n                        isContentProductSettings: true,\r\n                        focusOriginElement: 'sidebar.tsx',\r\n                    },\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    showMoreDirectChannelsModal = () => {\r\n        this.setState({showDirectChannelsModal: true});\r\n    };\r\n\r\n    hideMoreDirectChannelsModal = () => {\r\n        this.setState({showDirectChannelsModal: false});\r\n    };\r\n\r\n    showCreateCategoryModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.EDIT_CATEGORY,\r\n            dialogType: EditCategoryModal,\r\n            dialogProps: {},\r\n        });\r\n    };\r\n\r\n    showMoreChannelsModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.MORE_CHANNELS,\r\n            dialogType: BrowseChannels,\r\n        });\r\n    };\r\n\r\n    invitePeopleModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.INVITATION,\r\n            dialogType: InvitationModal,\r\n            dialogProps: {focusOriginElement: 'browseOrAddChannelMenuButton'},\r\n        });\r\n    };\r\n\r\n    showNewChannelModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.NEW_CHANNEL_MODAL,\r\n            dialogType: NewChannelModal,\r\n        });\r\n        this.closeEditRHS();\r\n    };\r\n\r\n    showCreateUserGroupModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.USER_GROUPS_CREATE,\r\n            dialogType: CreateUserGroupsModal,\r\n        });\r\n    };\r\n\r\n    handleOpenMoreDirectChannelsModal = (e?: Event) => {\r\n        e?.preventDefault();\r\n        if (this.state.showDirectChannelsModal) {\r\n            this.hideMoreDirectChannelsModal();\r\n        } else {\r\n            this.showMoreDirectChannelsModal();\r\n            this.closeEditRHS();\r\n        }\r\n    };\r\n\r\n    onDragStart = () => {\r\n        this.setState({isDragging: true});\r\n    };\r\n\r\n    onDragEnd = () => {\r\n        this.setState({isDragging: false});\r\n    };\r\n\r\n    renderModals = () => {\r\n        let moreDirectChannelsModal;\r\n        if (this.state.showDirectChannelsModal) {\r\n            moreDirectChannelsModal = (\r\n                <MoreDirectChannels\r\n                    onModalDismissed={this.hideMoreDirectChannelsModal}\r\n                    isExistingChannel={false}\r\n                    focusOriginElement='newDirectMessageButton'\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <>\r\n                {moreDirectChannelsModal}\r\n            </>\r\n        );\r\n    };\r\n\r\n    closeEditRHS = () => {\r\n        if (this.props.rhsOpen && this.props.rhsState === RHSStates.EDIT_HISTORY) {\r\n            this.props.actions.closeRightHandSide();\r\n        }\r\n    };\r\n\r\n    render() {\r\n        if (!this.props.teamId) {\r\n            return (<div/>);\r\n        }\r\n\r\n        const ariaLabel = localizeMessage({id: 'accessibility.sections.lhsNavigator', defaultMessage: 'channel navigator region'});\r\n\r\n        return (\r\n            <ResizableLhs\r\n                id='SidebarContainer'\r\n                className={classNames({\r\n                    'move--right': this.props.isOpen && this.props.isMobileView,\r\n                    dragging: this.state.isDragging,\r\n                })}\r\n            >\r\n                {this.props.isMobileView ? <MobileSidebarHeader/> : (\r\n                    <SidebarHeader\r\n                        showNewChannelModal={this.showNewChannelModal}\r\n                        showMoreChannelsModal={this.showMoreChannelsModal}\r\n                        showCreateUserGroupModal={this.showCreateUserGroupModal}\r\n                        invitePeopleModal={this.invitePeopleModal}\r\n                        showCreateCategoryModal={this.showCreateCategoryModal}\r\n                        canCreateChannel={this.props.canCreatePrivateChannel || this.props.canCreatePublicChannel}\r\n                        canJoinPublicChannel={this.props.canJoinPublicChannel}\r\n                        handleOpenDirectMessagesModal={this.handleOpenMoreDirectChannelsModal}\r\n                        unreadFilterEnabled={this.props.unreadFilterEnabled}\r\n                        canCreateCustomGroups={this.props.canCreateCustomGroups}\r\n                    />\r\n                )}\r\n                <div\r\n                    id='lhsNavigator'\r\n                    role='application'\r\n                    aria-label={ariaLabel}\r\n                    className='a11y__region'\r\n                    data-a11y-sort-order='6'\r\n                >\r\n                    <ChannelNavigator/>\r\n                </div>\r\n                <div className='sidebar--left__icons'>\r\n                    <Pluggable pluggableName='LeftSidebarHeader'/>\r\n                </div>\r\n                <SidebarList\r\n                    handleOpenMoreDirectChannelsModal={this.handleOpenMoreDirectChannelsModal}\r\n                    onDragStart={this.onDragStart}\r\n                    onDragEnd={this.onDragEnd}\r\n                />\r\n                <DataPrefetch/>\r\n                {this.renderModals()}\r\n            </ResizableLhs>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {fetchMyCategories} from 'mattermost-redux/actions/channel_categories';\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport {isCustomGroupsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {haveICurrentChannelPermission, haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {clearChannelSelection} from 'actions/views/channel_sidebar';\r\nimport {closeModal, openModal} from 'actions/views/modals';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getIsLhsOpen} from 'selectors/lhs';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\nimport {isUnreadFilterEnabled} from 'selectors/views/channel_sidebar';\r\nimport {isModalOpen} from 'selectors/views/modals';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport Sidebar from './sidebar';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const currentTeam = getCurrentTeam(state);\r\n    const unreadFilterEnabled = isUnreadFilterEnabled(state);\r\n\r\n    let canCreatePublicChannel = false;\r\n    let canCreatePrivateChannel = false;\r\n    let canJoinPublicChannel = false;\r\n\r\n    if (currentTeam) {\r\n        canCreatePublicChannel = haveICurrentChannelPermission(state, Permissions.CREATE_PUBLIC_CHANNEL);\r\n        canCreatePrivateChannel = haveICurrentChannelPermission(state, Permissions.CREATE_PRIVATE_CHANNEL);\r\n        canJoinPublicChannel = haveICurrentChannelPermission(state, Permissions.JOIN_PUBLIC_CHANNELS);\r\n    }\r\n\r\n    const canCreateCustomGroups = isCustomGroupsEnabled(state) && haveISystemPermission(state, {permission: Permissions.CREATE_CUSTOM_GROUP});\r\n\r\n    return {\r\n        teamId: currentTeam ? currentTeam.id : '',\r\n        canCreatePrivateChannel,\r\n        canCreatePublicChannel,\r\n        canJoinPublicChannel,\r\n        isOpen: getIsLhsOpen(state),\r\n        unreadFilterEnabled,\r\n        isMobileView: getIsMobileView(state),\r\n        isKeyBoardShortcutModalOpen: isModalOpen(state, ModalIdentifiers.KEYBOARD_SHORTCUTS_MODAL),\r\n        canCreateCustomGroups,\r\n        rhsState: getRhsState(state),\r\n        rhsOpen: getIsRhsOpen(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            clearChannelSelection,\r\n            fetchMyCategories,\r\n            openModal,\r\n            closeModal,\r\n            closeRightHandSide,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidebar);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useEffect, useRef} from 'react';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\n\r\nimport {resetReloadPostsInChannel} from 'mattermost-redux/actions/posts';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nconst PostsChannelResetWatcher = () => {\r\n    const dispatch = useDispatch();\r\n    const isCRTEnabled = useSelector(isCollapsedThreadsEnabled);\r\n    const loaded = useRef(false);\r\n    useEffect(() => {\r\n        if (loaded.current) {\r\n            dispatch(resetReloadPostsInChannel());\r\n        } else {\r\n            loaded.current = true;\r\n        }\r\n    }, [isCRTEnabled]);\r\n    return null;\r\n};\r\n\r\nexport default PostsChannelResetWatcher;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {basicUnreadMeta} from 'mattermost-redux/selectors/entities/channels';\r\nimport type {BasicUnreadStatus} from 'mattermost-redux/selectors/entities/channels';\r\nimport {ensureString} from 'mattermost-redux/utils/post_utils';\r\n\r\nimport faviconDefault16x16 from 'images/favicon/favicon-default-16x16.png';\r\nimport faviconDefault24x24 from 'images/favicon/favicon-default-24x24.png';\r\nimport faviconDefault32x32 from 'images/favicon/favicon-default-32x32.png';\r\nimport faviconDefault64x64 from 'images/favicon/favicon-default-64x64.png';\r\nimport faviconDefault96x96 from 'images/favicon/favicon-default-96x96.png';\r\nimport faviconMention16x16 from 'images/favicon/favicon-mentions-16x16.png';\r\nimport faviconMention24x24 from 'images/favicon/favicon-mentions-24x24.png';\r\nimport faviconMention32x32 from 'images/favicon/favicon-mentions-32x32.png';\r\nimport faviconMention64x64 from 'images/favicon/favicon-mentions-64x64.png';\r\nimport faviconMention96x96 from 'images/favicon/favicon-mentions-96x96.png';\r\nimport faviconUnread16x16 from 'images/favicon/favicon-unread-16x16.png';\r\nimport faviconUnread24x24 from 'images/favicon/favicon-unread-24x24.png';\r\nimport faviconUnread32x32 from 'images/favicon/favicon-unread-32x32.png';\r\nimport faviconUnread64x64 from 'images/favicon/favicon-unread-64x64.png';\r\nimport faviconUnread96x96 from 'images/favicon/favicon-unread-96x96.png';\r\nimport {Constants} from 'utils/constants';\r\nimport DesktopApp from 'utils/desktop_api';\r\nimport * as UserAgent from 'utils/user_agent';\r\n\r\nenum BadgeStatus {\r\n    Mention = 'Mention',\r\n    Unread = 'Unread',\r\n    None = 'None'\r\n}\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    unreadStatus: BasicUnreadStatus;\r\n    siteName?: string;\r\n    currentChannel?: Channel;\r\n    currentTeam?: Team;\r\n    currentTeammate: Channel | null;\r\n    inGlobalThreads: boolean;\r\n    inDrafts: boolean;\r\n    inScheduledPosts: boolean;\r\n};\r\n\r\nexport class UnreadsStatusHandlerClass extends React.PureComponent<Props> {\r\n    componentDidUpdate(prevProps: Props) {\r\n        this.updateTitle();\r\n        const oldBadgeStatus = this.getBadgeStatus(prevProps.unreadStatus);\r\n        const newBadgeStatus = this.getBadgeStatus(this.props.unreadStatus);\r\n\r\n        if (oldBadgeStatus !== newBadgeStatus) {\r\n            this.updateFavicon(newBadgeStatus);\r\n        }\r\n\r\n        this.updateDesktopApp();\r\n    }\r\n\r\n    get isDynamicFaviconSupported() {\r\n        return UserAgent.isChrome() || UserAgent.isFirefox();\r\n    }\r\n\r\n    getBadgeStatus(unreadStatus: BasicUnreadStatus) {\r\n        if (typeof unreadStatus === 'number') {\r\n            return BadgeStatus.Mention;\r\n        } else if (unreadStatus) {\r\n            return BadgeStatus.Unread;\r\n        }\r\n        return BadgeStatus.None;\r\n    }\r\n\r\n    updateDesktopApp = () => {\r\n        const {unreadStatus} = this.props;\r\n        const {isUnread, unreadMentionCount} = basicUnreadMeta(unreadStatus);\r\n\r\n        DesktopApp.updateUnreadsAndMentions(isUnread, unreadMentionCount);\r\n    };\r\n\r\n    updateTitle = () => {\r\n        const {\r\n            siteName,\r\n            currentChannel,\r\n            currentTeam,\r\n            currentTeammate,\r\n            unreadStatus,\r\n            inGlobalThreads,\r\n            inDrafts,\r\n            inScheduledPosts,\r\n        } = this.props;\r\n        const {formatMessage} = this.props.intl;\r\n\r\n        const currentSiteName = siteName || '';\r\n\r\n        const {isUnread, unreadMentionCount} = basicUnreadMeta(unreadStatus);\r\n\r\n        const mentionTitle = unreadMentionCount > 0 ? `(${unreadMentionCount}) ` : '';\r\n        const unreadTitle = !this.isDynamicFaviconSupported && isUnread ? '* ' : '';\r\n\r\n        if (currentChannel && currentTeam && currentChannel.id) {\r\n            let currentChannelName = currentChannel.display_name;\r\n            if (currentChannel.type === Constants.DM_CHANNEL) {\r\n                if (currentTeammate != null) {\r\n                    currentChannelName = currentTeammate.display_name;\r\n                }\r\n            }\r\n            document.title = `${mentionTitle}${unreadTitle}${currentChannelName} - ${currentTeam.display_name} ${currentSiteName}`;\r\n        } else if (currentTeam && inGlobalThreads) {\r\n            document.title = formatMessage({\r\n                id: 'globalThreads.title',\r\n                defaultMessage: '{prefix}Threads - {displayName} {siteName}',\r\n            }, {\r\n                prefix: `${mentionTitle}${unreadTitle}`,\r\n                displayName: currentTeam.display_name,\r\n                siteName: currentSiteName,\r\n            });\r\n        } else if (currentTeam && inDrafts) {\r\n            document.title = formatMessage({\r\n                id: 'drafts.title',\r\n                defaultMessage: '{prefix}Drafts - {displayName} {siteName}',\r\n            }, {\r\n                prefix: `${mentionTitle}${unreadTitle}`,\r\n                displayName: currentTeam.display_name,\r\n                siteName: currentSiteName,\r\n            });\r\n        } else if (currentTeam && inScheduledPosts) {\r\n            document.title = formatMessage({\r\n                id: 'scheduledPosts.title',\r\n                defaultMessage: '{prefix}Scheduled - {displayName} {siteName}',\r\n            }, {\r\n                prefix: `${mentionTitle}${unreadTitle}`,\r\n                displayName: currentTeam.display_name,\r\n                siteName: currentSiteName,\r\n            });\r\n        } else {\r\n            document.title = formatMessage({id: 'sidebar.team_select', defaultMessage: '{siteName} - Join a team'}, {siteName: currentSiteName || 'Mattermost'});\r\n        }\r\n    };\r\n\r\n    updateFavicon = (badgeStatus: BadgeStatus) => {\r\n        if (!(UserAgent.isFirefox() || UserAgent.isChrome())) {\r\n            return;\r\n        }\r\n\r\n        const link = document.querySelector('link[rel=\"icon\"]');\r\n\r\n        if (!link) {\r\n            return;\r\n        }\r\n        const link16x16 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"16x16\"]');\r\n        const link24x24 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"24x24\"]');\r\n        const link32x32 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"32x32\"]');\r\n        const link64x64 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"64x64\"]');\r\n        const link96x96 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"96x96\"]');\r\n\r\n        const getFavicon = (url: string): string => ensureString(url);\r\n\r\n        switch (badgeStatus) {\r\n        case BadgeStatus.Mention: {\r\n            link16x16!.href = getFavicon(faviconMention16x16);\r\n            link24x24!.href = getFavicon(faviconMention24x24);\r\n            link32x32!.href = getFavicon(faviconMention32x32);\r\n            link64x64!.href = getFavicon(faviconMention64x64);\r\n            link96x96!.href = getFavicon(faviconMention96x96);\r\n            break;\r\n        }\r\n        case BadgeStatus.Unread: {\r\n            link16x16!.href = getFavicon(faviconUnread16x16);\r\n            link24x24!.href = getFavicon(faviconUnread24x24);\r\n            link32x32!.href = getFavicon(faviconUnread32x32);\r\n            link64x64!.href = getFavicon(faviconUnread64x64);\r\n            link96x96!.href = getFavicon(faviconUnread96x96);\r\n            break;\r\n        }\r\n        default: {\r\n            link16x16!.href = getFavicon(faviconDefault16x16);\r\n            link24x24!.href = getFavicon(faviconDefault24x24);\r\n            link32x32!.href = getFavicon(faviconDefault32x32);\r\n            link64x64!.href = getFavicon(faviconDefault64x64);\r\n            link96x96!.href = getFavicon(faviconDefault96x96);\r\n        }\r\n        }\r\n    };\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default injectIntl(UnreadsStatusHandlerClass);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter, matchPath} from 'react-router-dom';\r\nimport type {RouteChildrenProps} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getCurrentChannel, getUnreadStatus} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport UnreadsStatusHandler from './unreads_status_handler';\r\n\r\ntype Props = RouteChildrenProps;\r\n\r\nfunction mapStateToProps(state: GlobalState, {location: {pathname}}: Props) {\r\n    const config = getConfig(state);\r\n    const currentChannel = getCurrentChannel(state);\r\n    const currentTeammate = (currentChannel && currentChannel.teammate_id) ? currentChannel : null;\r\n    const currentTeam = getCurrentTeam(state);\r\n\r\n    return {\r\n        currentChannel,\r\n        currentTeam,\r\n        currentTeammate,\r\n        siteName: config.SiteName,\r\n        unreadStatus: getUnreadStatus(state),\r\n        inGlobalThreads: matchPath(pathname, {path: '/:team/threads/:threadIdentifier?'}) != null,\r\n        inDrafts: matchPath(pathname, {path: '/:team/drafts'}) != null,\r\n        inScheduledPosts: matchPath(pathname, {path: '/:team/scheduled_posts'}) != null,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(UnreadsStatusHandler));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {lazy, useEffect} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {cleanUpStatusAndProfileFetchingPoll} from 'mattermost-redux/actions/status_profile_polling';\r\nimport {getIsUserStatusesConfigEnabled} from 'mattermost-redux/selectors/entities/common';\r\n\r\nimport {addVisibleUsersInCurrentChannelAndSelfToStatusPoll} from 'actions/status_actions';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport CenterChannel from 'components/channel_layout/center_channel';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport QueryParamActionController from 'components/query_param_actions/query_param_action_controller';\r\nimport Sidebar from 'components/sidebar';\r\nimport CRTPostsChannelResetWatcher from 'components/threading/channel_threads/posts_channel_reset_watcher';\r\nimport UnreadsStatusHandler from 'components/unreads_status_handler';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport {Constants} from 'utils/constants';\r\nimport {isInternetExplorer, isEdge} from 'utils/user_agent';\r\n\r\nconst ProductNoticesModal = makeAsyncComponent('ProductNoticesModal', lazy(() => import('components/product_notices_modal')));\r\nconst ResetStatusModal = makeAsyncComponent('ResetStatusModal', lazy(() => import('components/reset_status_modal')));\r\nconst MobileSidebarRight = makeAsyncComponent('MobileSidebarRight', lazy(() => import('components/mobile_sidebar_right')));\r\n\r\nconst BODY_CLASS_FOR_CHANNEL = ['app__body', 'channel-view'];\r\n\r\ntype Props = {\r\n    shouldRenderCenterChannel: boolean;\r\n}\r\n\r\nexport default function ChannelController(props: Props) {\r\n    const isMobileView = useSelector(getIsMobileView);\r\n    const enabledUserStatuses = useSelector(getIsUserStatusesConfigEnabled);\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        const isMsBrowser = isInternetExplorer() || isEdge();\r\n        const {navigator} = window;\r\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n        // @ts-ignore\r\n        const platform = navigator?.userAgentData?.platform || navigator?.platform || 'unknown';\r\n        document.body.classList.add(...getClassnamesForBody(platform, isMsBrowser));\r\n\r\n        return () => {\r\n            document.body.classList.remove(...BODY_CLASS_FOR_CHANNEL);\r\n\r\n            // This cleans up the status and profile setInterval of fetching poll we use to batch requests\r\n            // when fetching statuses and profiles for a list of users.\r\n            dispatch(cleanUpStatusAndProfileFetchingPoll());\r\n        };\r\n    }, []);\r\n\r\n    // Starts a regular interval to fetch statuses of users.\r\n    // see function \"addVisibleUsersInCurrentChannelAndSelfToStatusPoll\" for more details on which user's statuses are fetched.\r\n    useEffect(() => {\r\n        let loadStatusesIntervalId: NodeJS.Timeout;\r\n        if (enabledUserStatuses) {\r\n            loadStatusesIntervalId = setInterval(() => {\r\n                dispatch(addVisibleUsersInCurrentChannelAndSelfToStatusPoll());\r\n            }, Constants.STATUS_INTERVAL);\r\n        }\r\n\r\n        return () => {\r\n            clearInterval(loadStatusesIntervalId);\r\n        };\r\n    }, [enabledUserStatuses]);\r\n\r\n    return (\r\n        <>\r\n            <CRTPostsChannelResetWatcher/>\r\n            <QueryParamActionController/>\r\n            <Sidebar/>\r\n            <div\r\n                id='channel_view'\r\n                className='channel-view'\r\n                data-testid='channel_view'\r\n            >\r\n                <UnreadsStatusHandler/>\r\n                <ProductNoticesModal/>\r\n                <div className={classNames('container-fluid channel-view-inner')}>\r\n                    {props.shouldRenderCenterChannel ? <CenterChannel/> : <LoadingScreen centered={true}/>}\r\n                    <Pluggable pluggableName='Root'/>\r\n                    <ResetStatusModal/>\r\n                </div>\r\n            </div>\r\n            {isMobileView && <MobileSidebarRight/>}\r\n        </>\r\n    );\r\n}\r\n\r\nexport function getClassnamesForBody(platform: Window['navigator']['platform'], isMsBrowser = false) {\r\n    const bodyClass = [...BODY_CLASS_FOR_CHANNEL];\r\n\r\n    // OS Detection\r\n    if (platform === 'Win32' || platform === 'Win64') {\r\n        bodyClass.push('os--windows');\r\n    } else if (platform === 'MacIntel' || platform === 'MacPPC') {\r\n        bodyClass.push('os--mac');\r\n    }\r\n\r\n    // IE Detection\r\n    if (isMsBrowser) {\r\n        bodyClass.push('browser--ie');\r\n    }\r\n\r\n    return bodyClass;\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport iNoBounce from 'inobounce';\r\nimport React, {lazy, memo, useEffect, useRef, useState} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {Route, Switch, useHistory, useParams} from 'react-router-dom';\r\n\r\nimport type {ServerError} from '@mattermost/types/errors';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {getTeamContentFlaggingStatus} from 'mattermost-redux/actions/content_flagging';\r\nimport {\r\n    contentFlaggingFeatureEnabled,\r\n} from 'mattermost-redux/selectors/entities/content_flagging';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport {reconnect} from 'actions/websocket_actions.jsx';\r\nimport LocalStorageStore from 'stores/local_storage_store';\r\n\r\nimport {makeAsyncComponent, makeAsyncPluggableComponent} from 'components/async_load';\r\nimport ChannelController from 'components/channel_layout/channel_controller';\r\nimport useTelemetryIdentitySync from 'components/common/hooks/useTelemetryIdentifySync';\r\nimport InitialLoadingScreen from 'components/initial_loading_screen';\r\n\r\nimport Constants from 'utils/constants';\r\nimport DesktopApp from 'utils/desktop_api';\r\nimport {cmdOrCtrlPressed, isKeyPressed} from 'utils/keyboard';\r\nimport {TEAM_NAME_PATH_PATTERN} from 'utils/path';\r\nimport {isIosSafari} from 'utils/user_agent';\r\n\r\nimport type {OwnProps, PropsFromRedux} from './index';\r\n\r\nconst BackstageController = makeAsyncComponent('BackstageController', lazy(() => import('components/backstage')));\r\nconst Pluggable = makeAsyncPluggableComponent();\r\n\r\nconst WAKEUP_CHECK_INTERVAL = 30000; // 30 seconds\r\nconst WAKEUP_THRESHOLD = 60000; // 60 seconds\r\nconst UNREAD_CHECK_TIME_MILLISECONDS = 120 * 1000;\r\n\r\ndeclare global {\r\n    interface Window {\r\n        isActive: boolean;\r\n    }\r\n}\r\n\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\nfunction TeamController(props: Props) {\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n    const {team: teamNameParam} = useParams<Props['match']['params']>();\r\n\r\n    const [initialChannelsLoaded, setInitialChannelsLoaded] = useState(false);\r\n\r\n    const [team, setTeam] = useState<Team | null>(getTeamFromTeamList(props.teamsList, teamNameParam));\r\n\r\n    const contentFlaggingEnabled = useSelector(contentFlaggingFeatureEnabled);\r\n\r\n    const blurTime = useRef(Date.now());\r\n    const lastTime = useRef(Date.now());\r\n\r\n    useTelemetryIdentitySync();\r\n\r\n    useEffect(() => {\r\n        InitialLoadingScreen.stop('team_controller');\r\n        DesktopApp.reactAppInitialized();\r\n        async function fetchAllChannels() {\r\n            await props.fetchAllMyTeamsChannels();\r\n            setInitialChannelsLoaded(true);\r\n        }\r\n\r\n        props.fetchAllMyChannelMembers();\r\n        fetchAllChannels();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (props.disableWakeUpReconnectHandler) {\r\n            return () => {};\r\n        }\r\n\r\n        const wakeUpIntervalId = setInterval(() => {\r\n            const currentTime = Date.now();\r\n            if ((currentTime - lastTime.current) > WAKEUP_THRESHOLD) {\r\n                console.log('computer woke up - reconnecting'); //eslint-disable-line no-console\r\n                reconnect();\r\n            }\r\n            lastTime.current = currentTime;\r\n        }, WAKEUP_CHECK_INTERVAL);\r\n\r\n        return () => {\r\n            clearInterval(wakeUpIntervalId);\r\n        };\r\n    }, [props.disableWakeUpReconnectHandler]);\r\n\r\n    // Effect runs on mount, add event listeners on windows object\r\n    useEffect(() => {\r\n        function handleFocus() {\r\n            window.isActive = true;\r\n            props.markAsReadOnFocus();\r\n\r\n            // Temporary flag to disable refetching of channel members on browser focus\r\n            if (!props.disableRefetchingOnBrowserFocus) {\r\n                const currentTime = Date.now();\r\n                if ((currentTime - blurTime.current) > UNREAD_CHECK_TIME_MILLISECONDS && props.currentTeamId) {\r\n                    props.fetchChannelsAndMembers(props.currentTeamId);\r\n                }\r\n            }\r\n        }\r\n\r\n        function handleBlur() {\r\n            window.isActive = false;\r\n            blurTime.current = Date.now();\r\n            props.unsetActiveChannelOnServer();\r\n        }\r\n\r\n        function handleKeydown(event: KeyboardEvent) {\r\n            if (event.shiftKey && cmdOrCtrlPressed(event) && isKeyPressed(event, Constants.KeyCodes.L)) {\r\n                const replyTextbox = document.querySelector<HTMLElement>('#sidebar-right.is-open.expanded #reply_textbox');\r\n                if (replyTextbox) {\r\n                    replyTextbox.focus();\r\n                } else {\r\n                    const postTextbox = document.getElementById('post_textbox');\r\n                    if (postTextbox) {\r\n                        postTextbox.focus();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        window.addEventListener('focus', handleFocus);\r\n        window.addEventListener('blur', handleBlur);\r\n        window.addEventListener('keydown', handleKeydown);\r\n\r\n        return () => {\r\n            window.removeEventListener('focus', handleFocus);\r\n            window.removeEventListener('blur', handleBlur);\r\n            window.removeEventListener('keydown', handleKeydown);\r\n        };\r\n    }, [props.currentTeamId]);\r\n\r\n    // Load team content flagging status on team switch\r\n    useEffect(() => {\r\n        if (contentFlaggingEnabled && props.currentTeamId) {\r\n            dispatch(getTeamContentFlaggingStatus(props.currentTeamId));\r\n        }\r\n    }, [contentFlaggingEnabled, dispatch, props.currentTeamId]);\r\n\r\n    // Effect runs on mount, adds active state to window\r\n    useEffect(() => {\r\n        const browserIsIosSafari = isIosSafari();\r\n        if (browserIsIosSafari) {\r\n            // Use iNoBounce to prevent scrolling past the boundaries of the page\r\n            iNoBounce.enable();\r\n        }\r\n\r\n        // Set up tracking for whether the window is active\r\n        window.isActive = true;\r\n\r\n        LocalStorageStore.setTeamIdJoinedOnLoad(null);\r\n\r\n        return () => {\r\n            window.isActive = false;\r\n\r\n            if (browserIsIosSafari) {\r\n                iNoBounce.disable();\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    async function initTeamOrRedirect(team: Team) {\r\n        const {data: joinedTeam, error} = await props.initializeTeam(team) as ActionResult<Team, ServerError>; // Fix in MM-46907;\r\n        if (error) {\r\n            history.push('/error?type=team_not_found');\r\n            return;\r\n        }\r\n        if (joinedTeam) {\r\n            setTeam(joinedTeam);\r\n        }\r\n    }\r\n\r\n    async function joinTeamOrRedirect(teamNameParam: string, joinedOnFirstLoad: boolean) {\r\n        setTeam(null);\r\n\r\n        const {data: joinedTeam, error} = await props.joinTeam(teamNameParam, joinedOnFirstLoad) as ActionResult<Team, ServerError>; // Fix in MM-46907;\r\n        if (error) {\r\n            history.push('/error?type=team_not_found');\r\n            return;\r\n        }\r\n        if (joinedTeam) {\r\n            setTeam(joinedTeam);\r\n        }\r\n    }\r\n\r\n    const teamsListDependency = props.teamsList.map((team) => team.id).sort().join('+');\r\n\r\n    // Effect to run when url for team or teamsList changes\r\n    useEffect(() => {\r\n        if (teamNameParam) {\r\n            // skip reserved team names\r\n            if (Constants.RESERVED_TEAM_NAMES.includes(teamNameParam)) {\r\n                return;\r\n            }\r\n\r\n            const teamFromTeamNameParam = getTeamFromTeamList(props.teamsList, teamNameParam);\r\n            if (teamFromTeamNameParam) {\r\n                // If the team is already in the teams list, initialize it when we switch teams\r\n                initTeamOrRedirect(teamFromTeamNameParam);\r\n            } else if (team && team.name !== teamNameParam) {\r\n                // When we are already in a team and the new team is not in the teams list, attempt to join it\r\n                joinTeamOrRedirect(teamNameParam, false);\r\n            } else if (!team) {\r\n                // When we are not in a team and the new team is not in the teams list, attempt to join it\r\n                joinTeamOrRedirect(teamNameParam, true);\r\n            }\r\n        }\r\n    }, [teamNameParam, teamsListDependency]);\r\n\r\n    if (props.mfaRequired) {\r\n        history.push('/mfa/setup');\r\n        return null;\r\n    }\r\n\r\n    if (team === null) {\r\n        return null;\r\n    }\r\n\r\n    const teamLoaded = team?.name.toLowerCase() === teamNameParam?.toLowerCase();\r\n\r\n    return (\r\n        <Switch>\r\n            <Route\r\n                path={`/:team(${TEAM_NAME_PATH_PATTERN})/integrations`}\r\n                component={BackstageController}\r\n            />\r\n            <Route\r\n                path={`/:team(${TEAM_NAME_PATH_PATTERN})/emoji`}\r\n                component={BackstageController}\r\n            />\r\n            {props.plugins?.map((plugin) => (\r\n                <Route\r\n                    key={plugin.id}\r\n                    path={`/:team(${TEAM_NAME_PATH_PATTERN})/` + (plugin as any).route}\r\n                    render={() => (\r\n                        <Pluggable\r\n                            pluggableName={'NeedsTeamComponent'}\r\n                            pluggableId={plugin.id}\r\n                            css={{gridArea: 'center'}}\r\n                        />\r\n                    )}\r\n                />\r\n            ))}\r\n            <ChannelController shouldRenderCenterChannel={initialChannelsLoaded && teamLoaded}/>\r\n        </Switch>\r\n    );\r\n}\r\n\r\nfunction getTeamFromTeamList(teamsList: Props['teamsList'], teamName?: string) {\r\n    if (!teamName) {\r\n        return null;\r\n    }\r\n\r\n    const team = teamsList.find((teamInList) => teamInList.name === teamName) ?? null;\r\n    if (!team) {\r\n        return null;\r\n    }\r\n\r\n    return team;\r\n}\r\n\r\nexport default memo(TeamController);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useEffect} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\n/**\r\n * The purpose of this hook is to sync the user's id and role with client4's user id and role,\r\n * which is essential to identify the user in telemetry.\r\n */\r\nfunction useTelemetryIdentitySync() {\r\n    const user = useSelector(getCurrentUser);\r\n    const userId = user?.id ?? '';\r\n    const userRoles = user?.roles ?? '';\r\n\r\n    useEffect(() => {\r\n        if (userId) {\r\n            Client4.setUserId(userId);\r\n        }\r\n        if (userRoles) {\r\n            Client4.setUserRoles(userRoles);\r\n        }\r\n    }, [userId, userRoles]);\r\n}\r\n\r\nexport default useTelemetryIdentitySync;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\n\r\nimport {fetchAllMyTeamsChannels, fetchAllMyChannelMembers, fetchChannelsAndMembers, unsetActiveChannelOnServer} from 'mattermost-redux/actions/channels';\r\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getLicense, getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCurrentTeamId, getMyTeams} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {markAsReadOnFocus} from 'actions/views/channel';\r\nimport {getSelectedPostId} from 'selectors/rhs';\r\nimport {getSelectedThreadIdInCurrentTeam} from 'selectors/views/threads';\r\n\r\nimport {initializeTeam, joinTeam} from 'components/team_controller/actions';\r\n\r\nimport {checkIfMFARequired} from 'utils/route';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport TeamController from './team_controller';\r\n\r\ntype Params = {\r\n    url: string;\r\n    team?: string;\r\n}\r\n\r\nexport type OwnProps = RouteComponentProps<Params>;\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const license = getLicense(state);\r\n    const config = getConfig(state);\r\n    const currentUser = getCurrentUser(state);\r\n    const plugins = state.plugins.components.NeedsTeamComponent;\r\n    const disableRefetchingOnBrowserFocus = config.DisableRefetchingOnBrowserFocus === 'true';\r\n    const disableWakeUpReconnectHandler = config.DisableWakeUpReconnectHandler === 'true';\r\n\r\n    return {\r\n        currentTeamId: getCurrentTeamId(state),\r\n        currentChannelId: getCurrentChannelId(state),\r\n        teamsList: getMyTeams(state),\r\n        plugins,\r\n        selectedThreadId: getSelectedThreadIdInCurrentTeam(state),\r\n        selectedPostId: getSelectedPostId(state),\r\n        mfaRequired: checkIfMFARequired(currentUser, license, config, ownProps.match.url),\r\n        disableRefetchingOnBrowserFocus,\r\n        disableWakeUpReconnectHandler,\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    fetchChannelsAndMembers,\r\n    fetchAllMyTeamsChannels,\r\n    fetchAllMyChannelMembers,\r\n    markAsReadOnFocus,\r\n    initializeTeam,\r\n    joinTeam,\r\n    unsetActiveChannelOnServer,\r\n};\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(TeamController);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\n\r\nimport {SyncableType} from '@mattermost/types/groups';\r\nimport type {Group, SyncablePatch} from '@mattermost/types/groups';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AddGroupsToTeamModal from 'components/add_groups_to_team_modal';\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport Nbsp from 'components/html_entities/nbsp';\r\nimport ListModal, {DEFAULT_NUM_PER_PAGE} from 'components/list_modal';\r\nimport DropdownIcon from 'components/widgets/icons/fa_dropdown_icon';\r\nimport Menu from 'components/widgets/menu/menu';\r\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\r\n\r\nimport groupsAvatar from 'images/groups-avatar.png';\r\nimport {ModalIdentifiers} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    team: Team;\r\n    actions: {\r\n        getGroupsAssociatedToTeam: (teamID: string, q: string, page: number, perPage: number, filterAllowReference: boolean) => Promise<ActionResult<{groups: Group[]; totalGroupCount: number}>>;\r\n        closeModal: (modalId: string) => void;\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n        unlinkGroupSyncable: (groupID: string, syncableID: string, syncableType: SyncableType) => Promise<ActionResult>;\r\n        patchGroupSyncable: (groupID: string, syncableID: string, syncableType: SyncableType, patch: Partial<SyncablePatch>) => Promise<ActionResult>;\r\n        getMyTeamMembers: () => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    showConfirmModal: boolean;\r\n    item: Group;\r\n    listModal?: ListModal;\r\n}\r\n\r\nclass TeamGroupsManageModal extends React.PureComponent<Props, State> {\r\n    state = {\r\n        showConfirmModal: false,\r\n        item: {\r\n            member_count: 0,\r\n        },\r\n    } as State;\r\n\r\n    loadItems = async (pageNumber: number, searchTerm: string) => {\r\n        const {data} = await this.props.actions.getGroupsAssociatedToTeam(this.props.team.id, searchTerm, pageNumber, DEFAULT_NUM_PER_PAGE, true);\r\n\r\n        return {\r\n            items: data!.groups,\r\n            totalCount: data!.totalGroupCount,\r\n        };\r\n    };\r\n\r\n    handleDeleteCanceled = () => {\r\n        this.setState({showConfirmModal: false});\r\n    };\r\n\r\n    handleDeleteConfirmed = () => {\r\n        this.setState({showConfirmModal: false});\r\n        const {item, listModal} = this.state;\r\n        this.props.actions.unlinkGroupSyncable(item.id, this.props.team.id, SyncableType.Team).then(async () => {\r\n            if (listModal) {\r\n                listModal.setState({loading: true});\r\n                const {items, totalCount} = await listModal.props.loadItems(listModal.state.page, listModal.state.searchTerm);\r\n\r\n                listModal.setState({loading: false, items, totalCount});\r\n            }\r\n        });\r\n    };\r\n\r\n    onClickRemoveGroup = (item: Group, listModal: ListModal) => {\r\n        this.setState({showConfirmModal: true, item, listModal});\r\n    };\r\n\r\n    onClickConfirmRemoveGroup = (item: Group, listModal: ListModal) => this.props.actions.unlinkGroupSyncable(item.id, this.props.team.id, SyncableType.Team).then(async () => {\r\n        listModal.setState({loading: true});\r\n        const {items, totalCount} = await listModal.props.loadItems(listModal.state.page, listModal.state.searchTerm);\r\n        listModal.setState({loading: false, items, totalCount});\r\n    });\r\n\r\n    onHide = () => {\r\n        this.props.actions.closeModal(ModalIdentifiers.MANAGE_TEAM_GROUPS);\r\n    };\r\n\r\n    titleButtonOnClick = () => {\r\n        this.onHide();\r\n        this.props.actions.openModal({modalId: ModalIdentifiers.ADD_GROUPS_TO_TEAM, dialogType: AddGroupsToTeamModal});\r\n    };\r\n\r\n    setTeamMemberStatus = async (item: Group, listModal: ListModal, isTeamAdmin: boolean) => {\r\n        this.props.actions.patchGroupSyncable(item.id, this.props.team.id, SyncableType.Team, {scheme_admin: isTeamAdmin}).then(async () => {\r\n            listModal.setState({loading: true});\r\n            const {items, totalCount} = await listModal.props.loadItems(listModal.state.page, listModal.state.searchTerm);\r\n\r\n            this.props.actions.getMyTeamMembers();\r\n\r\n            listModal.setState({loading: false, items, totalCount});\r\n        });\r\n    };\r\n\r\n    renderRow = (item: Group, listModal: ListModal) => {\r\n        let title;\r\n        if (item.scheme_admin) {\r\n            title = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.teamAdmins'\r\n                    defaultMessage='Team Admins'\r\n                />\r\n            );\r\n        } else {\r\n            title = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.teamMembers'\r\n                    defaultMessage='Team Members'\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div\r\n                key={item.id}\r\n                className='more-modal__row'\r\n            >\r\n                <img\r\n                    className='more-modal__image'\r\n                    src={groupsAvatar}\r\n                    alt='group picture'\r\n                    width='32'\r\n                    height='32'\r\n                />\r\n                <div className='more-modal__details'>\r\n                    <div\r\n                        className='more-modal__name'\r\n                        data-testid='group-name'\r\n                    >{item.display_name} <Nbsp/> {'-'} <Nbsp/>\r\n                        <span className='more-modal__name_count'>\r\n                            <FormattedMessage\r\n                                id='numMembers'\r\n                                defaultMessage='{num, number} {num, plural, one {member} other {members}}'\r\n                                values={{\r\n                                    num: item.member_count,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n                <div className='more-modal__actions'>\r\n                    <MenuWrapper>\r\n                        <button\r\n                            id={`teamGroupsDropdown_${item.display_name}`}\r\n                            className='dropdown-toggle theme color--link style--none'\r\n                            type='button'\r\n                            aria-expanded='true'\r\n                            data-testid='menu-button'\r\n                        >\r\n                            <span>{title} </span>\r\n                            <DropdownIcon/>\r\n                        </button>\r\n                        <Menu\r\n                            openLeft={true}\r\n                            ariaLabel={Utils.localizeMessage({id: 'team_members_dropdown.menuAriaLabel', defaultMessage: 'Change the role of a team member'})}\r\n                        >\r\n                            <Menu.ItemAction\r\n                                show={!item.scheme_admin}\r\n                                onClick={() => this.setTeamMemberStatus(item, listModal, true)}\r\n                                text={Utils.localizeMessage({id: 'team_members_dropdown.makeTeamAdmins', defaultMessage: 'Make Team Admins'})}\r\n                            />\r\n                            <Menu.ItemAction\r\n                                show={Boolean(item.scheme_admin)}\r\n                                onClick={() => this.setTeamMemberStatus(item, listModal, false)}\r\n                                text={Utils.localizeMessage({id: 'team_members_dropdown.makeTeamMembers', defaultMessage: 'Make Team Members'})}\r\n                            />\r\n                            <Menu.ItemAction\r\n                                id='remove-group'\r\n                                onClick={() => this.onClickRemoveGroup(item, listModal)}\r\n                                text={Utils.localizeMessage({id: 'group_list_modal.removeGroupButton', defaultMessage: 'Remove Group'})}\r\n                            />\r\n                        </Menu>\r\n                    </MenuWrapper>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const {formatMessage} = this.props.intl;\r\n        const memberCount = this.state.item.member_count;\r\n        return (\r\n            <>\r\n                <ListModal\r\n                    show={!this.state.showConfirmModal}\r\n                    titleText={formatMessage({id: 'team_groups', defaultMessage: '{team} Groups'}, {team: this.props.team.display_name})}\r\n                    searchPlaceholderText={formatMessage({id: 'manage_team_groups_modal.search_placeholder', defaultMessage: 'Search groups'})}\r\n                    renderRow={this.renderRow}\r\n                    loadItems={this.loadItems}\r\n                    onHide={this.onHide}\r\n                    titleBarButtonText={formatMessage({id: 'group_list_modal.addGroupButton', defaultMessage: 'Add Groups'})}\r\n                    titleBarButtonOnClick={this.titleButtonOnClick}\r\n                    data-testid='list-modal'\r\n                />\r\n                <ConfirmModal\r\n                    show={this.state.showConfirmModal}\r\n                    title={formatMessage({id: 'remove_group_confirm_title', defaultMessage: 'Remove Group and {memberCount, number} {memberCount, plural, one {Member} other {Members}}'}, {memberCount})}\r\n                    message={formatMessage({id: 'remove_group_confirm_message', defaultMessage: '{memberCount, number} {memberCount, plural, one {member} other {members}} associated to this group will be removed from the team. Are you sure you wish to remove this group and {memberCount} {memberCount, plural, one {member} other {members}}?'}, {memberCount})}\r\n                    confirmButtonText={formatMessage({id: 'remove_group_confirm_button', defaultMessage: 'Yes, Remove Group and {memberCount, plural, one {Member} other {Members}}'}, {memberCount})}\r\n                    onConfirm={this.handleDeleteConfirmed}\r\n                    onCancel={this.handleDeleteCanceled}\r\n                    id='confirm-modal'\r\n                />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(TeamGroupsManageModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getGroupsAssociatedToTeam, unlinkGroupSyncable, patchGroupSyncable} from 'mattermost-redux/actions/groups';\r\nimport {getMyTeamMembers} from 'mattermost-redux/actions/teams';\r\n\r\nimport {closeModal, openModal} from 'actions/views/modals';\r\n\r\nimport TeamGroupsManageModal from './team_groups_manage_modal';\r\n\r\ntype OwnProps = {\r\n    teamID: string;\r\n};\r\n\r\nconst mapStateToProps = (state: GlobalState, ownProps: OwnProps) => {\r\n    return {\r\n        team: state.entities.teams.teams[ownProps.teamID],\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\r\n    actions: bindActionCreators({\r\n        getGroupsAssociatedToTeam,\r\n        closeModal,\r\n        openModal,\r\n        unlinkGroupSyncable,\r\n        patchGroupSyncable,\r\n        getMyTeamMembers,\r\n    }, dispatch),\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamGroupsManageModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {WrappedComponentProps} from 'react-intl';\r\n\r\nimport type {Team, TeamMembership} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport type {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\nimport {isGuest, isAdmin, isSystemAdmin} from 'mattermost-redux/utils/user_utils';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport * as Menu from 'components/menu';\r\nimport DropdownIcon from 'components/widgets/icons/fa_dropdown_icon';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nconst ROWS_FROM_BOTTOM_TO_OPEN_UP = 3;\r\n\r\ntype Props = WrappedComponentProps & {\r\n    user: UserProfile;\r\n    currentUser: UserProfile;\r\n    teamMember: TeamMembership;\r\n    teamUrl: string;\r\n    currentTeam?: Team;\r\n    index: number;\r\n    totalUsers: number;\r\n    collapsedThreads: ReturnType<typeof isCollapsedThreadsEnabled>;\r\n    actions: {\r\n        getMyTeamMembers: () => void;\r\n        getMyTeamUnreads: (collapsedThreads: boolean) => void;\r\n        getUser: (id: string) => void;\r\n        getTeamMember: (teamId: string, userId: string) => void;\r\n        getTeamStats: (teamId: string) => void;\r\n        getChannelStats: (channelId: string) => void;\r\n        updateTeamMemberSchemeRoles: (teamId: string, userId: string, b1: boolean, b2: boolean) => Promise<ActionResult>;\r\n        updateUserActive: (userId: string, active: boolean) => Promise<ActionResult>;\r\n        removeUserFromTeamAndGetStats: (teamId: string, userId: string) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    serverError: string|null;\r\n    showDemoteModal: boolean;\r\n    user: UserProfile|null;\r\n    role: string|null;\r\n}\r\n\r\nclass TeamMembersDropdown extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            serverError: null,\r\n            showDemoteModal: false,\r\n            user: null,\r\n            role: null,\r\n        };\r\n    }\r\n\r\n    private handleMakeMember = async () => {\r\n        const me = this.props.currentUser;\r\n        if (this.props.user.id === me.id && me.roles.includes('system_admin')) {\r\n            this.handleDemote(this.props.user, 'team_user');\r\n        } else {\r\n            const {error} = await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id, this.props.user.id, true, false);\r\n            if (error) {\r\n                this.setState({serverError: error.message});\r\n            } else {\r\n                this.props.actions.getUser(this.props.user.id);\r\n                this.props.actions.getTeamMember(this.props.teamMember.team_id, this.props.user.id);\r\n                if (this.props.user.id === me.id) {\r\n                    await this.props.actions.getMyTeamMembers();\r\n                    this.props.actions.getMyTeamUnreads(this.props.collapsedThreads);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    private handleRemoveFromTeam = async () => {\r\n        const {error} = await this.props.actions.removeUserFromTeamAndGetStats(this.props.teamMember.team_id, this.props.user.id);\r\n        if (error) {\r\n            this.setState({serverError: error.message});\r\n        }\r\n    };\r\n\r\n    private handleMakeAdmin = async () => {\r\n        const me = this.props.currentUser;\r\n        if (this.props.user.id === me.id && me.roles.includes('system_admin')) {\r\n            this.handleDemote(this.props.user, 'team_user team_admin');\r\n        } else {\r\n            const {error} = await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id, this.props.user.id, true, true);\r\n            if (error) {\r\n                this.setState({serverError: error.message});\r\n            } else {\r\n                this.props.actions.getUser(this.props.user.id);\r\n                this.props.actions.getTeamMember(this.props.teamMember.team_id, this.props.user.id);\r\n            }\r\n        }\r\n    };\r\n\r\n    private handleDemote = (user: UserProfile, role: string): void => {\r\n        this.setState({\r\n            serverError: this.state.serverError,\r\n            showDemoteModal: true,\r\n            user,\r\n            role,\r\n        });\r\n    };\r\n\r\n    private handleDemoteCancel = (): void => {\r\n        this.setState({\r\n            serverError: null,\r\n            showDemoteModal: false,\r\n            user: null,\r\n            role: null,\r\n        });\r\n    };\r\n\r\n    private handleDemoteSubmit = async () => {\r\n        const {error} = await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id, this.props.user.id, true, false);\r\n        if (error) {\r\n            this.setState({serverError: error.message});\r\n        } else {\r\n            this.props.actions.getUser(this.props.user.id);\r\n            getHistory().push(this.props.teamUrl);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        let serverError = null;\r\n        if (this.state.serverError) {\r\n            serverError = (\r\n                <div className='has-error'>\r\n                    <label className='has-error control-label'>{this.state.serverError}</label>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const {currentTeam, teamMember, user, intl} = this.props;\r\n\r\n        let currentRoles = null;\r\n\r\n        if (isGuest(user.roles)) {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.guest'\r\n                    defaultMessage='Guest'\r\n                />\r\n            );\r\n        } else if (user.roles.length > 0 && isSystemAdmin(user.roles)) {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.systemAdmin'\r\n                    defaultMessage='System Admin'\r\n                />\r\n            );\r\n        } else if ((teamMember.roles.length > 0 && isAdmin(teamMember.roles)) || teamMember.scheme_admin) {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.teamAdmin'\r\n                    defaultMessage='Team Admin'\r\n                />\r\n            );\r\n        } else {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.member'\r\n                    defaultMessage='Member'\r\n                />\r\n            );\r\n        }\r\n\r\n        const me = this.props.currentUser;\r\n        let showMakeMember = !isGuest(user.roles) && (isAdmin(teamMember.roles) || teamMember.scheme_admin) && !isSystemAdmin(user.roles);\r\n        let showMakeAdmin = !isGuest(user.roles) && !isAdmin(teamMember.roles) && !isSystemAdmin(user.roles) && !teamMember.scheme_admin;\r\n\r\n        if (user.delete_at > 0) {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.inactive'\r\n                    defaultMessage='Inactive'\r\n                />\r\n            );\r\n            showMakeMember = false;\r\n            showMakeAdmin = false;\r\n        }\r\n\r\n        const canRemoveFromTeam = user.id !== me.id && (!currentTeam?.group_constrained || user.is_bot);\r\n\r\n        let makeDemoteModal = null;\r\n        if (user.id === me.id) {\r\n            const title = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.confirmDemoteRoleTitle'\r\n                    defaultMessage='Confirm Demotion from System Admin Role'\r\n                />\r\n            );\r\n\r\n            const message = (\r\n                <div>\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.confirmDemoteDescription'\r\n                        defaultMessage=\"If you demote yourself from the System Admin role and there is not another user with System Admin privileges, you'll need to re-assign a System Admin by accessing the Mattermost server through a terminal and running the following command.\"\r\n                    />\r\n                    <br/>\r\n                    <br/>\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.confirmDemotionCmd'\r\n                        defaultMessage='platform roles system_admin {username}'\r\n                        values={{\r\n                            username: me.username,\r\n                        }}\r\n                    />\r\n                    {serverError}\r\n                </div>\r\n            );\r\n\r\n            const confirmButton = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.confirmDemotion'\r\n                    defaultMessage='Confirm Demotion'\r\n                />\r\n            );\r\n\r\n            makeDemoteModal = (\r\n                <ConfirmModal\r\n                    show={this.state.showDemoteModal}\r\n                    title={title}\r\n                    message={message}\r\n                    confirmButtonText={confirmButton}\r\n                    onConfirm={this.handleDemoteSubmit}\r\n                    onCancel={this.handleDemoteCancel}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (!canRemoveFromTeam && !showMakeAdmin && !showMakeMember) {\r\n            return <div>{currentRoles}</div>;\r\n        }\r\n\r\n        const {index, totalUsers} = this.props;\r\n        let openUp = false;\r\n        if (totalUsers > ROWS_FROM_BOTTOM_TO_OPEN_UP && totalUsers - index <= ROWS_FROM_BOTTOM_TO_OPEN_UP) {\r\n            openUp = true;\r\n        }\r\n\r\n        const menuRemove = (\r\n            <Menu.Item\r\n                id='removeFromTeam'\r\n                onClick={this.handleRemoveFromTeam}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.leave_team'\r\n                        defaultMessage='Remove from Team'\r\n                    />\r\n                }\r\n            />\r\n        );\r\n        const menuMakeAdmin = (\r\n            <Menu.Item\r\n                onClick={this.handleMakeAdmin}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.makeAdmin'\r\n                        defaultMessage='Make Team Admin'\r\n                    />\r\n                }\r\n            />\r\n        );\r\n        const menuMakeMember = (\r\n            <Menu.Item\r\n                onClick={this.handleMakeMember}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.makeMember'\r\n                        defaultMessage='Make Team Member'\r\n                    />\r\n                }\r\n            />\r\n        );\r\n        return (\r\n            <>\r\n                <Menu.Container\r\n                    menuButton={{\r\n                        id: `teamMembersDropdown_${user.username}`,\r\n                        class: 'dropdown-toggle theme color--link style--none',\r\n                        children: (\r\n                            <>\r\n                                <span>{currentRoles} </span>\r\n                                <DropdownIcon/>\r\n                            </>\r\n                        ),\r\n                    }}\r\n                    menu={{\r\n                        id: `teamMembersDropdown_${user.username}_menu`,\r\n                        'aria-label': intl.formatMessage({id: 'team_members_dropdown.menuAriaLabel', defaultMessage: 'Change the role of a team member'}),\r\n                    }}\r\n                    anchorOrigin={{\r\n                        vertical: openUp ? 'top' : 'bottom',\r\n                        horizontal: 'right',\r\n                    }}\r\n                    transformOrigin={{\r\n                        vertical: openUp ? 'bottom' : 'top',\r\n                        horizontal: 'right',\r\n                    }}\r\n                >\r\n                    {canRemoveFromTeam ? menuRemove : null}\r\n                    {showMakeAdmin ? menuMakeAdmin : null}\r\n                    {showMakeMember ? menuMakeMember : null}\r\n                </Menu.Container>\r\n                {makeDemoteModal}\r\n                {serverError}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(TeamMembersDropdown);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getChannelStats} from 'mattermost-redux/actions/channels';\r\nimport {\r\n    getMyTeamMembers,\r\n    getMyTeamUnreads,\r\n    getTeamStats,\r\n    getTeamMember,\r\n    updateTeamMemberSchemeRoles,\r\n} from 'mattermost-redux/actions/teams';\r\nimport {getUser, updateUserActive} from 'mattermost-redux/actions/users';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentRelativeTeamUrl, getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {removeUserFromTeamAndGetStats} from 'actions/team_actions';\r\n\r\nimport TeamMembersDropdown from './team_members_dropdown';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        currentUser: getCurrentUser(state),\r\n        teamUrl: getCurrentRelativeTeamUrl(state),\r\n        currentTeam: getCurrentTeam(state),\r\n        collapsedThreads: isCollapsedThreadsEnabled(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getMyTeamMembers,\r\n            getMyTeamUnreads,\r\n            getUser,\r\n            getTeamMember,\r\n            getTeamStats,\r\n            getChannelStats,\r\n            updateUserActive,\r\n            updateTeamMemberSchemeRoles,\r\n            removeUserFromTeamAndGetStats,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamMembersDropdown);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {TeamMembership, TeamStats, GetTeamMembersOpts} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {Teams} from 'mattermost-redux/constants';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport SearchableUserList from 'components/searchable_user_list/searchable_user_list_container';\r\nimport TeamMembersDropdown from 'components/team_members_dropdown';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as UserAgent from 'utils/user_agent';\r\n\r\nconst USERS_PER_PAGE = 50;\r\n\r\ntype Props = {\r\n    searchTerm: string;\r\n    users: UserProfile[];\r\n    teamMembers: {\r\n        [userId: string]: TeamMembership;\r\n    };\r\n    currentTeamId: string;\r\n    totalTeamMembers: number;\r\n    canManageTeamMembers?: boolean;\r\n    actions: {\r\n        getTeamMembers: (teamId: string, page?: number, perPage?: number, options?: GetTeamMembersOpts) => Promise<ActionResult<TeamMembership[]>>;\r\n        searchProfiles: (term: string, options?: {[key: string]: any}) => Promise<ActionResult<UserProfile[]>>;\r\n        getTeamStats: (teamId: string) => Promise<ActionResult<TeamStats>>;\r\n        loadProfilesAndTeamMembers: (page: number, perPage: number, teamId: string, options?: {[key: string]: any}) => Promise<ActionResult>;\r\n        loadStatusesForProfilesList: (users: UserProfile[]) => void;\r\n        loadTeamMembersForProfilesList: (profiles: any, teamId: string, reloadAllMembers: boolean) => Promise<ActionResult>;\r\n        setModalSearchTerm: (term: string) => ActionResult;\r\n    };\r\n}\r\n\r\ntype State = {\r\n    loading: boolean;\r\n}\r\n\r\nexport default class MemberListTeam extends React.PureComponent<Props, State> {\r\n    private searchTimeoutId: number;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.searchTimeoutId = 0;\r\n\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    async componentDidMount() {\r\n        await Promise.all([\r\n            this.props.actions.loadProfilesAndTeamMembers(0, Constants.PROFILE_CHUNK_SIZE, this.props.currentTeamId, {active: true}),\r\n            this.props.actions.getTeamMembers(this.props.currentTeamId, 0, Constants.DEFAULT_MAX_USERS_PER_TEAM,\r\n                {\r\n                    sort: Teams.SORT_USERNAME_OPTION,\r\n                    exclude_deleted_users: true,\r\n                },\r\n            ),\r\n            this.props.actions.getTeamStats(this.props.currentTeamId),\r\n        ]);\r\n        this.loadComplete();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.props.actions.setModalSearchTerm('');\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (prevProps.searchTerm !== this.props.searchTerm) {\r\n            clearTimeout(this.searchTimeoutId);\r\n\r\n            const searchTerm = this.props.searchTerm;\r\n            if (searchTerm === '') {\r\n                this.loadComplete();\r\n                this.searchTimeoutId = 0;\r\n                return;\r\n            }\r\n\r\n            const searchTimeoutId = window.setTimeout(\r\n                async () => {\r\n                    const {\r\n                        loadStatusesForProfilesList,\r\n                        loadTeamMembersForProfilesList,\r\n                        searchProfiles,\r\n                    } = this.props.actions;\r\n                    const {data} = await searchProfiles(searchTerm, {team_id: this.props.currentTeamId});\r\n\r\n                    if (searchTimeoutId !== this.searchTimeoutId) {\r\n                        return;\r\n                    }\r\n\r\n                    this.setState({loading: true});\r\n\r\n                    loadStatusesForProfilesList(data!);\r\n                    loadTeamMembersForProfilesList(data, this.props.currentTeamId, true).then(({data: membersLoaded}) => {\r\n                        if (membersLoaded) {\r\n                            this.loadComplete();\r\n                        }\r\n                    });\r\n                },\r\n                Constants.SEARCH_TIMEOUT_MILLISECONDS,\r\n            );\r\n\r\n            this.searchTimeoutId = searchTimeoutId;\r\n        }\r\n    }\r\n\r\n    loadComplete = () => {\r\n        this.setState({loading: false});\r\n    };\r\n\r\n    nextPage = async (page: number) => {\r\n        this.setState({loading: true});\r\n        await Promise.all([\r\n            this.props.actions.loadProfilesAndTeamMembers(page, USERS_PER_PAGE, this.props.currentTeamId, {active: true}),\r\n            this.props.actions.getTeamMembers(this.props.currentTeamId, page, Constants.DEFAULT_MAX_USERS_PER_TEAM,\r\n                {\r\n                    sort: Teams.SORT_USERNAME_OPTION,\r\n                    exclude_deleted_users: true,\r\n                } as GetTeamMembersOpts,\r\n            ),\r\n        ]);\r\n        this.loadComplete();\r\n    };\r\n\r\n    search = (term: string) => {\r\n        this.props.actions.setModalSearchTerm(term);\r\n    };\r\n\r\n    render() {\r\n        let teamMembersDropdown;\r\n        if (this.props.canManageTeamMembers) {\r\n            teamMembersDropdown = [TeamMembersDropdown];\r\n        }\r\n\r\n        const teamMembers = this.props.teamMembers;\r\n        const users = this.props.users;\r\n        const actionUserProps: {\r\n            [userId: string]: {\r\n                teamMember: TeamMembership;\r\n            };\r\n        } = {};\r\n\r\n        let usersToDisplay;\r\n        if (this.state.loading) {\r\n            usersToDisplay = null;\r\n        } else {\r\n            usersToDisplay = [];\r\n\r\n            for (let i = 0; i < users.length; i++) {\r\n                const user = users[i];\r\n\r\n                if (teamMembers[user.id] && user.delete_at === 0) {\r\n                    usersToDisplay.push(user);\r\n                    actionUserProps[user.id] = {\r\n                        teamMember: teamMembers[user.id],\r\n                    };\r\n                }\r\n            }\r\n        }\r\n\r\n        return (\r\n            <SearchableUserList\r\n                users={usersToDisplay}\r\n                usersPerPage={USERS_PER_PAGE}\r\n                total={this.props.totalTeamMembers}\r\n                nextPage={this.nextPage}\r\n                search={this.search}\r\n                actions={teamMembersDropdown}\r\n                actionUserProps={actionUserProps}\r\n                focusOnMount={!UserAgent.isMobile()}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getTeamStats, getTeamMembers} from 'mattermost-redux/actions/teams';\r\nimport {searchProfiles} from 'mattermost-redux/actions/users';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getMembersInCurrentTeam, getCurrentTeamStats} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getProfilesInCurrentTeam, searchProfilesInCurrentTeam} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadStatusesForProfilesList} from 'actions/status_actions';\r\nimport {loadProfilesAndTeamMembers, loadTeamMembersForProfilesList} from 'actions/user_actions';\r\nimport {setModalSearchTerm} from 'actions/views/search';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport MemberListTeam from './member_list_team';\r\n\r\ntype Props = {\r\n    teamId?: string;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const canManageTeamMembers = haveITeamPermission(state, ownProps.teamId, Permissions.MANAGE_TEAM_ROLES);\r\n\r\n    const searchTerm = state.views.search.modalSearch;\r\n\r\n    let users;\r\n    if (searchTerm) {\r\n        users = searchProfilesInCurrentTeam(state, searchTerm);\r\n    } else {\r\n        users = getProfilesInCurrentTeam(state);\r\n    }\r\n\r\n    const stats = getCurrentTeamStats(state) || {active_member_count: 0};\r\n\r\n    return {\r\n        searchTerm,\r\n        users,\r\n        teamMembers: getMembersInCurrentTeam(state) || {},\r\n        currentTeamId: state.entities.teams.currentTeamId,\r\n        totalTeamMembers: stats.active_member_count,\r\n        canManageTeamMembers,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            searchProfiles,\r\n            getTeamStats,\r\n            getTeamMembers,\r\n            loadProfilesAndTeamMembers,\r\n            loadStatusesForProfilesList,\r\n            loadTeamMembersForProfilesList,\r\n            setModalSearchTerm,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MemberListTeam);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\n\r\nimport InvitationModal from 'components/invitation_modal';\r\nimport MemberListTeam from 'components/member_list_team';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\n\r\nimport {focusElement} from 'utils/a11y_utils';\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\nimport './team_members_modal.scss';\r\n\r\ntype Props = {\r\n    currentTeam?: Team;\r\n    onExited: () => void;\r\n    onLoad?: () => void;\r\n    focusOriginElement?: string;\r\n    actions: {\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n    };\r\n}\r\n\r\ntype State = {\r\n    show: boolean;\r\n}\r\n\r\nexport default class TeamMembersModal extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            show: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.onLoad) {\r\n            this.props.onLoad();\r\n        }\r\n    }\r\n\r\n    handleHide = () => {\r\n        this.setState({show: false});\r\n    };\r\n\r\n    handleInvitePeople = () => {\r\n        const {actions} = this.props;\r\n\r\n        actions.openModal({\r\n            modalId: ModalIdentifiers.INVITATION,\r\n            dialogType: InvitationModal,\r\n        });\r\n\r\n        this.handleHide();\r\n    };\r\n\r\n    handleExit = () => {\r\n        if (this.props.focusOriginElement) {\r\n            focusElement(this.props.focusOriginElement, true);\r\n        }\r\n        this.props.onExited();\r\n    };\r\n\r\n    render() {\r\n        let teamDisplayName = '';\r\n        if (this.props.currentTeam) {\r\n            teamDisplayName = this.props.currentTeam.display_name;\r\n        }\r\n\r\n        return (\r\n            <GenericModal\r\n                id='teamMembersModal'\r\n                className='more-modal'\r\n                compassDesign={true}\r\n                show={this.state.show}\r\n                onHide={this.handleHide}\r\n                onExited={this.handleExit}\r\n                modalHeaderTextId='teamMemberModalLabel'\r\n                modalHeaderText={\r\n                    <FormattedMessage\r\n                        id='team_member_modal.members'\r\n                        defaultMessage='{team} Members'\r\n                        values={{\r\n                            team: teamDisplayName,\r\n                        }}\r\n                    />\r\n                }\r\n                ariaLabelledby='teamMemberModalLabel'\r\n                headerButton={\r\n                    <TeamPermissionGate\r\n                        teamId={this.props.currentTeam?.id}\r\n                        permissions={[Permissions.ADD_USER_TO_TEAM, Permissions.INVITE_GUEST]}\r\n                    >\r\n                        <button\r\n                            id='invitePeople'\r\n                            type='button'\r\n                            className='btn btn-primary btn-sm invite-people-btn'\r\n                            onClick={this.handleInvitePeople}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='team_member_modal.invitePeople'\r\n                                defaultMessage='Invite People'\r\n                            />\r\n                        </button>\r\n                    </TeamPermissionGate>\r\n                }\r\n                enforceFocus={false}\r\n                modalLocation='top'\r\n                bodyPadding={false}\r\n            >\r\n                <MemberListTeam\r\n                    teamId={this.props.currentTeam?.id}\r\n                />\r\n            </GenericModal>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\nimport {isModalOpen} from 'selectors/views/modals';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport TeamMembersModal from './team_members_modal';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const modalId = ModalIdentifiers.TEAM_MEMBERS;\r\n    return {\r\n        currentTeam: getCurrentTeam(state),\r\n        show: isModalOpen(state, modalId),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            openModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamMembersModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useMemo} from 'react';\r\nimport type {KeyboardEventHandler} from 'react';\r\nimport type {StylesConfig} from 'react-select';\r\nimport CreatableSelect from 'react-select/creatable';\r\n\r\nimport './select_text_input.scss';\r\n\r\nconst components = {\r\n    DropdownIndicator: null,\r\n};\r\n\r\nexport interface SelectTextInputOption {\r\n    label: string;\r\n    value: string;\r\n}\r\n\r\ntype Props = {\r\n    placeholder: string;\r\n    value: string[];\r\n    handleNewSelection: (selection: string) => void;\r\n    onChange: (option?: SelectTextInputOption[] | null) => void;\r\n    id?: string;\r\n    isClearable?: boolean;\r\n    description?: string;\r\n}\r\n\r\nconst styles = {\r\n    control: (baseStyles) => ({\r\n        ...baseStyles,\r\n        background: 'var(--center-channel-color-rgb)',\r\n    }),\r\n    input: (baseStyles) => ({\r\n        ...baseStyles,\r\n        color: 'rgba(var(--center-channel-color-rgb), 0.64)',\r\n    }),\r\n    multiValue: (baseStyles) => ({\r\n        ...baseStyles,\r\n        borderRadius: '10px',\r\n        background: 'rgba(var(--center-channel-color-rgb), 0.08)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n    }),\r\n    multiValueLabel: (baseStyles) => ({\r\n        ...baseStyles,\r\n        padding: '4px 6px 4px 10px',\r\n        color: 'var(--center-channel-color)',\r\n        fontFamily: 'Open Sans',\r\n        fontSize: '10px',\r\n        fontWeight: 600,\r\n        lineHeight: '12px',\r\n        letterSpacing: '0.2px',\r\n    }),\r\n    multiValueRemove: (baseStyles) => ({\r\n        ...baseStyles,\r\n        borderRadius: '50%',\r\n        background: 'rgba(var(--center-channel-color-rgb), 0.32)',\r\n        fontFamily: 'compass-icons',\r\n        fontSize: '12px',\r\n        fontWeight: 400,\r\n        color: 'white',\r\n        width: '10px',\r\n        height: '10px',\r\n        padding: 0,\r\n        marginRight: '4px',\r\n        ':hover': {\r\n            background: 'rgba(var(--center-channel-color-rgb), 0.32)',\r\n            color: 'white',\r\n        },\r\n    }),\r\n} satisfies StylesConfig<SelectTextInputOption, true>;\r\n\r\nconst SelectTextInput = ({placeholder, value, handleNewSelection, onChange, id, isClearable, description}: Props) => {\r\n    const [inputValue, setInputValue] = React.useState('');\r\n\r\n    const handleTextEnter = useCallback(() => {\r\n        // do not add the value if already exists\r\n        if (value?.includes(inputValue.trim()) || inputValue.length === 0) {\r\n            return;\r\n        }\r\n        handleNewSelection(inputValue);\r\n        setInputValue('');\r\n    }, [handleNewSelection, inputValue, value]);\r\n\r\n    const handleKeyDown: KeyboardEventHandler = useCallback((event) => {\r\n        if (!inputValue) {\r\n            return;\r\n        }\r\n        switch (event.key) {\r\n        case ' ':\r\n        case ',':\r\n        case 'Enter':\r\n            handleTextEnter();\r\n            event.preventDefault();\r\n        }\r\n    }, [inputValue, handleTextEnter]);\r\n\r\n    const selectValues = useMemo(() => {\r\n        return value.map((singleValue) => ({label: singleValue, value: singleValue}));\r\n    }, [value]);\r\n\r\n    return (\r\n        <>\r\n            <CreatableSelect\r\n                id={id}\r\n                className='select-text-input'\r\n                styles={styles}\r\n                components={components}\r\n                isClearable={isClearable}\r\n                onChange={useCallback((value) => onChange(value as SelectTextInputOption[]), [onChange])}\r\n                inputValue={inputValue}\r\n                isMulti={true}\r\n                menuIsOpen={false}\r\n                onInputChange={setInputValue}\r\n                onKeyDown={handleKeyDown}\r\n                placeholder={placeholder}\r\n                value={selectValues}\r\n                onBlur={handleTextEnter}\r\n            />\r\n            {description ? <p className='select-text-description'>{description}</p> : undefined}\r\n        </>\r\n    );\r\n};\r\n\r\nexport default SelectTextInput;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport SelectTextInput, {type SelectTextInputOption} from 'components/common/select_text_input/select_text_input';\r\nimport CheckboxSettingItem from 'components/widgets/modals/components/checkbox_setting_item';\r\nimport {type SaveChangesPanelState} from 'components/widgets/modals/components/save_changes_panel';\r\n\r\ntype Props = {\r\n    allowedDomains: string[];\r\n    setAllowedDomains: (domains: string[]) => void;\r\n    setHasChanges: (hasChanges: boolean) => void;\r\n    setSaveChangesPanelState: (state: SaveChangesPanelState) => void;\r\n}\r\n\r\nconst AllowedDomainsSelect = ({allowedDomains, setAllowedDomains, setHasChanges, setSaveChangesPanelState}: Props) => {\r\n    const [showAllowedDomains, setShowAllowedDomains] = useState<boolean>(allowedDomains.length > 0);\r\n    const {formatMessage} = useIntl();\r\n\r\n    const handleEnableAllowedDomains = useCallback((enabled: boolean) => {\r\n        setShowAllowedDomains(enabled);\r\n        if (!enabled) {\r\n            setAllowedDomains([]);\r\n        }\r\n    }, [setAllowedDomains]);\r\n\r\n    const updateAllowedDomains = useCallback((domain: string) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setAllowedDomains([...allowedDomains, domain]);\r\n    }, [allowedDomains, setAllowedDomains, setHasChanges, setSaveChangesPanelState]);\r\n\r\n    const handleOnChangeDomains = useCallback((allowedDomainsOptions?: SelectTextInputOption[] | null) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setAllowedDomains(allowedDomainsOptions?.map((domain) => domain.value) || []);\r\n    }, [setAllowedDomains, setHasChanges, setSaveChangesPanelState]);\r\n\r\n    return (\r\n        <>\r\n            <CheckboxSettingItem\r\n                inputFieldTitle={\r\n                    <FormattedMessage\r\n                        id='general_tab.allowedDomains'\r\n                        defaultMessage='Allow only users with a specific email domain to join this team'\r\n                    />\r\n                }\r\n                data-testid='allowedDomainsCheckbox'\r\n                className='access-allowed-domains-section'\r\n                title={formatMessage({\r\n                    id: 'general_tab.AllowedDomainsTitle',\r\n                    defaultMessage: 'Users with a specific email domain',\r\n                })}\r\n                description={formatMessage({\r\n                    id: 'general_tab.AllowedDomainsInfo',\r\n                    defaultMessage: 'When enabled, users can only join the team if their email matches a specific domain (e.g. \"mattermost.org\")',\r\n                })}\r\n                descriptionAboveContent={true}\r\n                inputFieldData={{name: 'showAllowedDomains'}}\r\n                inputFieldValue={showAllowedDomains}\r\n                handleChange={handleEnableAllowedDomains}\r\n            />\r\n            {showAllowedDomains &&\r\n            <SelectTextInput\r\n                id='allowedDomains'\r\n                placeholder={formatMessage({id: 'general_tab.AllowedDomainsExample', defaultMessage: 'corp.mattermost.com, mattermost.com'})}\r\n                aria-label={formatMessage({id: 'general_tab.allowedDomains.ariaLabel', defaultMessage: 'Allowed Domains'})}\r\n                value={allowedDomains}\r\n                onChange={handleOnChangeDomains}\r\n                handleNewSelection={updateAllowedDomains}\r\n                isClearable={false}\r\n                description={formatMessage({id: 'general_tab.AllowedDomainsTip', defaultMessage: 'Seperate multiple domains with a space, comma, tab or enter.'})}\r\n            />\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\nexport default AllowedDomainsSelect;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState, useEffect} from 'react';\r\nimport {defineMessages, useIntl} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {RefreshIcon} from '@mattermost/compass-icons/components';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport Input from 'components/widgets/inputs/input/input';\r\nimport type {BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\nimport BaseSettingItem from 'components/widgets/modals/components/base_setting_item';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nconst translations = defineMessages({\r\n    OpenInviteDescriptionError: {\r\n        id: 'team_settings.openInviteDescription.error',\r\n        defaultMessage: 'There was an error generating the invite code, please try again',\r\n    },\r\n});\r\n\r\ntype Props = {\r\n    regenerateTeamInviteId: (teamId: string) => Promise<ActionResult>;\r\n}\r\n\r\nconst InviteSectionInput = ({regenerateTeamInviteId}: Props) => {\r\n    const team = useSelector((state: GlobalState) => getCurrentTeam(state));\r\n    const canInviteTeamMembers = useSelector((state: GlobalState) => haveITeamPermission(state, team?.id || '', Permissions.INVITE_USER));\r\n    const [inviteId, setInviteId] = useState<Team['invite_id']>(team?.invite_id ?? '');\r\n    const [inviteIdError, setInviteIdError] = useState<BaseSettingItemProps['error'] | undefined>();\r\n    const {formatMessage} = useIntl();\r\n\r\n    useEffect(() => {\r\n        setInviteId(team?.invite_id || '');\r\n    }, [team?.invite_id]);\r\n\r\n    const handleRegenerateInviteId = useCallback(async () => {\r\n        const {data, error} = await regenerateTeamInviteId(team?.id || '');\r\n\r\n        if (data?.invite_id) {\r\n            setInviteId(data.invite_id);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setInviteIdError(translations.OpenInviteDescriptionError);\r\n        }\r\n    }, [regenerateTeamInviteId, team?.id]);\r\n\r\n    if (!canInviteTeamMembers) {\r\n        return null;\r\n    }\r\n    const inviteSectionInput = (\r\n        <div\r\n            data-testid='teamInviteContainer'\r\n            id='teamInviteContainer'\r\n        >\r\n            <Input\r\n                id='teamInviteId'\r\n                type='text'\r\n                value={inviteId}\r\n                maxLength={32}\r\n            />\r\n            <button\r\n                data-testid='regenerateButton'\r\n                id='regenerateButton'\r\n                className='btn btn-tertiary'\r\n                onClick={handleRegenerateInviteId}\r\n            >\r\n                <RefreshIcon/>\r\n                {formatMessage({id: 'general_tab.regenerate', defaultMessage: 'Regenerate'})}\r\n            </button>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <BaseSettingItem\r\n            className='access-invite-section'\r\n            title={formatMessage({\r\n                id: 'general_tab.codeTitle',\r\n                defaultMessage: 'Invite Code',\r\n            })}\r\n            description={formatMessage({\r\n                id: 'general_tab.codeLongDesc',\r\n                defaultMessage: 'The Invite Code is part of the unique team invitation link which is sent to members youre inviting to this team. Regenerating the code creates a new invitation link and invalidates the previous link.',\r\n\r\n            })}\r\n            content={inviteSectionInput}\r\n            error={inviteIdError}\r\n            descriptionAboveContent={true}\r\n        />\r\n    );\r\n};\r\n\r\nexport default InviteSectionInput;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport ExternalLink from 'components/external_link';\r\nimport BaseSettingItem from 'components/widgets/modals/components/base_setting_item';\r\nimport CheckboxSettingItem from 'components/widgets/modals/components/checkbox_setting_item';\r\n\r\ntype Props = {\r\n    allowOpenInvite: boolean;\r\n    isGroupConstrained?: boolean;\r\n    setAllowOpenInvite: (value: boolean) => void;\r\n};\r\n\r\nconst OpenInvite = ({isGroupConstrained, allowOpenInvite, setAllowOpenInvite}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n    if (isGroupConstrained) {\r\n        const groupConstrainedContent = (\r\n            <p id='groupConstrainedContent' >{\r\n                formatMessage({\r\n                    id: 'team_settings.openInviteDescription.groupConstrained',\r\n                    defaultMessage: 'Members of this team are added and removed by linked groups. <link>Learn More</link>',\r\n                }, {\r\n                    link: (msg: React.ReactNode) => (\r\n                        <ExternalLink\r\n                            href='https://mattermost.com/pl/default-ldap-group-constrained-team-channel.html'\r\n                            location='open_invite'\r\n                        >\r\n                            {msg}\r\n                        </ExternalLink>\r\n                    ),\r\n                })}\r\n            </p>\r\n        );\r\n        return (\r\n            <BaseSettingItem\r\n                className='access-invite-domains-section'\r\n                title={formatMessage({\r\n                    id: 'general_tab.openInviteText',\r\n                    defaultMessage: 'Users on this server',\r\n                })}\r\n                description={formatMessage({\r\n                    id: 'general_tab.openInviteDesc',\r\n                    defaultMessage: 'When enabled, a link to this team will be included on the landing page allowing anyone with an account to join this team. Changing this setting will create a new invitation link and invalidate the previous link.',\r\n                })}\r\n                descriptionAboveContent={true}\r\n                content={groupConstrainedContent}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <CheckboxSettingItem\r\n            className='access-invite-domains-section'\r\n            inputFieldTitle={\r\n                <FormattedMessage\r\n                    id='general_tab.openInviteTitle'\r\n                    defaultMessage='Allow any user with an account on this server to join this team'\r\n                />\r\n            }\r\n            inputFieldData={{name: 'allowOpenInvite'}}\r\n            inputFieldValue={allowOpenInvite}\r\n            handleChange={setAllowOpenInvite}\r\n            title={formatMessage({\r\n                id: 'general_tab.openInviteText',\r\n                defaultMessage: 'Users on this server',\r\n            })}\r\n            description={formatMessage({\r\n                id: 'general_tab.openInviteDesc',\r\n                defaultMessage: 'When enabled, a link to this team will be included on the landing page allowing anyone with an account to join this team. Changing this setting will create a new invitation link and invalidate the previous link.',\r\n            })}\r\n            descriptionAboveContent={true}\r\n        />\r\n    );\r\n};\r\n\r\nexport default OpenInvite;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport ModalSection from 'components/widgets/modals/components/modal_section';\r\nimport SaveChangesPanel, {type SaveChangesPanelState} from 'components/widgets/modals/components/save_changes_panel';\r\n\r\nimport AllowedDomainsSelect from './allowed_domains_select';\r\nimport InviteSectionInput from './invite_section_input';\r\nimport OpenInvite from './open_invite';\r\n\r\nimport type {PropsFromRedux, OwnProps} from '.';\r\n\r\nimport './team_access_tab.scss';\r\n\r\nconst generateAllowedDomainOptions = (allowedDomains?: string) => {\r\n    if (!allowedDomains || allowedDomains.length === 0) {\r\n        return [];\r\n    }\r\n    const domainList = allowedDomains.includes(',') ? allowedDomains.split(',') : [allowedDomains];\r\n    return domainList.map((domain) => domain.trim());\r\n};\r\n\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\nconst AccessTab = ({closeModal, collapseModal, hasChangeTabError, hasChanges, setHasChangeTabError, setHasChanges, team, actions}: Props) => {\r\n    const [allowedDomains, setAllowedDomains] = useState<string[]>(() => generateAllowedDomainOptions(team.allowed_domains));\r\n    const [allowOpenInvite, setAllowOpenInvite] = useState<boolean>(team.allow_open_invite ?? false);\r\n    const [saveChangesPanelState, setSaveChangesPanelState] = useState<SaveChangesPanelState>();\r\n    const {formatMessage} = useIntl();\r\n\r\n    const handleAllowedDomainsSubmit = useCallback(async (): Promise<boolean> => {\r\n        const {error} = await actions.patchTeam({\r\n            id: team.id,\r\n            allowed_domains: allowedDomains.length === 1 ? allowedDomains[0] : allowedDomains.join(', '),\r\n        });\r\n        if (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }, [actions, allowedDomains, team]);\r\n\r\n    const handleOpenInviteSubmit = useCallback(async (): Promise<boolean> => {\r\n        if (allowOpenInvite === team.allow_open_invite) {\r\n            return true;\r\n        }\r\n        const data = {\r\n            id: team.id,\r\n            allow_open_invite: allowOpenInvite,\r\n        };\r\n\r\n        const {error} = await actions.patchTeam(data);\r\n        if (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }, [actions, allowOpenInvite, team]);\r\n\r\n    const updateOpenInvite = useCallback((value: boolean) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setAllowOpenInvite(value);\r\n    }, [setHasChanges]);\r\n\r\n    const handleClose = useCallback(() => {\r\n        setSaveChangesPanelState('editing');\r\n        setHasChanges(false);\r\n        setHasChangeTabError(false);\r\n    }, [setHasChangeTabError, setHasChanges]);\r\n\r\n    const handleCancel = useCallback(() => {\r\n        setAllowedDomains(generateAllowedDomainOptions(team.allowed_domains));\r\n        setAllowOpenInvite(team.allow_open_invite ?? false);\r\n        handleClose();\r\n    }, [handleClose, team.allow_open_invite, team.allowed_domains]);\r\n\r\n    const collapseModalHandler = useCallback(() => {\r\n        if (hasChanges) {\r\n            setHasChangeTabError(true);\r\n            return;\r\n        }\r\n        collapseModal();\r\n    }, [collapseModal, hasChanges, setHasChangeTabError]);\r\n\r\n    const handleSaveChanges = useCallback(async () => {\r\n        const allowedDomainSuccess = await handleAllowedDomainsSubmit();\r\n        const openInviteSuccess = await handleOpenInviteSubmit();\r\n        if (!allowedDomainSuccess || !openInviteSuccess) {\r\n            setSaveChangesPanelState('error');\r\n            return;\r\n        }\r\n        setSaveChangesPanelState('saved');\r\n        setHasChangeTabError(false);\r\n    }, [handleAllowedDomainsSubmit, handleOpenInviteSubmit, setHasChangeTabError]);\r\n\r\n    return (\r\n        <ModalSection\r\n            content={\r\n                <>\r\n                    <div className='modal-header'>\r\n                        <button\r\n                            id='closeButton'\r\n                            type='button'\r\n                            className='close'\r\n                            data-dismiss='modal'\r\n                            onClick={closeModal}\r\n                        >\r\n                            <span aria-hidden='true'>{''}</span>\r\n                        </button>\r\n                        <h4 className='modal-title'>\r\n                            <div className='modal-back'>\r\n                                <i\r\n                                    className='fa fa-angle-left'\r\n                                    aria-label={formatMessage({\r\n                                        id: 'generic_icons.collapse',\r\n                                        defaultMessage: 'Collapes Icon',\r\n                                    })}\r\n                                    onClick={collapseModalHandler}\r\n                                />\r\n                            </div>\r\n                            <span>{formatMessage({id: 'team_settings_modal.title', defaultMessage: 'Team Settings'})}</span>\r\n                        </h4>\r\n                    </div>\r\n                    <div\r\n                        className='modal-access-tab-content user-settings'\r\n                        id='accessSettings'\r\n                        aria-labelledby='accessButton'\r\n                        role='tabpanel'\r\n                    >\r\n                        {team.group_constrained ?\r\n                            undefined :\r\n                            <AllowedDomainsSelect\r\n                                allowedDomains={allowedDomains}\r\n                                setAllowedDomains={setAllowedDomains}\r\n                                setHasChanges={setHasChanges}\r\n                                setSaveChangesPanelState={setSaveChangesPanelState}\r\n                            />\r\n                        }\r\n                        <div className='divider-light'/>\r\n                        <OpenInvite\r\n                            isGroupConstrained={team.group_constrained}\r\n                            allowOpenInvite={allowOpenInvite}\r\n                            setAllowOpenInvite={updateOpenInvite}\r\n                        />\r\n                        <div className='divider-light'/>\r\n                        {team.group_constrained ?\r\n                            undefined :\r\n                            <InviteSectionInput regenerateTeamInviteId={actions.regenerateTeamInviteId}/>\r\n                        }\r\n                        {hasChanges ?\r\n                            <SaveChangesPanel\r\n                                handleCancel={handleCancel}\r\n                                handleSubmit={handleSaveChanges}\r\n                                handleClose={handleClose}\r\n                                tabChangeError={hasChangeTabError}\r\n                                state={saveChangesPanelState}\r\n                            /> : undefined}\r\n                    </div>\r\n                </>\r\n            }\r\n        />\r\n    );\r\n};\r\nexport default AccessTab;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {patchTeam, regenerateTeamInviteId} from 'mattermost-redux/actions/teams';\r\n\r\nimport TeamAccessTab from './team_access_tab';\r\n\r\nexport type OwnProps = {\r\n    team: Team;\r\n    hasChanges: boolean;\r\n    hasChangeTabError: boolean;\r\n    setHasChanges: (hasChanges: boolean) => void;\r\n    setHasChangeTabError: (hasChangesError: boolean) => void;\r\n    closeModal: () => void;\r\n    collapseModal: () => void;\r\n};\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            patchTeam,\r\n            regenerateTeamInviteId,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(null, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(TeamAccessTab);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport type {ChangeEvent} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport Input from 'components/widgets/inputs/input/input';\r\nimport BaseSettingItem, {type BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    handleDescriptionChanges: (name: string) => void;\r\n    description: Team['description'];\r\n    clientError?: BaseSettingItemProps['error'];\r\n};\r\n\r\nconst TeamDescriptionSection = ({handleDescriptionChanges, clientError, description}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const updateDescription = useCallback((e: ChangeEvent<HTMLInputElement>) => {\r\n        handleDescriptionChanges(e.target.value);\r\n    }, [handleDescriptionChanges]);\r\n\r\n    const descriptionSectionInput = (\r\n        <Input\r\n            id='teamDescription'\r\n            data-testid='teamDescriptionInput'\r\n            containerClassName='description-section-input'\r\n            type='textarea'\r\n            maxLength={Constants.MAX_TEAMDESCRIPTION_LENGTH}\r\n            onChange={updateDescription}\r\n            value={description}\r\n            label={formatMessage({id: 'general_tab.teamDescription', defaultMessage: 'Description'})}\r\n        />\r\n    );\r\n\r\n    return (\r\n        <BaseSettingItem\r\n            description={formatMessage({\r\n                id: 'general_tab.teamDescriptionInfo',\r\n                defaultMessage: 'Team description provides additional information to help users select the right team. Maximum of 50 characters.',\r\n            })}\r\n            content={descriptionSectionInput}\r\n            className='description-setting-item'\r\n            error={clientError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default TeamDescriptionSection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport type {ChangeEvent} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport Input from 'components/widgets/inputs/input/input';\r\nimport BaseSettingItem, {type BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    handleNameChanges: (name: string) => void;\r\n    name: Team['display_name'];\r\n    clientError: BaseSettingItemProps['error'];\r\n};\r\n\r\nconst TeamNameSection = ({clientError, handleNameChanges, name}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const updateName = useCallback((e: ChangeEvent<HTMLInputElement>) => handleNameChanges(e.target.value), [handleNameChanges]);\r\n\r\n    const nameSectionInput = (\r\n        <Input\r\n            id='teamName'\r\n            data-testid='teamNameInput'\r\n            type='text'\r\n            maxLength={Constants.MAX_TEAMNAME_LENGTH}\r\n            onChange={updateName}\r\n            value={name}\r\n            label={formatMessage({id: 'general_tab.teamName', defaultMessage: 'Team Name'})}\r\n        />\r\n    );\r\n\r\n    return (\r\n        <BaseSettingItem\r\n            title={formatMessage({\r\n                id: 'general_tab.teamInfo',\r\n                defaultMessage: 'Team info',\r\n            })}\r\n            description={formatMessage({\r\n                id: 'general_tab.teamNameInfo',\r\n                defaultMessage: 'This name will appear on your sign-in screen and at the top of the left sidebar.',\r\n            })}\r\n            content={nameSectionInput}\r\n            error={clientError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default TeamNameSection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {type ChangeEvent, useRef, useState, useEffect, useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {TrashCanOutlineIcon} from '@mattermost/compass-icons/components';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport EditIcon from 'components/widgets/icons/fa_edit_icon';\r\nimport BaseSettingItem from 'components/widgets/modals/components/base_setting_item';\r\nimport type {BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as FileUtils from 'utils/file_utils';\r\nimport {imageURLForTeam} from 'utils/utils';\r\n\r\nimport './team_picture_section.scss';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    file?: File | null;\r\n    teamName: string;\r\n    disabled: boolean;\r\n    onFileChange: (e: ChangeEvent<HTMLInputElement>) => void;\r\n    onRemove: () => void;\r\n    clientError?: BaseSettingItemProps['error'];\r\n};\r\n\r\nconst TeamPictureSection = ({team, file, teamName, disabled, onFileChange, onRemove, clientError}: Props) => {\r\n    const selectInput = useRef<HTMLInputElement>(null);\r\n    const [image, setImage] = useState<string>('');\r\n    const [orientationStyles, setOrientationStyles] = useState<{transform: string; transformOrigin: string}>();\r\n    const {formatMessage} = useIntl();\r\n\r\n    const teamImageSource = imageURLForTeam(team);\r\n\r\n    const handleInputFile = useCallback(() => {\r\n        if (selectInput.current) {\r\n            selectInput.current.value = '';\r\n            selectInput.current.click();\r\n        }\r\n    }, []);\r\n\r\n    const editIcon = () => {\r\n        return (\r\n            <>\r\n                <input\r\n                    data-testid='uploadPicture'\r\n                    ref={selectInput}\r\n                    className='hidden'\r\n                    accept={Constants.ACCEPT_STATIC_IMAGE}\r\n                    disabled={disabled}\r\n                    type='file'\r\n                    onChange={onFileChange}\r\n                    aria-hidden={true}\r\n                    tabIndex={-1}\r\n                />\r\n                <span\r\n                    disabled={disabled}\r\n                    onClick={handleInputFile}\r\n                >\r\n                    <EditIcon/>\r\n                </span>\r\n            </>\r\n        );\r\n    };\r\n\r\n    const teamImage = () => {\r\n        if (file) {\r\n            const imageStyles = {\r\n                backgroundImage: 'url(' + image + ')',\r\n                backgroundSize: 'cover',\r\n                backgroundRepeat: 'round',\r\n                ...orientationStyles,\r\n            };\r\n\r\n            return (\r\n                <div\r\n                    id='teamIconImage'\r\n                    style={imageStyles}\r\n                    className='team-img-preview'\r\n                    onClick={handleInputFile}\r\n                />\r\n            );\r\n        }\r\n        if (teamImageSource) {\r\n            return (\r\n                <img\r\n                    id='teamIconImage'\r\n                    className='team-img-preview'\r\n                    src={teamImageSource}\r\n                    onClick={handleInputFile}\r\n                />\r\n            );\r\n        }\r\n        return (\r\n            <div className='team-picture-section__team-icon' >\r\n                <span\r\n                    id='teamIconInitial'\r\n                    onClick={handleInputFile}\r\n                    className='team-picture-section__team-name'\r\n                >{teamName.charAt(0).toUpperCase() + teamName.charAt(1)}</span>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const setPicture = (file: File) => {\r\n        if (file) {\r\n            const previewBlob = URL.createObjectURL(file);\r\n\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n                const orientation = FileUtils.getExifOrientation(e.target!.result! as ArrayBuffer);\r\n                const orientationStyles = FileUtils.getOrientationStyles(orientation);\r\n\r\n                setImage(previewBlob);\r\n                setOrientationStyles(orientationStyles);\r\n            };\r\n            reader.readAsArrayBuffer(file);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (file) {\r\n            setPicture(file);\r\n        }\r\n    }, [file]);\r\n\r\n    const removeImageButton = () => {\r\n        if (file || teamImageSource) {\r\n            return (\r\n                <button\r\n                    onClick={onRemove}\r\n                    data-testid='removeImageButton'\r\n                    className='style--none picture-setting-item__remove-button'\r\n                >\r\n                    <TrashCanOutlineIcon/>\r\n                    {formatMessage({id: 'setting_picture.remove_image', defaultMessage: 'Remove image'})}\r\n                </button>\r\n            );\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    const teamPictureSection = (\r\n        <>\r\n            <div className='team-picture-section' >\r\n                {teamImage()}\r\n                {editIcon()}\r\n            </div>\r\n            {removeImageButton()}\r\n        </>\r\n    );\r\n\r\n    return (\r\n        <BaseSettingItem\r\n            title={formatMessage({\r\n                id: 'setting_picture.title',\r\n                defaultMessage: 'Team Icon',\r\n            })}\r\n            description={teamImageSource ? undefined : formatMessage(\r\n                {\r\n                    id: 'setting_picture.help.profile',\r\n                    defaultMessage: 'Upload a picture in BMP, JPG, JPEG, or PNG format. Maximum file size: {max}',\r\n                },\r\n                {\r\n                    max: '50MB',\r\n                },\r\n            )}\r\n            content={teamPictureSection}\r\n            className='picture-setting-item'\r\n            error={clientError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default TeamPictureSection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState} from 'react';\r\nimport type {ChangeEvent} from 'react';\r\nimport {defineMessages, useIntl} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\nimport ModalSection from 'components/widgets/modals/components/modal_section';\r\nimport SaveChangesPanel, {type SaveChangesPanelState} from 'components/widgets/modals/components/save_changes_panel';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\nimport TeamDescriptionSection from './team_description_section';\r\nimport TeamNameSection from './team_name_section';\r\nimport TeamPictureSection from './team_picture_section';\r\n\r\nimport type {PropsFromRedux, OwnProps} from '.';\r\n\r\nimport './team_info_tab.scss';\r\n\r\nconst ACCEPTED_TEAM_IMAGE_TYPES = ['image/jpeg', 'image/png', 'image/bmp'];\r\nconst translations = defineMessages({\r\n    Required: {\r\n        id: 'general_tab.required',\r\n        defaultMessage: 'This field is required',\r\n    },\r\n    TeamNameRestrictions: {\r\n        id: 'general_tab.teamNameRestrictions',\r\n        defaultMessage: 'Team Name must be {min} or more characters up to a maximum of {max}. You can add a longer team description.',\r\n        values: {min: Constants.MIN_TEAMNAME_LENGTH, max: Constants.MAX_TEAMNAME_LENGTH},\r\n    },\r\n    TeamIconInvalidFileType: {\r\n        id: 'general_tab.teamIconInvalidFileType',\r\n        defaultMessage: 'Only BMP, JPG or PNG images may be used for team icons',\r\n    },\r\n    TeamIconTooLarge: {\r\n        id: 'general_tab.teamIconTooLarge',\r\n        defaultMessage: 'Unable to upload team icon. File is too large.',\r\n    },\r\n    TeamIconError: {\r\n        id: 'general_tab.teamIconError',\r\n        defaultMessage: 'An error occurred while selecting the image.',\r\n    },\r\n});\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\nconst InfoTab = ({team, hasChanges, maxFileSize, closeModal, collapseModal, hasChangeTabError, setHasChangeTabError, setHasChanges, actions}: Props) => {\r\n    const [name, setName] = useState<Team['display_name']>(team.display_name);\r\n    const [description, setDescription] = useState<Team['description']>(team.description);\r\n    const [teamIconFile, setTeamIconFile] = useState<File | undefined>();\r\n    const [loading, setLoading] = useState<boolean>(false);\r\n    const [imageClientError, setImageClientError] = useState<BaseSettingItemProps['error'] | undefined>();\r\n    const [nameClientError, setNameClientError] = useState<BaseSettingItemProps['error'] | undefined>();\r\n    const [saveChangesPanelState, setSaveChangesPanelState] = useState<SaveChangesPanelState>();\r\n    const {formatMessage} = useIntl();\r\n\r\n    const handleNameDescriptionSubmit = useCallback(async (): Promise<boolean> => {\r\n        if (name.trim() === team.display_name && description === team.description) {\r\n            return true;\r\n        }\r\n\r\n        if (!name) {\r\n            setNameClientError(translations.Required);\r\n            return false;\r\n        } else if (name.length < Constants.MIN_TEAMNAME_LENGTH) {\r\n            setNameClientError(translations.TeamNameRestrictions);\r\n            return false;\r\n        }\r\n        setNameClientError(undefined);\r\n        const {error} = await actions.patchTeam({id: team.id, display_name: name, description});\r\n        if (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }, [actions, description, name, team.description, team.display_name, team.id]);\r\n\r\n    const handleTeamIconSubmit = useCallback(async (): Promise<boolean> => {\r\n        if (!teamIconFile) {\r\n            return true;\r\n        }\r\n        setLoading(true);\r\n        setImageClientError(undefined);\r\n        const {error} = await actions.setTeamIcon(team.id, teamIconFile);\r\n        setLoading(false);\r\n        if (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }, [actions, team, teamIconFile]);\r\n\r\n    const handleSaveChanges = useCallback(async () => {\r\n        const nameDescriptionSuccess = await handleNameDescriptionSubmit();\r\n        const teamIconSuccess = await handleTeamIconSubmit();\r\n        if (!teamIconSuccess || !nameDescriptionSuccess) {\r\n            setSaveChangesPanelState('error');\r\n            return;\r\n        }\r\n        setSaveChangesPanelState('saved');\r\n        setHasChangeTabError(false);\r\n    }, [handleNameDescriptionSubmit, handleTeamIconSubmit, setHasChangeTabError]);\r\n\r\n    const handleClose = useCallback(() => {\r\n        setSaveChangesPanelState('editing');\r\n        setHasChanges(false);\r\n        setHasChangeTabError(false);\r\n    }, [setHasChangeTabError, setHasChanges]);\r\n\r\n    const handleCancel = useCallback(() => {\r\n        setName(team.display_name ?? team.name);\r\n        setDescription(team.description);\r\n        setTeamIconFile(undefined);\r\n        setImageClientError(undefined);\r\n        setNameClientError(undefined);\r\n        handleClose();\r\n    }, [handleClose, team.description, team.display_name, team.name]);\r\n\r\n    const handleTeamIconRemove = useCallback(async () => {\r\n        setLoading(true);\r\n        setImageClientError(undefined);\r\n        setTeamIconFile(undefined);\r\n        handleClose();\r\n\r\n        const {error} = await actions.removeTeamIcon(team.id);\r\n        setLoading(false);\r\n        if (error) {\r\n            setSaveChangesPanelState('error');\r\n            setHasChanges(true);\r\n            setHasChangeTabError(true);\r\n        }\r\n    }, [actions, handleClose, setHasChangeTabError, setHasChanges, team.id]);\r\n\r\n    const updateTeamIcon = useCallback((e: ChangeEvent<HTMLInputElement>) => {\r\n        if (e && e.target && e.target.files && e.target.files[0]) {\r\n            const file = e.target.files[0];\r\n\r\n            if (!ACCEPTED_TEAM_IMAGE_TYPES.includes(file.type)) {\r\n                setImageClientError(translations.TeamIconInvalidFileType);\r\n            } else if (file.size > maxFileSize) {\r\n                setImageClientError(translations.TeamIconTooLarge);\r\n            } else {\r\n                setTeamIconFile(file);\r\n                setImageClientError(undefined);\r\n                setSaveChangesPanelState('editing');\r\n                setHasChanges(true);\r\n            }\r\n        } else {\r\n            setTeamIconFile(undefined);\r\n            setImageClientError(translations.TeamIconError);\r\n        }\r\n    }, [maxFileSize, setHasChanges]);\r\n\r\n    const handleNameChanges = useCallback((name: string) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setName(name);\r\n    }, [setHasChanges]);\r\n\r\n    const handleDescriptionChanges = useCallback((description: string) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setDescription(description);\r\n    }, [setHasChanges]);\r\n\r\n    const handleCollapseModal = useCallback(() => {\r\n        if (hasChanges) {\r\n            setHasChangeTabError(true);\r\n            return;\r\n        }\r\n        collapseModal();\r\n    }, [collapseModal, hasChanges, setHasChangeTabError]);\r\n\r\n    const modalSectionContent = (\r\n        <>\r\n            <div className='modal-header'>\r\n                <button\r\n                    id='closeButton'\r\n                    type='button'\r\n                    className='close'\r\n                    data-dismiss='modal'\r\n                    onClick={closeModal}\r\n                >\r\n                    <span aria-hidden='true'>{''}</span>\r\n                </button>\r\n                <h4 className='modal-title'>\r\n                    <div className='modal-back'>\r\n                        <i\r\n                            className='fa fa-angle-left'\r\n                            aria-label={formatMessage({\r\n                                id: 'generic_icons.collapse',\r\n                                defaultMessage: 'Collapes Icon',\r\n                            })}\r\n                            onClick={handleCollapseModal}\r\n                        />\r\n                    </div>\r\n                    <span>{formatMessage({id: 'team_settings_modal.title', defaultMessage: 'Team Settings'})}</span>\r\n                </h4>\r\n            </div>\r\n            <div\r\n                className='modal-info-tab-content user-settings'\r\n                id='infoSettings'\r\n                aria-labelledby='infoButton'\r\n                role='tabpanel'\r\n            >\r\n                <div className='name-description-container' >\r\n                    <TeamNameSection\r\n                        name={name}\r\n                        clientError={nameClientError}\r\n                        handleNameChanges={handleNameChanges}\r\n                    />\r\n                    <TeamDescriptionSection\r\n                        description={description}\r\n                        handleDescriptionChanges={handleDescriptionChanges}\r\n                    />\r\n                </div>\r\n                <TeamPictureSection\r\n                    team={team}\r\n                    file={teamIconFile}\r\n                    disabled={loading}\r\n                    onFileChange={updateTeamIcon}\r\n                    onRemove={handleTeamIconRemove}\r\n                    teamName={team.display_name ?? team.name}\r\n                    clientError={imageClientError}\r\n                />\r\n                {hasChanges ?\r\n                    <SaveChangesPanel\r\n                        handleCancel={handleCancel}\r\n                        handleSubmit={handleSaveChanges}\r\n                        handleClose={handleClose}\r\n                        tabChangeError={hasChangeTabError}\r\n                        state={saveChangesPanelState}\r\n                    /> : undefined}\r\n            </div>\r\n        </>\r\n    );\r\n\r\n    return <ModalSection content={modalSectionContent}/>;\r\n};\r\nexport default InfoTab;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {getTeam, patchTeam, removeTeamIcon, setTeamIcon} from 'mattermost-redux/actions/teams';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport type {GlobalState} from 'types/store/index';\r\n\r\nimport TeamInfoTab from './team_info_tab';\r\n\r\nexport type OwnProps = {\r\n    team: Team;\r\n    hasChanges: boolean;\r\n    hasChangeTabError: boolean;\r\n    setHasChanges: (hasChanges: boolean) => void;\r\n    setHasChangeTabError: (hasChangesError: boolean) => void;\r\n    closeModal: () => void;\r\n    collapseModal: () => void;\r\n};\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const maxFileSize = parseInt(config.MaxFileSize ?? '', 10);\r\n\r\n    return {\r\n        maxFileSize,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getTeam,\r\n            patchTeam,\r\n            removeTeamIcon,\r\n            setTeamIcon,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(TeamInfoTab);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport AccessTab from './team_access_tab';\r\nimport InfoTab from './team_info_tab';\r\n\r\ntype Props = {\r\n    activeTab: string;\r\n    hasChanges: boolean;\r\n    hasChangeTabError: boolean;\r\n    setHasChanges: (hasChanges: boolean) => void;\r\n    setHasChangeTabError: (hasChangesError: boolean) => void;\r\n    closeModal: () => void;\r\n    collapseModal: () => void;\r\n    team?: Team;\r\n};\r\n\r\nconst TeamSettings = ({\r\n    activeTab = '',\r\n    closeModal,\r\n    collapseModal,\r\n    team,\r\n    hasChanges,\r\n    hasChangeTabError,\r\n    setHasChanges,\r\n    setHasChangeTabError,\r\n}: Props) => {\r\n    if (!team) {\r\n        return null;\r\n    }\r\n\r\n    let result;\r\n    switch (activeTab) {\r\n    case 'info':\r\n        result = (\r\n            <InfoTab\r\n                team={team}\r\n                hasChanges={hasChanges}\r\n                setHasChanges={setHasChanges}\r\n                hasChangeTabError={hasChangeTabError}\r\n                setHasChangeTabError={setHasChangeTabError}\r\n                closeModal={closeModal}\r\n                collapseModal={collapseModal}\r\n            />\r\n        );\r\n        break;\r\n    case 'access':\r\n        result = (\r\n            <AccessTab\r\n                team={team}\r\n                hasChanges={hasChanges}\r\n                setHasChanges={setHasChanges}\r\n                hasChangeTabError={hasChangeTabError}\r\n                setHasChangeTabError={setHasChangeTabError}\r\n                closeModal={closeModal}\r\n                collapseModal={collapseModal}\r\n            />\r\n        );\r\n        break;\r\n    default:\r\n        result = (\r\n            <div/>\r\n        );\r\n        break;\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\nexport default TeamSettings;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport TeamSettings from './team_settings';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        team: getCurrentTeam(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(TeamSettings);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState, useRef, useCallback} from 'react';\r\nimport {Modal, type ModalBody} from 'react-bootstrap';\r\nimport ReactDOM from 'react-dom';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport TeamSettings from 'components/team_settings';\r\n\r\nimport {focusElement} from 'utils/a11y_utils';\r\n\r\nconst SettingsSidebar = React.lazy(() => import('components/settings_sidebar'));\r\n\r\ntype Props = {\r\n    onExited: () => void;\r\n    canInviteUsers: boolean;\r\n    focusOriginElement?: string;\r\n}\r\n\r\nconst TeamSettingsModal = ({onExited, canInviteUsers, focusOriginElement}: Props) => {\r\n    const [activeTab, setActiveTab] = useState('info');\r\n    const [show, setShow] = useState<boolean>(true);\r\n    const [hasChanges, setHasChanges] = useState<boolean>(false);\r\n    const [hasChangeTabError, setHasChangeTabError] = useState<boolean>(false);\r\n    const modalBodyRef = useRef<ModalBody>(null);\r\n    const {formatMessage} = useIntl();\r\n\r\n    const updateTab = useCallback((tab: string) => {\r\n        if (hasChanges) {\r\n            setHasChangeTabError(true);\r\n            return;\r\n        }\r\n        setActiveTab(tab);\r\n        setHasChanges(false);\r\n        setHasChangeTabError(false);\r\n    }, [hasChanges]);\r\n\r\n    const handleHide = useCallback(() => setShow(false), []);\r\n\r\n    const handleClose = useCallback(() => {\r\n        if (focusOriginElement) {\r\n            focusElement(focusOriginElement, true);\r\n        }\r\n        setActiveTab('info');\r\n        setHasChanges(false);\r\n        setHasChangeTabError(false);\r\n        onExited();\r\n    }, [onExited, focusOriginElement]);\r\n\r\n    const handleCollapse = useCallback(() => {\r\n        const el = ReactDOM.findDOMNode(modalBodyRef.current) as HTMLDivElement;\r\n        el?.closest('.modal-dialog')!.classList.remove('display--content');\r\n        setActiveTab('');\r\n    }, []);\r\n\r\n    const tabs = [\r\n        {name: 'info', uiName: formatMessage({id: 'team_settings_modal.infoTab', defaultMessage: 'Info'}), icon: 'icon icon-information-outline', iconTitle: formatMessage({id: 'generic_icons.info', defaultMessage: 'Info Icon'})},\r\n    ];\r\n    if (canInviteUsers) {\r\n        tabs.push({name: 'access', uiName: formatMessage({id: 'team_settings_modal.accessTab', defaultMessage: 'Access'}), icon: 'icon icon-account-multiple-outline', iconTitle: formatMessage({id: 'generic_icons.member', defaultMessage: 'Member Icon'})});\r\n    }\r\n\r\n    return (\r\n        <Modal\r\n            dialogClassName='a11y__modal settings-modal'\r\n            show={show}\r\n            onHide={handleHide}\r\n            onExited={handleClose}\r\n            role='none'\r\n            aria-labelledby='teamSettingsModalLabel'\r\n            id='teamSettingsModal'\r\n        >\r\n            <Modal.Header\r\n                id='teamSettingsModalLabel'\r\n                closeButton={true}\r\n            >\r\n                <Modal.Title\r\n                    componentClass='h2'\r\n                    className='modal-header__title'\r\n                >\r\n                    {formatMessage({id: 'team_settings_modal.title', defaultMessage: 'Team Settings'})}\r\n                </Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body ref={modalBodyRef}>\r\n                <div className='settings-table'>\r\n                    <div className='settings-links'>\r\n                        <React.Suspense fallback={null}>\r\n                            <SettingsSidebar\r\n                                tabs={tabs}\r\n                                activeTab={activeTab}\r\n                                updateTab={updateTab}\r\n                            />\r\n                        </React.Suspense>\r\n                    </div>\r\n                    <div className='settings-content minimize-settings'>\r\n                        <TeamSettings\r\n                            activeTab={activeTab}\r\n                            hasChanges={hasChanges}\r\n                            setHasChanges={setHasChanges}\r\n                            hasChangeTabError={hasChangeTabError}\r\n                            setHasChangeTabError={setHasChangeTabError}\r\n                            closeModal={handleHide}\r\n                            collapseModal={handleCollapse}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </Modal.Body>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default TeamSettingsModal;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {isModalOpen} from 'selectors/views/modals';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport TeamSettingsModal from './team_settings_modal';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const teamId = getCurrentTeamId(state);\r\n    const canInviteUsers = haveITeamPermission(state, teamId, Permissions.INVITE_USER);\r\n    const modalId = ModalIdentifiers.TEAM_SETTINGS;\r\n    return {\r\n        show: isModalOpen(state, modalId),\r\n        canInviteUsers,\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(TeamSettingsModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function EditIcon() {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <i\r\n            className='icon-pencil-outline'\r\n            aria-hidden='true'\r\n            title={formatMessage({id: 'generic_icons.edit', defaultMessage: 'Edit Icon'})}\r\n        />\r\n    );\r\n}\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useEffect} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport {AlertCircleOutlineIcon} from '@mattermost/compass-icons/components';\r\n\r\nimport './save_changes_panel.scss';\r\n\r\nexport type SaveChangesPanelState = 'editing' | 'saved' | 'error' | undefined;\r\n\r\nconst CLOSE_TIMEOUT = 1200;\r\n\r\ntype Props = {\r\n    handleSubmit: () => void;\r\n    handleCancel: () => void;\r\n    handleClose: () => void;\r\n    tabChangeError?: boolean;\r\n    state: SaveChangesPanelState;\r\n    customErrorMessage?: string;\r\n    saveButtonText?: React.ReactNode;\r\n    cancelButtonText?: React.ReactNode;\r\n}\r\nfunction SaveChangesPanel({\r\n    handleSubmit,\r\n    handleCancel,\r\n    handleClose,\r\n    tabChangeError = false,\r\n    state = 'editing',\r\n    customErrorMessage,\r\n    saveButtonText,\r\n    cancelButtonText,\r\n}: Props) {\r\n    const panelClassName = classNames('SaveChangesPanel', {error: tabChangeError || state === 'error'}, {saved: state === 'saved'});\r\n    const messageClassName = classNames('SaveChangesPanel__message', {error: tabChangeError || state === 'error'}, {saved: state === 'saved'});\r\n    const cancelButtonClassName = classNames('btn btn-tertiary btn-sm SaveChangesPanel__cancel-btn', {error: tabChangeError || state === 'error'}, {saved: state === 'saved'});\r\n    const saveButtonClassName = classNames('btn btn-primary btn-sm SaveChangesPanel__save-btn', {error: tabChangeError || state === 'error'}, {saved: state === 'saved'});\r\n\r\n    useEffect(() => {\r\n        let timeoutId: NodeJS.Timeout;\r\n        if (state === 'saved') {\r\n            timeoutId = setTimeout(() => {\r\n                handleClose();\r\n            }, CLOSE_TIMEOUT);\r\n        }\r\n\r\n        return () => clearTimeout(timeoutId);\r\n    }, [handleClose, state]);\r\n\r\n    const generateMessage = () => {\r\n        if (customErrorMessage && (tabChangeError || state === 'error')) {\r\n            return customErrorMessage;\r\n        }\r\n\r\n        if (tabChangeError || state === 'editing') {\r\n            return (\r\n                <FormattedMessage\r\n                    id='saveChangesPanel.message'\r\n                    defaultMessage='You have unsaved changes'\r\n                />\r\n            );\r\n        }\r\n\r\n        if (state === 'error') {\r\n            return (\r\n                <FormattedMessage\r\n                    id='saveChangesPanel.error'\r\n                    defaultMessage='There was an error saving your settings'\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <FormattedMessage\r\n                id='saveChangesPanel.saved'\r\n                defaultMessage='Settings saved'\r\n            />\r\n        );\r\n    };\r\n\r\n    const generateControlButtons = () => {\r\n        if (state === 'saved') {\r\n            return (\r\n                <div className='SaveChangesPanel__btn-ctr'>\r\n                    <button\r\n                        id='panelCloseButton'\r\n                        data-testid='panelCloseButton'\r\n                        type='button'\r\n                        className='btn btn-icon btn-sm'\r\n                        onClick={handleClose}\r\n                    >\r\n                        <i\r\n                            className='icon icon-close'\r\n                        />\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const saveButtonDisabled = tabChangeError || state === 'error';\r\n\r\n        return (\r\n            <div className='SaveChangesPanel__btn-ctr'>\r\n                <button\r\n                    data-testid='SaveChangesPanel__cancel-btn'\r\n                    className={cancelButtonClassName}\r\n                    onClick={handleCancel}\r\n                >\r\n                    {cancelButtonText || (\r\n                        <FormattedMessage\r\n                            id='saveChangesPanel.cancel'\r\n                            defaultMessage='Undo'\r\n                        />\r\n                    )}\r\n                </button>\r\n                <button\r\n                    data-testid='SaveChangesPanel__save-btn'\r\n                    className={saveButtonClassName}\r\n                    onClick={handleSubmit}\r\n                    disabled={saveButtonDisabled}\r\n                >\r\n                    {saveButtonText || (\r\n                        <FormattedMessage\r\n                            id='saveChangesPanel.save'\r\n                            defaultMessage='Save'\r\n                        />\r\n                    )}\r\n                </button>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className={panelClassName}>\r\n            <p className={messageClassName}>\r\n                <AlertCircleOutlineIcon\r\n                    size={18}\r\n                    color={'currentcolor'}\r\n                />\r\n                {generateMessage()}\r\n            </p>\r\n            {generateControlButtons()}\r\n        </div>\r\n    );\r\n}\r\nexport default SaveChangesPanel;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChannelBookmarksState} from '@mattermost/types/channel_bookmarks';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nconst EMPTY_BOOKMARKS = {};\r\n\r\nexport const getChannelBookmarks = (state: GlobalState, channelId: string): ChannelBookmarksState['byChannelId'][string] => {\r\n    const bookmarks = state.entities.channelBookmarks.byChannelId[channelId];\r\n\r\n    if (!bookmarks) {\r\n        return EMPTY_BOOKMARKS;\r\n    }\r\n\r\n    return bookmarks;\r\n};\r\n\r\nexport const getChannelBookmark = (state: GlobalState, channelId: string, bookmarkId: string) => {\r\n    return getChannelBookmarks(state, channelId)[bookmarkId];\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {\r\n    isCollapsedThreadsEnabled,\r\n} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport {makeGetDraftsCount} from 'selectors/drafts';\r\n\r\nimport type {SidebarSize} from 'components/resizable_sidebar/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\nimport type {StaticPage} from 'types/store/lhs';\r\n\r\nexport function getIsLhsOpen(state: GlobalState): boolean {\r\n    return state.views.lhs.isOpen;\r\n}\r\n\r\nexport function getLhsSize(state: GlobalState): SidebarSize {\r\n    return state.views.lhs.size;\r\n}\r\n\r\nexport function getCurrentStaticPageId(state: GlobalState): string {\r\n    return state.views.lhs.currentStaticPageId;\r\n}\r\n\r\nexport const getDraftsCount = makeGetDraftsCount();\r\n\r\nexport const getVisibleStaticPages = createSelector(\r\n    'getVisibleSidebarStaticPages',\r\n    isCollapsedThreadsEnabled,\r\n    getDraftsCount,\r\n    (collapsedThreadsEnabled, draftsCount) => {\r\n        const staticPages: StaticPage[] = [];\r\n\r\n        if (collapsedThreadsEnabled) {\r\n            staticPages.push({\r\n                id: 'threads',\r\n                isVisible: true,\r\n            });\r\n        }\r\n\r\n        staticPages.push({\r\n            id: 'drafts',\r\n            isVisible: draftsCount > 0,\r\n        });\r\n\r\n        return staticPages.filter((item) => item.isVisible);\r\n    },\r\n);\r\n"],"names":["deleteBookmark","channelId","id","dispatch","getState","state","connectionId","getConnectionId","async","bookmark","getChannelBookmark","Client4","deleteChannelBookmark","type","ChannelBookmarkTypes","BOOKMARK_DELETED","data","error","Actions","createBookmark","createdBookmark","createChannelBookmark","RECEIVED_BOOKMARK","editBookmark","patch","updated","deleted","updateChannelBookmark","reorderBookmark","newOrder","bookmarks","updateChannelBookmarkSortOrder","RECEIVED_BOOKMARKS","fetchChannelBookmarks","getChannelBookmarks","forceLogoutIfNecessary","logError","setUnreadFilterEnabled","enabled","ActionTypes","SET_UNREAD_FILTER_ENABLED","setDraggingState","SIDEBAR_DRAGGING_SET_STATE","stopDragging","SIDEBAR_DRAGGING_STOP","createCategory","teamId","displayName","channelIds","multiSelectedChannelIds","views","channelSidebar","forEach","indexOf","multiSelectChannelAdd","result","createCategoryRedux","ADD_NEW_CATEGORY_ID","addChannelsInSidebar","categoryId","moveChannelsInSidebar","targetIndex","draggableChannelId","setManualSorting","arguments","length","undefined","categories","getCategoriesForCurrentTeam","displayedChannels","getDisplayedChannels","channelsToMove","targetCategory","find","category","filter","selectedChannel","channel","isDMGM","General","DM_CHANNEL","GM_CHANNEL","CategoryTypes","CUSTOM","FAVORITES","DIRECT_MESSAGES","displayedChannelIds","map","sort","a","b","newIndex","getCategory","filteredChannelIds","makeGetChannelIdsForCategory","removedChannelsAboveInsert","index","shiftedIndex","channel_ids","updatedChannelIds","insertMultipleWithoutDuplicates","previousChannelId","sourceIndex","Math","max","adjustTargetIndexForMove","moveChannelsToCategory","clearChannelSelection","MULTISELECT_CHANNEL_CLEAR","currentChannel","getCurrentChannelId","MULTISELECT_CHANNEL","MULTISELECT_CHANNEL_ADD","multiSelectChannelTo","lastSelected","lastSelectedChannel","allChannelsIdsInOrder","getChannelsInCategoryOrder","indexOfNew","indexOfLast","start","min","end","inBetween","slice","MULTISELECT_CHANNEL_TO","SearchableChannelList","React","getDerivedStateFromProps","props","isSearch","page","constructor","super","_defineProperty","e","target","isEnterKeyPressed","isKeyPressed","Constants","KeyCodes","ENTER","shiftKey","ctrlKey","altKey","classList","contains","click","stopPropagation","this","setState","joiningChannel","handleJoin","isMemberOfChannel","closeModal","ModalIdentifiers","MORE_CHANNELS","_this$props$channelsM","ariaLabel","concat","display_name","purpose","toLowerCase","channelTypeIcon","isArchivedChannel","ArchiveOutlineIcon","size","isPrivateChannel","LockOutlineIcon","GlobeIcon","memberCount","channelsMemberCount","membershipIndicator","intl","formatMessage","defaultMessage","CheckIcon","FormattedMessage","channelPurposeContainerAriaLabel","messages","channelPurpose","channelPurposeContainer","className","AccountOutlineIcon","name","joinViewChannelButtonClass","classNames","joinViewChannelButton","onClick","disabled","Boolean","tabIndex","LoadingWrapper","loading","text","joiningButton","sharedChannelIcon","shared","SharedChannelIndicator","withTooltip","key","role","values","channelName","_this$channelListScro","preventDefault","nextDisabled","nextTimeoutId","setTimeout","nextPage","channelListScroll","current","scrollTo","top","_this$channelListScro2","search","channelSearchValue","filterType","changeFilter","currentTarget","value","doSearch","rememberHideJoinedChannelsChecked","hideJoinedChannelsPreference","tagName","Filter","Archived","Private","Public","componentDidMount","UserAgent","focus","document","addEventListener","onKeyDown","componentWillUnmount","removeEventListener","myChannelMemberships","render","channels","listContent","nextButton","previousButton","LoadingScreen","noMore","MagnifyingGlassSVG","getEmptyStateMessage","noResultsText","pageStart","channelsPerPage","pageEnd","channelsToDisplay","createChannelRow","previousPage","input","QuickInput","ref","placeholder","onInput","handleChange","clearable","onClear","handleClear","checkIcon","color","channelDropdownItems","Menu","filterChange","All","leadingElement","GlobeCheckedIcon","labels","trailingElements","push","menuButton","getFilterLabel","ChevronDownIcon","channelDropdown","children","menu","item","hideJoinedButtonClass","checked","hideJoinedPreferenceCheckbox","handleChecked","CheckboxCheckedIcon","channelCountLabel","channelCount","count","dropDownContainer","_pt","isRequired","defineMessages","injectIntl","BrowseChannels","handleExit","closeEditRHS","actions","openModal","modalId","NEW_CHANNEL_MODAL","dialogType","NewChannelModal","rhsOpen","rhsState","RHSStates","EDIT_HISTORY","closeRightHandSide","force","searchedChannels","serverError","getChannels","then","getChannelsMemberCount","done","_result","currentUserId","teamName","joinChannel","message","getHistory","getRelativeChannelURL","term","clearTimeout","searchTimeoutId","onChange","searching","searchTerm","window","searchAllChannels","team_ids","nonAdminSearch","include_deleted","channelIDsForMemberCount","setSearchResults","team_id","ignoredErr","c","PRIVATE_CHANNEL","OPEN_CHANNEL","delete_at","shouldHideJoinedChannels","getChannelsWithoutJoined","setGlobalItem","StoragePrefixes","HIDE_JOINED_CHANNELS","toString","channelList","archivedChannels","privateChannels","allChannels","localeCompare","allChannelsWithoutJoined","publicChannelsWithoutJoined","archivedChannelsWithoutJoined","privateChannelsWithoutJoined","filterOptions","loadComplete","promises","CHANNELS_CHUNK_SIZE","getArchivedChannels","Promise","all","results","flatMap","channelsRequestStarted","serverErrorState","activeChannels","getActiveChannels","createNewChannelButton","icon","buttonClassName","TeamPermissionGate","permissions","Permissions","CREATE_PUBLIC_CHANNEL","handleNewChannel","localizeMessage","body","handleShowJoinedChannelsPreference","title","GenericModal","onExited","compassDesign","modalHeaderText","headerButton","autoCloseOnConfirmButton","enforceFocus","bodyPadding","getChannelsWithoutArchived","createSelector","getChannelsInCurrentTeam","getArchivedOtherChannels","getPrivateChannelsSelector","connect","team","getCurrentTeam","getGlobalItem","makeGetGlobalItem","getCurrentUserId","getCurrentTeamId","requests","status","RequestStatus","STARTED","getMyChannelMemberships","getRhsState","getIsRhsOpen","getChannelsMemberCountSelector","bindActionCreators","MAX_BOOKMARKS_PER_CHANNEL","BOOKMARK_PERMISSION","ADD_BOOKMARK_PUBLIC_CHANNEL","EDIT_BOOKMARK_PUBLIC_CHANNEL","DELETE_BOOKMARK_PUBLIC_CHANNEL","ORDER_BOOKMARK_PUBLIC_CHANNEL","ADD_BOOKMARK_PRIVATE_CHANNEL","EDIT_BOOKMARK_PRIVATE_CHANNEL","DELETE_BOOKMARK_PRIVATE_CHANNEL","ORDER_BOOKMARK_PRIVATE_CHANNEL","useChannelBookmarkPermission","action","useSelector","getHaveIChannelBookmarkPermission","getChannel","myMembership","getMyChannelMember","channel_id","permission","haveIChannelPermission","useCanUploadFiles","canUploadFiles","getConfig","useCanGetPublicLink","isPublicLinksEnabled","getIsChannelBookmarksEnabled","getFeatureFlagValue","license","getLicense","IsLicensed","useChannelBookmarks","useDispatch","order","useMemo","Object","keys","sort_order","tempOrder","setTempOrder","useState","useEffect","emojis","reduce","_ref","emoji","trimmedEmojiName","loadCustomEmojisIfNeeded","reorder","prevOrder","nextOrder","insertWithoutDuplicates","ChannelMoveToSubMenu","useIntl","getAllChannels","currentTeam","currentCategory","getCategoryInTeamWithChannel","handleMoveToCategory","event","handleMoveToNewCategory","EDIT_CATEGORY","EditCategoryModal","dialogProps","channelIdsToAdd","createSubmenuItemsForCategoryArray","CHANNELS","selectedCategory","StarOutlineIcon","FolderOutlineIcon","FolderMoveOutlineIcon","filterCategoriesBasedOnChannelType","inHeaderDropdown","ChevronRightIcon","menuId","menuAriaLabel","isSubmenuOneOfSelectedChannels","includes","every","getMoveToCategorySubmenuItems","memo","categoryName","isProcessing","timeoutId","renameCategory","currentTeamId","initialCategoryName","editButtonText","helpText","getText","confirmButtonText","handleEnterKeyPress","handleConfirm","handleCancel","isConfirmDisabled","inputComponent","MaxLengthInput","autoFocus","maxLength","LeaveTeamModal","show","handleSubmit","handleHide","leaveTeam","toggleSideBarRightMenu","handleKeyPress","currentUser","numOfPrivateChannels","numOfPublicChannels","modalMessage","UserUtils","roles","num_of_public_channels","num_of_private_channels","strong","chunks","Modal","dialogClassName","onHide","Header","closeButton","Title","componentClass","Body","Footer","getNumOfPrivateChannels","getMyChannels","getNumOfPublicChannels","getCurrentUser","toggleSideBarRightMenuAction","DEFAULT_NUM_PER_PAGE","ListModal","onPageChange","prevPage","loadItems","items","totalCount","numPerPage","renderRows","position","renderRow","paginationRange","startCount","endCount","titleText","titleBarButtonText","titleBarButtonOnClick","href","htmlFor","searchPlaceholderText","onSearchInput","total","onPrev","onNext","SearchShortcut","variant","controlKey","isMac","shortcutKeyVariant","ShortcutKeyVariant","Contrast","ShortcutKey","isDesktopApp","propTypes","CreateNewCategoryMenuItem","otherProps","_objectWithoutProperties","_excluded","handleCreateCategory","useCallback","assign","FolderPlusOutlineIcon","MarkAsReadConfirmModal","numChannels","header","confirm","MarkAsUnreadItem","handleViewCategory","DELETE_CATEGORY","MarkAsUnreadIcon","SidebarCategoryGenericMenu","isMenuOpen","setIsMenuOpen","menuOpen","class","DotsVerticalIcon","menuButtonTooltip","onToggle","isOpen","SidebarCategoryHeaderStatic","wrapEmojis","SidebarCategoryHeader","dragHandleProps","Reflect","deleteProperty","muted","dragging","isDragging","isCollapsed","isCollapsible","isDraggingOver","defaultProps","ChannelMentionBadge","unreadMentions","hasUrgent","badge","urgent","ChannelPencilIcon","hasDraft","draft","currentChannelId","trim","fileInfos","uploadsInProgress","ownProps","getPostDraft","DRAFT","SidebarChannelIcon","isDeleted","SidebarChannelMenu","channelLink","favoriteChannel","isFavorite","isMuted","isUnread","managePrivateChannelMembers","managePublicChannelMembers","readMultipleChannels","markMostRecentPostInChannelAsUnread","muteChannel","onMenuToggle","unfavoriteChannel","unmuteChannel","channelLeaveHandler","isLeaving","useRef","markAsReadUnreadMenuItem","handleMarkAsRead","handleMarkAsUnread","favoriteUnfavoriteMenuItem","handleUnfavoriteChannel","StarIcon","handleFavoriteChannel","muteUnmuteChannelMenuItem","muteChannelText","handleUnmuteChannel","BellOffOutlineIcon","handleMuteChannel","BellOutlineIcon","copyLinkMenuItem","handleCopyLink","copyToClipboard","LinkVariantIcon","addMembersMenuItem","handleAddMembers","CHANNEL_INVITE","ChannelInviteModal","AccountPlusOutlineIcon","leaveChannelMenuItem","DEFAULT_CHANNEL","leaveChannelText","handleLeaveChannel","ExitToAppIcon","isDestructive","ChannelMoveToSubmenu","mapDispatchToProps","member","MANAGE_PUBLIC_CHANNEL_MEMBERS","MANAGE_PRIVATE_CHANNEL_MEMBERS","isFavoriteChannel","isChannelMuted","getSiteURL","SidebarChannelLink","element","labelRef","showTooltip","offsetWidth","scrollWidth","label","ariaLabelPrefix","mark","Mark","ChannelLinkClicked","handleSelectChannel","defaultPrevented","button","cmdOrCtrlPressed","_this$props$channel","enableToolTipIfNeeded","isSharedChannel","remoteNames","fetchChannelRemotes","componentDidUpdate","prevProps","_prevProps$channel","_this$props$channel2","_prevProps$channel2","_this$props$channel3","_this$props$channel4","isChannelSelected","link","firstChannelName","showChannelsTutorialStep","channelsTutorialTip","ChannelsAndDirectMessagesTour","labelElement","WithTooltip","customStatus","teammateId","CustomStatusEmoji","userID","spanStyle","height","emojiStyle","marginTop","marginBottom","opacity","content","Pluggable","pluggableName","handleMenuToggle","selected","Link","getAriaLabel","to","handleChannelClick","unsetEditingPost","getUnreadCount","makeGetChannelUnreadCount","_ownProps$channel","unreadCount","config","enableTutorial","EnableTutorial","tutorialStep","getInt","TutorialTourName","ONBOARDING_TUTORIAL_STEP","channelTourTriggered","OnboardingTaskCategory","OnboardingTasksName","CHANNELS_TOUR","FINISHED","GenericTaskSteps","isOnboardingFlowEnabled","EnableOnboardingFlow","OnboardingTourSteps","CHANNELS_AND_DIRECT_MESSAGES","getRemoteNamesForChannel","mentions","unreadMsgs","showUnread","getFirstChannelName","SidebarBaseChannel","currentTeamName","handleLeavePublicChannel","callback","leaveChannel","handleLeavePrivateChannel","LEAVE_PRIVATE_CHANNEL_MODAL","LeaveChannelModal","channelIcon","SidebarBaseChannelIcon","channelType","SidebarDirectChannel","teammate_id","Preferences","CATEGORY_DIRECT_CHANNEL_SHOW","savePreferences","user_id","leaveDirectChannel","active","redirectChannel","teammate","ProfilePicture","src","getProfilePictureUrl","last_picture_update","is_bot","wrapperClass","newStatusIcon","statusClass","displayname","username","getIcon","remote_id","getUser","getRedirectChannelNameForTeam","SidebarGroupChannel","membersCount","CATEGORY_GROUP_CHANNEL_SHOW","getMemberCount","makeGetGmChannelMemberCount","connector","makeGetChannel","isCurrentChannel","draggingState","getDraggingState","autoSortedCategoryIds","getAutoSortedCategoryIds","isCategoryCollapsed","isCategoryDragged","setChannelRef","isDraggable","channelIndex","isAutoSortedCategory","setShow","setRef","refMethod","handleAnimationStart","animationName","handleAnimationEnd","component","selectedCount","Draggable","draggableId","provided","snapshot","draggable","innerRef","collapsed","expanded","unread","selectedDragging","fadeOnDrop","isDropAnimating","draggingOver","has","noFloat","draggableProps","onAnimationStart","onAnimationEnd","initializeTeam","selectTeam","LocalStorageStore","setPreviousTeamId","getIsUserStatusesConfigEnabled","addVisibleUsersInCurrentChannelAndSelfToStatusPoll","customGroupEnabled","isCustomGroupsEnabled","LDAPGroups","groupsParams","filter_allow_reference","per_page","include_member_count","include_member_ids","include_archived","myGroupsParams","_objectSpread","filter_has_member","getGroupsByUserIdPaginated","getAllGroupsAssociatedToChannelsInTeam","group_constrained","getAllGroupsAssociatedToTeam","getGroups","USER_ID_PAIR_REGEXP","RegExp","onChannelByIdentifierEnter","match","history","path","identifier","params","teamObj","getTeamByName","channelPath","channelsByName","getChannelByName","moreChannelsByName","getOtherChannels","chan","status_code","test","isDirectChannelIdentifier","getPathFromIdentifier","getChannelsNameMapInTeam","getChannelDispatchResult","getChannelByNameAndTeamName","entities","myMembers","membership","getChannelMember","_channel","_channel2","joinPromptResult","joinPrivateChannelPrompt","join","joinChannelDispatchResult","fetchChannelsAndMembers","handleChannelJoinError","goToDirectChannelByUserIds","replace","doChannelChange","goToChannelByChannelName","dispatchResult","goToDirectChannelByUserId","Utils","goToChannelByChannelId","groupId","url","handleError","markGroupChannelOpen","goToGroupChannelByGroupId","user","selectUserByUsername","getUserByUsername","directChannelDispatchRes","openDirectChannelToUserId","goToDirectChannelByUsername","email","selectUserByEmail","getUserByEmail","goToDirectChannelByEmail","userId","selectUser","GlobalActions","defaultChannel","ListItemSizeObserver","Map","resizeEntries","resizeEntry","resizedElement","itemData","trackedItemData","trackedItems","entries","changedHeight","ceil","borderBoxSize","blockSize","observer","ResizeObserver","handleResizeObserver","getInstance","instance","observe","itemId","set","unobserve","trackedItemToUnobserve","get","delete","listItemSizeObserver","ListItem","rowRef","heightRef","widthRef","width","indexRef","_rowRef$current$offse","_rowRef$current","newHeight","offsetHeight","onHeightChange","debouncedOnHeightChange","debounce","forceScrollCorrection","cleanupSizeObserver","_cleanupSizeObserver","cancel","onUnmount","DynamicVirtualizedList","PureComponent","itemOffsetMap","itemSizeMap","totalMeasuredSize","atBottom","scrollDirection","scrollOffset","initialScrollOffset","scrollUpdateWasRequested","scrollDelta","scrollHeight","localOlderPostsToRender","scrollBy","_outerRef","scrollTop","_scrollCorrectionInProgress","memoizeOne","overscanStartIndex","overscanStopIndex","visibleStartIndex","visibleStopIndex","onItemsRendered","clientHeight","onScroll","scrolledToInitIndex","_listMetaData","offset","initScrollToIndex","scrollToItem","_keepScrollToBottom","_keepScrollPosition","canLoadMorePosts","prevHeight","prevOffset","itemStyleCache","_itemStyleCache","style","prototype","hasOwnProperty","call","left","getItemOffset","getItemSize","_correctedInstances","_mountingCorrections","i","prevSize","newSize","findIndex","oldSize","_generateOffsetMeasurements","correctScrollToBottom","forceUpdate","delta","_getRangeToRender","prevState","deltaValue","_correctScroll","outerRef","innerRefWidth","clientWidth","startIndex","stopIndex","itemCount","getItemMetadata","localOlderPostsToRenderStartIndex","localOlderPostsToRenderStopIndex","isItemInLocalPosts","isLoader","loaderId","isVisible","visibleId","_getItemStyle","createElement","_handleNewMeasurements","_onItemRowUnmount","scrollByValue","useAnimationFrame","_scrollByCorrection","requestAnimationFrame","align","offsetOfItem","getOffsetForIndexAndAlignment","scrollToFailed","_commitHook","getSnapshotBeforeUpdate","_","previousScrollTop","previousScrollHeight","prevScrollDirection","prevScrollOffset","prevScrollUpdateWasRequested","_callPropsCallbacks","_dataChange","_heightChange","_widthChange","postlistScrollHeight","scrollValue","cancelAnimationFrame","_callOnItemsRendered","_callOnScroll","overscanCountForward","overscanCountBackward","scrollOffsetValue","getStartIndexForOffset","getStopIndexForStartIndex","overscanBackward","overscanForward","minValue","maxValue","initRangeToRender","innerTagName","outerTagName","innerListStyle","_onScrollVertical","_renderItems","_outerRefSetter","WebkitOverflowScrolling","overflowY","overflowAnchor","willChange","listMetaData","itemMetadata","estimatedTotalSize","maxOffset","minOffset","round","findNearestItem","high","low","PrivateChannelIntroSvg","_props$width","_props$height","viewBox","fill","xmlns","xmlnsXlink","clipPath","d","stroke","strokeOpacity","strokeLinecap","cx","cy","r","transform","fillOpacity","strokeLinejoin","x","y","rx","PublicChannelIntroSvg","SvgComponent","AddMembersButton","totalUsers","usersLimit","pluginButtons","LoadingSpinner","inviteUsers","ADD_USER_TO_TEAM","INVITE_GUEST","LessThanMaxFreeUsers","MoreThanMaxFreeUsers","_ref2","ToggleModalButton","INVITATION","InvitationModal","focusOriginElement","_ref3","ADD_GROUPS_TO_CHANNEL","modal","AddGroupsToChannelModal","isPrivate","ChannelPermissionGate","PluggableIntroButtons","channelMember","channelIsArchived","usePluginVisibilityInSharedChannel","buttons","buttonProps","_buttonProps$action","getMyChannelMembership","getChannelIntroPluginButtons","ChannelIntroMessage","_this$props$stats","stats","total_users_count","getTotalUsersStats","fullWidth","locale","channelProfiles","enableUserCreation","isReadOnly","teamIsGroupConstrained","creatorName","teammateName","isMobileView","centeredIntro","toggleFavorite","channelIntroId","pluggableButton","setHeaderButton","createSetHeaderButton","actionButtons","createFavoriteButton","UserProfile","createDMIntroMessage","profiles","channelMembership","currentUserProfile","v","pictures","profile","createNotificationPreferencesButton","getGMIntroMessageSpecificPart","createGMIntroMessage","teamInviteLink","MANAGE_PRIVATE_CHANNEL_PROPERTIES","MANAGE_PUBLIC_CHANNEL_PROPERTIES","INVITE_USER","ADD_GROUPS_TO_TEAM","AddGroupsToTeamModal","ChannelIntroTownSquareSvg","createDefaultIntroMessage","OFFTOPIC_CHANNEL","channelInviteButton","ChannelIntroPublicSvg","createOffTopicIntroMessage","uiName","memberMessage","date","FormattedDate","create_at","month","getMonthLong","day","year","createMessage","purposeMessage","creator","ChannelIntroPrivateSvg","createStandardIntroMessage","gmIntroMessages","NotificationLevel","ALL","DEFAULT","MENTION","NONE","userProfile","_membership$notify_pr","_userProfile$notify_p","channelNotifyProp","notify_props","desktop","userNotifyProp","notifyLevelToUse","EDIT_CHANNEL_HEADER","EditChannelHeaderModal","PencilOutlineIcon","classes","favoriteText","CHANNEL_NOTIFICATIONS","ChannelNotificationsModal","BellRingOutlineIcon","EnableUserCreation","getCurrentChannel","getMyCurrentChannelMembership","getDirectTeammate","creator_id","getTotalUsersStatsSelector","CATEGORY_DISPLAY_SETTINGS","CHANNEL_DISPLAY_MODE","CHANNEL_DISPLAY_MODE_DEFAULT","CHANNEL_DISPLAY_MODE_FULL_SCREEN","getCurrentLocale","getProfilesInCurrentChannel","isCurrentChannelFavorite","getDisplayNameByUser","getIsMobileView","PostListRow","blockShortcutReactToLastPostForNonMessages","listId","emitShortcutReactToLastPostFrom","isIdNotPost","Locations","NO_WHERE","isLastPost","shortcutReactToLastPostEmittedFrom","shortcutReactToLastPostEmittedFromCenter","CENTER","previousListId","loadingOlderPosts","loadingNewerPosts","OLDER_MESSAGES_LOADER","NEWER_MESSAGES_LOADER","CHANNEL_INTRO_MESSAGE","LOAD_OLDER_MESSAGES_TRIGGER","LOAD_NEWER_MESSAGES_TRIGGER","PostListRowListIds","PostListUtils","DateSeparator","NewMessageSeparator","separatorId","newMessagesSeparatorActions","exceededLimitChannelId","CenterMessageLock","loadOlderPosts","loadNewerPosts","shouldHideAnimation","hideAnimation","postProps","previousPostId","shouldHighlight","togglePostMenu","CombinedUserActivityPost","location","combinedId","PostComponent","post","firstInaccessiblePostTime","getShortcutReactToLastPostEmittedFrom","getPost","plugins","components","NewMessagesSeparatorAction","getLimitedViews","ScrollToBottomIcon","enableBackground","ScrollToBottomArrows","isScrolling","innerWidth","scrolling","HintToast","onDismiss","handleDismiss","CloseIcon","ScrollToBottomToast","jumpToRecentsMessage","UnreadBelowIcon","TOAST_REL_RANGES","RelativeRanges","ToastWrapperClass","_this","ESCAPE","showUnreadToast","hideUnreadToast","showNewMessagesToast","hideNewMessagesToast","showUnreadWithBottomStartToast","hideUnreadWithBottomStartToast","hideArchiveToast","showMessageHistoryToast","updateLastViewedBottomAt","onSearchHintDismiss","since","isToday","Date","Timestamp","useTime","ranges","searchShortcut","focusedPostId","atLatestPost","scrollToNewMessage","changeUrlToRemountChannelView","_this$props$hideScrol","_this$props","scrollToLatestMessages","hideScrollToBottomToast","scrollToUnreadMessages","unreadCountInChannel","unreadScrollPosition","UNREAD_SCROLL_POSITION_START_FROM_NEWEST","newRecentMessagesCount","countNewMessages","rootPosts","isCollapsedThreadsEnabled","postListIds","channelMarkedAsUnread","initScrollOffsetFromBottom","lastViewedAt","latestPostTimeStamp","lastViewedBottom","isNewMessageLineReached","shouldStartFromBottomWhenUnread","mounted","toastPresent","handleShortcut","updateToastStatus","updateNewMessagesAtInChannel","prevPostsCount","presentPostsCount","getToastToRender","showSearchHintToast","showScrollToBottomToast","unreadToastProps","onClickMessage","showActions","Toast","newMessagesToastText","unreadWithBottomStartToastProps","jumpDirection","showNewMessagesToastOverrides","archiveToastProps","extraClasses","archiveToastText","toasts","onScrollToBottomToastDismiss","hideSearchHintToast","getSearchHintToastText","toastToRender","getNewMessagesIndex","newMessages","withRouter","countUnreadsBelow","getAllPosts","postIds","allPosts","Posts","POST_DELETED","root_id","getRootPosts","obj","preparePostIdsForPostList","makePreparePostIdsForPostList","isManuallyUnread","lastChannelViewTime","getUnreadScrollPositionPreference","getPostIdsInChannel","countCurrentChannelUnreadMessages","ToastWrapper","LatestPostReader","latestPostId","getLatestPostId","latestPost","usePostAriaLabel","postListStyle","padding","virtListStyles","bottom","maxHeight","PostList","showSearchHintThreshold","getShowSearchHintThreshold","opened","dynamicListStyle","postMenuOpened","basePaddingClass","previousItemId","nextItemId","isDateLine","isStartOfNewMessages","getPreviousPostId","changeUnreadChunkTimeStamp","didUserScrollBackwards","didUserScrollForwards","isOffsetWithInRange","offsetFromBottom","getOffsetFromBottom","shouldLoadNewPosts","atOldestPost","scrollStopAction","fireAfter","SCROLL_DELAY","checkBottom","_this$listRef$current","postsRenderedRange","listRef","PostRequestTypes","AFTER_ID","showSearchHint","isSearchHintDismissed","updateScrollToBottomToastVisibility","screen","updateAtBottom","isAtBottom","now","isScrollToBottomDismissed","visibleTopItem","topPostId","updateFloatingTimestamp","newMessageLineIndex","onNewMessageLineReached","newMessagesSeparatorIndex","scrollToBottom","toggleShouldStartFromBottomWhenUnread","_this$listRef$current2","_this$listRef$current3","handleSearchHintDismiss","handleScrollToBottomToastDismiss","channelIntroMessage","initScrollCompleted","postListRef","DelayedAction","handleScrollStop","postIndex","postId","maxPostsForSlicing","handleWindowResize","EventEmitter","addListener","EventTypes","POST_LIST_SCROLL_TO_BOTTOM","postsAddedAtTop","channelHeaderAdded","_postListNode$parentE","postListNode","parentElement","_prevState","_this$listRef$current4","removeListener","newPostListIds","autoRetryEnable","nextState","FloatingTimestamp","AutoSizer","_ref4","renderToasts","USER_SCROLL_POSTS_PER_PAGE","POST_CHUNK_SIZE","markAndMeasureChannelSwitchEnd","fresh","PostListLoaded","measureAndReport","Measure","ChannelSwitch","startMark","endMark","canFail","TeamSwitch","TeamLinkClicked","clearMarks","isFirstLoad","isPrefetchingInProcess","loadPostsAround","loadUnreads","syncPostsInChannel","loadLatestPosts","markChannelAsRead","perPage","loadPosts","BEFORE_ID","autoRetriesCount","callLoadPosts","getOldestPostId","hasInaccessiblePosts","extraPagesLoaded","getPostsAfter","getPostsBeforeAutoLoad","oldestPostId","getOldestVisiblePostId","getLatestVisiblePostId","actionsForPostList","getPostsBefore","postsOnLoad","VirtPostList","formattedPostIds","centered","posts","postsInChannel","memoizedGetLatestPostId","memoizeResult","getPostsChunkAroundPost","makeGetPostsChunkAroundPost","chunk","unreadChunkTimeStamp","channelViewState","channelPrefetchStatus","limitedViews","focusedPost","getUnreadPostsChunk","getRecentPostsChunkInChannel","recent","oldest","shouldHideNewMessageIndicator","isPostsChunkIncludingUnreadsPosts","indicateNewMessages","PostView","loaderForChangeOfPostsChunk","channelLoading","_ownProps$match","last_post_at","isChannelLoading","teamMemberships","_params$identifier","postid","getTeamMemberships","onClickRefresh","reload","InputLoading","updateWaitForLoader","showMessage","setShowMessage","timeout","ChannelHeader","makeAsyncComponent","lazy","FileUploadOverlay","ChannelBookmarks","AdvancedCreatePost","ChannelBanner","ChannelView","updatedState","deferredPostView","createDeferredPostView","goToLastViewedChannel","waitForLoader","channelViewRef","enableWebSocketEventScope","WebSocketClient","updateActiveChannel","createPost","deactivatedChannel","onClickCloseChannel","missingChannelRole","onUpdateInputShowLoader","DeferredPostView","overlayType","DropOverlayIdCenterChannel","isChannelBookmarksEnabled","deferComponentRender","enableOnboardingFlow","FeatureFlagWebSocketEventScope","_getMyChannelMembersh","split","some","getRoles","isMissingChannelRoles","isDeactivatedDirectChannel","isCloud","Cloud","teamUrl","getCurrentRelativeTeamUrl","isFirstAdmin","ChannelIdentifierRouter","replaceUrlTimeout","channelUrl","PERMALINK_FADEOUT","replaceUrlIfPermalink","MobileChannelHeader","GlobalThreads","Drafts","PermalinkView","PlaybookRunner","CenterChannel","returnTo","lastReturnTo","nextProps","pathname","getProfiles","lastChannelPath","lhsOpen","rhsMenuOpen","Switch","Route","ID_PATH_PATTERN","TEAM_NAME_PATH_PATTERN","IDENTIFIER_PATH_PATTERN","SCHEDULED_POST_URL_SUFFIX","Redirect","mapStateToProps","lastViewedType","getLastViewedTypeByTeamName","getLastViewedChannelNameByTeamName","previousTeamId","getPreviousTeamId","previousTeamLastViewedType","getPreviousTeamLastViewedType","PreviousViewedTypes","THREADS","getIsLhsOpen","getIsRhsMenuOpen","useLocation","useHistory","actionMap","open_invitation_modal","searchParams","URLSearchParams","Priority","PrefetchLimits","prefetchQueue","unreadChannels","memberships","collapsedThreads","unreadChannelsCount","medium","unreadMax","mentionMax","mention_count_root","mention_count","mark_unread","queue","PQueue","concurrency","DataPrefetch","delay","unreadChannel","random","prefetchChannelPosts","prefetchRequestStatus","prefetchQueueObj","priority","hasOwn","priorityQueue","add","prefetchPosts","sidebarLoaded","loadProfilesForSidebar","prefetchTimeout","clear","prefetchData","isSidebarLoaded","lastUnreadChannel","getUnreadChannels","ResizableLhs","containerRef","ResizableDivider","globalCssVar","CssVarKeyForResizable","LHS","defaultWidth","DEFAULT_LHS_WIDTH","dir","ResizeDirection","LEFT","SidebarTeamMenu","_props$currentTeam","havePermissionToCreateTeam","haveISystemPermission","CREATE_TEAM","havePermissionToManageTeam","haveICurrentTeamPermission","MANAGE_TEAM","havePermissionToAddUserToTeam","havePermissionToInviteGuest","isCloudLicense","isGuestAccessEnabled","EnableGuestAccounts","isTeamGroupConstrained","isLicensedForLDAPGroups","experimentalPrimaryTeam","ExperimentalPrimaryTeam","joinableTeams","getJoinableTeamIds","haveMoreJoinableTeams","canJoinAnotherTeam","tooltipText","description","InvitePeopleMenuItem","AddGroupsToTeamMenuItem","TeamSettingsMenuItem","ManageViewMembersMenuItem","ManageGroupsMenuItem","teamID","LeaveTeamMenuItem","JoinAnotherTeamMenuItem","CreateTeamMenuItem","LearnAboutTeamsMenuItem","PluginMenuItems","handleClick","AccountMultiplePlusOutlineIcon","TEAM_SETTINGS","TeamSettingsModal","SettingsOutlineIcon","havePermissionToRemoveUserFromTeam","REMOVE_USER_FROM_TEAM","havePermissionToManageTeamRoles","MANAGE_TEAM_ROLES","TEAM_MEMBERS","TeamMembersModal","AccountMultipleOutlineIcon","MANAGE_TEAM_GROUPS","TeamGroupsManageModal","MonitorAccountIcon","LEAVE_TEAM","MessagePlusOutlineIcon","cloudSubscription","getCloudSubscription","subscriptionProduct","getSubscriptionProduct","isFreeTrial","is_free_trial","isStarterFree","sku","CloudProducts","STARTER","usageDeltas","useGetUsageDeltas","isTeamsLimitReached","teams","isTeamCreateRestricted","PlusIcon","RestrictedIndicatorForCreateTeam","RestrictedIndicator","feature","MattermostFeatures","CREATE_MULTIPLE_TEAMS","minimumPlanRequiredForFeature","LicenseSkus","Professional","blocked","tooltipMessage","titleAdminPreTrial","messageAdminPreTrial","trialLength","FREEMIUM_TO_ENTERPRISE_TRIAL_LENGTH_DAYS","titleAdminPostTrial","messageAdminPostTrial","titleEndUser","messageEndUser","MATTERMOST_ACADEMY_TEAM_TRAINING_LINK","open","LightbulbOutlineIcon","pluginInMainMenu","getMainMenuPluginComponents","pluginMenuItems","plugin","SidebarHeader","canCreateChannel","canJoinPublicChannel","SidebarBrowseOrAddChannelMenu","onCreateNewChannelClick","showNewChannelModal","onBrowseChannelClick","showMoreChannelsModal","onOpenDirectMessageClick","handleOpenDirectMessagesModal","canCreateCustomGroups","onCreateNewUserGroupClick","showCreateUserGroupModal","unreadFilterEnabled","onCreateNewCategoryClick","showCreateCategoryModal","onInvitePeopleClick","invitePeopleModal","CHANNEL_MODE","QuickSwitchModal","switchBox","textbox","getTextbox","activeElement","focusTextbox","focusPostTextbox","querySelector","_this$props$onExited","focusElement","shouldShowLoadingSpinner","mode","joinChannelById","switchToChannel","MENTION_MORE_CHANNELS","hideOnSelect","suggestions","suggestionItems","flattenItems","loadingPropPresent","isItemLoaded","pretext","matchedPretext","hasSuggestions","providers","channelProviders","help","modalSubheaderText","hideOnCancel","SuggestionBox","setSwitchBoxRef","onItemSelected","listComponent","SuggestionList","listPosition","completeOnTab","spellCheck","delayInputUpdate","openWhenEmpty","onSuggestionsReceived","handleSuggestionsReceived","forceSuggestionsWhenBlur","shouldSearchCompleteText","NoResultsIndicator","NoResultsVariant","Search","titleValues","SwitchChannelProvider","disableTooltip","enableTooltip","shortcut","default","ShortcutKeys","ctrl","shift","mac","cmd","ChannelFilter","toggleUnreadFilter","Keyboard","U","handleUnreadFilterKeyPress","unreadsAriaLabel","getMyTeams","hasMultipleTeams","isUnreadFilterEnabled","ChannelNavigator","QUICK_SWITCH","M","L","K","toggleQuickSwitchModal","isQuickSwitcherOpen","handleQuickSwitchKeyPress","showUnreadsCategory","openQuickSwitcher","shouldShowUnreadsCategory","isModalOpen","DeleteCategoryModal","deleteCategory","confirmButtonClassName","category_name","paginationCount","paginationNext","paginationPrev","SidebarCategoryMenu","getUnreadsIdsForCategory","makeGetUnreadIdsForCategory","unreadsIds","muteUnmuteCategoryMenuItem","toggleCategoryMute","setCategoryMuted","deleteCategoryMenuItem","renameCategoryMenuItem","handleDeleteCategory","handleRenameCategory","TrashCanOutlineIcon","handleSortChannels","sorting","setCategorySorting","sortChannelsSelectedValue","sortChannelsIcon","FormatListBulletedIcon","CategorySorting","Alphabetical","SortAlphabeticalAscendingIcon","Recency","ClockOutlineIcon","sortChannelsMenuItem","Manual","markAsReadMenuItem","MarkAsReadMenuItem","SidebarCategorySortingMenu","selectedDmNumber","getVisibleDmGmLimit","handleSortDirectMessages","sortDirectMessagesIcon","sortDirectMessagesSelectedValue","sortDirectMessagesMenuItem","showMessagesCountSelectedValue","showMessagesCountMenuItem","DM_AND_GM_SHOW_COUNTS","dmGmShowCount","handlelimitVisibleDMsGMs","number","CATEGORY_SIDEBAR_SETTINGS","LIMIT_VISIBLE_DMS_GMS","openDirectMessageMenuItem","isAddChannelCtaDropdownOpen","addChannelCtaDropdown","AddChannelsCtaButton","touchedAddChannelsCtaButton","getBool","TOUCHED","Touched","ADD_CHANNELS_CTA","canCreatePublicChannel","haveICurrentChannelPermission","CREATE_PRIVATE_CHANNEL","JOIN_PUBLIC_CHANNELS","isAddChannelCtaOpen","openAddChannelsCtaOpen","ADD_CHANNEL_CTA_DROPDOWN_TOGGLE","setAddChannelCtaDropdown","buttonClass","addChannelsButton","btnCallback","storePreferencesAndTrackEvent","MenuWrapper","renderDropdownItems","joinPublicChannel","createChannel","ItemAction","Group","browseChannelsAction","InviteMembersButton","SidebarCategory","_this$categoryTitleRe","categoryTitleRef","handleA11yKeyDown","a11yKeyDownRegistered","_this$categoryTitleRe2","handleCollapse","SidebarChannel","DraggingStateTypes","CATEGORY","setCategoryCollapsed","newDropBoxRef","remove","handleOpenMoreDirectChannelsModal","nativeEvent","CHANNEL","DM","isNewCategory","isDragDisabled","onTransitionEnd","removeAnimation","_this$categoryTitleRe3","_this$categoryTitleRe4","A11yCustomEventTypes","ACTIVATE","handleA11yActivateEvent","DEACTIVATE","handleA11yDeactivateEvent","_this$categoryTitleRe5","_this$categoryTitleRe6","categoryIndex","renderedChannels","renderChannel","categoryMenu","newLabel","addHelpLabel","KeyboardShortcutSequence","KEYBOARD_SHORTCUTS","navDMMenu","hideDescription","isInsideTooltip","categoryNames","disableInteractiveElementBlocking","inviteMembersButton","addChannelsCtaButton","dropDisabled","isDropDisabled","menuIsOpen","capture","DraggingStates","CAPTURE","Droppable","droppableId","droppableProvided","droppableSnapshot","droppableProps","renderNewDropBox","showPlaceholder","direct_messages","favorites","getChannelIdsForCategory","makeGetFilteredChannelIdsForCategory","isAdmin","DraftsLink","GlobalThreadsLink","UnreadChannelIndicator","UnreadChannels","SidebarList","staticPages","channelRefs","unreadChannelIds","spring","_scrollTo","val","getCurrentValue","scrollbar","scrollToChannel","getFirstUnreadChannel","getLastUnreadChannel","scrollingToUnread","offsetTop","margin","showTopUnread","scrollEnd","getDisplayedChannelIds","scrollToPosition","showBottomUnread","scrollAnimation","setCurrentValue","setAtRest","setEndValue","firstUnreadChannel","firstUnreadElement","lastUnreadElement","getFirstUnreadChannelFromChannelIdArray","reverse","switchToChannelById","switchToLhsStaticPage","metaKey","UP","DOWN","staticPageIds","getDisplayedStaticPageIds","allIds","curSelectedId","currentStaticPageId","curIndex","nextIndex","nextId","mod","navigateById","allChannelIds","unshift","hasUnreadThreads","direction","findNextUnreadChannelId","nextChannelId","newCategoryIds","updateUnreadIndicators","before","droppable","querySelectorAll","draggingChannels","MIXED_CHANNELS","BEFORE","initial","onDragStart","DURING","onDragEnd","reason","destination","moveCategory","animate","SpringSystem","createSpring","setOvershootClampingEnabled","onSpringUpdate","handleScrollAnimationUpdate","navigateChannelShortcut","navigateUnreadChannelShortcut","close","unreadsCategory","renderedCategories","renderCategory","DragDropContext","onBeforeDragStart","onBeforeCapture","above","below","scrollToFirstUnreadChannel","extraClass","scrollToLastUnreadChannel","Scrollbars","_getThreadCountsInCur","getThreadCountsInCurrentTeam","total_unread_threads","getUnreadChannelIds","getCurrentStaticPageId","getVisibleStaticPages","MobileSidebarHeader","MoreDirectChannels","CreateUserGroupsModal","KeyboardShortcutsModal","UserSettingsModal","Sidebar","FORWARD_SLASH","isKeyBoardShortcutModalOpen","KEYBOARD_SHORTCUTS_MODAL","A","USER_SETTINGS","isContentProductSettings","showDirectChannelsModal","USER_GROUPS_CREATE","hideMoreDirectChannelsModal","showMoreDirectChannelsModal","moreDirectChannelsModal","onModalDismissed","isExistingChannel","fetchMyCategories","handleClickClearChannelSelection","handleKeyDownEvent","canCreatePrivateChannel","renderModals","CREATE_CUSTOM_GROUP","PostsChannelResetWatcher","isCRTEnabled","loaded","resetReloadPostsInChannel","BadgeStatus","UnreadsStatusHandlerClass","unreadStatus","unreadMentionCount","basicUnreadMeta","DesktopApp","updateUnreadsAndMentions","siteName","currentTeammate","inGlobalThreads","inDrafts","inScheduledPosts","currentSiteName","mentionTitle","unreadTitle","isDynamicFaviconSupported","currentChannelName","prefix","badgeStatus","link16x16","link24x24","link32x32","link64x64","link96x96","getFavicon","ensureString","Mention","faviconMention16x16","faviconMention24x24","faviconMention32x32","faviconMention64x64","faviconMention96x96","Unread","faviconUnread16x16","faviconUnread24x24","faviconUnread32x32","faviconUnread64x64","faviconUnread96x96","faviconDefault16x16","faviconDefault24x24","faviconDefault32x32","faviconDefault64x64","faviconDefault96x96","updateTitle","oldBadgeStatus","getBadgeStatus","newBadgeStatus","updateFavicon","updateDesktopApp","None","SiteName","getUnreadStatus","matchPath","UnreadsStatusHandler","ProductNoticesModal","ResetStatusModal","MobileSidebarRight","BODY_CLASS_FOR_CHANNEL","ChannelController","enabledUserStatuses","_navigator$userAgentD","isMsBrowser","isInternetExplorer","isEdge","navigator","platform","userAgentData","bodyClass","getClassnamesForBody","cleanUpStatusAndProfileFetchingPoll","loadStatusesIntervalId","setInterval","STATUS_INTERVAL","clearInterval","CRTPostsChannelResetWatcher","QueryParamActionController","shouldRenderCenterChannel","BackstageController","makeAsyncPluggableComponent","_StyledPluggable","_styled","withConfig","gridArea","TeamController","_props$plugins","teamNameParam","useParams","initialChannelsLoaded","setInitialChannelsLoaded","setTeam","getTeamFromTeamList","teamsList","contentFlaggingEnabled","contentFlaggingFeatureEnabled","blurTime","lastTime","joinTeamOrRedirect","joinedOnFirstLoad","joinedTeam","joinTeam","_user$id","_user$roles","userRoles","setUserId","setUserRoles","useTelemetryIdentitySync","InitialLoadingScreen","stop","reactAppInitialized","fetchAllMyChannelMembers","fetchAllMyTeamsChannels","fetchAllChannels","disableWakeUpReconnectHandler","wakeUpIntervalId","currentTime","console","log","reconnect","handleFocus","isActive","markAsReadOnFocus","disableRefetchingOnBrowserFocus","handleBlur","unsetActiveChannelOnServer","handleKeydown","replyTextbox","postTextbox","getElementById","getTeamContentFlaggingStatus","browserIsIosSafari","isIosSafari","iNoBounce","setTeamIdJoinedOnLoad","teamsListDependency","RESERVED_TEAM_NAMES","teamFromTeamNameParam","initTeamOrRedirect","mfaRequired","teamLoaded","route","pluggableId","_teamsList$find","teamInList","teamname","teamByNameResult","isSuccess","addUserToTeamResult","addUserToTeam","Error","NeedsTeamComponent","DisableRefetchingOnBrowserFocus","DisableWakeUpReconnectHandler","selectedThreadId","getSelectedThreadIdInCurrentTeam","selectedPostId","getSelectedPostId","checkIfMFARequired","showConfirmModal","member_count","pageNumber","getGroupsAssociatedToTeam","groups","totalGroupCount","listModal","unlinkGroupSyncable","SyncableType","Team","isTeamAdmin","patchGroupSyncable","scheme_admin","getMyTeamMembers","groupsAvatar","alt","Nbsp","num","DropdownIcon","openLeft","setTeamMemberStatus","onClickRemoveGroup","titleButtonOnClick","ConfirmModal","onConfirm","handleDeleteConfirmed","onCancel","handleDeleteCanceled","TeamMembersDropdown","me","handleDemote","updateTeamMemberSchemeRoles","teamMember","getTeamMember","getMyTeamUnreads","removeUserFromTeamAndGetStats","showDemoteModal","currentRoles","isGuest","isSystemAdmin","showMakeMember","showMakeAdmin","canRemoveFromTeam","makeDemoteModal","confirmButton","handleDemoteSubmit","handleDemoteCancel","openUp","menuRemove","handleRemoveFromTeam","menuMakeAdmin","handleMakeAdmin","menuMakeMember","handleMakeMember","anchorOrigin","vertical","horizontal","transformOrigin","getTeamStats","getChannelStats","updateUserActive","MemberListTeam","loadProfilesAndTeamMembers","getTeamMembers","DEFAULT_MAX_USERS_PER_TEAM","Teams","SORT_USERNAME_OPTION","exclude_deleted_users","setModalSearchTerm","PROFILE_CHUNK_SIZE","loadStatusesForProfilesList","loadTeamMembersForProfilesList","searchProfiles","membersLoaded","SEARCH_TIMEOUT_MILLISECONDS","teamMembersDropdown","canManageTeamMembers","teamMembers","users","actionUserProps","usersToDisplay","SearchableUserList","usersPerPage","totalTeamMembers","focusOnMount","haveITeamPermission","modalSearch","searchProfilesInCurrentTeam","getProfilesInCurrentTeam","getCurrentTeamStats","active_member_count","getMembersInCurrentTeam","onLoad","_this$props$currentTe","_this$props$currentTe2","teamDisplayName","modalHeaderTextId","ariaLabelledby","handleInvitePeople","modalLocation","DropdownIndicator","styles","control","baseStyles","background","multiValue","borderRadius","display","alignItems","multiValueLabel","fontFamily","fontSize","fontWeight","lineHeight","letterSpacing","multiValueRemove","marginRight","handleNewSelection","isClearable","inputValue","setInputValue","handleTextEnter","handleKeyDown","selectValues","singleValue","CreatableSelect","isMulti","onInputChange","onBlur","AllowedDomainsSelect","allowedDomains","setAllowedDomains","setHasChanges","setSaveChangesPanelState","showAllowedDomains","setShowAllowedDomains","handleEnableAllowedDomains","updateAllowedDomains","domain","handleOnChangeDomains","allowedDomainsOptions","CheckboxSettingItem","inputFieldTitle","descriptionAboveContent","inputFieldData","inputFieldValue","SelectTextInput","translations","OpenInviteDescriptionError","InviteSectionInput","_team$invite_id","regenerateTeamInviteId","canInviteTeamMembers","inviteId","setInviteId","invite_id","inviteIdError","setInviteIdError","handleRegenerateInviteId","inviteSectionInput","Input","RefreshIcon","BaseSettingItem","OpenInvite","isGroupConstrained","allowOpenInvite","setAllowOpenInvite","groupConstrainedContent","msg","ExternalLink","generateAllowedDomainOptions","patchTeam","_team$allow_open_invi","collapseModal","hasChangeTabError","hasChanges","setHasChangeTabError","allowed_domains","allow_open_invite","saveChangesPanelState","handleAllowedDomainsSubmit","handleOpenInviteSubmit","updateOpenInvite","handleClose","_team$allow_open_invi2","collapseModalHandler","handleSaveChanges","allowedDomainSuccess","openInviteSuccess","ModalSection","SaveChangesPanel","tabChangeError","handleDescriptionChanges","clientError","updateDescription","descriptionSectionInput","containerClassName","MAX_TEAMDESCRIPTION_LENGTH","handleNameChanges","updateName","nameSectionInput","MAX_TEAMNAME_LENGTH","TeamPictureSection","file","onFileChange","onRemove","selectInput","image","setImage","orientationStyles","setOrientationStyles","teamImageSource","imageURLForTeam","handleInputFile","previewBlob","URL","createObjectURL","reader","FileReader","onload","orientation","FileUtils","readAsArrayBuffer","setPicture","teamPictureSection","teamImage","imageStyles","backgroundImage","backgroundSize","backgroundRepeat","charAt","toUpperCase","accept","ACCEPT_STATIC_IMAGE","EditIcon","ACCEPTED_TEAM_IMAGE_TYPES","Required","TeamNameRestrictions","MIN_TEAMNAME_LENGTH","TeamIconInvalidFileType","TeamIconTooLarge","TeamIconError","_config$MaxFileSize","maxFileSize","parseInt","MaxFileSize","getTeam","removeTeamIcon","setTeamIcon","_team$display_name2","setName","setDescription","teamIconFile","setTeamIconFile","setLoading","imageClientError","setImageClientError","nameClientError","setNameClientError","handleNameDescriptionSubmit","handleTeamIconSubmit","nameDescriptionSuccess","_team$display_name","handleTeamIconRemove","updateTeamIcon","files","handleCollapseModal","modalSectionContent","TeamNameSection","TeamDescriptionSection","TeamSettings","activeTab","InfoTab","AccessTab","SettingsSidebar","canInviteUsers","setActiveTab","modalBodyRef","updateTab","tab","el","ReactDOM","closest","tabs","iconTitle","fallback","customErrorMessage","saveButtonText","cancelButtonText","panelClassName","saved","messageClassName","cancelButtonClassName","saveButtonClassName","AlertCircleOutlineIcon","generateControlButtons","saveButtonDisabled","EMPTY_BOOKMARKS","channelBookmarks","byChannelId","bookmarkId","lhs","getDraftsCount","makeGetDraftsCount","collapsedThreadsEnabled","draftsCount"],"sourceRoot":""}