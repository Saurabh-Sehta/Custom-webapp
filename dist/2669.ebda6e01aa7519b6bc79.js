"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[2669],{58628:(e,t,n)=>{n.d(t,{Ht:()=>d,uN:()=>c,Fu:()=>u,ng:()=>h,_M:()=>m}),n(43813);var a=n(23877),s=n(40693),r=n(92159),i=n(1418),o=n(87988),l=n(21413);function c(e,t){return(n,i)=>{const o=i(),c=(0,l.K7)(o);return n(function(e,t,n){return async(i,o)=>{const l=o(),c=(0,r.K)(l,e,t);try{await s.mT.deleteChannelBookmark(e,t,n),i({type:a.Fi.BOOKMARK_DELETED,data:c})}catch(e){return{data:!1,error:e}}return{data:!0}}}(e,t,c))}}function d(e,t){return(n,r)=>{const i=r(),o=(0,l.K7)(i);return n(function(e,t,n){return async r=>{try{const i=await s.mT.createChannelBookmark(e,t,n);r({type:a.Fi.RECEIVED_BOOKMARK,data:i})}catch(e){return{data:!1,error:e}}return{data:!0}}}(e,t,o))}}function u(e,t,n){return async(r,i)=>{const o=i(),c=(0,l.K7)(o);return r(function(e,t,n,r){return async i=>{try{const{updated:o,deleted:l}=await s.mT.updateChannelBookmark(e,t,n,r);o&&i({type:a.Fi.RECEIVED_BOOKMARK,data:o}),l&&i({type:a.Fi.BOOKMARK_DELETED,data:l})}catch(e){return{data:!1,error:e}}return{data:!0}}}(e,t,n,c))}}function m(e,t,n){return(r,i)=>{const o=i(),c=(0,l.K7)(o);return r(function(e,t,n,r){return async i=>{try{const o=await s.mT.updateChannelBookmarkSortOrder(e,t,n,r);i({type:a.Fi.RECEIVED_BOOKMARKS,data:{channelId:e,bookmarks:o}})}catch(e){return{data:!1,error:e}}return{data:!0}}}(e,t,n,c))}}function h(e){return function(e){return async(t,n)=>{let r;try{r=await s.mT.getChannelBookmarks(e),t({type:a.Fi.RECEIVED_BOOKMARKS,data:{channelId:e,bookmarks:r}})}catch(e){return(0,o.UP)(e,t,n),t((0,i.vV)(e)),{error:e}}return{data:r}}}(e)}},52073:(e,t,n)=>{n.d(t,{Go:()=>C,Jb:()=>m,Lt:()=>g,U5:()=>h,lE:()=>b,nh:()=>f,wf:()=>E,zZ:()=>p,zk:()=>u}),n(43813),n(74883);var a=n(4629),s=n(40057),r=n(8907),i=n(57676),o=n(65952),l=n(24380),c=n(9916),d=n(78451);function u(e){return{type:d.Q3.SET_UNREAD_FILTER_ENABLED,enabled:e}}function m(e){return{type:d.Q3.SIDEBAR_DRAGGING_SET_STATE,data:e}}function h(){return{type:d.Q3.SIDEBAR_DRAGGING_STOP}}function p(e,t,n){return async(s,r)=>{if(n){const e=r().views.channelSidebar.multiSelectedChannelIds;n.forEach((t=>{e.indexOf(t)>=0&&s(E(t))}))}const i=await s((0,a.zZ)(e,t,n));return s({type:d.Q3.ADD_NEW_CATEGORY_ID,data:i.data.id})}}function g(e,t){return f(e,0,t,!1)}function f(e,t,n){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(d,u)=>{const m=u(),h=m.views.channelSidebar.multiSelectedChannelIds;let p=[];if(h.length&&-1!==h.indexOf(n)){const t=(0,c.WJ)(m),a=(0,c.sC)(m);let i=[n];const o=t.find((t=>t.id===e));i=h.filter((e=>{const t=a.find((t=>e===t.id)),n=(null==t?void 0:t.type)===s.Bz.DM_CHANNEL||(null==t?void 0:t.type)===s.Bz.GM_CHANNEL;return(null==o?void 0:o.type)===r.e.CUSTOM||(null==o?void 0:o.type)===r.e.FAVORITES||n&&(null==o?void 0:o.type)===r.e.DIRECT_MESSAGES||!n&&(null==o?void 0:o.type)!==r.e.DIRECT_MESSAGES}));const l=a.map((e=>e.id));i.sort(((e,t)=>l.indexOf(e)-l.indexOf(t))),i.forEach((e=>d(E(e)))),p=i}else p=[n];const g=function(e,t,n,a,s){if(0===a)return 0;const r=(0,i.p7)(e,t),o=(0,i.n7)()(e,r),c=o.filter(((e,t)=>e!==s&&-1!==n.indexOf(e)&&t<=a)),d=a-c.length;if(r.channel_ids.length===o.length)return d;const u=(0,l.q3)(o,n,d),m=u[u.indexOf(n[0])-1];let h=r.channel_ids.indexOf(m)+1;const p=r.channel_ids.indexOf(n[0]);return-1!==p&&p<h&&(h-=1),Math.max(h-c.length,0)}(m,e,p,t,n);return d((0,a.jN)(e,p,g,o))}}function b(){return(e,t)=>0===t().views.channelSidebar.multiSelectedChannelIds.length?{data:!1}:(e({type:d.Q3.MULTISELECT_CHANNEL_CLEAR}),{data:!0})}function E(e){return(t,n)=>{const a=n();if(!a.views.channelSidebar.multiSelectedChannelIds.length){const e=(0,o.eH)(a);t({type:d.Q3.MULTISELECT_CHANNEL,data:e})}return t({type:d.Q3.MULTISELECT_CHANNEL_ADD,data:e})}}function C(e){return(t,n)=>{const a=n(),s=a.views.channelSidebar.multiSelectedChannelIds;let r=a.views.channelSidebar.lastSelectedChannel;if(!s.length){const e=(0,o.eH)(a);t({type:d.Q3.MULTISELECT_CHANNEL,data:e}),r=e}const i=(0,c.qY)(a).map((e=>e.id)),l=i.indexOf(e),u=i.indexOf(r);if(l===u)return{data:!1};const m=Math.min(u,l),h=Math.max(u,l),p=i.slice(m,h+1);return t({type:d.Q3.MULTISELECT_CHANNEL_TO,data:p})}}},52052:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var a=n(23453),s=n(5908),r=n(30413),i=n(40057),o=n(8361),l=n(65952),c=n(14776),d=n(7430),u=n(61185),m=n(79751),h=n(2386),p=n(75270),g=n(77212),f=n(78451),b=n(62688),E=n.n(b),C=(n(3188),n(30973),n(43813),n(10844),n(74883),n(17046),n(54823),n(29012),n(4290),n(71633)),v=n.n(C),y=n(97023),M=n.n(y),_=n(14778),T=n(14696),S=n(16983),w=n(1396),I=n(63234),A=n(26808),R=n(85406),N=n(16230),P=n(36057),O=n(70669),L=n(86255),D=n(59050),k=n(90617),F=n(55476),x=n(78064),U=n(19513),B=n(4715);function H(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class q extends M().PureComponent{static getDerivedStateFromProps(e,t){return{isSearch:e.isSearch,page:e.isSearch&&!t.isSearch?0:t.page}}constructor(e){super(e),H(this,"onKeyDown",(e=>{const t=e.target,n=(0,U.e)(e,f.Ay.KeyCodes.ENTER);n&&(e.shiftKey||e.ctrlKey||e.altKey)||n&&null!=t&&t.classList.contains("more-modal__row")&&t.click()})),H(this,"handleJoin",((e,t)=>{t.stopPropagation(),this.setState({joiningChannel:e.id}),this.props.handleJoin(e,(()=>{this.setState({joiningChannel:""})})),this.isMemberOfChannel(e.id)&&this.props.closeModal(f.IQ.MORE_CHANNELS)})),H(this,"createChannelRow",(e=>{var t;const n="".concat(e.display_name,", ").concat(e.purpose).toLowerCase();let a;a=(0,x.Oj)(e)?M().createElement(R.ArchiveOutlineIcon,{size:18}):(0,N.Zp)(e)?M().createElement(R.LockOutlineIcon,{size:18}):M().createElement(R.GlobeIcon,{size:18});let s=0;null!==(t=this.props.channelsMemberCount)&&void 0!==t&&t[e.id]&&(s=this.props.channelsMemberCount[e.id]);const r=this.isMemberOfChannel(e.id)?M().createElement("div",{id:"membershipIndicatorContainer","aria-label":this.props.intl.formatMessage({id:"more_channels.membership_indicator",defaultMessage:"Membership Indicator: Joined"})},M().createElement(R.CheckIcon,{size:14}),M().createElement(_.FormattedMessage,{id:"more_channels.joined",defaultMessage:"Joined"})):null,i=this.props.intl.formatMessage(j.channelPurpose,{memberCount:s,channelPurpose:e.purpose||""}),o=M().createElement("div",{id:"channelPurposeContainer","aria-label":i},r,r?M().createElement("span",{className:"dot"}):null,M().createElement(R.AccountOutlineIcon,{size:14}),M().createElement("span",{"data-testid":"channelMemberCount-".concat(e.name)},s),e.purpose.length>0?M().createElement("span",{className:"dot"}):null,M().createElement("span",{className:"more-modal__description"},e.purpose)),l=v()("btn btn-sm",{"btn-secondary outlineButton":this.isMemberOfChannel(e.id),"btn-primary primaryButton":!this.isMemberOfChannel(e.id)}),c=M().createElement("button",{id:"joinViewChannelButton",onClick:t=>this.handleJoin(e,t),className:l,disabled:Boolean(this.state.joiningChannel),tabIndex:-1,"aria-label":this.isMemberOfChannel(e.id)?this.props.intl.formatMessage({id:"more_channels.view",defaultMessage:"View"}):this.props.intl.formatMessage({id:"joinChannel.JoinButton",defaultMessage:"Join"})},M().createElement(F.A,{loading:this.state.joiningChannel===e.id,text:j.joiningButton},M().createElement(_.FormattedMessage,{id:this.isMemberOfChannel(e.id)?"more_channels.view":"joinChannel.JoinButton",defaultMessage:this.isMemberOfChannel(e.id)?"View":"Join"}))),d=e.shared?M().createElement(D.A,{className:"shared-channel-icon",withTooltip:!0}):null;return M().createElement("div",{className:"more-modal__row",key:e.id,id:"ChannelRow-".concat(e.name),"data-testid":"ChannelRow-".concat(e.name),"aria-label":n,onClick:t=>this.handleJoin(e,t),tabIndex:0},M().createElement("div",{className:"more-modal__details"},M().createElement("div",{className:"style--none more-modal__name"},a,M().createElement("span",{id:"channelName"},e.display_name),d),o),M().createElement("div",{className:"more-modal__actions"},c,this.state.joiningChannel===e.id&&!this.isMemberOfChannel(e.id)&&M().createElement("span",{className:"sr-only",role:"alert"},M().createElement(_.FormattedMessage,{id:"more_channels.joinedChannel",defaultMessage:"Joined channel {channelName}",values:{channelName:e.display_name}}))))})),H(this,"nextPage",(e=>{var t;e.preventDefault(),this.setState({page:this.state.page+1,nextDisabled:!0}),this.nextTimeoutId=setTimeout((()=>this.setState({nextDisabled:!1})),500),this.props.nextPage(this.state.page+1),null===(t=this.channelListScroll.current)||void 0===t||t.scrollTo({top:0})})),H(this,"previousPage",(e=>{var t;e.preventDefault(),this.setState({page:this.state.page-1}),null===(t=this.channelListScroll.current)||void 0===t||t.scrollTo({top:0})})),H(this,"doSearch",(()=>{this.props.search(this.state.channelSearchValue),""===this.state.channelSearchValue&&this.setState({page:0})})),H(this,"filterChange",(e=>{this.props.changeFilter(e),this.props.filter!==e&&this.setState({page:0})})),H(this,"handleChange",(e=>{null!=e&&e.currentTarget&&this.setState({channelSearchValue:null==e?void 0:e.currentTarget.value},(()=>this.doSearch()))})),H(this,"handleClear",(()=>{this.setState({channelSearchValue:""},(()=>this.doSearch()))})),H(this,"handleChecked",(()=>{this.props.rememberHideJoinedChannelsChecked?this.props.hideJoinedChannelsPreference(!1):this.props.hideJoinedChannelsPreference(!0)})),H(this,"getEmptyStateMessage",(()=>{if(this.state.channelSearchValue.length>0)return M().createElement(_.FormattedMessage,{id:"more_channels.noMore",tagName:"strong",defaultMessage:"No results for {text}",values:{text:this.state.channelSearchValue}});switch(this.props.filter){case Y.Archived:return M().createElement(_.FormattedMessage,{id:"more_channels.noArchived",tagName:"strong",defaultMessage:"No archived channels"});case Y.Private:return M().createElement(_.FormattedMessage,{id:"more_channels.noPrivate",tagName:"strong",defaultMessage:"No private channels"});case Y.Public:return M().createElement(_.FormattedMessage,{id:"more_channels.noPublic",tagName:"strong",defaultMessage:"No public channels"});default:return M().createElement(_.FormattedMessage,{id:"more_channels.noChannels",tagName:"strong",defaultMessage:"No channels"})}})),H(this,"getFilterLabel",(()=>{switch(this.props.filter){case Y.Archived:return M().createElement(_.FormattedMessage,{id:"more_channels.show_archived_channels",defaultMessage:"Channel Type: Archived"});case Y.Public:return M().createElement(_.FormattedMessage,{id:"more_channels.show_public_channels",defaultMessage:"Channel Type: Public"});case Y.Private:return M().createElement(_.FormattedMessage,{id:"more_channels.show_private_channels",defaultMessage:"Channel Type: Private"});default:return M().createElement(_.FormattedMessage,{id:"more_channels.show_all_channels",defaultMessage:"Channel Type: All"})}})),this.nextTimeoutId=0,this.state={joiningChannel:"",page:0,nextDisabled:!1,channelSearchValue:""},this.filter=M().createRef(),this.channelListScroll=M().createRef()}componentDidMount(){!B.Fr()&&this.filter.current&&this.filter.current.focus(),document.addEventListener("keydown",this.onKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.onKeyDown)}isMemberOfChannel(e){return this.props.myChannelMemberships[e]}render(){const e=this.props.channels;let t,n,a;if(this.props.loading&&0===e.length)t=M().createElement(w.A,null);else if(0===e.length)t=M().createElement("div",{className:"no-channel-message","aria-label":this.state.channelSearchValue.length>0?this.props.intl.formatMessage(j.noMore,{text:this.state.channelSearchValue}):this.props.intl.formatMessage({id:"widgets.channels_input.empty",defaultMessage:"No channels found"})},M().createElement(P.A,null),M().createElement("h3",{className:"primary-message"},this.getEmptyStateMessage()),this.props.noResultsText);else{const e=this.state.page*this.props.channelsPerPage,s=e+this.props.channelsPerPage,r=this.props.channels.slice(e,s);t=r.map(this.createChannelRow),r.length>=this.props.channelsPerPage&&s<this.props.channels.length&&(n=M().createElement("button",{className:"btn btn-sm btn-tertiary filter-control filter-control__next",onClick:this.nextPage,disabled:this.state.nextDisabled,"aria-label":this.props.intl.formatMessage({id:"more_channels.next",defaultMessage:"Next"})},M().createElement(_.FormattedMessage,{id:"more_channels.next",defaultMessage:"Next"}))),this.state.page>0&&(a=M().createElement("button",{className:"btn btn-sm btn-tertiary filter-control filter-control__prev",onClick:this.previousPage,"aria-label":this.props.intl.formatMessage({id:"more_channels.prev",defaultMessage:"Previous"})},M().createElement(_.FormattedMessage,{id:"more_channels.prev",defaultMessage:"Previous"})))}const s=M().createElement("div",{className:"filter-row"},M().createElement("span",{id:"searchIcon","aria-hidden":"true"},M().createElement("i",{className:"icon icon-magnify"})),M().createElement(L.A,{id:"searchChannelsTextbox",ref:this.filter,className:"form-control filter-textbox",placeholder:this.props.intl.formatMessage({id:"filtered_channels_list.search",defaultMessage:"Search channels"}),onInput:this.handleChange,clearable:!0,onClear:this.handleClear,value:this.state.channelSearchValue,"aria-label":this.props.intl.formatMessage({id:"filtered_channels_list.search",defaultMessage:"Search Channels"})})),r=M().createElement(R.CheckIcon,{size:18,color:"var(--button-bg)"}),i=[M().createElement(O.q7,{key:"channelsMoreDropdownAll",id:"channelsMoreDropdownAll",onClick:()=>this.filterChange(Y.All),leadingElement:M().createElement(R.GlobeCheckedIcon,{size:16}),labels:M().createElement(_.FormattedMessage,{id:"suggestion.all",defaultMessage:"All channel types"}),trailingElements:this.props.filter===Y.All?r:null,"aria-label":this.props.intl.formatMessage({id:"suggestion.all",defaultMessage:"All channel types"})}),M().createElement(O.q7,{key:"channelsMoreDropdownPublic",id:"channelsMoreDropdownPublic",onClick:()=>this.filterChange(Y.Public),leadingElement:M().createElement(R.GlobeIcon,{size:16}),labels:M().createElement(_.FormattedMessage,{id:"suggestion.public",defaultMessage:"Public channels"}),trailingElements:this.props.filter===Y.Public?r:null,"aria-label":this.props.intl.formatMessage({id:"suggestion.public",defaultMessage:"Public channels"})}),M().createElement(O.q7,{key:"channelsMoreDropdownPrivate",id:"channelsMoreDropdownPrivate",onClick:()=>this.filterChange(Y.Private),leadingElement:M().createElement(R.LockOutlineIcon,{size:16}),labels:M().createElement(_.FormattedMessage,{id:"suggestion.private",defaultMessage:"Private channels"}),trailingElements:this.props.filter===Y.Private?r:null,"aria-label":this.props.intl.formatMessage({id:"suggestion.private",defaultMessage:"Private channels"})})];i.push(M().createElement(O.wv,{key:"channelsMoreDropdownSeparator"}),M().createElement(O.q7,{key:"channelsMoreDropdownArchived",id:"channelsMoreDropdownArchived",onClick:()=>this.filterChange(Y.Archived),leadingElement:M().createElement(R.ArchiveOutlineIcon,{size:16}),labels:M().createElement(_.FormattedMessage,{id:"suggestion.archive",defaultMessage:"Archived channels"}),trailingElements:this.props.filter===Y.Archived?r:null,"aria-label":this.props.intl.formatMessage({id:"suggestion.archive",defaultMessage:"Archived channels"})}));const o=M().createElement(M().Fragment,null,this.getFilterLabel(),M().createElement(R.ChevronDownIcon,{color:"rgba(var(--center-channel-color-rgb), 0.64)",size:16})),l=M().createElement(M().Fragment,null,M().createElement("div",{role:"status","aria-atomic":"true",className:"sr-only"},this.props.intl.formatMessage({id:"more_channels.channel_type_filter.filter_type_set",defaultMessage:"Channel type filter set to {filterType}"},{filterType:this.props.filter})),M().createElement(O.mc,{menuButton:{id:"menuWrapper",children:o,"aria-label":this.props.intl.formatMessage({id:"more_channels.channel_type_filter",defaultMessage:"Channel type filter"})},menu:{id:"browseChannelsDropdown","aria-label":this.props.intl.formatMessage({id:"more_channels.channel_type_filter",defaultMessage:"Channel type filter"})}},i.map((e=>e)))),c=v()("get-app__checkbox",{checked:this.props.rememberHideJoinedChannelsChecked}),d=M().createElement("div",{id:"hideJoinedPreferenceCheckbox",onClick:this.handleChecked,onKeyDown:e=>{e.stopPropagation(),"Enter"!==e.key&&" "!==e.key||this.handleChecked()},role:"checkbox","aria-checked":this.props.rememberHideJoinedChannelsChecked,"aria-label":this.props.intl.formatMessage({id:"more_channels.hide_joined_channels",defaultMessage:"Hide joined channels"}),tabIndex:0},M().createElement("div",{className:c},this.props.rememberHideJoinedChannelsChecked?M().createElement(k.A,null):null),M().createElement(_.FormattedMessage,{id:"more_channels.hide_joined",defaultMessage:"Hide Joined"}));let u;u=0===e.length?this.props.intl.formatMessage({id:"more_channels.count_zero",defaultMessage:"0 Results"}):1===e.length?this.props.intl.formatMessage({id:"more_channels.count_one",defaultMessage:"1 Result"}):e.length>1?this.props.intl.formatMessage(j.channelCount,{count:e.length}):this.props.intl.formatMessage({id:"more_channels.count_zero",defaultMessage:"0 Results"});const m=M().createElement("div",{className:"more-modal__dropdown"},M().createElement("span",{id:"channelCountLabel"},u),M().createElement("span",{className:"sr-only",role:"status","aria-live":"polite"},u),M().createElement("div",{id:"modalPreferenceContainer"},l,d));return M().createElement("div",{className:"filtered-user-list"},s,m,M().createElement("div",{role:"search",className:"more-modal__list",tabIndex:-1},M().createElement("div",{id:"moreChannelsList",tabIndex:-1,ref:this.channelListScroll},t)),M().createElement("div",{className:"filter-controls"},a,n))}}H(q,"propTypes",{channels:E().array.isRequired,channelsPerPage:E().number.isRequired,nextPage:E().func.isRequired,isSearch:E().bool.isRequired,search:E().func.isRequired,handleJoin:E().func.isRequired,noResultsText:E().element.isRequired,changeFilter:E().func.isRequired,closeModal:E().func.isRequired,hideJoinedChannelsPreference:E().func.isRequired,rememberHideJoinedChannelsChecked:E().bool.isRequired,loading:E().bool,channelsMemberCount:E().objectOf(E().number)});const j=(0,_.defineMessages)({channelCount:{id:"more_channels.count",defaultMessage:"{count} Results"},channelPurpose:{id:"more_channels.channel_purpose",defaultMessage:"Channel Information: Membership Indicator: Joined, Member count {memberCount} , Purpose: {channelPurpose}"},joiningButton:{id:"joinChannel.joiningButton",defaultMessage:"Joining..."},noMore:{id:"more_channels.noMore",defaultMessage:"No results for {text}"}}),V=(0,_.injectIntl)(q);var G=n(83007),z=n(63155),W=n(85873);function K(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let Y=function(e){return e.All="All",e.Public="Public",e.Private="Private",e.Archived="Archived",e}({});class J extends M().PureComponent{constructor(e){super(e),K(this,"activeChannels",[]),K(this,"loadComplete",(()=>{this.setState({loading:!1})})),K(this,"handleNewChannel",(()=>{this.handleExit(),this.closeEditRHS(),this.props.actions.openModal({modalId:f.IQ.NEW_CHANNEL_MODAL,dialogType:I.default})})),K(this,"handleExit",(()=>{this.props.actions.closeModal(f.IQ.MORE_CHANNELS)})),K(this,"closeEditRHS",(()=>{this.props.rhsOpen&&this.props.rhsState===f._n.EDIT_HISTORY&&this.props.actions.closeRightHandSide()})),K(this,"onChange",(e=>{this.state.search&&!e||this.setState({searchedChannels:[],serverError:null})})),K(this,"nextPage",(e=>{this.props.actions.getChannels(this.props.teamId,e+1,50).then((e=>{e.data&&e.data.length>0&&this.props.actions.getChannelsMemberCount(e.data.map((e=>e.id)))}))})),K(this,"handleJoin",(async(e,t)=>{var n;const{actions:a,currentUserId:s,teamId:r,teamName:i}=this.props;let o;this.isMemberOfChannel(e.id)||(o=await a.joinChannel(s,r,e.id)),null!==(n=o)&&void 0!==n&&n.error?this.setState({serverError:o.error.message}):(this.props.actions.getChannelsMemberCount([e.id]),(0,G.J)().push((0,z.d7)(i,e.name)),this.closeEditRHS()),t&&t()})),K(this,"search",(e=>{if(clearTimeout(this.searchTimeoutId),""===e)return this.onChange(!0),this.setState({search:!1,searchedChannels:[],searching:!1,searchTerm:e}),void(this.searchTimeoutId=0);this.setState({search:!0,searching:!0,searchTerm:e});const t=window.setTimeout((async()=>{try{const{data:n}=await this.props.actions.searchAllChannels(e,{team_ids:[this.props.teamId],nonAdminSearch:!0,include_deleted:!0});if(t!==this.searchTimeoutId)return;if(n){const e=n.map((e=>e.id));e.length>0&&this.props.actions.getChannelsMemberCount(e),this.setSearchResults(n.filter((e=>e.team_id===this.props.teamId)))}else this.setState({searchedChannels:[],searching:!1})}catch(e){this.setState({searchedChannels:[],searching:!1})}}),100);this.searchTimeoutId=t})),K(this,"setSearchResults",(e=>{let t=e.filter((e=>e.type!==f.Ay.PRIVATE_CHANNEL||this.isMemberOfChannel(e.id)));this.state.filter===Y.Private&&(t=e.filter((e=>e.type===f.Ay.PRIVATE_CHANNEL&&this.isMemberOfChannel(e.id)))),this.state.filter===Y.Public&&(t=e.filter((e=>e.type===f.Ay.OPEN_CHANNEL&&0===e.delete_at))),this.state.filter===Y.Archived&&(t=e.filter((e=>0!==e.delete_at))),this.props.shouldHideJoinedChannels&&(t=this.getChannelsWithoutJoined(t)),this.setState({searchedChannels:t,searching:!1})})),K(this,"changeFilter",(e=>{this.search(this.state.searchTerm),this.setState({filter:e})})),K(this,"handleShowJoinedChannelsPreference",(e=>{this.search(this.state.searchTerm),this.props.actions.setGlobalItem(f.eN.HIDE_JOINED_CHANNELS,e.toString())})),K(this,"getChannelsWithoutJoined",(e=>e.filter((e=>!this.isMemberOfChannel(e.id))))),K(this,"getActiveChannels",(()=>{const{channels:e,archivedChannels:t,shouldHideJoinedChannels:n,privateChannels:a}=this.props,{search:s,searchedChannels:r,filter:i}=this.state,o=e.concat(a).sort(((e,t)=>e.display_name.localeCompare(t.display_name))),l=this.getChannelsWithoutJoined(o),c=this.getChannelsWithoutJoined(e),d=this.getChannelsWithoutJoined(t),u=this.getChannelsWithoutJoined(a),m={[Y.All]:n?l:o,[Y.Archived]:n?d:t,[Y.Private]:n?u:a,[Y.Public]:n?c:e};return s?r:m[i]||m[Y.All]})),this.searchTimeoutId=0,this.state={loading:!0,filter:Y.All,search:!1,searchedChannels:[],serverError:null,searching:!1,searchTerm:""}}componentDidMount(){if(!this.props.teamId)return void this.loadComplete();const e=[this.props.actions.getChannels(this.props.teamId,0,100),this.props.actions.getArchivedChannels(this.props.teamId,0,100)];Promise.all(e).then((e=>{const t=e.flatMap((e=>e.data?e.data.map((e=>e.id)):[]));this.props.privateChannels.forEach((e=>t.push(e.id))),t.length>0&&this.props.actions.getChannelsMemberCount(t)})),this.loadComplete()}isMemberOfChannel(e){return this.props.myChannelMemberships[e]}render(){const{teamId:e,channelsRequestStarted:t,shouldHideJoinedChannels:n}=this.props,{search:a,serverError:s,searching:r}=this.state;let i;this.activeChannels=this.getActiveChannels(),s&&(i=M().createElement("div",{className:"form-group has-error"},M().createElement("label",{className:"control-label"},s)));const o=(t,n)=>{const a=v()("btn",t);return M().createElement(A.A,{teamId:e,permissions:[S.A.CREATE_PUBLIC_CHANNEL]},M().createElement("button",{type:"button",id:"createNewChannelButton",className:a,onClick:this.handleNewChannel,"aria-label":(0,W.Vw)({id:"more_channels.create",defaultMessage:"Create New Channel"})},n,M().createElement(_.FormattedMessage,{id:"more_channels.create",defaultMessage:"Create New Channel"})))},l=M().createElement(M().Fragment,null,M().createElement("p",{className:"secondary-message"},M().createElement(_.FormattedMessage,{id:"more_channels.searchError",defaultMessage:"Try searching different keywords, checking for typos or adjusting the filters."})),o("btn-primary",M().createElement("i",{className:"icon-plus"}))),c=this.state.loading?M().createElement(w.A,null):M().createElement(M().Fragment,null,M().createElement(V,{channels:this.activeChannels,channelsPerPage:50,nextPage:this.nextPage,isSearch:a,search:this.search,handleJoin:this.handleJoin,noResultsText:l,loading:a?r:t,changeFilter:this.changeFilter,filter:this.state.filter,myChannelMemberships:this.props.myChannelMemberships,closeModal:this.props.actions.closeModal,hideJoinedChannelsPreference:this.handleShowJoinedChannelsPreference,rememberHideJoinedChannelsChecked:n,channelsMemberCount:this.props.channelsMemberCount}),i),d=M().createElement(_.FormattedMessage,{id:"more_channels.title",defaultMessage:"Browse Channels"});return M().createElement(T.zW,{id:"browseChannelsModal",onExited:this.handleExit,compassDesign:!0,modalHeaderText:d,headerButton:o("btn-secondary btn-sm"),autoCloseOnConfirmButton:!1,"aria-modal":!0,enforceFocus:!1,bodyPadding:!1},c)}}K(J,"propTypes",{channels:E().array.isRequired,archivedChannels:E().array.isRequired,privateChannels:E().array.isRequired,currentUserId:E().string.isRequired,teamId:E().string.isRequired,teamName:E().string,channelsRequestStarted:E().bool,shouldHideJoinedChannels:E().bool.isRequired,rhsOpen:E().bool,channelsMemberCount:E().objectOf(E().number),actions:E().shape({getChannels:E().func.isRequired,getArchivedChannels:E().func.isRequired,joinChannel:E().func.isRequired,searchAllChannels:E().func.isRequired,openModal:E().func.isRequired,closeModal:E().func.isRequired,setGlobalItem:E().func.isRequired,closeRightHandSide:E().func.isRequired,getChannelsMemberCount:E().func.isRequired}).isRequired});const Q=(0,o.Mz)("getChannelsWithoutArchived",l.aW,(e=>e&&e.filter((e=>0===e.delete_at&&e.type!==f.Ay.PRIVATE_CHANNEL)))),Z=(0,o.Mz)("getArchivedOtherChannels",l.aW,(e=>e&&e.filter((e=>0!==e.delete_at)))),X=(0,o.Mz)("getPrivateChannelsSelector",l.aW,(e=>e&&e.filter((e=>e.type===f.Ay.PRIVATE_CHANNEL)))),$=(0,a.connect)((function(e){const t=(0,c.H7)(e),n=(0,g.zR)(f.eN.HIDE_JOINED_CHANNELS,"false");return{channels:Q(e)||[],archivedChannels:Z(e)||[],privateChannels:X(e)||[],currentUserId:(0,d.WR)(e),teamId:(0,c.Sy)(e),teamName:null==t?void 0:t.name,channelsRequestStarted:e.requests.channels.getChannels.status===i.IZ.STARTED,myChannelMemberships:(0,l.vd)(e)||{},shouldHideJoinedChannels:"true"===n(e),rhsState:(0,p.bM)(e),rhsOpen:(0,p.A)(e),channelsMemberCount:(0,l.kV)(e)}}),(function(e){return{actions:(0,s.bindActionCreators)({getChannels:r.Jp,getArchivedChannels:r.xM,joinChannel:r.Cg,searchAllChannels:r.Q1,openModal:m.q,closeModal:m.O,setGlobalItem:u.X2,closeRightHandSide:h.bP,getChannelsMemberCount:r.kV},e)}}))(J)},97026:(e,t,n)=>{n.d(t,{GX:()=>S,PM:()=>f,_4:()=>_,_E:()=>A,bY:()=>w,wR:()=>I}),n(74883),n(17046),n(76409),n(43813);var a=n(97023),s=n(23453),r=n(40057),i=n(92159),o=n(65952),l=n(26614),c=n(80635),d=n(24380),u=n(58628),m=n(33172),h=n(78451),p=n(78138),g=n(68124);const f=50,{OPEN_CHANNEL:b,PRIVATE_CHANNEL:E,GM_CHANNEL:C,DM_CHANNEL:v}=h.Ay,y=(e,t)=>"".concat(e).concat(t),M={[y("add",b)]:r.xB.ADD_BOOKMARK_PUBLIC_CHANNEL,[y("edit",b)]:r.xB.EDIT_BOOKMARK_PUBLIC_CHANNEL,[y("delete",b)]:r.xB.DELETE_BOOKMARK_PUBLIC_CHANNEL,[y("order",b)]:r.xB.ORDER_BOOKMARK_PUBLIC_CHANNEL,[y("add",E)]:r.xB.ADD_BOOKMARK_PRIVATE_CHANNEL,[y("edit",E)]:r.xB.EDIT_BOOKMARK_PRIVATE_CHANNEL,[y("delete",E)]:r.xB.DELETE_BOOKMARK_PRIVATE_CHANNEL,[y("order",E)]:r.xB.ORDER_BOOKMARK_PRIVATE_CHANNEL},_=(e,t)=>(0,s.useSelector)((n=>T(n,e,t))),T=(e,t,n)=>{const a=(0,o.c)(e,t);if(!a)return!1;if(0!==a.delete_at)return!1;const{type:s}=a;if("threads"===s)return!1;if(s===C||s===v){const n=(0,o.MQ)(e,t);return(null==n?void 0:n.channel_id)===t}const r=M[y(n,s)];return a&&r&&(0,c.Ec)(e,a.team_id,t,r)},S=()=>(0,s.useSelector)((e=>(0,g.DE)((0,l.zj)(e)))),w=()=>(0,s.useSelector)((e=>(0,g.kc)((0,l.zj)(e)))),I=e=>{if("true"!==(0,l.Y6)(e,"ChannelBookmarks"))return!1;const t=(0,l.Ay)(e);return"true"===(null==t?void 0:t.IsLicensed)},A=e=>{const t=(0,s.useDispatch)(),n=(0,s.useSelector)((t=>(0,i.H)(t,e))),r=(0,a.useMemo)((()=>Object.keys(n).sort(((e,t)=>n[e].sort_order-n[t].sort_order))),[n]),[o,l]=(0,a.useState)();return(0,a.useEffect)((()=>{o&&l(void 0)}),[r]),(0,a.useEffect)((()=>{e&&t((0,u.ng)(e))}),[e]),(0,a.useEffect)((()=>{const e=Object.values(n).reduce(((e,t)=>{let{emoji:n}=t;return n&&e.push((0,p.at)(n)),e}),[]);e.length&&t((0,m.fS)(e))}),[n]),{bookmarks:n,order:null!=o?o:r,reorder:async(n,a,s)=>{l((0,d.wq)(r,n,s));const{error:i}=await t((0,u._M)(e,n,s));i&&l(void 0)}}}},34086:(e,t,n)=>{n.d(t,{A:()=>C}),n(17046),n(57406),n(55448);var a=n(97023),s=n.n(a),r=n(14778),i=n(23453),o=n(85406),l=n(8907),c=n(57676),d=n(65952),u=n(14776),m=n(52073),h=n(79751),p=n(9916),g=n(12555),f=n(70669),b=n(78451);const E=e=>{const{formatMessage:t}=(0,r.useIntl)(),n=(0,i.useDispatch)(),a=(0,i.useSelector)(d.ou),E=(0,i.useSelector)((e=>e.views.channelSidebar.multiSelectedChannelIds)),C=(0,i.useSelector)(u.H7),v=(0,i.useSelector)((e=>C?(0,p.WJ)(e):void 0)),y=(0,i.useSelector)((t=>C?(0,c.oT)(t,(null==C?void 0:C.id)||"",e.channel.id):void 0));function M(t,a){t.preventDefault(),(null==y?void 0:y.id)!==a&&n((0,m.Lt)(a,e.channel.id))}function _(){n((0,h.q)({modalId:b.IQ.EDIT_CATEGORY,dialogType:g.default,dialogProps:{channelIdsToAdd:-1===E.indexOf(e.channel.id)?[e.channel.id]:E}}))}function T(t,n){return[...t.map((t=>{let a=s().createElement("span",null,t.display_name);t.type===l.e.FAVORITES&&(a=s().createElement(r.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.favorites",defaultMessage:"Favorites"})),t.type===l.e.CHANNELS&&(a=s().createElement(r.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.channels",defaultMessage:"Channels"}));let i=null;return n&&n.display_name===t.display_name&&(i=s().createElement(o.CheckIcon,{color:"var(--button-bg)",size:18})),s().createElement(f.q7,{id:"moveToCategory-".concat(e.channel.id,"-").concat(t.id),key:"moveToCategory-".concat(e.channel.id,"-").concat(t.id),leadingElement:t.type===l.e.FAVORITES?s().createElement(o.StarOutlineIcon,{size:18}):s().createElement(o.FolderOutlineIcon,{size:18}),labels:a,trailingElements:i,onClick:e=>M(e,t.id)})})),s().createElement(f.wv,{key:"ChannelMenu-moveToDivider"}),s().createElement(f.q7,{id:"moveToNewCategory-".concat(e.channel.id),key:"moveToNewCategory-".concat(e.channel.id),"aria-haspopup":!0,leadingElement:s().createElement(o.FolderMoveOutlineIcon,{size:18}),labels:s().createElement(r.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.moveToNewCategory",defaultMessage:"New Category"}),onClick:_})]}function S(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.filter((e=>e.type!==l.e.CHANNELS)):e.filter((e=>e.type!==l.e.DIRECT_MESSAGES))}return v?s().createElement(f.g8,{id:"moveTo-".concat(e.channel.id),labels:s().createElement(r.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.moveTo",defaultMessage:"Move to..."}),leadingElement:e.inHeaderDropdown?null:s().createElement(o.FolderMoveOutlineIcon,{size:18}),trailingElements:s().createElement(o.ChevronRightIcon,{size:16}),menuId:"moveTo-".concat(e.channel.id,"-menu"),menuAriaLabel:t({id:"sidebar_left.sidebar_channel_menu.moveTo.dropdownAriaLabel",defaultMessage:"Move to submenu"})},function(t,n){const s=E.includes(e.channel.id);return e.inHeaderDropdown||!s?T(S(t,e.channel.type===b.Ay.DM_CHANNEL||e.channel.type===b.Ay.GM_CHANNEL),n):E.every((e=>a[e].type===b.Ay.DM_CHANNEL||a[e].type===b.Ay.GM_CHANNEL))?T(S(t,!0),n):E.every((e=>a[e].type!==b.Ay.DM_CHANNEL&&a[e].type!==b.Ay.GM_CHANNEL))?T(S(t,!1),n):T(t.filter((e=>e.type!==l.e.CHANNELS&&e.type!==l.e.DIRECT_MESSAGES)),n)}(v,y)):null},C=(0,a.memo)(E)},12555:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var a=n(23453),s=n(5908),r=n(4629),i=n(14776),o=n(52073),l=n(62688),c=n.n(l),d=(n(4290),n(97023)),u=n.n(d),m=n(14778),h=n(14696),p=n(86255),g=n(85873);function f(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class b extends u().PureComponent{constructor(e){super(e),f(this,"timeoutId",null),f(this,"isProcessing",!1),f(this,"handleClear",(()=>{this.setState({categoryName:""})})),f(this,"handleChange",(e=>{this.setState({categoryName:e.target.value})})),f(this,"handleCancel",(()=>{this.handleClear()})),f(this,"handleConfirm",(()=>{this.isProcessing||(this.isProcessing=!0,this.timeoutId=setTimeout((()=>{this.isProcessing=!1}),1e3),this.props.categoryId?this.props.actions.renameCategory(this.props.categoryId,this.state.categoryName):this.props.actions.createCategory(this.props.currentTeamId,this.state.categoryName,this.props.channelIdsToAdd))})),f(this,"isConfirmDisabled",(()=>!this.state.categoryName||Boolean(this.props.initialCategoryName)&&this.props.initialCategoryName===this.state.categoryName||this.state.categoryName.length>22)),f(this,"getText",(()=>{let e,t,n;return this.props.categoryId?(e=u().createElement(m.FormattedMessage,{id:"rename_category_modal.renameCategory",defaultMessage:"Rename Category"}),t=u().createElement(m.FormattedMessage,{id:"rename_category_modal.rename",defaultMessage:"Rename"})):(e=u().createElement(m.FormattedMessage,{id:"create_category_modal.createCategory",defaultMessage:"Create New Category"}),t=u().createElement(m.FormattedMessage,{id:"create_category_modal.create",defaultMessage:"Create"}),n=u().createElement(m.FormattedMessage,{id:"edit_category_modal.helpText",defaultMessage:"Drag channels into this category to organize your sidebar."})),{modalHeaderText:e,editButtonText:t,helpText:n}})),this.state={categoryName:e.initialCategoryName||""}}componentWillUnmount(){this.timeoutId&&clearTimeout(this.timeoutId)}render(){const{modalHeaderText:e,editButtonText:t,helpText:n}=this.getText();return u().createElement(h.zW,{id:"editCategoryModal",modalHeaderText:e,confirmButtonText:t,compassDesign:!0,onExited:this.props.onExited,handleEnterKeyPress:this.handleConfirm,handleConfirm:this.handleConfirm,handleCancel:this.handleCancel,isConfirmDisabled:this.isConfirmDisabled()},u().createElement(p.A,{inputComponent:p.P,autoFocus:!0,className:"form-control filter-textbox",type:"text",value:this.state.categoryName,placeholder:(0,g.Vw)({id:"edit_category_modal.placeholder",defaultMessage:"Name your category"}),clearable:!0,onClear:this.handleClear,onChange:this.handleChange,maxLength:22}),Boolean(n)&&u().createElement("span",{className:"edit-category__helpText"},n))}}f(b,"propTypes",{onExited:c().func.isRequired,currentTeamId:c().string.isRequired,categoryId:c().string,initialCategoryName:c().string,channelIdsToAdd:c().arrayOf(c().string),actions:c().shape({createCategory:c().func.isRequired,renameCategory:c().func.isRequired}).isRequired});const E=(0,a.connect)((function(e){return{currentTeamId:(0,i.Sy)(e)}}),(function(e){return{actions:(0,s.bindActionCreators)({createCategory:o.zZ,renameCategory:r.D8},e)}}))(b)},31892:(e,t,n)=>{n.d(t,{A:()=>_});var a=n(23453),s=n(5908),r=n(23739),i=n(65952),o=n(14776),l=n(7430),c=n(91767),d=n(78451),u=n(62688),m=n.n(u),h=(n(4290),n(97023)),p=n.n(h),g=n(83675),f=n(14778),b=n(79342),E=n(19513);function C(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class v extends p().PureComponent{constructor(e){super(e),C(this,"handleHide",(()=>{this.setState({show:!1})})),C(this,"handleKeyPress",(e=>{(0,E.e)(e,d.Ay.KeyCodes.ENTER)&&this.handleSubmit()})),C(this,"handleSubmit",(()=>{this.handleHide(),this.props.actions.leaveTeam(this.props.currentTeamId,this.props.currentUserId),this.props.actions.toggleSideBarRightMenu()})),this.state={show:!0}}componentDidMount(){document.addEventListener("keypress",this.handleKeyPress)}componentWillUnmount(){document.removeEventListener("keypress",this.handleKeyPress)}render(){const{currentUser:e,numOfPrivateChannels:t,numOfPublicChannels:n}=this.props;let a;return a=b.P(e.roles)?0!==n&&0!==t?p().createElement(f.FormattedMessage,{id:"leave_team_modal_guest.description",defaultMessage:"<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} and {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> You won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_public_channels:n,num_of_private_channels:t,strong:e=>p().createElement("strong",null,e)}}):0===n?p().createElement(f.FormattedMessage,{id:"leave_team_modal_guest_only_private.description",defaultMessage:"<strong>You will be removed from {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> You won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_private_channels:t,strong:e=>p().createElement("strong",null,e)}}):p().createElement(f.FormattedMessage,{id:"leave_team_modal_guest_only_public.description",defaultMessage:"<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} on this team.</strong> You won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_public_channels:n,strong:e=>p().createElement("strong",null,e)}}):0!==n&&0!==t?p().createElement(f.FormattedMessage,{id:"leave_team_modal.description",defaultMessage:"<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} and {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> If the team is private you won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_public_channels:n,num_of_private_channels:t,strong:e=>p().createElement("strong",null,e)}}):0===n?p().createElement(f.FormattedMessage,{id:"leave_team_modal_private.description",defaultMessage:"<strong>You will be removed from {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> If the team is private you won't be able to rejoin it without an invitation from another team member. Are you sure?",values:{num_of_private_channels:t,strong:e=>p().createElement("strong",null,e)}}):p().createElement(f.FormattedMessage,{id:"leave_team_modal_public.description",defaultMessage:"<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} on this team.</strong> Are you sure?",values:{num_of_public_channels:n,strong:e=>p().createElement("strong",null,e)}}),p().createElement(g.Modal,{dialogClassName:"a11y__modal",className:"modal-confirm",show:this.state.show,onExited:this.props.onExited,onHide:this.handleHide,id:"leaveTeamModal",role:"none","aria-labelledby":"leaveTeamModalLabel"},p().createElement(g.Modal.Header,{closeButton:!1},p().createElement(g.Modal.Title,{componentClass:"h1",id:"leaveTeamModalLabel"},p().createElement(f.FormattedMessage,{id:"leave_team_modal.title",defaultMessage:"Leave the team?"}))),p().createElement(g.Modal.Body,null,a),p().createElement(g.Modal.Footer,null,p().createElement("button",{type:"button",className:"btn btn-tertiary",onClick:this.handleHide,id:"leaveTeamNo"},p().createElement(f.FormattedMessage,{id:"leave_team_modal.no",defaultMessage:"No"})),p().createElement("button",{type:"button",className:"btn btn-danger",onClick:this.handleSubmit,id:"leaveTeamYes"},p().createElement(f.FormattedMessage,{id:"leave_team_modal.yes",defaultMessage:"Yes"}))))}}function y(e){return(0,i.$3)(e).filter((e=>e.type===d.YM.PRIVATE_CHANNEL)).length}function M(e){return(0,i.$3)(e).filter((e=>e.type===d.YM.OPEN_CHANNEL)).length}C(v,"propTypes",{currentUserId:m().string.isRequired,currentTeamId:m().string.isRequired,numOfPublicChannels:m().number.isRequired,numOfPrivateChannels:m().number.isRequired,onExited:m().func.isRequired,actions:m().shape({leaveTeam:m().func.isRequired,toggleSideBarRightMenu:m().func.isRequired}).isRequired});const _=(0,a.connect)((function(e){return{currentUserId:(0,l.WR)(e),currentTeamId:(0,o.Sy)(e),currentUser:(0,l.HW)(e),numOfPrivateChannels:y(e),numOfPublicChannels:M(e)}}),(function(e){return{actions:(0,s.bindActionCreators)({leaveTeam:r.fy,toggleSideBarRightMenu:c.u9},e)}}))(v)},1277:(e,t,n)=>{n.d(t,{$:()=>u,A:()=>m});var a=n(62688),s=n.n(a),r=(n(43813),n(4290),n(97023)),i=n.n(r),o=n(83675),l=n(14778),c=n(1396);function d(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u=50;class m extends i().PureComponent{constructor(e){super(e),d(this,"handleHide",(()=>{this.setState({show:!1})})),d(this,"handleExit",(()=>{this.props.onHide&&this.props.onHide()})),d(this,"onNext",(()=>{const e=this.state.page+1;this.onPageChange(e)})),d(this,"onPrev",(()=>{const e=this.state.page-1;this.onPageChange(e)})),d(this,"onPageChange",(async e=>{this.setState({loading:!0});const t=await this.props.loadItems(e,this.state.searchTerm);this.setState({page:e,items:t.items,loading:!1})})),d(this,"onSearchInput",(async e=>{const{target:t}=e,n=t.value;this.setState({loading:!0,searchTerm:n});const a=await this.props.loadItems(0,n),{items:s,totalCount:r}=a;this.setState({loading:!1,items:s,totalCount:r})})),this.numPerPage=e.numPerPage||u,this.state={show:!0,page:0,items:[],totalCount:0,loading:!0,searchTerm:""}}async componentDidMount(){const{totalCount:e,items:t}=await this.props.loadItems(0,"");this.setState({totalCount:e,items:t,loading:!1})}renderRows(){return this.state.loading?i().createElement("div",null,i().createElement(c.A,{position:"absolute",key:"loading"})):this.state.items.map((e=>this.props.renderRow(e,this)))}paginationRange(){let e=this.state.page*this.numPerPage+1;const t=e+this.state.items.length-1;return 0===t&&(e=0),{startCount:e,endCount:t}}render(){if(!this.props.show)return null;const{endCount:e,startCount:t}=this.paginationRange();return i().createElement("div",null,i().createElement(o.Modal,{dialogClassName:"a11y__modal more-modal more-modal--action",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},i().createElement(o.Modal.Header,{closeButton:!0},i().createElement(o.Modal.Title,{componentClass:"h1"},i().createElement("span",{className:"name"},this.props.titleText)),this.props.titleBarButtonText&&this.props.titleBarButtonOnClick&&i().createElement("a",{className:"btn btn-md btn-primary",href:"#",onClick:this.props.titleBarButtonOnClick},this.props.titleBarButtonText)),i().createElement(o.Modal.Body,null,i().createElement("div",{className:"filtered-user-list"},i().createElement("div",{className:"filter-row"},i().createElement("div",{className:"col-xs-12"},i().createElement("label",{className:"hidden-label",htmlFor:"searchUsersInput"},this.props.searchPlaceholderText),i().createElement("input",{id:"searchUsersInput",className:"form-control filter-textbox",placeholder:this.props.searchPlaceholderText,onChange:this.onSearchInput})),i().createElement("div",{className:"col-sm-12"},i().createElement("span",{className:"member-count pull-left"},i().createElement(l.FormattedMessage,{id:"list_modal.paginatorCount",defaultMessage:"{startCount, number} - {endCount, number} of {total, number} total",values:{startCount:t,endCount:e,total:this.state.totalCount}})))),i().createElement("div",{className:"more-modal__list"},i().createElement("div",null,this.renderRows())),i().createElement("div",{className:"filter-controls"},this.state.page>0&&i().createElement("button",{onClick:this.onPrev,className:"btn btn-sm btn-tertiary filter-control filter-control__prev"},i().createElement(l.FormattedMessage,{id:"filtered_user_list.prev",defaultMessage:"Previous"})),this.props.numPerPage&&this.state.items.length>=this.props.numPerPage&&e!==this.state.totalCount&&i().createElement("button",{onClick:this.onNext,className:"btn btn-sm btn-tertiary filter-control filter-control__next"},i().createElement(l.FormattedMessage,{id:"filtered_user_list.next",defaultMessage:"Next"})))))))}}d(m,"propTypes",{titleText:s().string,searchPlaceholderText:s().string,titleBarButtonText:s().string,numPerPage:s().number,show:s().bool,titleBarButtonOnClick:s().func,loadItems:s().func.isRequired,onHide:s().func,renderRow:s().func.isRequired}),d(m,"defaultProps",{show:!0})},83642:(e,t,n)=>{n.d(t,{t:()=>u});var a=n(62688),s=n.n(a),r=n(71633),i=n.n(r),o=n(97023),l=n.n(o),c=n(95025),d=n(4715);const u=e=>{let{className:t,variant:n}=e;const a=(0,d.cX)()?"âŒ˜":"Ctrl",s=n||c.l.Contrast;return l().createElement("span",{className:i()("search-shortcut",t)},l().createElement(c.e,{variant:s},a),!(0,d.y3)()&&l().createElement(c.e,{variant:s},"Shift"),l().createElement(c.e,{variant:s},"F"))};u.propTypes={className:s().string}},19174:(e,t,n)=>{n.d(t,{A:()=>f});var a=n(62688),s=n.n(a),r=(n(29206),n(97023)),i=n.n(r),o=n(14778),l=n(23453),c=n(85406),d=n(79751),u=n(12555),m=n(70669),h=n(78451);const p=["id"],g=e=>{let{id:t}=e,n=function(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}(e,p);const a=(0,l.useDispatch)(),s=(0,r.useCallback)((()=>{a((0,d.q)({modalId:h.IQ.EDIT_CATEGORY,dialogType:u.default}))}),[a]);return i().createElement(m.q7,Object.assign({id:"create-".concat(t),onClick:s,"aria-haspopup":!0,leadingElement:i().createElement(c.FolderPlusOutlineIcon,{size:18}),labels:i().createElement(o.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.createCategory",defaultMessage:"Create New Category"})},n))};g.propTypes={id:s().string.isRequired};const f=g},51877:(e,t,n)=>{n.d(t,{A:()=>C});var a=n(62688),s=n.n(a),r=(n(29206),n(97023)),i=n.n(r),o=n(14778),l=n(23453),c=n(85406),d=n(79751),u=n(70669),m=n(78451),h=n(14696);const p=()=>null,g=e=>{let{handleConfirm:t,numChannels:n,onExited:a}=e;const s=(0,o.useIntl)(),r=s.formatMessage({id:"mark_as_read_confirm_modal.header",defaultMessage:"Mark as read"}),l=s.formatMessage({id:"mark_as_read_confirm_modal.body",defaultMessage:"Are you sure you want to mark {numChannels} channels as read?"},{numChannels:n}),c=s.formatMessage({id:"mark_as_read_confirm_modal.confirm",defaultMessage:"Mark as read"});return i().createElement(h.zW,{ariaLabel:r,compassDesign:!0,modalHeaderText:r,handleConfirm:t,handleCancel:p,onExited:a,confirmButtonText:c},i().createElement("span",{className:"mark-as-read__helpText"},l))};g.propTypes={handleConfirm:s().func.isRequired,numChannels:s().number.isRequired,onExited:s().func.isRequired};const f=g,b=["id","handleViewCategory","numChannels"],E=e=>{let{id:t,handleViewCategory:n,numChannels:a}=e,s=function(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}(e,b);const h=(0,l.useDispatch)(),p=(0,r.useCallback)((()=>{a<=0||(1!==a?h((0,d.q)({modalId:m.IQ.DELETE_CATEGORY,dialogType:f,dialogProps:{handleConfirm:n,numChannels:a}})):n())}),[h,n,a]);return i().createElement(u.q7,Object.assign({id:"view-".concat(t),onClick:p,"aria-haspopup":a>1,leadingElement:i().createElement(c.MarkAsUnreadIcon,{size:18}),labels:i().createElement(o.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.viewCategory",defaultMessage:"Mark category as read"})},s))};E.propTypes={id:s().string.isRequired,handleViewCategory:s().func.isRequired,numChannels:s().number.isRequired};const C=E},77813:(e,t,n)=>{n.d(t,{A:()=>h});var a=n(62688),s=n.n(a),r=(n(17046),n(71633)),i=n.n(r),o=n(97023),l=n.n(o),c=n(14778),d=n(85406),u=n(70669);const m=e=>{let{id:t,children:n,name:a}=e;const[s,r]=(0,o.useState)(!1),{formatMessage:m}=(0,c.useIntl)();return l().createElement("div",{className:i()("SidebarMenu","MenuWrapper",{"MenuWrapper--open":s,menuOpen:s})},l().createElement(u.mc,{menuButton:{id:"SidebarCategoryMenu-Button-".concat(t),"aria-label":m({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"},{name:a}),class:"SidebarMenu_menuButton",children:l().createElement(d.DotsVerticalIcon,{size:16})},menuButtonTooltip:{text:m({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"},{name:a}),class:"hidden-xs"},menu:{id:"SidebarChannelMenu-MenuList-".concat(t),"aria-label":m({id:"sidebar_left.sidebar_category_menu.dropdownAriaLabel",defaultMessage:"Edit category menu"}),onToggle:function(e){r(e)}}},n))};m.propTypes={id:s().string.isRequired,children:s().arrayOf(s().node).isRequired,name:s().string.isRequired};const h=(0,o.memo)(m)},66039:(e,t,n)=>{n.d(t,{U:()=>d,w:()=>u});var a=n(62688),s=n.n(a),r=(n(29206),n(71633)),i=n.n(r),o=n(97023),l=n.n(o),c=n(78138);const d=l().forwardRef(((e,t)=>l().createElement("div",{className:"SidebarChannelGroupHeader SidebarChannelGroupHeader--static"},l().createElement("div",{ref:t,className:"SidebarChannelGroupHeader_groupButton"},l().createElement("div",{className:"SidebarChannelGroupHeader_text"},(0,c.uN)(e.displayName)),e.children))));d.propTypes={children:s().node,displayName:s().string.isRequired},d.displayName="SidebarCategoryHeaderStatic";const u=l().forwardRef(((e,t)=>{const{dragHandleProps:n}=e;return n&&n.role&&Reflect.deleteProperty(n,"role"),l().createElement("div",{className:i()("SidebarChannelGroupHeader",{muted:e.muted,dragging:e.isDragging})},l().createElement("button",{ref:t,className:i()("SidebarChannelGroupHeader_groupButton"),"aria-label":e.displayName,onClick:e.onClick,"aria-expanded":!e.isCollapsed},l().createElement("i",{className:i()("icon icon-chevron-down",{"icon-rotate-minus-90":e.isCollapsed,"hide-arrow":!e.isCollapsible})}),l().createElement("div",Object.assign({className:"SidebarChannelGroupHeader_text"},n,{tabIndex:-1}),(0,c.uN)(e.displayName))),e.children)}));u.propTypes={children:s().node,displayName:s().string.isRequired,isCollapsed:s().bool.isRequired,isCollapsible:s().bool,isDragging:s().bool,isDraggingOver:s().bool,muted:s().bool.isRequired,onClick:s().func.isRequired},u.defaultProps={isCollapsible:!0,isDragging:!1,isDraggingOver:!1},u.displayName="SidebarCategoryHeader"},45697:(e,t,n)=>{n.d(t,{A:()=>c});var a=n(62688),s=n.n(a),r=n(71633),i=n.n(r),o=n(97023),l=n.n(o);function c(e){let{unreadMentions:t,hasUrgent:n,icon:a,className:s}=e;return t>0?l().createElement("span",{id:"unreadMentions",className:i()({badge:!0,urgent:n},s)},a,l().createElement("span",{className:"unreadMentions"},t)):null}c.propTypes={unreadMentions:s().number.isRequired,hasUrgent:s().bool,icon:s().node,className:s().string}},69440:(e,t,n)=>{n.d(t,{A:()=>Pe});var a=n(23453),s=n(65952),r=n(14776),i=n(9916),o=(n(17046),n(29206),n(71633)),l=n.n(o),c=n(97023),d=n.n(c),u=n(22005),m=n(14778),h=n(78451),p=n(5908),g=n(25778),f=n(79751),b=n(62688),E=n.n(b),C=n(69238),v=n(56707),y=n(3569),M=n(26614),_=n(77440),T=n(73996),S=n(16230),w=n(87778),I=n(52073),A=n(2386),R=n(51140),N=n(75270),P=n(53791),O=n(99243),L=(n(4290),n(81911)),D=n(59671),k=n(67277),F=n(59050),x=n(64766),U=n(87131),B=n(694),H=n(78138),q=n(19513),j=n(3295),V=n(45697);function G(e){let{hasDraft:t}=e;return t?d().createElement("i",{"data-testid":"draftIcon",className:"icon icon-pencil-outline channel-pencil-icon"}):null}n(76685),G.propTypes={hasDraft:E().bool.isRequired};const z=(0,c.memo)(G);function W(e,t,n){return null!==e&&Boolean(e.message.trim()||e.fileInfos.length||e.uploadsInProgress.length)&&n!==t}const K=(0,a.connect)((function(e,t){const n=(0,s.eH)(e);return{hasDraft:W((0,N.UR)(e,h.eN.DRAFT,t.id),t.id,n)}}))(z);function Y(e){let{isDeleted:t,icon:n}=e;return t?d().createElement("i",{className:"icon icon-archive-outline"}):n}Y.propTypes={icon:E().oneOfType([E().element,E().oneOf([null])]),isDeleted:E().bool.isRequired};const J=Y;var Q=n(30413),Z=n(16983),X=n(80635),$=n(15755),ee=n(63155),te=n(85406),ne=n(46),ae=n(34086),se=n(70669),re=n(85873);const ie=e=>{let{channel:t,channelLink:n,currentUserId:a,favoriteChannel:s,isFavorite:r,isMuted:i,isUnread:o,managePrivateChannelMembers:l,managePublicChannelMembers:u,readMultipleChannels:p,markMostRecentPostInChannelAsUnread:g,muteChannel:f,onMenuToggle:b,openModal:E,unfavoriteChannel:C,unmuteChannel:v,channelLeaveHandler:y}=e;const M=(0,c.useRef)(!1),{formatMessage:_}=(0,m.useIntl)();let T=null;if(o){function N(){p([t.id])}T=d().createElement(se.q7,{id:"markAsRead-".concat(t.id),onClick:N,leadingElement:d().createElement(te.MarkAsUnreadIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.markAsRead",defaultMessage:"Mark as Read"})})}else{function P(){g(t.id)}T=d().createElement(se.q7,{id:"markAsUnread-".concat(t.id),onClick:P,leadingElement:d().createElement(te.MarkAsUnreadIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.markAsUnread",defaultMessage:"Mark as Unread"})})}let S=null;if(r){function O(){C(t.id)}S=d().createElement(se.q7,{id:"unfavorite-".concat(t.id),onClick:O,leadingElement:d().createElement(te.StarIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.unfavoriteChannel",defaultMessage:"Unfavorite"})})}else{function L(){s(t.id)}S=d().createElement(se.q7,{id:"favorite-".concat(t.id),onClick:L,leadingElement:d().createElement(te.StarOutlineIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.favoriteChannel",defaultMessage:"Favorite"})})}let w=null;if(i){let D=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.unmuteChannel",defaultMessage:"Unmute Channel"});function k(){v(a,t.id)}t.type!==h.Ay.DM_CHANNEL&&t.type!==h.Ay.GM_CHANNEL||(D=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.unmute",defaultMessage:"Unmute"})),w=d().createElement(se.q7,{id:"unmute-".concat(t.id),onClick:k,leadingElement:d().createElement(te.BellOffOutlineIcon,{size:18}),labels:D})}else{let F=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.muteChannel",defaultMessage:"Mute Channel"});function x(){f(a,t.id)}t.type!==h.Ay.DM_CHANNEL&&t.type!==h.Ay.GM_CHANNEL||(F=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.mute",defaultMessage:"Mute"})),w=d().createElement(se.q7,{id:"mute-".concat(t.id),onClick:x,leadingElement:d().createElement(te.BellOutlineIcon,{size:18}),labels:F})}let I=null;if(t.type===h.Ay.OPEN_CHANNEL||t.type===h.Ay.PRIVATE_CHANNEL){function U(){(0,re.lW)(n)}I=d().createElement(se.q7,{id:"copyLink-".concat(t.id),onClick:U,leadingElement:d().createElement(te.LinkVariantIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.copyLink",defaultMessage:"Copy Link"})})}let A=null;if(t.type===h.Ay.PRIVATE_CHANNEL&&l||t.type===h.Ay.OPEN_CHANNEL&&u){function B(){E({modalId:h.IQ.CHANNEL_INVITE,dialogType:ne.A,dialogProps:{channel:t}})}A=d().createElement(se.q7,{id:"addMembers-".concat(t.id),onClick:B,"aria-haspopup":"true",leadingElement:d().createElement(te.AccountPlusOutlineIcon,{size:18}),labels:d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.addMembers",defaultMessage:"Add Members"})})}let R=null;if(t.name!==h.Ay.DEFAULT_CHANNEL){let H=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.leaveChannel",defaultMessage:"Leave Channel"});function q(){!M.current&&y&&(M.current=!0,y((()=>{M.current=!1})))}t.type!==h.Ay.DM_CHANNEL&&t.type!==h.Ay.GM_CHANNEL||(H=d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel_menu.leaveConversation",defaultMessage:"Close Conversation"})),R=d().createElement(se.q7,{id:"leave-".concat(t.id),onClick:q,leadingElement:d().createElement(te.ExitToAppIcon,{size:18}),labels:H,isDestructive:!0})}return d().createElement(se.mc,{menuButton:{id:"SidebarChannelMenu-Button-".concat(t.id),class:"SidebarMenu_menuButton","aria-label":_({id:"sidebar_left.sidebar_channel_menu.editChannel.ariaLabel",defaultMessage:"Channel options for {channelName}"},{channelName:t.name}),children:d().createElement(te.DotsVerticalIcon,{size:16})},menuButtonTooltip:{class:"hidden-xs",text:_({id:"sidebar_left.sidebar_channel_menu.editChannel",defaultMessage:"Channel options"})},menu:{id:"SidebarChannelMenu-MenuList-".concat(t.id),"aria-label":_({id:"sidebar_left.sidebar_channel_menu.dropdownAriaLabel",defaultMessage:"Edit channel menu"}),onToggle:b}},T,S,w,d().createElement(se.wv,null),d().createElement(ae.A,{channel:t}),(I||A)&&d().createElement(se.wv,null),I,A,R&&d().createElement(se.wv,null),R)},oe=(0,c.memo)(ie),le={readMultipleChannels:Q.Zi,markMostRecentPostInChannelAsUnread:w.pr,favoriteChannel:Q.yc,unfavoriteChannel:Q.XJ,muteChannel:$.vW,unmuteChannel:$.c2,openModal:f.q},ce=(0,a.connect)((function(e,t){const n=(0,y.vd)(e)[t.channel.id],a=(0,r.H7)(e);let i=!1,o=!1;return a&&(i=(0,X.Ec)(e,a.id,t.channel.id,Z.A.MANAGE_PUBLIC_CHANNEL_MEMBERS),o=(0,X.Ec)(e,a.id,t.channel.id,Z.A.MANAGE_PRIVATE_CHANNEL_MEMBERS)),{currentUserId:(0,y.WR)(e),isFavorite:(0,s.g1)(e,t.channel.id),isMuted:(0,S.X4)(n),channelLink:"".concat((0,ee.vV)()).concat(t.channelLink),managePublicChannelMembers:i,managePrivateChannelMembers:o}}),le)(oe);function de(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ue extends d().PureComponent{constructor(e){super(e),de(this,"enableToolTipIfNeeded",(()=>{const e=this.labelRef.current,t=e&&e.offsetWidth<e.scrollWidth;this.setState({showTooltip:Boolean(t)})})),de(this,"getAriaLabel",(()=>{const{label:e,ariaLabelPrefix:t,unreadMentions:n,intl:a}=this.props;let s=e;return t&&(s+=" ".concat(t)),1===n?s+=" ".concat(n," ").concat(a.formatMessage({id:"accessibility.sidebar.types.mention",defaultMessage:"mention"})):n>1&&(s+=" ".concat(n," ").concat(a.formatMessage({id:"accessibility.sidebar.types.mentions",defaultMessage:"mentions"}))),this.props.isUnread&&0===n&&(s+=" ".concat(a.formatMessage({id:"accessibility.sidebar.types.unread",defaultMessage:"unread"}))),s.toLowerCase()})),de(this,"handleChannelClick",(e=>{(0,D.Gy)(j.CU.ChannelLinkClicked),this.handleSelectChannel(e),this.props.rhsOpen&&this.props.rhsState===h._n.EDIT_HISTORY&&this.props.actions.closeRightHandSide()})),de(this,"handleSelectChannel",(e=>{e.defaultPrevented||0!==e.button||((0,q.r)(e)?(e.preventDefault(),this.props.actions.multiSelectChannelAdd(this.props.channel.id)):e.shiftKey?(e.preventDefault(),this.props.actions.multiSelectChannelTo(this.props.channel.id)):e.altKey&&!this.props.isUnread?(e.preventDefault(),this.props.actions.markMostRecentPostInChannelAsUnread(this.props.channel.id)):this.props.actions.clearChannelSelection())})),de(this,"handleMenuToggle",(e=>{this.setState({isMenuOpen:e})})),this.labelRef=d().createRef(),this.state={isMenuOpen:!1,showTooltip:!1}}componentDidMount(){var e;this.enableToolTipIfNeeded(),this.props.isSharedChannel&&null!==(e=this.props.channel)&&void 0!==e&&e.id&&0===this.props.remoteNames.length&&this.props.actions.fetchChannelRemotes(this.props.channel.id)}componentDidUpdate(e){var t,n,a,s,r;e.label!==this.props.label&&this.enableToolTipIfNeeded(),this.props.isSharedChannel&&((null===(t=e.channel)||void 0===t?void 0:t.id)!==(null===(n=this.props.channel)||void 0===n?void 0:n.id)||(null===(a=e.channel)||void 0===a?void 0:a.team_id)!==(null===(s=this.props.channel)||void 0===s?void 0:s.team_id))&&0===this.props.remoteNames.length&&null!==(r=this.props.channel)&&void 0!==r&&r.id&&this.props.actions.fetchChannelRemotes(this.props.channel.id)}render(){const{channel:e,icon:t,isChannelSelected:n,isMuted:a,isUnread:s,label:r,link:i,unreadMentions:o,firstChannelName:c,showChannelsTutorialStep:u,hasUrgent:m}=this.props;let p=null;(c===e.name||!c&&u&&e.name===h.Ay.DEFAULT_CHANNEL)&&(p=c?d().createElement(x.Pr,{firstChannelName:e.display_name}):d().createElement(x.Pr,null));let g=d().createElement("span",{ref:this.labelRef,className:"SidebarChannelLinkLabel"},(0,H.uN)(r));this.state.showTooltip&&(g=d().createElement(U.A,{title:r},g));const f=this.props.teammateId?d().createElement(k.A,{userID:this.props.teammateId,showTooltip:!0,spanStyle:{height:18},emojiStyle:{marginTop:-4,marginBottom:0,opacity:.8}}):null,b=this.props.isSharedChannel?d().createElement(F.A,{className:"icon",withTooltip:!0,remoteNames:this.props.remoteNames}):null,E=d().createElement(d().Fragment,null,d().createElement(J,{isDeleted:0!==e.delete_at,icon:t}),d().createElement("div",{className:"SidebarChannelLinkLabel_wrapper"},g,f,d().createElement(B.default,{pluggableName:"SidebarChannelLinkLabel",channel:this.props.channel}),b),d().createElement(K,{id:e.id}),d().createElement(V.A,{unreadMentions:o,hasUrgent:m}),d().createElement("div",{className:l()("SidebarMenu","MenuWrapper",{menuOpen:this.state.isMenuOpen},{"MenuWrapper--open":this.state.isMenuOpen})},d().createElement(ce,{channel:e,channelLink:i,isUnread:s,channelLeaveHandler:this.props.channelLeaveHandler,onMenuToggle:this.handleMenuToggle}))),C=l()(["SidebarLink",{menuOpen:this.state.isMenuOpen,muted:a,"unread-title":this.props.isUnread,selected:n}]);return d().createElement(L.Link,{className:C,id:"sidebarItem_".concat(e.name),"aria-label":this.getAriaLabel(),to:i,onClick:this.handleChannelClick,tabIndex:0},E,p)}}de(ue,"propTypes",{link:E().string.isRequired,label:E().string.isRequired,ariaLabelPrefix:E().string,channelLeaveHandler:E().func,icon:E().oneOfType([E().element,E().oneOf([null])]),unreadMentions:E().number.isRequired,isUnread:E().bool.isRequired,isMuted:E().bool.isRequired,isChannelSelected:E().bool.isRequired,teammateId:E().string,firstChannelName:E().string,showChannelsTutorialStep:E().bool.isRequired,hasUrgent:E().bool.isRequired,rhsOpen:E().bool,isSharedChannel:E().bool,remoteNames:E().arrayOf(E().string).isRequired,actions:E().shape({markMostRecentPostInChannelAsUnread:E().func.isRequired,clearChannelSelection:E().func.isRequired,multiSelectChannelTo:E().func.isRequired,multiSelectChannelAdd:E().func.isRequired,unsetEditingPost:E().func.isRequired,closeRightHandSide:E().func.isRequired,fetchChannelRemotes:E().func.isRequired}).isRequired});const me=(0,m.injectIntl)(ue),he=(0,a.connect)((function(){const e=(0,s.KP)();return(t,n)=>{var a;const s=(0,y.vd)(t)[n.channel.id],r=e(t,n.channel.id),o=(0,M.zj)(t),l="true"===o.EnableTutorial,c=(0,y.WR)(t),d=(0,_.yW)(t,O.AG.ONBOARDING_TUTORIAL_STEP,c,0),u=(0,_.yW)(t,P.XV,P.Z.CHANNELS_TOUR,O.BL)===P.gy.STARTED,m=o.EnableOnboardingFlow,h=l&&d===O.NI.CHANNELS_AND_DIRECT_MESSAGES&&u&&"true"===m,p=null!==(a=n.channel)&&void 0!==a&&a.shared?(0,T.lk)(t,n.channel.id):[];return{unreadMentions:r.mentions,unreadMsgs:r.messages,isUnread:r.showUnread,isMuted:(0,S.X4)(s),hasUrgent:r.hasUrgent,isChannelSelected:(0,i.T$)(t,n.channel.id),firstChannelName:h?(0,R.Hd)(t):"",showChannelsTutorialStep:h,rhsState:(0,N.bM)(t),rhsOpen:(0,N.A)(t),remoteNames:p}}}),(function(e){return{actions:(0,p.bindActionCreators)({markMostRecentPostInChannelAsUnread:w.pr,unsetEditingPost:w.K4,clearChannelSelection:I.lE,multiSelectChannelTo:I.Go,multiSelectChannelAdd:I.wf,closeRightHandSide:A.bP,fetchChannelRemotes:v.No},e)}}))(me);var pe=n(9386);const ge=e=>{let{channel:t,currentTeamName:n,actions:a}=e;const s=(0,m.useIntl)(),r=(0,c.useCallback)((e=>{a.leaveChannel(t.id),e()}),[t.id,a.leaveChannel]),i=(0,c.useCallback)((e=>{a.openModal({modalId:h.IQ.LEAVE_PRIVATE_CHANNEL_MODAL,dialogType:C.A,dialogProps:{channel:t}}),e()}),[t,a.openModal]);let o=null;t.type===h.Ay.OPEN_CHANNEL&&t.name!==h.Ay.DEFAULT_CHANNEL?o=r:t.type===h.Ay.PRIVATE_CHANNEL&&(o=i);const l=d().createElement(pe.A,{channelType:t.type});let u;return t.type===h.Ay.OPEN_CHANNEL?u=s.formatMessage({id:"accessibility.sidebar.types.public",defaultMessage:"public channel"}):t.type===h.Ay.PRIVATE_CHANNEL&&(u=s.formatMessage({id:"accessibility.sidebar.types.private",defaultMessage:"private channel"})),d().createElement(he,{channel:t,link:"/".concat(n,"/channels/").concat(t.name),label:t.display_name,ariaLabelPrefix:u,channelLeaveHandler:o,icon:l,isSharedChannel:t.shared})};ge.propTypes={currentTeamName:E().string.isRequired};const fe=ge,be=(0,a.connect)(null,(function(e){return{actions:(0,p.bindActionCreators)({leaveChannel:g.nE,openModal:f.q},e)}}))(fe);var Ee=n(35631),Ce=n(7430),ve=n(40693),ye=n(61767),Me=n(83007);function _e(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Te extends d().PureComponent{constructor(){super(...arguments),_e(this,"handleLeaveChannel",(e=>{const t=this.props.channel.teammate_id,n=h.YM.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW,a=this.props.currentUserId;this.props.actions.savePreferences(a,[{user_id:a,category:n,name:t,value:"false"}]).then(e),this.props.actions.leaveDirectChannel(this.props.channel.name),this.props.active&&(0,Me.J)().push("/".concat(this.props.currentTeamName,"/channels/").concat(this.props.redirectChannel))})),_e(this,"getIcon",(()=>{const{channel:e,teammate:t}=this.props;if(!t)return null;if(t.id&&t.delete_at)return d().createElement("i",{className:"icon icon-archive-outline"});let n="";return"online"===e.status?n="status-online":"away"===e.status?n="status-away":"dnd"===e.status&&(n="status-dnd"),d().createElement(ye.A,{src:ve.mT.getProfilePictureUrl(t.id,t.last_picture_update),size:"xs",status:t.is_bot?"":e.status,wrapperClass:"DirectChannel__profile-picture",newStatusIcon:!0,statusClass:"DirectChannel__status-icon ".concat(n)})}))}render(){const{channel:e,teammate:t,currentTeamName:n}=this.props;if(!t)return null;let a=e.display_name;return this.props.currentUserId===t.id&&(a=this.props.intl.formatMessage({id:"sidebar.directchannel.you",defaultMessage:"{displayname} (you)"},{displayname:e.display_name})),d().createElement(he,{teammateId:t.id,channel:e,link:"/".concat(n,"/messages/@").concat(t.username),label:a,channelLeaveHandler:this.handleLeaveChannel,icon:this.getIcon(),isSharedChannel:Boolean(t.remote_id)})}}_e(Te,"propTypes",{currentTeamName:E().string.isRequired,currentUserId:E().string.isRequired,redirectChannel:E().string.isRequired,active:E().bool.isRequired,actions:E().shape({savePreferences:E().func.isRequired,leaveDirectChannel:E().func.isRequired}).isRequired});const Se=(0,m.injectIntl)(Te),we=(0,a.connect)((function(e,t){const n=(0,Ce.wz)(e,t.channel.teammate_id),a=(0,Ce.HW)(e),i=(0,r.H7)(e),o=i?(0,s.Dn)(e,i.id):"",l=(0,s.eH)(e),c=t.channel.id===l;return{teammate:n,currentUserId:a.id,redirectChannel:o,active:c}}),(function(e){return{actions:(0,p.bindActionCreators)({savePreferences:Ee.SF,leaveDirectChannel:g.iq},e)}}))(Se),Ie=e=>{let{channel:t,currentUserId:n,actions:a,active:s,currentTeamName:r,redirectChannel:i,membersCount:o}=e;const l=(0,c.useCallback)((e=>{const o=t.id,l=h.Ay.Preferences.CATEGORY_GROUP_CHANNEL_SHOW;a.savePreferences(n,[{user_id:n,category:l,name:o,value:"false"}]).then(e),s&&(0,Me.J)().push("/".concat(r,"/channels/").concat(i))}),[t.id,a,s,r,i,n]);return d().createElement(he,{channel:t,link:"/".concat(r,"/messages/").concat(t.name),label:t.display_name,channelLeaveHandler:l,icon:d().createElement("div",{className:"status status--group"},o)})};Ie.propTypes={currentTeamName:E().string.isRequired,currentUserId:E().string.isRequired,redirectChannel:E().string.isRequired,active:E().bool.isRequired,membersCount:E().number.isRequired,actions:E().shape({savePreferences:E().func.isRequired}).isRequired};const Ae=(0,c.memo)(Ie),Re=(0,a.connect)((function(){const e=(0,s.fV)();return(t,n)=>{const a=(0,Ce.WR)(t),i=(0,r.H7)(t),o=i?(0,s.Dn)(t,i.id):"",l=(0,s.eH)(t),c=e(t,n.channel);return{currentUserId:a,redirectChannel:o,active:n.channel.id===l,membersCount:c}}}),(function(e){return{actions:(0,p.bindActionCreators)({savePreferences:Ee.SF},e)}}))(Ae),Ne=(0,a.connect)((function(){const e=(0,s.s9)(),t=(0,s.KP)();return(n,a)=>{const o=e(n,a.channelId),l=(0,r.H7)(n),c=(0,s.eH)(n),d=t(n,(null==o?void 0:o.id)||"");return{channel:o,isCurrentChannel:(null==o?void 0:o.id)===c,currentTeamName:null==l?void 0:l.name,unreadMentions:d.mentions,isUnread:d.showUnread,draggingState:(0,i.NX)(n),isChannelSelected:(0,i.T$)(n,a.channelId),multiSelectedChannelIds:n.views.channelSidebar.multiSelectedChannelIds,autoSortedCategoryIds:(0,i.VM)(n)}}})),Pe=Ne((function(e){let{isCategoryCollapsed:t,isCategoryDragged:n,isUnread:a,isCurrentChannel:s,setChannelRef:r,channel:i,currentTeamName:o,isDraggable:p,isChannelSelected:g,draggingState:f,multiSelectedChannelIds:b,channelIndex:E,isAutoSortedCategory:C,autoSortedCategoryIds:v}=e;const[y,M]=(0,c.useState)(!0);if(!i)return null;if(!o)return null;function _(){return n||t&&!a&&!s}function T(e){return t=>{r((null==i?void 0:i.id)||"",t),null==e||e(t)}}function S(e){e&&"toOpaqueAnimation"===e.animationName&&!_()&&M(!0)}function w(e){e&&"toTransparentAnimation"===e.animationName&&_()&&M(!1)}let I;if(I=y?i.type===h.Ay.DM_CHANNEL?d().createElement(we,{channel:i,currentTeamName:o}):i.type===h.Ay.GM_CHANNEL?d().createElement(Re,{channel:i,currentTeamName:o}):d().createElement(be,{channel:i,currentTeamName:o}):null,p){let e;return g&&f.state&&f.id===i.id&&b.length>1&&(e=y?d().createElement("div",{className:"SidebarChannel__selectedCount"},d().createElement(m.FormattedMessage,{id:"sidebar_left.sidebar_channel.selectedCount",defaultMessage:"{count} selected",values:{count:b.length}})):null),d().createElement(u.Draggable,{draggableId:i.id,index:E},((t,n)=>d().createElement("li",Object.assign({draggable:"false",ref:T(t.innerRef),className:l()("SidebarChannel",{collapsed:_(),expanded:!_(),unread:a,active:s,dragging:n.isDragging,selectedDragging:g&&f.state&&f.id!==i.id,fadeOnDrop:n.isDropAnimating&&n.draggingOver&&v.has(n.draggingOver),noFloat:C&&!n.isDragging})},t.draggableProps,t.dragHandleProps,{onAnimationStart:S,onAnimationEnd:w,role:"listitem",tabIndex:-1}),I,e)))}return d().createElement("li",{ref:T(),className:l()("SidebarChannel",{collapsed:_(),expanded:!_(),unread:a,active:s}),onAnimationStart:S,onAnimationEnd:w,role:"listitem"},I)}))},7383:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ci}),n(3188),n(6552);var a=n(23453),s=n(30413),r=n(65952),i=n(26614),o=n(14776),l=n(7430),c=n(25778),d=n(75270),u=n(10189),m=(n(43813),n(4290),n(1418)),h=n(87373),p=n(87988),g=n(23739),f=n(3569),b=n(77440),E=n(59935),C=n(46859),v=n(30388),y=n(83949);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e){return async(t,n)=>{t((0,g.Uv)(e.id));const a=n(),s=(0,l.HW)(a);v.A.setPreviousTeamId(s.id,e.id),(0,f.F4)(a)&&t((0,E.I8)());const r=(0,i.Ay)(a),o=(0,b.h7)(a);if(r&&"true"===r.IsLicensed&&("true"===r.LDAPGroups||o)){const n={filter_allow_reference:!1,page:0,per_page:60,include_member_count:!0,include_member_ids:!0,include_archived:!1},a=_(_({},n),{},{filter_has_member:s.id});s&&t((0,h.N9)(a)),"true"===r.LDAPGroups&&t((0,h.jM)(e.id,!0)),e.group_constrained&&"true"===r.LDAPGroups?t((0,h.UT)(e.id,!0)):t((0,h.f)(n))}return{data:e}}}var w=n(20553),I=n(44785),A=n.n(I),R=(n(17046),n(74883),n(57406),n(55448),n(70727)),N=n.n(R),P=n(97023),O=n.n(P),L=n(81911),D=n(88350),k=n(83739),F=n(55171),x=n(15252),U=n(62688),B=n.n(U),H=n(71633),q=n.n(H),j=n(11925),V=n(7380),G=n(5908),z=n(17085),W=n(49176),K=n(35664),Y=n(78451),J=(n(29206),n(97309),n(10844),n(59297),n(40693)),Q=n(15755),Z=n(91767),X=n(78064),$=n(85873);const ee=new RegExp("^[a-zA-Z0-9]{".concat(26,"}__[a-zA-Z0-9]{").concat(26,"}$"));function te(e){let{match:t,history:n}=e;return async(e,a)=>{const i=a(),{path:c,identifier:d,team:u}=t.params;if(!d)return{data:void 0};const m=(0,o.Uj)(i,u);if(!m)return{data:void 0};const h=await async function(e,t,n){if("channels"===t){const t=(0,r.Os)(e,n),a=(0,r.pd)(e).find((e=>e.name===n));if(26===n.length){if(!t&&!a)try{return await J.mT.getChannel(n),"channel_id"}catch(e){return 404===e.status_code?"channel_name":"error"}return"channel_name"}return!t&&!a&&40===n.length||t&&t.type===Y.YM.GM_CHANNEL||a&&a.type===Y.YM.GM_CHANNEL?"group_channel_group_id":function(e){return 54===e.length&&ee.test(e)}(n)?"direct_channel_user_ids":"channel_name"}return"messages"===t?0===n.indexOf("@")?"direct_channel_username":n.indexOf("@")>0?"direct_channel_email":26===n.length?"direct_channel_user_id":40===n.length?"group_channel_group_id":"error":"error"}(i,c,d);switch(h){case"channel_name":e(function(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=d.toLowerCase(),m=(0,o.Uj)(i,c);if(!m)return{data:void 0};let h,p=(0,r.wX)(i,m.id)[u];if(!p){const e=await n((0,s.lB)(c,u,!0));"data"in e&&(p=e.data)}if(p&&(h=i.entities.channels.myMembers[p.id],!h)){const e=await n((0,s.UB)(p.id,(0,l.WR)(i)));"data"in e&&(h=e.data)}if(!p||!h){var g,f;if((null===(g=p)||void 0===g?void 0:g.type)===Y.YM.PRIVATE_CHANNEL){const e=await n((0,X.DT)(m,p.display_name));if("data"in e&&!e.data.join)return{data:void 0}}const a=await n((0,s.Cg)((0,l.WR)(i),m.id,(null===(f=p)||void 0===f?void 0:f.id)||"",u));if("error"in a){if(!p){const a=await n((0,s.lB)(c,u,!0));if("error"in a||0===a.data.delete_at)return await n((0,s.DC)(m.id)),ie(e,t,(0,r.Dn)(i,m.id)),{data:void 0};p=a.data}}else p=a.data.channel}return p.type===Y.YM.DM_CHANNEL?n(ae(e,t)):p.type===Y.YM.GM_CHANNEL?t.replace("/".concat(c,"/messages/").concat(p.name)):se(p),{data:void 0}}}(t,n));break;case"channel_id":e(function(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=d.toLowerCase();let m=(0,r.c)(i,u);const h=i.entities.channels.myMembers[u],p=(0,o.Uj)(i,c);if(!m||!h){const a=await n((0,s.Cg)((0,l.WR)(i),p.id,u,""));if("error"in a)return await n((0,s.DC)(p.id)),ie(e,t,(0,r.Dn)(i,p.id)),{data:void 0};m=a.data.channel}return m.type===Y.YM.DM_CHANNEL?n(ne(e,t,$.zj(m.name,(0,l.WR)(i)))):m.type===Y.YM.GM_CHANNEL?t.replace("/".concat(c,"/messages/").concat(m.name)):t.replace("/".concat(c,"/channels/").concat(m.name)),{data:void 0}}}(t,n));break;case"group_channel_group_id":e(function(e,t){return async(n,a)=>{const i=a(),{identifier:c,team:d}=e.params,u=c.toLowerCase();t.replace(e.url.replace("/channels/","/messages/"));let m=(0,r.Os)(i,u);const h=(0,o.Uj)(i,d);if(!m){const a=await n((0,s.Cg)((0,l.WR)(i),h.id,"",u));if("error"in a)return await n((0,s.DC)(h.id)),re(e,t,(0,r.Dn)(i,h.id)),{data:void 0};m=a.data.channel}return n((0,s.wO)(m.id)),se(m),{data:void 0}}}(t,n));break;case"direct_channel_username":e(function(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=d.slice(1,d.length).toLowerCase(),m=(0,o.Uj)(i,c);let h=(0,l.JE)(i,u);if(!h){const a=await n((0,z.JE)(u));if("error"in a)return await n((0,s.DC)(m.id)),re(e,t,(0,r.Dn)(i,m.id)),{data:void 0};h=a.data}const p=await n((0,Q.q6)(h.id));return"error"in p?(await n((0,s.DC)(m.id)),re(e,t,(0,r.Dn)(i,m.id)),{data:void 0}):(se(p.data),{data:void 0})}}(t,n));break;case"direct_channel_email":e(function(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=d.toLowerCase(),m=(0,o.Uj)(i,c);let h=(0,l.ht)(i,u);if(!h){const a=await n((0,z.ht)(u));if("error"in a)return await n((0,s.DC)(m.id)),re(e,t,(0,r.Dn)(i,m.id)),{data:void 0};h=a.data}return t.replace("/".concat(c,"/messages/@").concat(h.username)),{data:void 0}}}(t,n));break;case"direct_channel_user_ids":e(ae(t,n));break;case"direct_channel_user_id":e(ne(t,n,d));break;case"error":await e((0,s.DC)(m.id)),re(t,n,(0,r.Dn)(i,m.id))}return{data:void 0}}}function ne(e,t,n){return async(a,i)=>{const c=i(),{team:d}=e.params,u=(0,o.Uj)(c,d);let m=(0,l.wz)(c,n);if(!m){const i=await a((0,z.wz)(n));if("error"in i)return await a((0,s.DC)(u.id)),re(e,t,(0,r.Dn)(c,u.id)),{data:void 0};m=i.data}return t.replace("/".concat(d,"/messages/@").concat(m.username)),{data:void 0}}}function ae(e,t){return async(n,a)=>{const i=a(),{team:c,identifier:d}=e.params,u=$.zj(d.toLowerCase(),(0,l.WR)(a())),m=(0,o.Uj)(i,c);let h=(0,l.wz)(i,u);if(!h){const a=await n((0,z.wz)(u));if("error"in a)return await n((0,s.DC)(m.id)),re(e,t,(0,r.Dn)(i,m.id)),{data:void 0};h=a.data}return t.replace("/".concat(c,"/messages/@").concat(h.username)),{data:void 0}}}function se(e){Z.tk(e)}function re(e,t,n){const{team:a}=e.params;t.push(a?"/".concat(a,"/channels/").concat(n):"/")}async function ie(e,t,n){const{team:a}=e.params;t.push(a?"/error?type=channel_not_found&returnTo=/".concat(a,"/channels/").concat(n):"/")}var oe=n(35073),le=n(97026),ce=n(14778),de=n(87818),ue=n(78417),me=n(1396),he=n(40057),pe=n(52729),ge=n(78546),fe=n(30112),be=n(92008),Ee=n(59671),Ce=n(70713),ve=n(72870),ye=n(10711),Me=n(46177),_e=n.n(Me);function Te(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Se{constructor(){Te(this,"trackedItems",new Map),Te(this,"handleResizeObserver",(e=>{e.forEach((e=>{const t=e.target;let n;for(const[,e]of this.trackedItems.entries())if(e.element===t){n=e;break}if(!n)return;const a=Math.ceil(e.borderBoxSize[0].blockSize);n.callback(a)}))})),this.observer=new ResizeObserver(this.handleResizeObserver)}static getInstance(){return Se.instance||(Se.instance=new Se),Se.instance}observe(e,t,n){return this.trackedItems.set(e,{element:t,callback:n}),this.observer.observe(t),()=>this.unobserve(e)}unobserve(e){const t=this.trackedItems.get(e);t&&(this.observer.unobserve(t.element),this.trackedItems.delete(e))}}Te(Se,"instance",null);const we=Se.getInstance(),Ie=e=>{const t=(0,P.useRef)(null),n=(0,P.useRef)(e.height),a=(0,P.useRef)(e.width),s=(0,P.useRef)(e.index);return(0,P.useEffect)((()=>{n.current=e.height,a.current=e.width,s.current=e.index}),[e.itemId,e.height,e.width,e.index]),(0,P.useEffect)((()=>{var n,a;const s=Math.ceil(null!==(n=null==t||null===(a=t.current)||void 0===a?void 0:a.offsetHeight)&&void 0!==n?n:0);e.onHeightChange(e.itemId,s,!1)}),[e.itemId]),(0,P.useEffect)((()=>{const r=_e()((s=>{if(!t.current)return;const r=t.current.offsetWidth!==a.current;n.current=s,e.onHeightChange(e.itemId,s,r)}),200);let i;return t.current&&(i=we.observe(e.itemId,t.current,(function(e){t.current&&e!==n.current&&r(e)}))),()=>{var t;null===(t=i)||void 0===t||t(),null==r||r.cancel(),e.onUnmount(e.itemId,s.current)}}),[e.itemId]),O().createElement("div",{ref:t,role:"listitem",className:"item_measurer"},e.item)};Ie.propTypes={item:B().node.isRequired,itemId:B().string.isRequired,index:B().number.isRequired,height:B().number.isRequired,width:B().number,onHeightChange:B().func.isRequired,onUnmount:B().func.isRequired};const Ae=(0,P.memo)(Ie);function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){Pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pe(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Oe extends P.PureComponent{constructor(e){super(e),Pe(this,"_listMetaData",{itemOffsetMap:{},itemSizeMap:{},totalMeasuredSize:0,atBottom:!0}),Pe(this,"_itemStyleCache",{}),Pe(this,"_scrollCorrectionInProgress",!1),Pe(this,"_scrollByCorrection",null),Pe(this,"_keepScrollPosition",!1),Pe(this,"_keepScrollToBottom",!1),Pe(this,"_mountingCorrections",0),Pe(this,"_correctedInstances",0),Pe(this,"state",{scrollDirection:"backward",scrollOffset:"number"==typeof this.props.initialScrollOffset?this.props.initialScrollOffset:0,scrollUpdateWasRequested:!1,scrollDelta:0,scrollHeight:0,localOlderPostsToRender:[]}),Pe(this,"scrollBy",((e,t)=>()=>{const n=this._outerRef;"function"==typeof n.scrollBy&&t?n.scrollBy(0,t):e&&(n.scrollTop=e),this._scrollCorrectionInProgress=!1})),Pe(this,"_callOnItemsRendered",(0,ye.A)(((e,t,n,a)=>this.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:n,visibleStopIndex:a})))),Pe(this,"_callOnScroll",(0,ye.A)(((e,t,n,a,s)=>this.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:n,scrollHeight:a,clientHeight:s})))),Pe(this,"_commitHook",(()=>{if(!this.state.scrolledToInitIndex&&Object.keys(this._listMetaData.itemOffsetMap).length){const{index:e,position:t,offset:n}=this.props.initScrollToIndex();this.scrollToItem(e,t,n),this.setState({scrolledToInitIndex:!0}),0===e?this._keepScrollToBottom=!0:this._keepScrollPosition=!0}})),Pe(this,"_dataChange",(()=>{this._listMetaData.totalMeasuredSize<this.props.height&&this.props.canLoadMorePosts()})),Pe(this,"_heightChange",((e,t)=>{t+e>=this._listMetaData.totalMeasuredSize-10&&this.scrollToItem(0,"end")})),Pe(this,"_widthChange",((e,t)=>{t+e>=this._listMetaData.totalMeasuredSize-10&&this.scrollToItem(0,"end")})),Pe(this,"_getItemStyle",(e=>{const{itemData:t}=this.props,n=this._itemStyleCache;let a;return Object.prototype.hasOwnProperty.call(n,t[e])?a=n[t[e]]:(a={left:0,top:De(this.props,e,this._listMetaData),height:Ue(this.props,e,this._listMetaData),width:"100%"},n[t[e]]=a),a})),Pe(this,"_correctScroll",(()=>{const{scrollOffset:e}=this.state,t=this._outerRef;t&&(t.scrollTop=e,this._scrollCorrectionInProgress=!1,this._correctedInstances=0,this._mountingCorrections=0)})),Pe(this,"_generateOffsetMeasurements",(()=>{const{itemOffsetMap:e,itemSizeMap:t}=this._listMetaData,{itemData:n}=this.props;this._listMetaData.totalMeasuredSize=0;for(let a=n.length-1;a>=0;a--){const s=e[n[a+1]]||0,r=t[n[a+1]]||0;e[n[a]]=s+r,this._listMetaData.totalMeasuredSize+=t[n[a]]||0,delete this._itemStyleCache[n[a]]}})),Pe(this,"_handleNewMeasurements",((e,t,n)=>{const{itemSizeMap:a}=this._listMetaData,{itemData:s}=this.props,r=s.findIndex((t=>t===e)),i=a[e]||0;if(i===t)return;if(a[e]=t,!this.state.scrolledToInitIndex)return void this._generateOffsetMeasurements();const o=this._outerRef;if((this.props.height+o.scrollTop>=this._listMetaData.totalMeasuredSize-10||this._keepScrollToBottom)&&this.props.correctScrollToBottom)return this._generateOffsetMeasurements(),this.scrollToItem(0,"end"),void this.forceUpdate();if(n||this._keepScrollPosition){const e=t-i,[,,n]=this._getRangeToRender(this.state.scrollOffset);if(this._generateOffsetMeasurements(),r<n+1)return;return this._scrollCorrectionInProgress=!0,void this.setState((t=>{let n;return n=0===this._mountingCorrections?e:t.scrollDelta+e,this._mountingCorrections++,{scrollOffset:t.scrollOffset+e,scrollDelta:n}}),(()=>{this._correctedInstances++,this._mountingCorrections===this._correctedInstances&&this._correctScroll()}))}this._generateOffsetMeasurements()})),Pe(this,"_onItemRowUnmount",((e,t)=>{const{props:n}=this;if(n.itemData[t]!==e&&!n.itemData.includes(e)){delete this._listMetaData.itemSizeMap[e],delete this._listMetaData.itemOffsetMap[e];const t=this._outerRef,n=t.offsetHeight+t.scrollTop>=this._listMetaData.totalMeasuredSize-10;this._generateOffsetMeasurements(),n&&this.scrollToItem(0,"end"),this.forceUpdate()}})),Pe(this,"_onScrollVertical",(e=>{if(!this.state.scrolledToInitIndex)return;const{scrollTop:t,scrollHeight:n}=e.currentTarget;this._scrollCorrectionInProgress?this.state.scrollUpdateWasRequested&&this.setState((()=>({scrollUpdateWasRequested:!1}))):(n!==this.state.scrollHeight&&this.setState({scrollHeight:n}),this.setState((e=>e.scrollOffset===t?null:{scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1,scrollHeight:n,scrollTop:t,scrollDelta:0})))})),Pe(this,"_outerRefSetter",(e=>{const{outerRef:t}=this.props;this.innerRefWidth=this.props.innerRef.current.clientWidth,this._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"current")&&(t.current=e)})),Pe(this,"_renderItems",(()=>{const e=this.innerRefWidth,[t,n]=this._getRangeToRender(),a=this.props.itemData.length,s=[];if(a>0)for(let r=a-1;r>=0;r--){const{size:a}=Le(this.props,r,this._listMetaData),[i,o]=this.state.localOlderPostsToRender,l=r>=i&&r<o+1&&i===n+1,c=this.props.itemData[r]===this.props.loaderId,d=this.props.itemData[r]===this.props.visibleId,u=this.props.itemData[r],m=this._getItemStyle(r);if(r>=t&&r<n+1||l||c||d){const t=(0,P.createElement)(this.props.children,{data:this.props.itemData,itemId:u});s.push((0,P.createElement)(Ae,{key:u,index:r,item:t,itemId:u,height:a,width:e,onHeightChange:this._handleNewMeasurements,onUnmount:this._onItemRowUnmount}))}else s.push((0,P.createElement)("div",{key:u,style:m}))}return s}))}scrollTo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._scrollCorrectionInProgress=!0,this.setState((n=>({scrollDirection:n.scrollOffset>=e?"backward":"forward",scrollOffset:e,scrollUpdateWasRequested:!0,scrollByValue:t})),(()=>{n?this._scrollByCorrection=window.requestAnimationFrame(this.scrollBy(this.state.scrollOffset,this.state.scrollByValue)):this.scrollBy(this.state.scrollOffset,this.state.scrollByValue)()})),this.forceUpdate()}scrollToItem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const{scrollOffset:a}=this.state,s=this._outerRef;if(0===e&&"end"===t)return void this.scrollTo(s.scrollHeight-this.props.height);const r=ke(this.props,e,t,a,this._listMetaData);r||!Ue(this.props,e,this._listMetaData)&&this.props.scrollToFailed&&this.state.scrolledToInitIndex&&this.props.scrollToFailed(e),this.scrollTo(r+n)}componentDidMount(){const{initialScrollOffset:e}=this.props;"number"==typeof e&&null!==this._outerRef&&(this._outerRef.scrollTop=e),this._commitHook()}getSnapshotBeforeUpdate(e,t){if(t.localOlderPostsToRender[0]!==this.state.localOlderPostsToRender[0]||t.localOlderPostsToRender[1]!==this.state.localOlderPostsToRender[1]){const e=this._outerRef;return{previousScrollTop:e.scrollTop,previousScrollHeight:e.scrollHeight}}return null}componentDidUpdate(e,t,n){if(this.state.scrolledToInitIndex){const{scrollDirection:e,scrollOffset:n,scrollUpdateWasRequested:a,scrollHeight:s}=this.state,{scrollDirection:r,scrollOffset:i,scrollUpdateWasRequested:o,scrollHeight:l}=t;e===r&&n===i&&a===o&&s===l||this._callPropsCallbacks(),t.scrolledToInitIndex||(this._keepScrollPosition=!1,this._keepScrollToBottom=!1)}if(this._commitHook(),e.itemData!==this.props.itemData&&this._dataChange(),e.height!==this.props.height&&this._heightChange(e.height,t.scrollOffset),t.scrolledToInitIndex!==this.state.scrolledToInitIndex&&this._dataChange(),e.width!==this.props.width&&(this.innerRefWidth=this.props.innerRef.current.clientWidth,this._widthChange(e.height,t.scrollOffset)),t.localOlderPostsToRender[0]!==this.state.localOlderPostsToRender[0]||t.localOlderPostsToRender[1]!==this.state.localOlderPostsToRender[1]){const e=this._outerRef.scrollHeight,t=n.previousScrollTop+(e-n.previousScrollHeight);this.scrollTo(t,t-n.previousScrollTop,!0)}}componentWillUnmount(){this._scrollByCorrection&&window.cancelAnimationFrame(this._scrollByCorrection)}_callPropsCallbacks(){const{itemData:e,height:t}=this.props,{scrollDirection:n,scrollOffset:a,scrollUpdateWasRequested:s,scrollHeight:r}=this.state,i=e.length;if("function"==typeof this.props.onItemsRendered&&i>0){const[e,t,s,r]=this._getRangeToRender();this._callOnItemsRendered(e,t,s,r),"backward"===n&&a<1e3&&t!==i-1&&!Ue(this.props,t+1,this._listMetaData).size&&this.state.scrolledToInitIndex&&this.setState((e=>e.localOlderPostsToRender[0]!==t+1?{localOlderPostsToRender:[t+1,t+50]}:null))}"function"==typeof this.props.onScroll&&this._callOnScroll(n,a,s,r,t)}_getRangeToRender(e){const{itemData:t,overscanCountForward:n,overscanCountBackward:a}=this.props,{scrollDirection:s,scrollOffset:r}=this.state,i=t.length;if(0===i)return[0,0,0,0];const o=e>=0?e:r,l=Fe(this.props,o,this._listMetaData),c=xe(this.props,l,o,this._listMetaData),d="backward"===s?a:Math.max(1,n),u="forward"===s?a:Math.max(1,n),m=Math.max(0,c-d);let h=Math.max(0,Math.min(i-1,l+u));for(;!Ue(this.props,h,this._listMetaData)&&h>0&&this._listMetaData.totalMeasuredSize>this.props.height;)h--;return!this.state.scrolledToInitIndex&&this.props.initRangeToRender.length?this.props.initRangeToRender:[m,h,l,c]}render(){const{className:e,id:t,innerRef:n,innerTagName:a,outerTagName:s,style:r,innerListStyle:i}=this.props,o=this._onScrollVertical,l=this._renderItems();return(0,P.createElement)(s,{className:e,id:t,onScroll:o,ref:this._outerRefSetter,style:Ne({WebkitOverflowScrolling:"touch",overflowY:"auto",overflowAnchor:"none",willChange:"transform",width:"100%"},r)},(0,P.createElement)(a,{ref:n,role:"list",className:"innerList",style:i},l))}}Pe(Oe,"defaultProps",{innerTagName:"div",itemData:void 0,outerTagName:"div",overscanCountForward:30,overscanCountBackward:10});const Le=(e,t,n)=>{const{itemOffsetMap:a,itemSizeMap:s}=n,{itemData:r}=e;return s[r[t]]?{offset:a[r[t]]||0,size:s[r[t]]||0}:{offset:0,size:0}},De=(e,t,n)=>Le(e,t,n).offset,ke=(e,t,n,a,s)=>{const{height:r}=e,i=Le(e,t,s),o=s.totalMeasuredSize,l=Math.max(0,i.offset+i.size-r),c=Math.max(0,i.offset);switch(n){case"start":return c;case"end":return l;case"center":return Math.round(c-r/2+i.size/2);default:return a>=c&&a<=l?o-(a+r):a-c<l-a?c:l}},Fe=(e,t,n)=>{const{totalMeasuredSize:a}=n,{itemData:s}=e;return t<=a?((e,t,n,a,s)=>{let r=a;for(;a<=n;)s-Le(e,a,t).offset<=0&&(r=a),a++;return r})(e,n,s.length,0,t):0},xe=(e,t,n,a)=>{const{itemData:s}=e;let r=t;const i=n+e.height,o=Le(e,r,a);let l=o.offset+(o.size||0);for(;r>0&&l<=i;){const t=Le(e,r,a);l=t.offset+t.size,r--}return r>=s.length?0:r},Ue=(e,t,n)=>Le(e,t,n).size;var Be=n(99255),He=n(87778),qe=n(69410),je=n(70689),Ve=n(2809),Ge=n(69657),ze=n(85406),We=n(62351),Ke=n(16230),Ye=n(69669),Je=n(64109);const Qe=e=>{var t,n;return P.createElement("svg",Object.assign({width:null!==(t=e.width)&&void 0!==t?t:"130",height:null!==(n=e.height)&&void 0!==n?n:"102",viewBox:"0 0 130 102",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e),P.createElement("g",{clipPath:"url(#clip0_4212_90419)"},P.createElement("path",{d:"M2.50001 16L2.5 31L127.5 31L127.5 75L66 75",stroke:"var(--center-channel-color)",strokeOpacity:"0.32",strokeLinecap:"round"}),P.createElement("path",{d:"M2.5 69L2.5 42L29 42",stroke:"var(--center-channel-color)",strokeOpacity:"0.32",strokeLinecap:"round"}),P.createElement("path",{d:"M18.5 70.5L18.5 56.5L106 56.5",stroke:"var(--center-channel-color)",strokeOpacity:"0.32",strokeLinecap:"round"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 16)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 74)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 16 74)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"71",cy:"59",r:"43",fill:"var(--center-channel-color)",fillOpacity:"0.12"}),P.createElement("path",{d:"M110.748 91.5258L119 100V56C119 54.8954 118.105 54 117 54H76.0005C74.8959 54 74.0005 54.8954 74.0005 56V88.9211C74.0005 90.0256 74.8959 90.9211 76.0005 90.9211H109.316C109.855 90.9211 110.372 91.1391 110.748 91.5258Z",fill:"#28427B"}),P.createElement("circle",{opacity:"0.48",cx:"86.831",cy:"65.831",r:"5.83099",fill:"var(--button-color)"}),P.createElement("path",{opacity:"0.4",d:"M96 64H112",stroke:"var(--button-color-rgb)",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M82 79H103.38",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M82 83H96.2535",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M96 68H110",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M82 75H93.0141",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M95.6064 75H107.268",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),P.createElement("path",{d:"M28.605 67.5638L15 81V12C15 10.8954 15.8954 10 17 10H83C84.1046 10 85 10.8954 85 12V64.9868C85 66.0914 84.1046 66.9868 83 66.9868H30.0103C29.4842 66.9868 28.9793 67.1941 28.605 67.5638Z",fill:"var(--center-channel-bg)"}),P.createElement("path",{d:"M28.2536 67.2081L15.5 79.8035V12C15.5 11.1716 16.1716 10.5 17 10.5H83C83.8284 10.5 84.5 11.1716 84.5 12V64.9868C84.5 65.8153 83.8284 66.4868 83 66.4868H30.0103C29.3527 66.4868 28.7215 66.746 28.2536 67.2081Z",stroke:"var(--center-channel-color)",strokeOpacity:"0.8"}),P.createElement("circle",{cx:"33",cy:"29",r:"9",fill:"var(--center-channel-color)",fillOpacity:"0.4"}),P.createElement("path",{d:"M48 25H64",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 49H62",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 55H47",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M48 31H73",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 43H42",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M46 43H64",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("circle",{cx:"78",cy:"19",r:"19",fill:"#32539A"}),P.createElement("path",{d:"M98 49L80 49",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("path",{d:"M76 49L70 49",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("path",{d:"M67 49L65 49",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("circle",{cx:"44",cy:"75",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"52",cy:"75",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"60",cy:"75",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("rect",{x:"70.5",y:"15.5",width:"15",height:"12",rx:"1.5",stroke:"var(--button-color)"}),P.createElement("path",{d:"M73 16V13C73 10.2386 75.2386 8 78 8V8C80.7614 8 83 10.2386 83 13V16",stroke:"var(--button-color)"})),P.createElement("defs",null,P.createElement("clipPath",{id:"clip0_4212_90419"},P.createElement("rect",{width:"130",height:"102",fill:"white"}))))};Qe.propTypes={width:B().number,height:B().number};const Ze=Qe,Xe=e=>{var t,n;return O().createElement("svg",{width:null!==(t=e.width)&&void 0!==t?t:"130",height:null!==(n=e.height)&&void 0!==n?n:"102",viewBox:"0 0 130 102",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},O().createElement("g",{clipPath:"url(#clip0_4212_90121)"},O().createElement("path",{d:"M2.50001 16L2.5 31L127.5 31L127.5 75L66 75",stroke:"rgba(var(--center-channel-color-rgb), 0.32)",strokeLinecap:"round"}),O().createElement("path",{d:"M2.5 69L2.5 42L29 42",stroke:"rgba(var(--center-channel-color-rgb), 0.32)",strokeLinecap:"round"}),O().createElement("path",{d:"M18.5 70.5L18.5 56.5L106 56.5",stroke:"rgba(var(--center-channel-color-rgb), 0.32)",strokeLinecap:"round"}),O().createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 16)",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),O().createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 74)",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),O().createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 16 74)",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),O().createElement("circle",{cx:"71",cy:"59",r:"43",fill:"rgba(var(--center-channel-color-rgb), 0.12)"}),O().createElement("path",{d:"M110.748 91.5258L119 100V56C119 54.8954 118.105 54 117 54H76.0005C74.8959 54 74.0005 54.8954 74.0005 56V88.9211C74.0005 90.0256 74.8959 90.9211 76.0005 90.9211H109.316C109.855 90.9211 110.372 91.1391 110.748 91.5258Z",fill:"#28427B"}),O().createElement("circle",{opacity:"0.48",cx:"86.831",cy:"65.831",r:"5.83099",fill:"var(--button-color)"}),O().createElement("path",{opacity:"0.4",d:"M96 64H112",stroke:"var(--button-color-rgb)",strokeLinecap:"round"}),O().createElement("path",{opacity:"0.4",d:"M82 79H103.38",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),O().createElement("path",{opacity:"0.4",d:"M82 83H96.2535",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),O().createElement("path",{opacity:"0.4",d:"M96 68H110",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),O().createElement("path",{opacity:"0.4",d:"M82 75H93.0141",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),O().createElement("path",{opacity:"0.4",d:"M95.6064 75H107.268",stroke:"rgba(var(--button-color-rgb))",strokeLinecap:"round"}),O().createElement("path",{d:"M28.605 67.5638L15 81V12C15 10.8954 15.8954 10 17 10H83C84.1046 10 85 10.8954 85 12V64.9868C85 66.0914 84.1046 66.9868 83 66.9868H30.0103C29.4842 66.9868 28.9793 67.1941 28.605 67.5638Z",fill:"rgba(var(--center-channel-bg-rgb))"}),O().createElement("path",{d:"M28.2536 67.2081L15.5 79.8035V12C15.5 11.1716 16.1716 10.5 17 10.5H83C83.8284 10.5 84.5 11.1716 84.5 12V64.9868C84.5 65.8153 83.8284 66.4868 83 66.4868H30.0103C29.3527 66.4868 28.7215 66.746 28.2536 67.2081Z",stroke:"rgba(var(--center-channel-color-rgb), 0.8)"}),O().createElement("circle",{cx:"33",cy:"29",r:"9",fill:"rgba(var(--center-channel-color-rgb), 0.4)"}),O().createElement("path",{d:"M48 25H64",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),O().createElement("path",{d:"M25 49H62",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),O().createElement("path",{d:"M25 55H47",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),O().createElement("path",{d:"M48 31H73",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),O().createElement("path",{d:"M25 43H42",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),O().createElement("path",{d:"M46 43H64",stroke:"rgba(var(--center-channel-color-rgb), 0.4)",strokeLinecap:"round"}),O().createElement("circle",{cx:"78",cy:"19",r:"19",fill:"#32539A"}),O().createElement("path",{d:"M98 49L80 49",stroke:"rgba(var(--center-channel-color-rgb), 0.8)",strokeLinecap:"round",strokeLinejoin:"round"}),O().createElement("path",{d:"M76 49L70 49",stroke:"rgba(var(--center-channel-color-rgb), 0.8)",strokeLinecap:"round",strokeLinejoin:"round"}),O().createElement("path",{d:"M67 49L65 49",stroke:"rgba(var(--center-channel-color-rgb), 0.8)",strokeLinecap:"round",strokeLinejoin:"round"}),O().createElement("circle",{cx:"44",cy:"75",r:"2",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),O().createElement("circle",{cx:"52",cy:"75",r:"2",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),O().createElement("circle",{cx:"60",cy:"75",r:"2",fill:"rgba(var(--center-channel-color-rgb), 0.32)"}),O().createElement("circle",{cx:"78",cy:"19",r:"9.5",stroke:"rgba(var(--button-color-rgb))"}),O().createElement("path",{d:"M87.5 20.2525C86.1859 21.8482 82.4292 23 78 23C73.5708 23 69.8141 21.8482 68.5 20.2525",stroke:"rgba(var(--button-color-rgb))"}),O().createElement("path",{d:"M86.6622 15C84.9331 16.1956 81.7014 17 78 17C74.2986 17 71.0669 16.1956 69.3378 15",stroke:"rgba(var(--button-color-rgb))"}),O().createElement("path",{d:"M81.5 19C81.5 21.7141 81.059 24.1482 80.3642 25.8854C80.0162 26.7553 79.6144 27.4258 79.1937 27.8706C78.7741 28.3143 78.3705 28.5 78 28.5C77.6295 28.5 77.2259 28.3143 76.8063 27.8706C76.3856 27.4258 75.9838 26.7553 75.6358 25.8854C74.941 24.1482 74.5 21.7141 74.5 19C74.5 16.2859 74.941 13.8518 75.6358 12.1146C75.9838 11.2447 76.3856 10.5742 76.8063 10.1294C77.2259 9.6857 77.6295 9.5 78 9.5C78.3705 9.5 78.7741 9.6857 79.1937 10.1294C79.6144 10.5742 80.0162 11.2447 80.3642 12.1146C81.059 13.8518 81.5 16.2859 81.5 19Z",stroke:"rgba(var(--button-color-rgb))"})),O().createElement("defs",null,O().createElement("clipPath",{id:"clip0_4212_90121"},O().createElement("rect",{width:"130",height:"102",fill:"rgba(var(--center-channel-bg-rgb))"}))))};Xe.propTypes={width:B().number,height:B().number};const $e=Xe,et=e=>{var t,n;return P.createElement("svg",Object.assign({width:null!==(t=e.width)&&void 0!==t?t:"130",height:null!==(n=e.height)&&void 0!==n?n:"92",viewBox:"0 0 130 92",fill:"none",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},e),P.createElement("g",{clipPath:"url(#clip0_4210_88396)"},P.createElement("path",{d:"M2.50001 6.00001L2.5 21L127.5 21L127.5 65L66 65",stroke:"var(--center-channel-color)",strokeOpacity:"0.24",strokeLinecap:"round"}),P.createElement("path",{d:"M2.49999 59L2.49999 32L29 32",stroke:"var(--center-channel-color)",strokeOpacity:"0.24",strokeLinecap:"round"}),P.createElement("path",{d:"M18.5 60.5L18.5 46.5L106 46.5",stroke:"var(--center-channel-color)",strokeOpacity:"0.24",strokeLinecap:"round"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 6)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 0 64)",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 8.74228e-08 8.74228e-08 -1 16 64)",fill:"var(--center-channel-color)",fillOpacity:"0.4"}),P.createElement("circle",{cx:"71",cy:"49",r:"43",fill:"var(--center-channel-color)",fillOpacity:"0.12"}),P.createElement("path",{d:"M109.748 82.5258L117.999 91V47C117.999 45.8954 117.104 45 115.999 45H74.9998C73.8952 45 72.9998 45.8954 72.9998 47V79.9211C72.9998 81.0256 73.8952 81.9211 74.9998 81.9211H108.315C108.855 81.9211 109.371 82.1391 109.748 82.5258Z",fill:"#28427B"}),P.createElement("circle",{opacity:"0.48",cx:"85.8309",cy:"56.831",r:"5.83099",fill:"#FFFFFF"}),P.createElement("path",{opacity:"0.4",d:"M94.9999 55H111",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M80.9999 70H102.38",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M80.9999 74H95.2535",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M94.9999 59H109",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M80.9999 66H92.014",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{opacity:"0.4",d:"M94.6064 66H106.268",stroke:"#FFFFFF",strokeLinecap:"round"}),P.createElement("path",{d:"M28.605 57.5638L15 71V2C15 0.895431 15.8954 0 17 0H83C84.1046 0 85 0.89543 85 2V54.9868C85 56.0914 84.1046 56.9868 83 56.9868H30.0103C29.4842 56.9868 28.9793 57.1941 28.605 57.5638Z",fill:"var(--center-channel-bg)"}),P.createElement("path",{d:"M28.2536 57.2081L15.5 69.8035V2C15.5 1.17157 16.1716 0.5 17 0.5H83C83.8284 0.5 84.5 1.17157 84.5 2V54.9868C84.5 55.8153 83.8284 56.4868 83 56.4868H30.0103C29.3527 56.4868 28.7215 56.746 28.2536 57.2081Z",stroke:"var(--center-channel-color)",strokeOpacity:"0.8"}),P.createElement("circle",{cx:"33",cy:"19",r:"9",fill:"var(--center-channel-color)",fillOpacity:"0.4"}),P.createElement("path",{d:"M48 15H64",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 39H69",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 45H47",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M48 21H73",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M25 33H42",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("path",{d:"M46 33H64",stroke:"var(--center-channel-color)",strokeOpacity:"0.4",strokeLinecap:"round"}),P.createElement("circle",{cx:"44",cy:"65",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"52",cy:"65",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("circle",{cx:"60",cy:"65",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),P.createElement("path",{d:"M101 33L83 33",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("path",{d:"M79 33L73 33",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),P.createElement("path",{d:"M70 33L68 33",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"})),P.createElement("defs",null,P.createElement("clipPath",{id:"clip0_4210_88396"},P.createElement("rect",{width:"130",height:"92",fill:"white"}))))};et.propTypes={width:B().number,height:B().number};const tt=et;var nt=n(64182),at=n(57486),st=n(26808),rt=n(61767),it=n(12762),ot=n(72180),lt=n(45036),ct=n(40142),dt=n(46),ut=n(49888),mt=n(53654);const ht=e=>{let{totalUsers:t,usersLimit:n,channel:s,pluginButtons:r}=e;const i=(0,a.useSelector)(o.Sy);if(!t)return O().createElement(mt.A,null);const l=t<n;return O().createElement(st.A,{teamId:i,permissions:[he.xB.ADD_USER_TO_TEAM,he.xB.INVITE_GUEST]},l?O().createElement(pt,{pluginButtons:r}):O().createElement(gt,{channel:s,pluginButtons:r}))};ht.propTypes={totalUsers:B().number,usersLimit:B().number.isRequired,pluginButtons:B().node};const pt=e=>{let{pluginButtons:t}=e;const{formatMessage:n}=(0,ce.useIntl)();return O().createElement(O().Fragment,null,t,O().createElement("div",{className:"LessThanMaxFreeUsers"},O().createElement(it.A,{id:"introTextInvite",className:"btn btn-sm btn-primary",modalId:Y.IQ.INVITATION,dialogType:ut.default,dialogProps:{focusOriginElement:"browseOrAddChannelMenuButton"}},O().createElement("i",{className:"icon-email-plus-outline",title:n({id:"generic_icons.add",defaultMessage:"Add Icon"}),"aria-hidden":"true"}),O().createElement(ce.FormattedMessage,{id:"intro_messages.inviteOthersToWorkspace.button",defaultMessage:"Invite others to the workspace"}))))},gt=e=>{let{channel:t,pluginButtons:n}=e;const{formatMessage:a}=(0,ce.useIntl)(),s=t.group_constrained?Y.IQ.ADD_GROUPS_TO_CHANNEL:Y.IQ.CHANNEL_INVITE,r=t.group_constrained?ct.A:dt.A;if(0!==t.delete_at)return null;const i=t.type===Y.YM.PRIVATE_CHANNEL;return O().createElement("div",{className:"MoreThanMaxFreeUsersWrapper"},O().createElement("div",{className:"MoreThanMaxFreeUsers"},O().createElement(at.A,{channelId:t.id,teamId:t.team_id,permissions:[i?he.xB.MANAGE_PRIVATE_CHANNEL_MEMBERS:he.xB.MANAGE_PUBLIC_CHANNEL_MEMBERS]},O().createElement(it.A,{className:"action-button",modalId:s,dialogType:r,dialogProps:{channel:t}},O().createElement("i",{className:"icon-account-plus-outline",title:a({id:"generic_icons.add",defaultMessage:"Add Icon"}),"aria-hidden":"true"}),t.group_constrained&&O().createElement(ce.FormattedMessage,{id:"intro_messages.inviteGropusToChannel.button",defaultMessage:"Add groups"}),!t.group_constrained&&O().createElement(ce.FormattedMessage,{id:"intro_messages.inviteMembersToChannel.button",defaultMessage:"Add people"})))),n)},ft=O().memo(ht);var bt=n(21650),Et=n(66935);const Ct=O().memo((e=>{let{channel:t,pluginButtons:n,channelMember:a}=e;const s=0!==t.delete_at;if(!(0,Et.K)(t.id))return null;if(s||0===n.length||!a)return null;const r=n.map((e=>O().createElement("button",{key:e.id,className:"action-button",onClick:()=>{var n;return null===(n=e.action)||void 0===n?void 0:n.call(e,t,a)}},e.icon,e.text)));return O().createElement(O().Fragment,null,r)}));Ct.propTypes={pluginButtons:B().array.isRequired},Ct.displayName="PluggableIntroButtons";const vt=Ct,yt=(0,a.connect)((function(e,t){return{channelMember:(0,r.M9)(e,t.channel.id),pluginButtons:(0,bt.qm)(e)}}))(vt);function Mt(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class _t extends O().PureComponent{constructor(){super(...arguments),Mt(this,"toggleFavorite",(()=>{this.props.channel&&(this.props.isFavorite?this.props.actions.unfavoriteChannel(this.props.channel.id):this.props.actions.favoriteChannel(this.props.channel.id))}))}componentDidMount(){var e;null!==(e=this.props.stats)&&void 0!==e&&e.total_users_count||this.props.actions.getTotalUsersStats()}render(){const{currentUserId:e,channel:t,fullWidth:n,locale:a,channelProfiles:s,enableUserCreation:r,isReadOnly:i,isFavorite:o,teamIsGroupConstrained:l,creatorName:c,teammate:d,teammateName:u,currentUser:m,stats:h,usersLimit:p,channelMember:g,isMobileView:f}=this.props;let b="";return n||(b="channel-intro--centered"),t?t.type===Y.YM.DM_CHANNEL?function(e,t,n,a,s,r,i,o){const l="channelIntro";if(i){const n=i?$.RG(i.id,i.last_picture_update):"";let s=null,c=null;null!=i&&i.is_bot||(s=O().createElement(yt,{channel:e}),c=wt(e));const d=O().createElement("div",{className:"channel-intro__actions"},It(a,r),c,s);return O().createElement("div",{id:l,className:"channel-intro "+t},O().createElement("div",{className:"post-profile-img__container channel-intro-img"},O().createElement(rt.A,{src:n,size:"xl-custom-DM",status:i.is_bot?"":e.status,userId:null==i?void 0:i.id,username:null==i?void 0:i.username})),O().createElement("h2",{className:"channel-intro__title"},O().createElement(ot.A,{userId:null==i?void 0:i.id})),O().createElement("p",{className:"channel-intro__text"},O().createElement(ce.FormattedMessage,{id:"intro_messages.DM",defaultMessage:"This is the start of your direct message history with {teammate}. Messages and files shared here are not shown to anyone else.",values:{teammate:o}})),d)}return O().createElement("div",{id:l,className:"channel-intro "+t},O().createElement("p",{className:"channel-intro__text"},O().createElement(ce.FormattedMessage,{id:"intro_messages.teammate",defaultMessage:"This is the start of your direct message history with this teammate. Messages and files shared here are not shown to anyone else."})))}(t,b,0,o,0,this.toggleFavorite,d,u):t.type===Y.YM.GM_CHANNEL?function(e,t,n,a,s,r,i,o,l){const c="channelIntro";if(r.length>0){const d=r.find((e=>e.id===i)),u=r.filter((e=>e.id!==i)).map((e=>O().createElement(rt.A,{key:"introprofilepicture"+e.id,src:$.RG(e.id,e.last_picture_update),size:"xl-custom-GM",userId:e.id,username:e.username}))),m=O().createElement("div",{className:"channel-intro__actions"},It(n,s),wt(e),!a&&At(e,o),O().createElement(yt,{channel:e}));return O().createElement("div",{id:c,className:"channel-intro "+t},O().createElement("div",{className:"post-profile-img__container channel-intro-img channel-intro-img__group"},u),O().createElement("h2",{className:"channel-intro__title"},e.display_name),O().createElement("p",{className:"channel-intro__text"},O().createElement(ce.FormattedMessage,{id:"intro_messages.group_message",defaultMessage:"This is the start of your group message history with these teammates. "}),St(d,l)),m)}return O().createElement("div",{id:c,className:"channel-intro "+t},O().createElement("p",{className:"channel-intro__text"},O().createElement(ce.FormattedMessage,{id:"intro_messages.group_message",defaultMessage:"This is the start of your group message history with these teammates. Messages and files shared here are not shown to people outside this area."})))}(t,b,o,f,this.toggleFavorite,s,e,m,g):t.name===Y.YM.DEFAULT_CHANNEL?function(e,t,n,a,s,r,i,o,l,c,d){let u=null;const m=i.total_users_count,h=e.type===Y.YM.PRIVATE_CHANNEL,p=m<o;let g=null,f=null,b=null;if(!c){f=O().createElement(yt,{channel:e});const t=wt(e);t&&(g=O().createElement(at.A,{teamId:e.team_id,channelId:e.id,permissions:[h?he.xB.MANAGE_PRIVATE_CHANNEL_PROPERTIES:he.xB.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},t))}return!c&&l&&(u=O().createElement(st.A,{teamId:e.team_id,permissions:[he.xB.INVITE_USER]},O().createElement(st.A,{teamId:e.team_id,permissions:[he.xB.ADD_USER_TO_TEAM]},!d&&O().createElement(ft,{totalUsers:m,usersLimit:o,channel:e,pluginButtons:f}),d&&O().createElement(it.A,{className:"intro-links color--link",modalId:Y.IQ.ADD_GROUPS_TO_TEAM,dialogType:Ye.A,dialogProps:{channel:e}},O().createElement("i",{className:"fa fa-user-plus"}),O().createElement(ce.FormattedMessage,{id:"intro_messages.addGroupsToTeam",defaultMessage:"Add other groups to this team"}))))),b=p?O().createElement("div",{className:"channel-intro__actions"},b=u):O().createElement("div",{className:"channel-intro__actions"},It(a,r),g,At(e,n),d&&f),O().createElement("div",{id:"channelIntro",className:"channel-intro "+t},O().createElement(tt,null),O().createElement("h2",{className:"channel-intro__title"},e.display_name),O().createElement("p",{className:"channel-intro__text"},!c&&O().createElement(ce.FormattedMessage,{id:"intro_messages.default",defaultMessage:"Welcome to {display_name}. Post messages here that you want everyone to see. Everyone automatically becomes a member of this channel when they join the team.",values:{display_name:e.display_name}}),c&&O().createElement(ce.FormattedMessage,{id:"intro_messages.readonly.default",defaultMessage:"Welcome to {display_name}. Messages can only be posted by admins. Everyone automatically becomes a permanent member of this channel when they join the team.",values:{display_name:e.display_name}})),b)}(t,b,m,o,0,this.toggleFavorite,h,p,r,i,l):t.name===Y.YM.OFFTOPIC_CHANNEL?function(e,t,n,a,s,r,i,o){const l=e.type===Y.YM.PRIVATE_CHANNEL,c=wt(e),d=i.total_users_count,u=d<o;let m=null,h=null;c&&(m=O().createElement(at.A,{teamId:e.team_id,channelId:e.id,permissions:[l?he.xB.MANAGE_PRIVATE_CHANNEL_PROPERTIES:he.xB.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},c));const p=O().createElement(ft,{totalUsers:d,usersLimit:o,channel:e,pluginButtons:O().createElement(yt,{channel:e})});return h=u?O().createElement("div",{className:"channel-intro__actions"},h=p):O().createElement("div",{className:"channel-intro__actions"},It(n,r),m,At(e,s)),O().createElement("div",{id:"channelIntro",className:"channel-intro "+t},O().createElement($e,null),O().createElement("h2",{className:"channel-intro__title"},e.display_name),O().createElement("p",{className:"channel-intro__text"},O().createElement(ce.FormattedMessage,{id:"intro_messages.offTopic",defaultMessage:"This is the start of {display_name}, a channel for non-work-related conversations.",values:{display_name:e.display_name}})),h)}(t,b,o,0,m,this.toggleFavorite,h,p):t.type===Y.YM.OPEN_CHANNEL||t.type===Y.YM.PRIVATE_CHANNEL?function(e,t,n,a,s,r,i,o,l,c){const d=e.display_name;let u,m=null;const h=0!==e.delete_at,p=i.total_users_count,g=p<o;u=h?"":e.type===Y.YM.PRIVATE_CHANNEL?O().createElement(ce.FormattedMessage,{id:"intro_messages.onlyInvited",defaultMessage:"This is the start of {display_name}. Only invited members can see this private channel.",values:{display_name:e.display_name}}):O().createElement(ce.FormattedMessage,{id:"intro_messages.anyMember",defaultMessage:"This is the start of {display_name}. Any team member can join and read this channel.",values:{display_name:e.display_name}});const f=O().createElement(ce.FormattedDate,{value:e.create_at,month:(0,lt.FS)(l),day:"2-digit",year:"numeric"});let b,E;""===c?e.type===Y.YM.PRIVATE_CHANNEL?b=O().createElement(ce.FormattedMessage,{id:"intro_messages.noCreatorPrivate",defaultMessage:"Private channel created on {date}.",values:{name:d,date:f}}):e.type===Y.YM.OPEN_CHANNEL&&(b=O().createElement(ce.FormattedMessage,{id:"intro_messages.noCreator",defaultMessage:"Public channel created on {date}.",values:{name:d,date:f}})):e.type===Y.YM.PRIVATE_CHANNEL?b=O().createElement("span",null,O().createElement(ce.FormattedMessage,{id:"intro_messages.creatorPrivate",defaultMessage:"Private channel created by {creator} on {date}.",values:{name:d,creator:c,date:f}})):e.type===Y.YM.OPEN_CHANNEL&&(b=O().createElement("span",null,O().createElement(ce.FormattedMessage,{id:"intro_messages.creator",defaultMessage:"Public channel created by {creator} on {date}.",values:{name:d,creator:c,date:f}}))),e.purpose&&""!==e.purpose&&(E=O().createElement("span",null,O().createElement(ce.FormattedMessage,{id:"intro_messages.purpose",defaultMessage:" This channel's purpose is: {purpose}",values:{purpose:e.purpose}})));const C=e.type===Y.YM.PRIVATE_CHANNEL;let v=null,y=null;const M=wt(e);return M&&(v=O().createElement(at.A,{teamId:e.team_id,channelId:e.id,permissions:[C?he.xB.MANAGE_PRIVATE_CHANNEL_PROPERTIES:he.xB.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},M)),m=O().createElement(ft,{totalUsers:p,usersLimit:o,channel:e,pluginButtons:O().createElement(yt,{channel:e})}),y=g?O().createElement("div",{className:"channel-intro__actions"},y=m):O().createElement("div",{className:"channel-intro__actions"},It(a,r),m,v,!s&&At(e,n),O().createElement(yt,{channel:e})),O().createElement("div",{id:"channelIntro",className:"channel-intro "+t},C?O().createElement(Ze,null):O().createElement($e,null),O().createElement("h2",{className:"channel-intro__title"},e.display_name),O().createElement("div",{className:"channel-intro__created"},C?O().createElement(ze.LockOutlineIcon,{size:14}):O().createElement(ze.GlobeIcon,{size:14}),b),O().createElement("p",{className:"channel-intro__text"},u,E),y)}(t,b,m,o,f,this.toggleFavorite,h,p,a,c):null:null}}Mt(_t,"propTypes",{currentUserId:B().string.isRequired,fullWidth:B().bool.isRequired,locale:B().string.isRequired,channelProfiles:B().array.isRequired,enableUserCreation:B().bool,isReadOnly:B().bool,isFavorite:B().bool.isRequired,teamIsGroupConstrained:B().bool,creatorName:B().string.isRequired,teammateName:B().string,stats:B().any.isRequired,usersLimit:B().number.isRequired,isMobileView:B().bool.isRequired,actions:B().shape({getTotalUsersStats:B().func.isRequired,favoriteChannel:B().func.isRequired,unfavoriteChannel:B().func.isRequired}).isRequired});const Tt=(0,ce.defineMessages)({muted:{id:"intro_messages.GM.muted",defaultMessage:"This group message is currently <b>muted</b>, so you will not be notified."},[We.S.ALL]:{id:"intro_messages.GM.all",defaultMessage:"You'll be notified <b>for all activity</b> in this group message."},[We.S.DEFAULT]:{id:"intro_messages.GM.all",defaultMessage:"You'll be notified <b>for all activity</b> in this group message."},[We.S.MENTION]:{id:"intro_messages.GM.mention",defaultMessage:"You have selected to be notified <b>only when mentioned</b> in this group message."},[We.S.NONE]:{id:"intro_messages.GM.none",defaultMessage:"You have selected to <b>never</b> be notified in this group message."}}),St=(e,t)=>{var n,a;if((0,Ke.X4)(t))return O().createElement(ce.FormattedMessage,Object.assign({},Tt.muted,{values:{b:e=>O().createElement("b",null,e)}}));const s=(null==t||null===(n=t.notify_props)||void 0===n?void 0:n.desktop)||We.S.DEFAULT,r=(null==e||null===(a=e.notify_props)||void 0===a?void 0:a.desktop)||We.S.MENTION;let i=s;return i===We.S.DEFAULT&&(i=r),s===We.S.DEFAULT&&r===We.S.MENTION&&(i=We.S.ALL),O().createElement(ce.FormattedMessage,Object.assign({},Tt[i],{values:{b:e=>O().createElement("b",null,e)}}))};function wt(e){return 0!==e.delete_at?null:O().createElement(it.A,{modalId:Y.IQ.EDIT_CHANNEL_HEADER,ariaLabel:$.Vw({id:"intro_messages.setHeader",defaultMessage:"Set header"}),className:"action-button",dialogType:nt.A,dialogProps:{channel:e}},O().createElement(ze.PencilOutlineIcon,{size:24}),O().createElement(ce.FormattedMessage,{id:"intro_messages.setHeader",defaultMessage:"Set header"}))}function It(e,t,n){let a;return a=e?O().createElement(ce.FormattedMessage,{id:"channel_info_rhs.top_buttons.favorited",defaultMessage:"Favorited"}):O().createElement(ce.FormattedMessage,{id:"channel_info_rhs.top_buttons.favorite",defaultMessage:"Favorite"}),O().createElement("button",{id:"toggleFavoriteIntroButton",className:"action-button ".concat(e?"active":"","  ").concat(n),onClick:t,"aria-label":"Favorite"},e?O().createElement(ze.StarIcon,{size:24}):O().createElement(ze.StarOutlineIcon,{size:24}),a)}function At(e,t){return O().createElement(it.A,{id:"channelIntroNotificationPreferencesButton",modalId:Y.IQ.CHANNEL_NOTIFICATIONS,ariaLabel:$.Vw({id:"intro_messages.notificationPreferences",defaultMessage:"Notification Preferences"}),className:"action-button",dialogType:Je.A,dialogProps:{channel:e,currentUser:t,focusOriginElement:"channelIntroNotificationPreferencesButton"}},O().createElement(ze.BellRingOutlineIcon,{size:24}),O().createElement(ce.FormattedMessage,{id:"intro_messages.notificationPreferences",defaultMessage:"Notifications"}))}const Rt=(0,a.connect)((function(e){const t="true"===(0,i.zj)(e).EnableUserCreation,n=(0,o.H7)(e),a=(0,r.Lw)(e),s=(0,r.tW)(e),c=a?(0,r.yH)(e,a.id):void 0,d=(0,l.HW)(e),u=a?(0,l.wz)(e,a.creator_id):void 0,m=(0,l.ig)(e)||{total_users_count:0};return{currentUserId:(0,l.WR)(e),channel:a,fullWidth:(0,b.Jt)(e,Y.pm.CATEGORY_DISPLAY_SETTINGS,Y.pm.CHANNEL_DISPLAY_MODE,Y.pm.CHANNEL_DISPLAY_MODE_DEFAULT)===Y.pm.CHANNEL_DISPLAY_MODE_FULL_SCREEN,locale:(0,Ge.k)(e),channelProfiles:(0,l.Gv)(e),enableUserCreation:t,isReadOnly:!1,isFavorite:(0,r.TJ)(e),teamIsGroupConstrained:Boolean(null==n?void 0:n.group_constrained),creatorName:(0,$.GZ)(e,u),teammate:c,teammateName:(0,$.GZ)(e,c),currentUser:d,stats:m,usersLimit:10,channelMember:s,isMobileView:(0,V.w3)(e)}}),(function(e){return{actions:(0,G.bindActionCreators)({getTotalUsersStats:z.ig,favoriteChannel:s.yc,unfavoriteChannel:s.XJ},e)}}))(_t);var Nt,Pt,Ot,Lt=n(42599),Dt=n(50800),kt=n(76261);class Ft extends O().PureComponent{blockShortcutReactToLastPostForNonMessages(e){const{actions:{emitShortcutReactToLastPostFrom:t}}=this.props;(0,be.Bn)(e)&&t(Y.Hc.NO_WHERE)}componentDidUpdate(e){const{listId:t,isLastPost:n,shortcutReactToLastPostEmittedFrom:a}=this.props,s=e.shortcutReactToLastPostEmittedFrom!==a&&a===Y.Hc.CENTER;n&&s&&this.blockShortcutReactToLastPostForNonMessages(t)}render(){const{listId:e,previousListId:t,loadingOlderPosts:n,loadingNewerPosts:a}=this.props,{OLDER_MESSAGES_LOADER:s,NEWER_MESSAGES_LOADER:r,CHANNEL_INTRO_MESSAGE:i,LOAD_OLDER_MESSAGES_TRIGGER:o,LOAD_NEWER_MESSAGES_TRIGGER:l}=Y.D3;if(fe.fE(e)){const t=fe.GG(e);return O().createElement(Dt.A,{key:t,date:t})}if(fe.OO(e))return O().createElement(kt.A,{separatorId:e,newMessagesSeparatorActions:this.props.newMessagesSeparatorActions,channelId:this.props.channelId});if(this.props.exceededLimitChannelId)return O().createElement(je.A,null);if(e===i)return O().createElement(Rt,null);if(e===o||e===l)return O().createElement("button",{className:"more-messages-text theme style--none color--link",onClick:e===o?this.props.loadOlderPosts:this.props.loadNewerPosts},O().createElement(ce.FormattedMessage,{id:"posts_view.loadMore",defaultMessage:"Load More Messages"}));if(e===s||e===r){const e=!n&&!a;return O().createElement("div",{className:"loading-screen"},O().createElement("div",{className:q()("loading__content",{hideAnimation:e})},O().createElement("div",{className:"round round-1"}),O().createElement("div",{className:"round round-2"}),O().createElement("div",{className:"round round-3"})))}const c={previousPostId:t,shouldHighlight:Boolean(this.props.shouldHighlight),togglePostMenu:this.props.togglePostMenu,isLastPost:this.props.isLastPost};return fe.mD(e)?O().createElement(Lt.A,Object.assign({location:Y.Hc.CENTER,combinedId:e},c)):O().createElement(Ve.A,Object.assign({post:this.props.post,location:Y.Hc.CENTER},c))}}Nt=Ft,Pt="propTypes",Ot={listId:B().string.isRequired,previousListId:B().string,fullWidth:B().bool,shouldHighlight:B().bool,loadOlderPosts:B().func.isRequired,loadNewerPosts:B().func.isRequired,togglePostMenu:B().func.isRequired,isLastPost:B().bool.isRequired,shortcutReactToLastPostEmittedFrom:B().string.isRequired,loadingNewerPosts:B().bool.isRequired,loadingOlderPosts:B().bool.isRequired,exceededLimitChannelId:B().string,firstInaccessiblePostTime:B().number,channelId:B().string.isRequired,newMessagesSeparatorActions:B().array.isRequired,actions:B().shape({emitShortcutReactToLastPostFrom:B().any.isRequired}).isRequired},(Pt=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(Pt))in Nt?Object.defineProperty(Nt,Pt,{value:Ot,enumerable:!0,configurable:!0,writable:!0}):Nt[Pt]=Ot;const xt=(0,a.connect)((function(e,t){const n={shortcutReactToLastPostEmittedFrom:(0,qe.l6)(e),post:(0,pe.f5)(e,t.listId),currentUserId:(0,f.WR)(e),newMessagesSeparatorActions:e.plugins.components.NewMessagesSeparatorAction};if(t.listId===Y.D3.OLDER_MESSAGES_LOADER||t.listId===Y.D3.CHANNEL_INTRO_MESSAGE){const t=(0,f.eH)(e),a=(0,pe.VT)(e).channels[t];(Boolean(a)||0===a)&&(n.exceededLimitChannelId=t,n.firstInaccessiblePostTime=a)}return n}),(function(e){return{actions:(0,G.bindActionCreators)({emitShortcutReactToLastPostFrom:He.Sq},e)}}))(Ft);function Ut(e){const{formatMessage:t}=(0,ce.useIntl)();return O().createElement("span",e,O().createElement("svg",{x:"0px",y:"0px",viewBox:"-239 239 21 23",enableBackground:"new -239 239 21 23",role:"img","aria-label":t({id:"generic_icons.arrow.down",defaultMessage:"Down Arrow Icon"})},O().createElement("path",{d:"M-239,241.4l2.4-2.4l8.1,8.2l8.1-8.2l2.4,2.4l-10.5,10.6L-239,241.4z M-228.5,257.2l8.1-8.2l2.4,2.4l-10.5,10.6l-10.5-10.6 l2.4-2.4L-228.5,257.2z"})))}const Bt=e=>{let{isScrolling:t,atBottom:n,onClick:a}=e;return window.innerWidth>768?null:O().createElement("div",{className:q()("post-list__arrows",{scrolling:t&&!1===n}),onClick:a},O().createElement(Ut,null))};Bt.propTypes={isScrolling:B().bool.isRequired,atBottom:B().bool,onClick:B().func.isRequired};const Ht=Bt;n(76409);var qt=n(8361),jt=n(99044);const Vt=e=>{let{children:t,onDismiss:n}=e;return O().createElement("div",{"data-testid":"hint-toast",className:"hint-toast"},O().createElement("div",{className:"hint-toast__message"},t),O().createElement("div",{className:"hint-toast__dismiss",onClick:()=>{"function"==typeof n&&n()},"data-testid":"dismissHintToast"},O().createElement(jt.A,{className:"close-btn",id:"dismissHintToast"})))};Vt.propTypes={children:B().node.isRequired,onDismiss:B().func.isRequired};var Gt=n(87383);const zt=e=>{let{onDismiss:t,onClick:n}=e;const{formatMessage:a}=(0,ce.useIntl)(),s=a({id:"postlist.toast.scrollToBottom",defaultMessage:"Jump to recents"});return O().createElement("div",{"data-testid":"scroll-to-bottom-toast",className:"scroll-to-bottom-toast btn btn-primary",onClick:e=>{e.preventDefault(),n()}},O().createElement(Gt.A,null),s,O().createElement("div",{className:"scroll-to-bottom-toast__dismiss",onClick:e=>{e.preventDefault(),e.stopPropagation(),t()},"data-testid":"scroll-to-bottom-toast--dismiss-button"},O().createElement(jt.A,{className:"close-btn",id:"dismissScrollToBottomToast"})))};zt.propTypes={onDismiss:B().func.isRequired,onClick:B().func.isRequired};const Wt=zt;var Kt=n(83642),Yt=n(77828),Jt=n(89227),Qt=n(83007),Zt=n(36397),Xt=n(19513);function $t(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const en=[Yt.hp.t8];class tn extends O().PureComponent{constructor(e){var t;super(e),t=this,$t(this,"handleShortcut",(e=>{(0,Xt.e)(e,Y.Ay.KeyCodes.ESCAPE)&&(this.state.showUnreadToast?this.hideUnreadToast():this.state.showNewMessagesToast?this.hideNewMessagesToast():this.state.showUnreadWithBottomStartToast?this.hideUnreadWithBottomStartToast():this.hideArchiveToast())})),$t(this,"hideUnreadToast",(()=>{this.state.showUnreadToast&&this.setState({showUnreadToast:!1})})),$t(this,"hideArchiveToast",(()=>{this.state.showMessageHistoryToast&&this.setState({showMessageHistoryToast:!1})})),$t(this,"hideNewMessagesToast",(function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.state.showNewMessagesToast&&(t.setState({showNewMessagesToast:!1}),e&&t.props.updateLastViewedBottomAt())})),$t(this,"hideSearchHintToast",(()=>{this.props.onSearchHintDismiss&&this.props.onSearchHintDismiss()})),$t(this,"hideUnreadWithBottomStartToast",(()=>{this.state.showUnreadWithBottomStartToast&&this.setState({showUnreadWithBottomStartToast:!1})})),$t(this,"newMessagesToastText",((e,t)=>this.props.width>500&&void 0!==t?O().createElement(ce.FormattedMessage,{id:"postlist.toast.newMessagesSince",defaultMessage:"{count, number} new {count, plural, one {message} other {messages}} {isToday, select, true {} other {since}} {date}",values:{count:e,isToday:(0,Zt.cK)(new Date(t)).toString(),date:O().createElement(Yt.Ay,{value:t,useTime:!1,ranges:en})}}):O().createElement(ce.FormattedMessage,{id:"postlist.toast.newMessages",defaultMessage:"{count, number} new {count, plural, one {message} other {messages}}",values:{count:e}}))),$t(this,"archiveToastText",(()=>O().createElement(ce.FormattedMessage,{id:"postlist.toast.history",defaultMessage:"Viewing message history"}))),$t(this,"getSearchHintToastText",(()=>O().createElement(ce.FormattedMessage,{id:"postlist.toast.searchHint",defaultMessage:"Tip: Try {searchShortcut} to search this channel",values:{searchShortcut:O().createElement(Kt.t,null)}}))),$t(this,"changeUrlToRemountChannelView",(()=>{const{match:e}=this.props;(0,Qt.J)().replace("/".concat(e.params.team))})),$t(this,"scrollToNewMessage",(()=>{const{focusedPostId:e,atLatestPost:t,scrollToNewMessage:n,updateLastViewedBottomAt:a}=this.props;!e||t?(n(),a(),this.hideNewMessagesToast()):this.changeUrlToRemountChannelView()})),$t(this,"scrollToLatestMessages",(()=>{var e,t;const{focusedPostId:n,atLatestPost:a,scrollToLatestMessages:s}=this.props;if(n){if(!a)return void this.changeUrlToRemountChannelView();this.hideArchiveToast()}s(),this.hideUnreadToast(),null===(e=(t=this.props).hideScrollToBottomToast)||void 0===e||e.call(t)})),$t(this,"scrollToUnreadMessages",(()=>{this.props.scrollToUnreadMessages(),this.hideUnreadWithBottomStartToast()})),this.state={unreadCountInChannel:e.unreadCountInChannel,unreadCount:0}}static getDerivedStateFromProps(e,t){let n,{showUnreadToast:a,showNewMessagesToast:s,showMessageHistoryToast:r,showUnreadWithBottomStartToast:i}=t;return n=e.atLatestPost?e.unreadScrollPosition===he.pm.UNREAD_SCROLL_POSITION_START_FROM_NEWEST&&t.unreadCountInChannel?t.unreadCountInChannel+e.newRecentMessagesCount:tn.countNewMessages(e.rootPosts,e.isCollapsedThreadsEnabled,e.postListIds):e.channelMarkedAsUnread?e.unreadScrollPosition===he.pm.UNREAD_SCROLL_POSITION_START_FROM_NEWEST?e.unreadCountInChannel+e.newRecentMessagesCount:t.unreadCountInChannel:t.unreadCountInChannel+e.newRecentMessagesCount,void 0===a&&null!==e.atBottom&&(a=n>0&&!e.atBottom),void 0===r&&""!==e.focusedPostId&&null!==e.atBottom&&(r=e.initScrollOffsetFromBottom>1e3||!e.atLatestPost),!e.channelMarkedAsUnread||!1!==e.atBottom||t.channelMarkedAsUnread||t.showUnreadToast||(a=!0),e.channelMarkedAsUnread&&e.lastViewedAt!==t.lastViewedAt&&!1===e.atBottom&&(a=!0),!a&&n>0&&!1===e.atBottom&&e.latestPostTimeStamp&&e.lastViewedBottom<e.latestPostTimeStamp&&(s=!0),e.unreadScrollPosition!==he.pm.UNREAD_SCROLL_POSITION_START_FROM_NEWEST||e.channelMarkedAsUnread||(a=!1),n||(a=!1,s=!1),e.isNewMessageLineReached&&(i=!1),void 0===i&&e.lastViewedAt&&e.lastViewedAt!==t.lastViewedAt&&e.shouldStartFromBottomWhenUnread&&n>0&&!e.isNewMessageLineReached&&(i=!0),{unreadCount:n,showUnreadToast:a,showNewMessagesToast:s,showUnreadWithBottomStartToast:i,lastViewedAt:e.lastViewedAt,atBottom:e.atBottom,channelMarkedAsUnread:e.channelMarkedAsUnread,showMessageHistoryToast:r}}componentDidMount(){this.mounted=!0;const{showUnreadToast:e,showNewMessagesToast:t,showMessageHistoryToast:n,showUnreadWithBottomStartToast:a}=this.state,s=Boolean(e||t||n||a);document.addEventListener("keydown",this.handleShortcut),this.props.actions.updateToastStatus(s)}componentDidUpdate(e,t){const{showUnreadToast:n,showNewMessagesToast:a,showMessageHistoryToast:s,showUnreadWithBottomStartToast:r}=this.state,{atBottom:i,atLatestPost:o,postListIds:l,lastViewedBottom:c,updateNewMessagesAtInChannel:d,actions:u}=this.props;!e.atBottom&&i&&o&&(this.hideNewMessagesToast(!1),this.hideUnreadToast(),this.hideArchiveToast());const m=e.postListIds.length,h=l.length;if(h!==m&&l[0]!==e.postListIds[0]&&!1===i&&o&&h>0&&!n&&d(c),t.showUnreadToast!==n||t.showNewMessagesToast!==a||t.showMessageHistoryToast!==s||t.showUnreadWithBottomStartToast!==r){const e=Boolean(n||a||s||r);u.updateToastStatus(e)}}componentWillUnmount(){document.removeEventListener("keydown",this.handleShortcut)}getToastToRender(){const{atLatestPost:e,atBottom:t,width:n,lastViewedAt:a,showSearchHintToast:s,showScrollToBottomToast:r}=this.props,{showUnreadToast:i,showNewMessagesToast:o,showMessageHistoryToast:l,showUnreadWithBottomStartToast:c,unreadCount:d}=this.state,u={show:!0,width:n,onDismiss:this.hideUnreadToast,onClick:this.scrollToLatestMessages,onClickMessage:O().createElement(ce.FormattedMessage,{id:"postlist.toast.scrollToBottom",defaultMessage:"Jump to recents"}),showActions:!e||e&&!1===t};if(i&&d>0)return O().createElement(Jt.A,u,this.newMessagesToastText(d,a));const m={show:!0,width:n,onDismiss:this.hideUnreadWithBottomStartToast,onClick:this.scrollToUnreadMessages,onClickMessage:O().createElement(ce.FormattedMessage,{id:"postlist.toast.scrollToUnread",defaultMessage:"Jump to unreads"}),showActions:!0,jumpDirection:"up"};if(c&&d>0)return O().createElement(Jt.A,m,this.newMessagesToastText(d,a));if(o){const e={onDismiss:this.hideNewMessagesToast,onClick:this.scrollToNewMessage,onClickMessage:O().createElement(ce.FormattedMessage,{id:"postlist.toast.scrollToLatest",defaultMessage:"Jump to new messages"})};return O().createElement(Jt.A,Object.assign({},u,e),this.newMessagesToastText(d,a))}if(l){const e={show:!0,width:n,onDismiss:this.hideArchiveToast,onClick:this.scrollToLatestMessages,onClickMessage:O().createElement(ce.FormattedMessage,{id:"postlist.toast.scrollToBottom",defaultMessage:"Jump to recents"}),showActions:!0,extraClasses:"toast__history"};return O().createElement(Jt.A,e,this.archiveToastText())}const h=[];return r&&h.push(O().createElement(Wt,{key:"scroll-to-bottom-toast",onClick:this.scrollToLatestMessages,onDismiss:this.props.onScrollToBottomToastDismiss})),s&&h.push(O().createElement(Vt,{key:"search-hint-toast",onDismiss:this.hideSearchHintToast},this.getSearchHintToastText())),h.length>0?O().createElement("div",{className:"toasts-wrapper"},h):null}render(){const e=this.getToastToRender();return O().createElement(O().Fragment,null,e)}}$t(tn,"propTypes",{channelMarkedAsUnread:B().bool,postListIds:B().arrayOf(B().string).isRequired,latestPostTimeStamp:B().number,atBottom:B().oneOfType([B().bool,B().oneOf([null])]),lastViewedBottom:B().number.isRequired,width:B().number.isRequired,focusedPostId:B().string,initScrollOffsetFromBottom:B().number.isRequired,updateNewMessagesAtInChannel:B().func.isRequired,scrollToNewMessage:B().func.isRequired,scrollToLatestMessages:B().func.isRequired,scrollToUnreadMessages:B().func.isRequired,updateLastViewedBottomAt:B().func.isRequired,showSearchHintToast:B().bool.isRequired,onSearchHintDismiss:B().func.isRequired,showScrollToBottomToast:B().bool.isRequired,onScrollToBottomToastDismiss:B().func.isRequired,hideScrollToBottomToast:B().func.isRequired,shouldStartFromBottomWhenUnread:B().bool.isRequired,isNewMessageLineReached:B().bool.isRequired,rootPosts:B().objectOf(B().bool).isRequired,lastViewedAt:B().number.isRequired,newRecentMessagesCount:B().number.isRequired,unreadScrollPosition:B().string.isRequired,isCollapsedThreadsEnabled:B().bool.isRequired}),$t(tn,"defaultProps",{focusedPostId:""}),$t(tn,"countNewMessages",(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a=(0,fe.V)(n);if(a<=0)return 0;let s=n.slice(0,a).filter((e=>!(0,be.Bn)(e)));return t&&(s=s.filter((t=>e[t]))),s.length}));const nn=(0,ce.injectIntl)(tn),an=(0,L.withRouter)((0,a.connect)((function(){const e=(0,qt.Mz)("makeCountUnreadsBelow",pe.zX,l.WR,((e,t)=>t),((e,t,n)=>n),b.WW,((e,t,n,a,s)=>n?n.map((t=>e[t])).filter((e=>e&&e.user_id!==t&&e.state!==he.AF.POST_DELETED&&e.create_at>a&&(!s||""===e.root_id))).length:0)),t=(0,qt.Mz)("makeGetRootPosts",pe.zX,l.WR,r.Lw,((e,t,n)=>Object.values(e).filter((e=>""===e.root_id&&e.channel_id===(null==n?void 0:n.id)&&e.state!==he.AF.POST_DELETED)).reduce(((e,t)=>(e[t.id]=!0,e)),{}))),n=(0,fe.fG)();return function(a,s){let i=0;const o=(0,r.PW)(a,s.channelId),l=a.views.channel.lastChannelViewTime[s.channelId],c=(0,b.z0)(a);if(!s.atLatestPost){let t=(0,pe.Lf)(a,s.channelId)||[];t&&(t=n(a,{postIds:t,lastViewedAt:l})),i=e(a,t,l)}return{rootPosts:t(a),lastViewedAt:l,newRecentMessagesCount:i,unreadScrollPosition:c,isCollapsedThreadsEnabled:(0,b.WW)(a),unreadCountInChannel:(0,r.zk)(a),channelMarkedAsUnread:o}}}),(function(e){return{actions:(0,G.bindActionCreators)({updateToastStatus:c.p4},e)}}))(nn));var sn=n(694),rn=n(89092);const on=e=>{const{postIds:t}=e,n=(0,P.useMemo)((()=>(0,be.h7)(t||[])),[t]),s=(0,a.useSelector)((e=>(0,pe.f5)(e,n))),r=(0,be.VD)(s);return O().createElement("span",{className:"sr-only","aria-live":"polite"},r)};on.propTypes={postIds:B().arrayOf(B().string)};const ln=on;function cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cn(Object(n),!0).forEach((function(t){un(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function un(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mn={padding:"14px 0px 7px"},hn={position:"absolute",bottom:"0",maxHeight:"100%"};class pn extends O().PureComponent{constructor(e){var t;super(e),t=this,un(this,"scrollStopAction",null),un(this,"handleWindowResize",(()=>{this.showSearchHintThreshold=this.getShowSearchHintThreshold()})),un(this,"togglePostMenu",(e=>{let t=this.state.dynamicListStyle;this.props.isMobileView&&(t=dn(dn({},t),{},{willChange:e?"unset":"transform"})),this.setState({postMenuOpened:e,dynamicListStyle:t})})),un(this,"onNewMessageLineReached",(()=>{this.setState({isNewMessageLineReached:!0})})),un(this,"renderRow",(e=>{let{data:t,itemId:n,style:a}=e;const s=t.indexOf(n);let r="";const i="post-row__padding",o=-1!==s&&s<t.length-1?t[s+1]:"",l=s>0&&s<t.length?t[s-1]:"";((0,fe.fE)(l)||(0,fe.OO)(l))&&(r+=i+" bottom"),((0,fe.fE)(o)||(0,fe.OO)(o))&&(r.includes(i)?r+=" top":r+=i+" top");const c=n===this.state.postListIds[0];return O().createElement("div",{style:a,className:r},O().createElement(xt,{listId:n,previousListId:(0,be.fn)(t,s),shouldHighlight:n===this.props.focusedPostId,loadOlderPosts:this.props.actions.loadOlderPosts,loadNewerPosts:this.props.actions.loadNewerPosts,togglePostMenu:this.togglePostMenu,isLastPost:c,loadingNewerPosts:this.props.loadingNewerPosts,loadingOlderPosts:this.props.loadingOlderPosts,channelId:this.props.channelId}))})),un(this,"scrollToFailed",(e=>{0===e?this.props.actions.changeUnreadChunkTimeStamp(0):this.props.actions.changeUnreadChunkTimeStamp(this.props.lastViewedAt)})),un(this,"onScroll",(e=>{let{scrollDirection:t,scrollOffset:n,scrollUpdateWasRequested:a,clientHeight:s,scrollHeight:r}=e;if(r<=0)return;const i="backward"===t&&!a,o="forward"===t&&!a,l=n<1e3,c=this.getOffsetFromBottom(n,r,s),d=c<1e3;if(i&&l&&!this.props.atOldestPost?this.props.actions.loadOlderPosts():o&&d&&!this.props.atLatestPost&&this.props.actions.loadNewerPosts(),this.props.isMobileView&&(this.state.isScrolling||this.setState({isScrolling:!0}),this.scrollStopAction&&this.scrollStopAction.fireAfter(Y.Ay.SCROLL_DELAY)),this.checkBottom(n,r,s),a){var u;const e=null===(u=this.listRef.current)||void 0===u?void 0:u._getRangeToRender();e&&e[3]<=1&&!this.props.atLatestPost&&this.props.actions.canLoadMorePosts(Y.DL.AFTER_ID),!this.state.atBottom&&r&&this.setState({initScrollOffsetFromBottom:c})}this.props.isMobileView&&this.state.showSearchHint&&this.setState({showSearchHint:!1}),this.props.isMobileView||this.state.isSearchHintDismissed||this.setState({showSearchHint:c>this.showSearchHintThreshold}),this.updateScrollToBottomToastVisibility(n,r,s)})),un(this,"getShowSearchHintThreshold",(()=>3*window.screen.height)),un(this,"checkBottom",((e,t,n)=>{this.updateAtBottom(this.isAtBottom(e,t,n))})),un(this,"getOffsetFromBottom",((e,t,n)=>t-n-e)),un(this,"isAtBottom",((e,t,n)=>this.getOffsetFromBottom(e,t,n)<=10&&t>0)),un(this,"updateAtBottom",(e=>{if(e!==this.state.atBottom){let t=Date.now();this.props.latestPostTimeStamp&&this.props.latestPostTimeStamp>t&&(t=this.props.latestPostTimeStamp),this.setState({atBottom:e,lastViewedBottom:t})}})),un(this,"updateLastViewedBottomAt",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();t.setState({lastViewedBottom:e})})),un(this,"handleScrollStop",(()=>{this.mounted&&this.setState({isScrolling:!1})})),un(this,"handleSearchHintDismiss",(()=>{this.setState({showSearchHint:!1,isSearchHintDismissed:!0})})),un(this,"handleScrollToBottomToastDismiss",(()=>{this.setState({showScrollToBottomToast:!1,isScrollToBottomDismissed:!0})})),un(this,"hideScrollToBottomToast",(()=>{this.setState({showScrollToBottomToast:!1})})),un(this,"updateScrollToBottomToastVisibility",((e,t,n)=>{if(this.state.showScrollToBottomToast&&this.state.atBottom)this.setState({showScrollToBottomToast:!1});else if(!this.state.isScrollToBottomDismissed){const a=this.getOffsetFromBottom(e,t,n);this.setState({showScrollToBottomToast:a>this.showSearchHintThreshold})}})),un(this,"updateFloatingTimestamp",(e=>{this.props.isMobileView&&this.props.postListIds&&this.setState({topPostId:(0,be.h7)(this.props.postListIds.slice(e))})})),un(this,"onItemsRendered",(e=>{let{visibleStartIndex:t,visibleStopIndex:n}=e;this.updateFloatingTimestamp(t),this.newMessageLineIndex>0&&!this.state.isNewMessageLineReached&&this.newMessageLineIndex<=t&&this.newMessageLineIndex>=n&&this.onNewMessageLineReached()})),un(this,"initScrollToIndex",(()=>{if(this.props.focusedPostId)return{index:this.state.postListIds.findIndex((e=>e===this.props.focusedPostId)),position:"center"};if(this.props.shouldStartFromBottomWhenUnread)return{index:0,position:"end"};const e=(0,fe.V)(this.state.postListIds);return e>0?(0,fe.fE)(this.state.postListIds[e+1])?{index:e+1,position:"start",offset:-50}:{index:e,position:"start",offset:-50}:{index:0,position:"end"}})),un(this,"scrollToLatestMessages",(()=>{this.props.atLatestPost?this.scrollToBottom():(this.updateNewMessagesAtInChannel(),this.props.actions.changeUnreadChunkTimeStamp(0))})),un(this,"scrollToUnreadMessages",(()=>{this.props.actions.toggleShouldStartFromBottomWhenUnread()})),un(this,"scrollToBottom",(()=>{var e;null===(e=this.listRef.current)||void 0===e||e.scrollToItem(0,"end")})),un(this,"scrollToNewMessage",(()=>{var e;null===(e=this.listRef.current)||void 0===e||e.scrollToItem((0,fe.V)(this.state.postListIds),"start",-50)})),un(this,"updateNewMessagesAtInChannel",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();t.props.actions.updateNewMessagesAtInChannel(t.props.channelId,e)})),un(this,"renderToasts",(e=>O().createElement(an,{atLatestPost:this.props.atLatestPost,postListIds:this.state.postListIds,atBottom:this.state.atBottom,width:e,lastViewedBottom:this.state.lastViewedBottom,latestPostTimeStamp:this.props.latestPostTimeStamp,scrollToUnreadMessages:this.scrollToUnreadMessages,scrollToNewMessage:this.scrollToNewMessage,scrollToLatestMessages:this.scrollToLatestMessages,updateNewMessagesAtInChannel:this.updateNewMessagesAtInChannel,updateLastViewedBottomAt:this.updateLastViewedBottomAt,shouldStartFromBottomWhenUnread:this.props.shouldStartFromBottomWhenUnread,isNewMessageLineReached:this.state.isNewMessageLineReached,channelId:this.props.channelId,focusedPostId:this.props.focusedPostId,initScrollOffsetFromBottom:this.state.initScrollOffsetFromBottom,onSearchHintDismiss:this.handleSearchHintDismiss,showSearchHintToast:this.state.showSearchHint,showScrollToBottomToast:this.state.showScrollToBottomToast,onScrollToBottomToastDismiss:this.handleScrollToBottomToastDismiss,hideScrollToBottomToast:this.hideScrollToBottomToast})));const n=Y.D3.CHANNEL_INTRO_MESSAGE;this.mounted=!0,this.state={isScrolling:!1,atBottom:null,lastViewedBottom:Date.now(),postListIds:[n],topPostId:"",postMenuOpened:!1,dynamicListStyle:{willChange:"transform"},initScrollCompleted:!1,initScrollOffsetFromBottom:0,showSearchHint:!1,isSearchHintDismissed:!1,isNewMessageLineReached:!1,showScrollToBottomToast:!1,isScrollToBottomDismissed:!1},this.listRef=O().createRef(),this.postListRef=O().createRef(),this.props.isMobileView&&(this.scrollStopAction=new rn.A(this.handleScrollStop)),this.initRangeToRender=this.props.focusedPostId?[0,100]:[0,50];let a=0;a=e.focusedPostId?(this.props.postListIds||[]).findIndex((e=>e===this.props.focusedPostId)):(0,fe.V)(e.postListIds||[]),this.newMessageLineIndex=(0,fe.V)(e.postListIds||[]);const s=e.focusedPostId?100:50;this.initRangeToRender=[Math.max(a-30,0),Math.max(a+30,Math.min((e.postListIds||[]).length-1,s))],this.showSearchHintThreshold=this.getShowSearchHintThreshold()}componentDidMount(){this.mounted=!0,window.addEventListener("resize",this.handleWindowResize),ve.A.addListener(Y.wf.POST_LIST_SCROLL_TO_BOTTOM,this.scrollToLatestMessages)}getSnapshotBeforeUpdate(e){if(this.postListRef&&this.postListRef.current){const n=this.props.postListIds&&this.props.postListIds.length!==(e.postListIds||[]).length&&this.props.postListIds[0]===(e.postListIds||[])[0],a=this.props.atOldestPost!==e.atOldestPost;if((n||a)&&!1===this.state.atBottom){var t;const e=this.postListRef.current;return{previousScrollTop:null===(t=e.parentElement)||void 0===t?void 0:t.scrollTop,previousScrollHeight:e.scrollHeight}}}return null}componentDidUpdate(e,t,n){if(this.props.isMobileView&&!e.isMobileView&&(this.scrollStopAction=new rn.A(this.handleScrollStop)),!this.postListRef.current)return;const a=(e.postListIds||[]).length,s=(this.props.postListIds||[]).length;if(this.newMessageLineIndex=(0,fe.V)(this.props.postListIds||[]),n){const t=this.postListRef.current.scrollHeight,i=s!==a&&(this.props.postListIds||[])[0]===(e.postListIds||[])[0],o=this.props.atOldestPost!==e.atOldestPost;if((i||o)&&!this.state.atBottom&&n){const e=n.previousScrollTop+(t-n.previousScrollHeight);var r;0!==e&&e-n.previousScrollTop!=0&&(null===(r=this.listRef.current)||void 0===r||r.scrollTo(e,e-n.previousScrollTop,!0))}}}componentWillUnmount(){this.mounted=!1,window.removeEventListener("resize",this.handleWindowResize),ve.A.removeListener(Y.wf.POST_LIST_SCROLL_TO_BOTTOM,this.scrollToLatestMessages)}static getDerivedStateFromProps(e,t){const n=e.postListIds||[];let a;a=e.atOldestPost?[...n,Y.D3.CHANNEL_INTRO_MESSAGE]:e.autoRetryEnable?[...n,Y.D3.OLDER_MESSAGES_LOADER]:[...n,Y.D3.LOAD_OLDER_MESSAGES_TRIGGER],e.atLatestPost||(a=e.autoRetryEnable?[Y.D3.NEWER_MESSAGES_LOADER,...a]:[Y.D3.LOAD_NEWER_MESSAGES_TRIGGER,...a]);const s={postListIds:a};if(e.isMobileView!==t.isMobileView){s.isMobileView=e.isMobileView;const n=t.dynamicListStyle;t.postMenuOpened&&(e.isMobileView||"unset"!==n.willChange?e.isMobileView&&"transform"===n.willChange&&(s.dynamicListStyle=dn(dn({},n),{},{willChange:"unset"})):s.dynamicListStyle=dn(dn({},n),{},{willChange:"transform"}))}return s}render(){const{channelId:e}=this.props,{dynamicListStyle:t}=this.state;return O().createElement("div",{className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0,"data-a11y-loop-navigation":!1,"aria-label":$.Vw({id:"accessibility.sections.centerContent",defaultMessage:"message list main region"})},this.props.isMobileView&&O().createElement(O().Fragment,null,O().createElement(Be.A,{isScrolling:this.state.isScrolling,postId:this.state.topPostId}),O().createElement(Ht,{isScrolling:this.state.isScrolling,atBottom:Boolean(this.state.atBottom),onClick:this.scrollToBottom})),O().createElement("div",{className:"post-list-holder-by-time",key:"postlist-"+e},O().createElement("div",{className:"post-list__table"},O().createElement("div",{id:"postListContent",className:"post-list__content"},O().createElement(ln,{postIds:this.props.postListIds}),O().createElement(Ce.Ay,null,(e=>{let{height:n,width:a}=e;return O().createElement(O().Fragment,null,O().createElement("div",null,O().createElement(sn.default,{pluggableName:"ChannelToast"}),this.renderToasts(a)),O().createElement(Oe,{ref:this.listRef,id:"postListScrollContainer",className:"post-list__dynamic",height:n,width:a,itemData:this.state.postListIds,overscanCountForward:80,overscanCountBackward:80,onScroll:this.onScroll,initScrollToIndex:this.initScrollToIndex,canLoadMorePosts:this.props.actions.canLoadMorePosts,innerRef:this.postListRef,style:dn(dn({},hn),t),innerListStyle:mn,initRangeToRender:this.initRangeToRender,loaderId:Y.D3.OLDER_MESSAGES_LOADER,correctScrollToBottom:this.props.atLatestPost,onItemsRendered:this.onItemsRendered,scrollToFailed:this.scrollToFailed},this.renderRow))}))))))}}un(pn,"propTypes",{postListIds:B().arrayOf(B().string),channelId:B().string.isRequired,autoRetryEnable:B().bool.isRequired,loadingNewerPosts:B().bool.isRequired,loadingOlderPosts:B().bool.isRequired,isMobileView:B().bool.isRequired,atOldestPost:B().bool,atLatestPost:B().bool,latestPostTimeStamp:B().number,lastViewedAt:B().number.isRequired,focusedPostId:B().string,shouldStartFromBottomWhenUnread:B().bool.isRequired,actions:B().shape({loadOlderPosts:B().func.isRequired,loadNewerPosts:B().func.isRequired,canLoadMorePosts:B().func.isRequired,changeUnreadChunkTimeStamp:B().func.isRequired,updateNewMessagesAtInChannel:B().any.isRequired,toggleShouldStartFromBottomWhenUnread:B().func.isRequired}).isRequired});var gn=n(3295);function fn(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const bn=Y.YM.POST_CHUNK_SIZE/2;function En(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,Ee.Gy)(gn.CU.PostListLoaded),(0,gn.uB)({name:gn.t$.ChannelSwitch,startMark:gn.CU.ChannelLinkClicked,endMark:gn.CU.PostListLoaded,labels:{fresh:e.toString()},canFail:!0}),(0,gn.uB)({name:gn.t$.TeamSwitch,startMark:gn.CU.TeamLinkClicked,endMark:gn.CU.PostListLoaded,labels:{fresh:e.toString()},canFail:!0}),(0,Ee.MR)([gn.CU.ChannelLinkClicked,gn.CU.TeamLinkClicked,gn.CU.PostListLoaded])}class Cn extends O().PureComponent{constructor(e){var t;super(e),t=this,fn(this,"postsOnLoad",(async e=>{const{focusedPostId:t,isFirstLoad:n,latestPostTimeStamp:a,isPrefetchingInProcess:s,actions:r}=this.props;t?await r.loadPostsAround(e,t):n?s||await r.loadUnreads(e):a?await r.syncPostsInChannel(e,a,!1):await r.loadLatestPosts(e),t||this.props.actions.markChannelAsRead(e),this.mounted&&this.setState({loadingOlderPosts:!1,loadingNewerPosts:!1})})),fn(this,"callLoadPosts",(async(e,t,n,a)=>{const{error:s}=await this.props.actions.loadPosts({channelId:e,postId:t,type:n,perPage:a});return n===Y.DL.BEFORE_ID?this.setState({loadingOlderPosts:!1}):this.setState({loadingNewerPosts:!1}),s?this.autoRetriesCount<3?(this.autoRetriesCount++,await this.callLoadPosts(e,t,n,a)):this.mounted&&this.setState({autoRetryEnable:!1}):(this.mounted&&this.setState({autoRetryEnable:!0}),this.state.autoRetryEnable||(this.autoRetriesCount=0)),{error:s}})),fn(this,"getOldestVisiblePostId",(()=>(0,be.J3)(this.props.postListIds||[]))),fn(this,"getLatestVisiblePostId",(()=>(0,be.h7)(this.props.postListIds||[]))),fn(this,"canLoadMorePosts",(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y.DL.BEFORE_ID;t.props.hasInaccessiblePosts||t.props.postListIds&&(t.state.loadingOlderPosts||t.state.loadingNewerPosts||(t.extraPagesLoaded>30?t.state.autoRetryEnable&&t.setState({autoRetryEnable:!1}):(t.props.atOldestPost||e!==Y.DL.BEFORE_ID?t.props.atLatestPost||await t.getPostsAfter():await t.getPostsBeforeAutoLoad(),t.extraPagesLoaded+=1)))})),fn(this,"getPostsBefore",(async()=>{if(this.state.loadingOlderPosts)return;this.state.autoRetryEnable||(this.extraPagesLoaded=0);const e=this.getOldestVisiblePostId();this.setState({loadingOlderPosts:!0}),await this.callLoadPosts(this.props.channelId,e,Y.DL.BEFORE_ID,bn)})),fn(this,"getPostsAfter",(async()=>{if(this.state.loadingNewerPosts)return;this.state.autoRetryEnable||(this.extraPagesLoaded=0);const e=this.getLatestVisiblePostId();this.setState({loadingNewerPosts:!0}),await this.callLoadPosts(this.props.channelId,e,Y.DL.AFTER_ID,bn)})),fn(this,"getPostsBeforeAutoLoad",(async()=>{if(this.state.loadingOlderPosts)return;const e=this.getOldestVisiblePostId();this.setState({loadingOlderPosts:!0}),await this.callLoadPosts(this.props.channelId,e,Y.DL.BEFORE_ID,200)})),this.state={loadingNewerPosts:!1,loadingOlderPosts:!1,autoRetryEnable:!0},this.extraPagesLoaded=0,this.autoRetriesCount=0,this.actionsForPostList={loadOlderPosts:this.getPostsBefore,loadNewerPosts:this.getPostsAfter,canLoadMorePosts:this.canLoadMorePosts,changeUnreadChunkTimeStamp:e.changeUnreadChunkTimeStamp,toggleShouldStartFromBottomWhenUnread:e.toggleShouldStartFromBottomWhenUnread,updateNewMessagesAtInChannel:this.props.actions.updateNewMessagesAtInChannel}}componentDidMount(){this.mounted=!0,this.props.channelId&&(this.postsOnLoad(this.props.channelId),this.props.postListIds&&En())}componentDidUpdate(e){this.props.channelId!==e.channelId&&this.postsOnLoad(this.props.channelId),null!=this.props.postListIds&&null==e.postListIds&&En(!0)}componentWillUnmount(){this.mounted=!1}render(){return this.props.postListIds?O().createElement("div",{className:"post-list-holder-by-time",key:"postlist-"+this.props.channelId},O().createElement("div",{className:"post-list__table"},O().createElement("div",{id:"virtualizedPostListContent",className:"post-list__content"},O().createElement(pn,{loadingNewerPosts:this.state.loadingNewerPosts,loadingOlderPosts:this.state.loadingOlderPosts,atOldestPost:this.props.atOldestPost,atLatestPost:this.props.atLatestPost,focusedPostId:this.props.focusedPostId,channelId:this.props.channelId,autoRetryEnable:this.state.autoRetryEnable,shouldStartFromBottomWhenUnread:this.props.shouldStartFromBottomWhenUnread,actions:this.actionsForPostList,postListIds:this.props.formattedPostIds,latestPostTimeStamp:this.props.latestPostTimeStamp,isMobileView:this.props.isMobileView,lastViewedAt:this.props.lastViewedAt})))):O().createElement(me.A,{centered:!0})}}fn(Cn,"propTypes",{formattedPostIds:B().arrayOf(B().string),postListIds:B().arrayOf(B().string),channelId:B().string.isRequired,focusedPostId:B().string,atLatestPost:B().bool.isRequired,atOldestPost:B().bool,isFirstLoad:B().bool.isRequired,latestPostTimeStamp:B().number,changeUnreadChunkTimeStamp:B().func.isRequired,isPrefetchingInProcess:B().bool.isRequired,isMobileView:B().bool.isRequired,lastViewedAt:B().number.isRequired,toggleShouldStartFromBottomWhenUnread:B().func.isRequired,shouldStartFromBottomWhenUnread:B().bool.isRequired,hasInaccessiblePosts:B().bool.isRequired,actions:B().shape({loadPostsAround:B().func.isRequired,loadUnreads:B().func.isRequired,loadPosts:B().func.isRequired,syncPostsInChannel:B().func.isRequired,loadLatestPosts:B().func.isRequired,markChannelAsRead:B().func.isRequired,updateNewMessagesAtInChannel:B().any.isRequired}).isRequired});const vn=(e,t)=>!e.entities.posts.postsInChannel[t],yn=(0,ge.el)((e=>(0,be.h7)(e))),Mn=(0,a.connect)((function(){const e=(0,pe.A8)(),t=(0,fe.fG)();return function(n,a){let s,r,i,o=0,l=!1,c=!1;const{focusedPostId:d,unreadChunkTimeStamp:u,channelId:m,shouldStartFromBottomWhenUnread:h}=a,p=n.views.channel,g=p.lastChannelViewTime[m],f=p.channelPrefetchStatus[m]===he.IZ.STARTED,b=(0,pe.VT)(n),E=Boolean(b.channels[m])||0===b.channels[m],C=(0,pe.f5)(n,d||"");r=d&&void 0!==C?e(n,d,m):u&&!h?(0,pe.AB)(n,m,u):(0,pe.Gn)(n,m),r&&(s=r.order,l=Boolean(r.recent),c=Boolean(r.oldest));let v=!1;if(null!=u&&(v=h&&!(0,pe.dH)(n,r,u)),s&&(i=t(n,{postIds:s,lastViewedAt:g,indicateNewMessages:!v}),s.length)){const e=yn(s);o=(0,pe.f5)(n,e).create_at}return{lastViewedAt:g,isFirstLoad:vn(n,m),formattedPostIds:i,atLatestPost:l,atOldestPost:c,latestPostTimeStamp:o,postListIds:s,isPrefetchingInProcess:f,shouldStartFromBottomWhenUnread:h,isMobileView:(0,V.w3)(n),hasInaccessiblePosts:E}}}),(function(e){return{actions:(0,G.bindActionCreators)({loadUnreads:c.jw,loadPosts:c.i,loadLatestPosts:c.F8,loadPostsAround:c.zp,syncPostsInChannel:c.LD,markChannelAsRead:s.Zn,updateNewMessagesAtInChannel:Z.Lg},e)}}))(Cn);function _n(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Tn extends O().PureComponent{constructor(e){super(e),_n(this,"changeUnreadChunkTimeStamp",(e=>{this.setState({unreadChunkTimeStamp:e,loaderForChangeOfPostsChunk:!0},(()=>{window.requestAnimationFrame((()=>{this.setState({loaderForChangeOfPostsChunk:!1})}))}))})),_n(this,"toggleShouldStartFromBottomWhenUnread",(()=>{this.setState((e=>({loaderForChangeOfPostsChunk:!0,shouldStartFromBottomWhenUnread:!e.shouldStartFromBottomWhenUnread})),(()=>{window.requestAnimationFrame((()=>{this.setState({loaderForChangeOfPostsChunk:!1})}))}))}));const t=this.props.unreadScrollPosition===Y.pm.UNREAD_SCROLL_POSITION_START_FROM_NEWEST;this.state={unreadChunkTimeStamp:e.lastViewedAt,shouldStartFromBottomWhenUnread:t,loaderForChangeOfPostsChunk:!1,channelLoading:e.channelLoading}}static getDerivedStateFromProps(e,t){return null===t.unreadChunkTimeStamp&&e.lastViewedAt?{unreadChunkTimeStamp:e.lastViewedAt}:e.channelLoading!==t.channelLoading?{unreadChunkTimeStamp:e.lastViewedAt,channelLoading:e.channelLoading}:null}render(){return this.props.channelLoading||this.state.loaderForChangeOfPostsChunk?O().createElement("div",{id:"post-list"},O().createElement(me.A,{centered:!0})):O().createElement("div",{id:"post-list",role:"main"},O().createElement(Mn,{unreadChunkTimeStamp:this.state.unreadChunkTimeStamp,channelId:this.props.channelId,changeUnreadChunkTimeStamp:this.changeUnreadChunkTimeStamp,shouldStartFromBottomWhenUnread:this.state.shouldStartFromBottomWhenUnread,toggleShouldStartFromBottomWhenUnread:this.toggleShouldStartFromBottomWhenUnread,focusedPostId:this.props.focusedPostId}))}}_n(Tn,"propTypes",{lastViewedAt:B().number,channelLoading:B().bool.isRequired,channelId:B().string.isRequired,focusedPostId:B().string,unreadScrollPosition:B().string.isRequired});const Sn=(0,L.withRouter)((0,a.connect)((function(){return function(e,t){var n;const a=null===(n=t.match)||void 0===n?void 0:n.params,s=(0,o.Uj)(e,(null==a?void 0:a.team)||"");let i;const c=(0,r.c)(e,t.channelId);let d=e.views.channel.lastChannelViewTime[t.channelId];c&&(c.type===Y.YM.DM_CHANNEL&&c.teammate_id&&(i=(0,l.wz)(e,c.teammate_id)),d=c.last_post_at?d:c.last_post_at);const u=((e,t,n,a,s)=>{var r;if(e.postid)return!1;const i=null===(r=e.identifier)||void 0===r?void 0:r.toLowerCase();if(t&&n){if(t.type!==Y.YM.DM_CHANNEL&&t.name!==i)return!0;if(t.type===Y.YM.DM_CHANNEL&&a&&i!=="@".concat(a.username))return!0;const e=n.id;return!!(t.team_id&&t.team_id!==e||s&&!s[e])}return!0})(a,c,s,i,(0,o.bO)(e));return{unreadScrollPosition:(0,b.z0)(e),lastViewedAt:d,channelLoading:u}}}))(Tn));var wn=n(7344);const In=()=>{location.reload()},An=e=>{let{updateWaitForLoader:t}=e;const[n,a]=(0,P.useState)(!1);return(0,P.useEffect)((()=>{let e=setTimeout((()=>{a(!0),t(!0),e=setTimeout((()=>{t(!1)}),2e3)}),5e3);return()=>{clearTimeout(e),t(!1)}}),[]),O().createElement("div",{className:"AdvancedTextEditor__skeleton"},n&&O().createElement(O().Fragment,null,O().createElement(ce.FormattedMessage,{id:"center_panel.input.cannot_load_component",defaultMessage:"Something went wrong while loading the component. Please wait a moment, or try reloading the app."}),O().createElement("button",{className:"btn btn-tertiary channel-archived__close-btn",onClick:In},O().createElement(ce.FormattedMessage,{id:"center_panel.reloadPage",defaultMessage:"Reload"}))))};An.propTypes={updateWaitForLoader:B().func.isRequired};const Rn=An;function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function On(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ln=(0,x.S)("ChannelHeader",(0,P.lazy)((()=>Promise.all([n.e(2754),n.e(1852),n.e(6098),n.e(9949),n.e(4446),n.e(4014),n.e(6222)]).then(n.bind(n,86222))))),Dn=(0,x.S)("FileUploadOverlay",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,77143))))),kn=(0,x.S)("ChannelBookmarks",(0,P.lazy)((()=>Promise.all([n.e(4446),n.e(1119)]).then(n.bind(n,39403))))),Fn=(0,x.S)("AdvancedCreatePost",(0,P.lazy)((()=>n.e(3797).then(n.bind(n,73797))))),xn=(0,x.S)("ChannelBanner",(0,P.lazy)((()=>n.e(388).then(n.bind(n,10388)))));class Un extends O().PureComponent{static getDerivedStateFromProps(e,t){let n={};const a=e.match.params.postid;return e.match.url!==t.url&&e.channelId!==t.channelId&&(n={deferredPostView:Un.createDeferredPostView(),url:e.match.url,focusedPostId:a}),e.channelId!==t.channelId&&(n=Pn(Pn({},n),{},{channelId:e.channelId,focusedPostId:a})),a&&a!==t.focusedPostId&&(n=Pn(Pn({},n),{},{focusedPostId:a})),Object.keys(n).length?n:null}constructor(e){super(e),On(this,"onClickCloseChannel",(()=>{this.props.goToLastViewedChannel()})),On(this,"onUpdateInputShowLoader",(e=>{this.setState({waitForLoader:e})})),this.state={url:e.match.url,channelId:e.channelId,focusedPostId:e.match.params.postid,deferredPostView:Un.createDeferredPostView(),waitForLoader:!1},this.channelViewRef=O().createRef()}componentDidUpdate(e){e.channelId!==this.props.channelId&&this.props.enableWebSocketEventScope&&wn.A.updateActiveChannel(this.props.channelId)}render(){let e;e=this.props.deactivatedChannel?O().createElement("div",{className:"post-create__container AdvancedTextEditor__ctr",id:"post-create"},O().createElement("div",{className:"channel-archived__message"},O().createElement(ce.FormattedMessage,{id:"channelView.archivedChannelWithDeactivatedUser",defaultMessage:"You are viewing an archived channel with a <b>deactivated user</b>. New messages cannot be posted.",values:{b:e=>O().createElement("b",null,e)}}),O().createElement("button",{className:"btn btn-primary channel-archived__close-btn",onClick:this.onClickCloseChannel},O().createElement(ce.FormattedMessage,{id:"center_panel.archived.closeChannel",defaultMessage:"Close Channel"})))):this.props.channelIsArchived?O().createElement("div",{className:"post-create__container",id:"post-create"},O().createElement("div",{id:"channelArchivedMessage",className:"channel-archived__message"},O().createElement(ce.FormattedMessage,{id:"channelView.archivedChannel",defaultMessage:"You are viewing an <b>archived channel</b>. New messages cannot be posted.",values:{b:e=>O().createElement("b",null,e)}}),O().createElement("button",{className:"btn btn-primary channel-archived__close-btn",onClick:this.onClickCloseChannel},O().createElement(ce.FormattedMessage,{id:"center_panel.archived.closeChannel",defaultMessage:"Close Channel"})))):this.props.missingChannelRole||this.state.waitForLoader?O().createElement(Rn,{updateWaitForLoader:this.onUpdateInputShowLoader}):O().createElement("div",{id:"post-create","data-testid":"post-create",className:"post-create__container AdvancedTextEditor__ctr"},O().createElement(Fn,null));const t=this.state.deferredPostView;return O().createElement("div",{ref:this.channelViewRef,id:"app-content",className:"app__content"},O().createElement(Dn,{overlayType:"center",id:ue.nY}),O().createElement(Ln,this.props),this.props.isChannelBookmarksEnabled&&O().createElement(kn,{channelId:this.props.channelId}),O().createElement(xn,{channelId:this.props.channelId}),O().createElement(t,{channelId:this.props.channelId,focusedPostId:this.state.focusedPostId}),e)}}On(Un,"createDeferredPostView",(()=>(0,de.A)(Sn,O().createElement("div",{id:"post-list",className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0}))));const Bn={goToLastViewedChannel:c.TJ},Hn=(0,a.connect)((function(e){const t=(0,r.Lw)(e),n=(0,i.zj)(e),a="true"===n.EnableOnboardingFlow,s="true"===n.FeatureFlagWebSocketEventScope,c=function(e,t){var n;return!(t&&(null===(n=(0,r.M9)(e,t.id))||void 0===n?void 0:n.roles)||"").split(" ").some((t=>Boolean((0,oe.O0)(e)[t])))}(e,t);return{channelId:t?t.id:"",deactivatedChannel:!!t&&(0,r.nO)(e,t.id),enableOnboardingFlow:a,channelIsArchived:!!t&&0!==t.delete_at,isCloud:"true"===(0,i.Ay)(e).Cloud,teamUrl:(0,o._p)(e),isFirstAdmin:(0,l.OK)(e),enableWebSocketEventScope:s,isChannelBookmarksEnabled:(0,le.wR)(e),missingChannelRole:c}}),Bn),qn=(0,L.withRouter)(Hn(Un));function jn(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Vn extends O().PureComponent{constructor(e){super(e),jn(this,"replaceUrlIfPermalink",(()=>{this.props.match.params.postid&&(this.replaceUrlTimeout=setTimeout((()=>{const e=this.props.match.url.split("/").slice(0,-1).join("/");(0,Qt.J)().replace(e)}),Y.Ay.PERMALINK_FADEOUT))})),this.state={prevProps:e}}componentDidUpdate(e){this.props.match.params.team===e.match.params.team&&this.props.match.params.identifier===e.match.params.identifier||(clearTimeout(this.replaceUrlTimeout),this.props.actions.onChannelByIdentifierEnter(this.props),this.replaceUrlIfPermalink())}componentDidMount(){this.props.actions.onChannelByIdentifierEnter(this.props),this.replaceUrlIfPermalink()}componentWillUnmount(){clearTimeout(this.replaceUrlTimeout)}render(){return O().createElement(qn,null)}}jn(Vn,"propTypes",{match:B().shape({params:B().shape({identifier:B().string.isRequired,team:B().string.isRequired,postid:B().string,path:B().string.isRequired}).isRequired,url:B().string.isRequired}).isRequired,actions:B().shape({onChannelByIdentifierEnter:B().func.isRequired}).isRequired,history:B().any.isRequired});const Gn=(0,L.withRouter)((0,a.connect)(null,(function(e){return{actions:(0,G.bindActionCreators)({onChannelByIdentifierEnter:te},e)}}))(Vn));var zn=n(82739);const Wn=(0,x.S)("MobileChannelHeader",(0,P.lazy)((()=>Promise.all([n.e(2754),n.e(9949),n.e(4446),n.e(4014),n.e(8844)]).then(n.bind(n,88844))))),Kn=(0,x.S)("GlobalThreads",(0,P.lazy)((()=>n.e(8085).then(n.bind(n,88085)))),O().createElement("div",{className:"app__content"},O().createElement(me.A,null))),Yn=(0,x.S)("Drafts",(0,P.lazy)((()=>n.e(2794).then(n.bind(n,22794)))),O().createElement("div",{className:"app__content"},O().createElement(me.A,null))),Jn=(0,x.S)("PermalinkView",(0,P.lazy)((()=>n.e(1300).then(n.bind(n,21300))))),Qn=(0,x.S)("PlaybookRunner",(0,P.lazy)((()=>n.e(7422).then(n.bind(n,87422)))));class Zn extends O().PureComponent{constructor(e){super(e),this.state={returnTo:"",lastReturnTo:""}}static getDerivedStateFromProps(e,t){return t.lastReturnTo!==e.location.pathname&&e.location.pathname.includes("/pl/")?{lastReturnTo:e.location.pathname,returnTo:t.lastReturnTo}:{lastReturnTo:e.location.pathname}}async componentDidMount(){const{actions:e}=this.props;await e.getProfiles()}render(){const{lastChannelPath:e,isCollapsedThreadsEnabled:t,isMobileView:n}=this.props,a=this.props.match.url;return O().createElement("div",{key:"inner-wrap",className:q()("inner-wrap","channel__wrap",{"move--right":this.props.lhsOpen,"move--left":this.props.rhsOpen,"move--left-small":this.props.rhsMenuOpen})},n&&O().createElement(Wn,null),O().createElement("div",{className:"row main"},O().createElement(L.Switch,null,O().createElement(L.Route,{path:"".concat(a,"/pl/:postid(").concat(zn.Zv,")"),render:e=>O().createElement(Jn,Object.assign({},e,{returnTo:this.state.returnTo}))}),O().createElement(L.Route,{path:"/:team(".concat(zn.LD,")/:path(channels|messages)/:identifier(").concat(zn.x,")/:postid(").concat(zn.Zv,")?"),component:Gn}),O().createElement(L.Route,{path:"/:team(".concat(zn.LD,")/_playbooks/:playbookId(").concat(zn.Zv,")/run")},O().createElement(Qn,null)),t?O().createElement(L.Route,{path:"/:team(".concat(zn.LD,")/threads/:threadIdentifier(").concat(zn.Zv,")?"),component:Kn}):null,O().createElement(L.Route,{path:"/:team(".concat(zn.LD,")/drafts"),component:Yn}),O().createElement(L.Route,{path:"/:team(".concat(zn.LD,")/").concat(Y.pj),component:Yn}),O().createElement(L.Redirect,{to:e}))))}}const Xn=(0,a.connect)(((e,t)=>{const n=(0,K.Gw)(e,t.match.params.team);let a=(0,K.y1)(e,t.match.params.team);const s=(0,K.Kf)(e),i=(0,o.Uj)(e,t.match.params.team);let c,u;return s!==(null==i?void 0:i.id)&&(c=(0,K.Jl)(e)),a||(a=(0,r.Dn)(e,i.id)),u=!(0,b.WW)(e)||c!==Y.po.THREADS&&n!==Y.po.THREADS?"".concat(t.match.url,"/channels/").concat(a):"".concat(t.match.url,"/threads"),{lastChannelPath:u,lhsOpen:(0,W.Cu)(e),rhsOpen:(0,d.A)(e),rhsMenuOpen:(0,d.ZE)(e),isCollapsedThreadsEnabled:(0,b.WW)(e),currentUserId:(0,l.WR)(e),isMobileView:(0,V.w3)(e)}}),(function(e){return{actions:(0,G.bindActionCreators)({getProfiles:z.r7},e)}})),$n=(0,L.withRouter)(Xn(Zn));n(36169),n(30973);var ea=n(79751);const ta=function(){const e=(0,L.useLocation)(),t=(0,a.useDispatch)(),n=(0,L.useHistory)(),s={open_invitation_modal:{modalId:Y.IQ.INVITATION,dialogType:ut.default}};return(0,P.useEffect)((()=>{const a=new URLSearchParams(e.search),r=a.get("action");r&&s[r]&&(t((0,ea.q)(s[r])),a.delete("action"),n.replace({search:a.toString()}))}),[e,s]),null};var na=n(4629),aa=n(16983),sa=n(80635),ra=n(52073),ia=n(2386),oa=n(9916),la=n(98496);function ca(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function da(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ca(Object(n),!0).forEach((function(t){ua(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ca(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ua(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ma=function(e){return e[e.high=1]="high",e[e.medium=2]="medium",e[e.low=3]="low",e}(ma||{}),ha=function(e){return e[e.mentionMax=10]="mentionMax",e[e.unreadMax=20]="unreadMax",e}(ha||{});const pa=(0,ge.el)(((e,t,n)=>{const a=e.length;let s={[ma.high]:[],[ma.medium]:[],[ma.low]:[]};if(!a||a>ha.unreadMax)return s;for(const r of e){const e=r.id,i=t[e];if(a>=ha.mentionMax&&s[ma.high].length>=ha.mentionMax)break;i&&!(0,Ke.X4)(i)&&((n?i.mention_count_root:i.mention_count)?s=da(da({},s),{},{[ma.high]:[...s[ma.high],e]}):i.notify_props&&"mention"!==i.notify_props.mark_unread&&a<ha.mentionMax&&(s=da(da({},s),{},{[ma.medium]:[...s[ma.medium],e]})))}return s}));var ga=n(79030),fa=n(65357);function ba(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ea=new ga.A({concurrency:2});class Ca extends O().PureComponent{constructor(){super(...arguments),ba(this,"prefetchPosts",(e=>{let t;const n=this.props.unreadChannels.find((t=>e===t.id));return!n||n.type!==Y.YM.PRIVATE_CHANNEL&&n.type!==Y.YM.OPEN_CHANNEL||Date.now()-n.last_post_at<=1e3&&(t=1e3*Math.random()),this.props.actions.prefetchChannelPosts(e,t)})),ba(this,"prefetchData",(()=>{const{prefetchRequestStatus:e,prefetchQueueObj:t}=this.props;for(const n in t){if(!Object.hasOwn(t,n))continue;const a=t[n];for(const t of a)Object.hasOwn(e,t)||Ea.add((async()=>this.prefetchPosts(t)))}}))}async componentDidUpdate(e){const{currentChannelId:t,prefetchQueueObj:n,sidebarLoaded:a}=this.props;a&&!e.sidebarLoaded&&(0,fa.mp)(),!t||!a||e.currentChannelId&&e.sidebarLoaded?e.prefetchQueueObj!==n&&(clearTimeout(this.prefetchTimeout),await Ea.clear(),this.prefetchData()):(Ea.add((async()=>this.prefetchPosts(t))),this.prefetchData())}render(){return null}}function va(e){return(0,oa.WJ)(e).length>0}ba(Ca,"propTypes",{currentChannelId:B().string.isRequired,prefetchQueueObj:B().objectOf(B().arrayOf(B().string)).isRequired,prefetchRequestStatus:B().objectOf(B().string).isRequired,sidebarLoaded:B().bool.isRequired,unreadChannels:B().array.isRequired,actions:B().shape({prefetchChannelPosts:B().func.isRequired}).isRequired});const ya=(0,a.connect)((function(e){const t=e.views.channel.lastUnreadChannel,n=(0,f.vd)(e),a=(0,r.OM)(e,t),s=pa(a,n,(0,b.WW)(e)),i=e.views.channel.channelPrefetchStatus;return{currentChannelId:(0,r.eH)(e),prefetchQueueObj:s,prefetchRequestStatus:i,sidebarLoaded:va(e),unreadChannels:a}}),(function(e){return{actions:(0,G.bindActionCreators)({prefetchChannelPosts:c.At},e)}}))(Ca);var Ma=n(71769),_a=n(7021);function Ta(e){let{children:t,id:n,className:a}=e;const s=(0,P.useRef)(null);return O().createElement("div",{id:n,className:a,ref:s},t,O().createElement(_a.A,{name:"lhsResizeHandle",globalCssVar:Ma.Oq.LHS,defaultWidth:Ma.LA,dir:Ma.Cr.LEFT,containerRef:s}))}Ta.propTypes={children:B().node.isRequired};const Sa=Ta;var wa=n(74754),Ia=n(45955),Aa=n(30135),Ra=n(31892),Na=n(70669),Pa=n(8283),Oa=n(87364),La=n(8610),Da=n(3289),ka=n(86145),Fa=n(52231);function xa(e){var t;const n=(0,a.useSelector)(i.Ay),s=(0,a.useSelector)(i.zj),r=(0,a.useSelector)((e=>(0,oe.y4)(e,{permission:he.xB.CREATE_TEAM}))),l=(0,a.useSelector)((e=>(0,sa.pU)(e,he.xB.MANAGE_TEAM))),c=(0,a.useSelector)((e=>(0,sa.pU)(e,he.xB.ADD_USER_TO_TEAM))),d=(0,a.useSelector)((e=>(0,sa.pU)(e,he.xB.INVITE_GUEST))),u=(0,Fa.P3)(n),m="true"===(null==s?void 0:s.EnableGuestAccounts),h=Boolean(null===(t=e.currentTeam)||void 0===t?void 0:t.group_constrained),p="true"===(null==n?void 0:n.LDAPGroups),g=s.ExperimentalPrimaryTeam,f=(0,a.useSelector)(o.sZ),b=(null==f?void 0:f.length)>0,E=!g&&b,C=e.currentTeam.description?e.currentTeam.description:e.currentTeam.display_name;return O().createElement(Na.mc,{menuButton:{id:"sidebarTeamMenuButton",class:"btn btn-sm btn-quaternary btn-inverted",children:O().createElement(O().Fragment,null,O().createElement("span",null,e.currentTeam.display_name),O().createElement("i",{className:"icon icon-chevron-down"}))},menuButtonTooltip:{text:C},menu:{id:"sidebarTeamMenu"}},(m&&d||c)&&O().createElement(Ua,null),h&&p&&l&&O().createElement(Ba,null),l&&O().createElement(Ha,null),O().createElement(qa,null),h&&p&&l&&O().createElement(ja,{teamID:e.currentTeam.id}),!h&&g!==e.currentTeam.name&&O().createElement(Va,null),(E||r)&&O().createElement(Na.wv,null),E&&O().createElement(Ga,null),r&&O().createElement(za,{isCloud:u}),O().createElement(Na.wv,null),O().createElement(Ya,null),O().createElement(Ja,null))}function Ua(e){const t=(0,a.useDispatch)(),n=(0,P.useCallback)((()=>{t((0,ea.q)({modalId:Y.IQ.INVITATION,dialogType:ut.default,dialogProps:{focusOriginElement:"sidebarTeamMenuButton"}}))}),[t]);return O().createElement(Na.q7,Object.assign({onClick:n,leadingElement:O().createElement(ze.AccountMultiplePlusOutlineIcon,{size:18,"aria-hidden":"true"}),labels:O().createElement(O().Fragment,null,O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.invitePeopleMenuItem.primaryLabel",defaultMessage:"Invite people"}),O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.invitePeopleMenuItem.secondaryLabel",defaultMessage:"Add or invite people to the team"})),"aria-haspopup":"dialog"},e))}function Ba(e){const t=(0,a.useDispatch)(),n=(0,P.useCallback)((()=>{t((0,ea.q)({modalId:Y.IQ.ADD_GROUPS_TO_TEAM,dialogType:Ye.A,dialogProps:{focusOriginElement:"sidebarTeamMenuButton"}}))}),[t]);return O().createElement(Na.q7,Object.assign({onClick:n,leadingElement:O().createElement(ze.AccountPlusOutlineIcon,{size:18,"aria-hidden":"true"}),labels:O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.addGroupsToTeamMenuItem.primaryLabel",defaultMessage:"Add groups"}),"aria-haspopup":"dialog"},e))}function Ha(e){const t=(0,a.useDispatch)(),n=(0,P.useCallback)((()=>{t((0,ea.q)({modalId:Y.IQ.TEAM_SETTINGS,dialogType:La.A,dialogProps:{focusOriginElement:"sidebarTeamMenuButton"}}))}),[t]);return O().createElement(Na.q7,Object.assign({leadingElement:O().createElement(ze.SettingsOutlineIcon,{size:18,"aria-hidden":"true"}),onClick:n,labels:O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.teamSettingsMenuItem.primaryLabel",defaultMessage:"Team settings"}),"aria-haspopup":"dialog"},e))}function qa(e){const t=(0,a.useDispatch)(),n=(0,a.useSelector)((e=>(0,sa.pU)(e,he.xB.REMOVE_USER_FROM_TEAM))),s=(0,a.useSelector)((e=>(0,sa.pU)(e,he.xB.MANAGE_TEAM_ROLES))),r=(0,P.useCallback)((()=>{t((0,ea.q)({modalId:Y.IQ.TEAM_MEMBERS,dialogType:Oa.A,dialogProps:{focusOriginElement:"sidebarTeamMenuButton"}}))}),[t]);let i=O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.viewMembersMenuItem.primaryLabel",defaultMessage:"View members"});return n&&s&&(i=O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.manageMembersMenuItem.primaryLabel",defaultMessage:"Manage members"})),O().createElement(Na.q7,Object.assign({leadingElement:O().createElement(ze.AccountMultipleOutlineIcon,{size:18,"aria-hidden":"true"}),onClick:r,labels:i,"aria-haspopup":"dialog"},e))}function ja(e){let{teamID:t}=e;const n=(0,a.useDispatch)(),s=(0,P.useCallback)((()=>{n((0,ea.q)({modalId:Y.IQ.MANAGE_TEAM_GROUPS,dialogType:Pa.A,dialogProps:{teamID:t}}))}),[n,t]);return O().createElement(Na.q7,{leadingElement:O().createElement(ze.MonitorAccountIcon,{size:18,"aria-hidden":"true"}),onClick:s,labels:O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.manageGroupsMenuItem.primaryLabel",defaultMessage:"Manage groups"}),"aria-haspopup":"dialog"})}function Va(){const e=(0,a.useDispatch)(),t=(0,P.useCallback)((()=>{e((0,ea.q)({modalId:Y.IQ.LEAVE_TEAM,dialogType:Ra.A}))}),[e]);return O().createElement(Na.q7,{leadingElement:O().createElement(ze.ExitToAppIcon,{size:18,"aria-hidden":"true"}),onClick:t,isDestructive:!0,labels:O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.leaveTeamMenuItem.primaryLabel",defaultMessage:"Leave team"}),"aria-haspopup":"dialog"})}function Ga(){const e=(0,L.useHistory)(),t=(0,P.useCallback)((()=>{e.push("/select_team")}),[e]);return O().createElement(Na.q7,{leadingElement:O().createElement(ze.MessagePlusOutlineIcon,{size:18,"aria-hidden":"true"}),onClick:t,labels:O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.joinAnotherTeamMenuItem.primaryLabel",defaultMessage:"Join another team"})})}function za(e){let{isCloud:t}=e;const n=(0,L.useHistory)(),s=(0,a.useSelector)(Ia.dw),r=(0,a.useSelector)(Ia.Pd),i=t&&"true"===(null==s?void 0:s.is_free_trial),o=t&&(null==r?void 0:r.sku)===Y.YE.STARTER,l=(0,Aa.A)(),c=o&&!i&&l.teams.active>=0,d=t&&(i||c),u=(0,P.useCallback)((()=>{c||d||n.push("/create_team")}),[n,c]);return O().createElement(Na.q7,{leadingElement:O().createElement(ze.PlusIcon,{size:18,"aria-hidden":"true"}),onClick:u,labels:O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.createTeamMenuItem.primaryLabel",defaultMessage:"Create a team"}),trailingElements:d&&O().createElement(Wa,{isFreeTrial:i})})}function Wa(e){let{isFreeTrial:t}=e;const{formatMessage:n}=(0,ce.useIntl)();return O().createElement(Da.A,{feature:Y.W0.CREATE_MULTIPLE_TEAMS,minimumPlanRequiredForFeature:Y.gS.Professional,blocked:!t,tooltipMessage:n({id:"navbar_dropdown.create.tooltip.cloudFreeTrial",defaultMessage:"During your trial you are able to create multiple teams. These teams will be archived after your trial."}),titleAdminPreTrial:n({id:"navbar_dropdown.create.modal.titleAdminPreTrial",defaultMessage:"Try unlimited teams with a free trial"}),messageAdminPreTrial:n({id:"navbar_dropdown.create.modal.messageAdminPreTrial",defaultMessage:"Create unlimited teams with one of our paid plans. Get the full experience of Enterprise when you start a free, {trialLength} day trial."},{trialLength:ka.$w}),titleAdminPostTrial:n({id:"navbar_dropdown.create.modal.titleAdminPostTrial",defaultMessage:"Upgrade to create unlimited teams"}),messageAdminPostTrial:n({id:"navbar_dropdown.create.modal.messageAdminPostTrial",defaultMessage:"Multiple teams allow for context-specific spaces that are more attuned to your and your teams' needs. Upgrade to the Professional plan to create unlimited teams."}),titleEndUser:n({id:"navbar_dropdown.create.modal.titleEndUser",defaultMessage:"Multiple teams available in paid plans"}),messageEndUser:n({id:"navbar_dropdown.create.modal.messageEndUser",defaultMessage:"Multiple teams allow for context-specific spaces that are more attuned to your teams' needs."})})}za.propTypes={isCloud:B().bool.isRequired};const Ka="https://mattermost.com/pl/mattermost-academy-team-training";function Ya(){const e=(0,P.useCallback)((()=>{window.open(Ka,"_blank","noopener noreferrer")}),[]);return O().createElement(Na.q7,{className:"learnAboutTeamsMenuItem",onClick:e,leadingElement:O().createElement(ze.LightbulbOutlineIcon,{size:18,"aria-hidden":"true"}),labels:O().createElement(ce.FormattedMessage,{id:"sidebarLeft.teamMenu.learnAboutTeamsMenuItem.primaryLabel",defaultMessage:"Learn about teams"})})}function Ja(){const e=(0,a.useSelector)(bt.Ui);if(e.length>0){const t=e.map((e=>O().createElement(Na.q7,{id:"".concat(e.id,"_pluginmenuitem"),key:e.id,onClick:function(){e.action&&e.action()},labels:O().createElement("span",null,e.text)})));return O().createElement(O().Fragment,null,O().createElement(Na.wv,null),t)}return null}const Qa=e=>{const t=(0,a.useSelector)(o.H7);return t?O().createElement("div",{className:"sidebarHeaderContainer"},O().createElement(xa,{currentTeam:t}),(e.canCreateChannel||e.canJoinPublicChannel)&&O().createElement(wa.Ay,{canCreateChannel:e.canCreateChannel,onCreateNewChannelClick:e.showNewChannelModal,canJoinPublicChannel:e.canJoinPublicChannel,onBrowseChannelClick:e.showMoreChannelsModal,onOpenDirectMessageClick:e.handleOpenDirectMessagesModal,canCreateCustomGroups:e.canCreateCustomGroups,onCreateNewUserGroupClick:e.showCreateUserGroupModal,unreadFilterEnabled:e.unreadFilterEnabled,onCreateNewCategoryClick:e.showCreateCategoryModal,onInvitePeopleClick:e.invitePeopleModal})):null};Qa.propTypes={showNewChannelModal:B().func.isRequired,showMoreChannelsModal:B().func.isRequired,showCreateUserGroupModal:B().func.isRequired,invitePeopleModal:B().func.isRequired,showCreateCategoryModal:B().func.isRequired,canCreateChannel:B().bool.isRequired,canJoinPublicChannel:B().bool.isRequired,handleOpenDirectMessagesModal:B().func.isRequired,unreadFilterEnabled:B().bool.isRequired,canCreateCustomGroups:B().bool.isRequired};const Za=Qa;var Xa=n(14696),$a=n(63669),es=n(92243),ts=n(32269),ns=n(4565),as=n(32721),ss=n(26562),rs=n(30138),is=n(4715);function os(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ls="channel";class cs extends O().PureComponent{constructor(e){super(e),os(this,"focusTextbox",(()=>{if(null===this.switchBox)return;const e=this.switchBox.getTextbox();document.activeElement!==e&&(e.focus(),$.PO(e))})),os(this,"setSwitchBoxRef",(e=>{this.switchBox=e,this.focusTextbox()})),os(this,"hideOnSelect",(()=>{this.focusPostTextbox(),this.setState({text:""}),this.props.onExited()})),os(this,"focusPostTextbox",(()=>{is.Fr()||setTimeout((()=>{const e=document.querySelector("#post_textbox");e&&e.focus()}))})),os(this,"hideOnCancel",(()=>{var e,t;null===(e=(t=this.props).onExited)||void 0===e||e.call(t),(0,rs.p)(this.props.focusOriginElement,!0)})),os(this,"onChange",(e=>{this.setState({text:e.target.value,shouldShowLoadingSpinner:!0})})),os(this,"handleSubmit",(async e=>{if(e)if(this.props.rhsOpen&&this.props.rhsState===Y._n.EDIT_HISTORY&&this.props.actions.closeRightHandSide(),this.state.mode===ls){const{joinChannelById:t,switchToChannel:n}=this.props.actions,a=e.channel;e.type===Y.Ay.MENTION_MORE_CHANNELS&&a.type===Y.Ay.OPEN_CHANNEL&&await t(a.id),n(a).then((e=>{"data"in e&&this.hideOnSelect()}))}else(0,Qt.J)().push("/"+e.name),this.hideOnSelect()})),os(this,"handleSuggestionsReceived",(e=>{const t=(0,as.zi)(e),n=t.some((e=>!(0,as.pb)(e)));this.setState({shouldShowLoadingSpinner:n,pretext:e.matchedPretext,hasSuggestions:t.length>0})})),os(this,"render",(()=>{const e=this.channelProviders,t=O().createElement("h2",{id:"quickSwitchHeader"},O().createElement(ce.FormattedMessage,{id:"quick_switch_modal.switchChannels",defaultMessage:"Find Channels"}));let n;n=this.props.isMobileView?O().createElement(ce.FormattedMessage,{id:"quick_switch_modal.help_mobile",defaultMessage:"Type to find a channel."}):O().createElement(ce.FormattedMessage,{id:"quickSwitchModal.help_no_team",defaultMessage:"Type to find a channel. Use <b>UP/DOWN</b> to browse, <b>ENTER</b> to select, <b>ESC</b> to dismiss.",values:{b:e=>O().createElement("b",null,e)}});const a=O().createElement("div",{className:"channel-switcher__header"},t),s=O().createElement("div",{className:"channel-switcher__hint",id:"quickSwitchHint"},n);return O().createElement(Xa.zW,{className:"a11y__modal channel-switcher",id:"quickSwitchModal",show:!0,bodyPadding:!1,enforceFocus:!1,onExited:this.hideOnCancel,onHide:this.hideOnCancel,ariaLabel:this.props.intl.formatMessage({id:"quick_switch_modal.switchChannels",defaultMessage:"Find Channels"}),modalHeaderText:a,modalSubheaderText:s,compassDesign:!0},O().createElement("div",{className:"channel-switcher__suggestion-box"},O().createElement("i",{className:"icon icon-magnify icon-16"}),O().createElement(ts.A,{ref:this.setSwitchBoxRef,id:"quickSwitchInput","aria-label":this.props.intl.formatMessage({id:"quick_switch_modal.input",defaultMessage:"quick switch input"}),className:"form-control focused",onChange:this.onChange,value:this.state.text,onItemSelected:this.handleSubmit,listComponent:ns.A,listPosition:"bottom",maxLength:"64",providers:e,completeOnTab:!1,spellCheck:"false",delayInputUpdate:!0,openWhenEmpty:!0,onSuggestionsReceived:this.handleSuggestionsReceived,forceSuggestionsWhenBlur:!0,shouldSearchCompleteText:!0}),!this.state.shouldShowLoadingSpinner&&!this.state.hasSuggestions&&this.state.text&&O().createElement($a.A,{variant:es.L.Search,titleValues:{channelName:"".concat(this.state.pretext)}})))})),this.channelProviders=[new ss.Ay],this.switchBox=null,this.state={text:"",mode:ls,hasSuggestions:!0,shouldShowLoadingSpinner:!0,pretext:""}}}os(cs,"propTypes",{onExited:B().func.isRequired,isMobileView:B().bool.isRequired,rhsOpen:B().bool,actions:B().shape({joinChannelById:B().func.isRequired,switchToChannel:B().func.isRequired,closeRightHandSide:B().func.isRequired}).isRequired,focusOriginElement:B().string.isRequired});const ds=(0,ce.injectIntl)(cs),us=(0,a.connect)((function(e){return{isMobileView:(0,V.w3)(e),rhsState:(0,d.bM)(e),rhsOpen:(0,d.A)(e)}}),(function(e){return{actions:(0,G.bindActionCreators)({joinChannelById:c.yO,switchToChannel:c.BX,closeRightHandSide:ia.bP},e)}}))(ds);var ms=n(87131),hs=n(61190);function ps(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const gs=(0,ce.defineMessages)({disableTooltip:{id:"sidebar_left.channel_filter.showAllChannels",defaultMessage:"Show all channels"},enableTooltip:{id:"sidebar_left.channel_filter.filterByUnread",defaultMessage:"Filter by unread"}}),fs={default:[hs.f.ctrl,hs.f.shift,"U"],mac:[hs.f.cmd,hs.f.shift,"U"]};class bs extends O().PureComponent{constructor(){super(...arguments),ps(this,"handleUnreadFilterClick",(e=>{null==e||e.preventDefault(),null==e||e.stopPropagation(),this.toggleUnreadFilter()})),ps(this,"handleUnreadFilterKeyPress",(e=>{Xt.r(e)&&e.shiftKey&&Xt.e(e,Y.Ay.KeyCodes.U)&&(e.preventDefault(),e.stopPropagation(),this.toggleUnreadFilter())})),ps(this,"toggleUnreadFilter",(()=>{const{unreadFilterEnabled:e}=this.props;this.props.actions.setUnreadFilterEnabled(!e)}))}componentDidMount(){document.addEventListener("keydown",this.handleUnreadFilterKeyPress)}componentWillUnmount(){document.removeEventListener("keydown",this.handleUnreadFilterKeyPress)}render(){const{intl:e,unreadFilterEnabled:t}=this.props,n=e.formatMessage({id:"sidebar_left.channel_filter.filterUnreadAria",defaultMessage:"unreads filter"});return O().createElement("div",{className:"SidebarFilters"},O().createElement(ms.A,{title:t?gs.disableTooltip:gs.enableTooltip,shortcut:fs},O().createElement("a",{href:"#",className:q()("SidebarFilters_filterButton",{active:t}),onClick:this.toggleUnreadFilter,"aria-label":n},O().createElement("i",{className:"icon icon-filter-variant"}))))}}ps(bs,"propTypes",{unreadFilterEnabled:B().bool.isRequired,actions:B().shape({setUnreadFilterEnabled:B().func.isRequired}).isRequired});const Es=(0,ce.injectIntl)(bs),Cs=(0,a.connect)((function(e){const t=(0,o.vt)(e);return{hasMultipleTeams:t&&t.length>1,unreadFilterEnabled:(0,oa.ZM)(e)}}),(function(e){return{actions:(0,G.bindActionCreators)({setUnreadFilterEnabled:ra.zk},e)}}))(Es);function vs(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ys extends O().PureComponent{constructor(){super(...arguments),vs(this,"openQuickSwitcher",(e=>{e.preventDefault(),this.props.actions.openModal({modalId:Y.IQ.QUICK_SWITCH,dialogType:us,dialogProps:{focusOriginElement:"SidebarChannelNavigatorButton"}})})),vs(this,"handleShortcut",(e=>{const{actions:{closeModal:t}}=this.props;Xt.r(e)&&e.shiftKey&&(Xt.e(e,Y.Ay.KeyCodes.M)&&(e.preventDefault(),t(Y.IQ.QUICK_SWITCH)),Xt.e(e,Y.Ay.KeyCodes.L)&&t(Y.IQ.QUICK_SWITCH))})),vs(this,"handleQuickSwitchKeyPress",(e=>{Xt.r(e)&&!e.shiftKey&&Xt.e(e,Y.Ay.KeyCodes.K)&&(e.altKey||$.Xz(e)||(e.preventDefault(),this.toggleQuickSwitchModal()))})),vs(this,"toggleQuickSwitchModal",(()=>{const{isQuickSwitcherOpen:e,actions:{openModal:t,closeModal:n}}=this.props;e?n(Y.IQ.QUICK_SWITCH):t({modalId:Y.IQ.QUICK_SWITCH,dialogType:us,dialogProps:{focusOriginElement:"SidebarChannelNavigatorButton"}})}))}componentDidMount(){document.addEventListener("keydown",this.handleShortcut),document.addEventListener("keydown",this.handleQuickSwitchKeyPress)}componentWillUnmount(){document.removeEventListener("keydown",this.handleShortcut),document.removeEventListener("keydown",this.handleQuickSwitchKeyPress)}render(){return O().createElement("div",{className:"SidebarChannelNavigator webapp"},!this.props.showUnreadsCategory&&O().createElement(Cs,null),O().createElement("button",{className:"SidebarChannelNavigator_jumpToButton",onClick:this.openQuickSwitcher,"aria-label":this.props.intl.formatMessage({id:"sidebar_left.channel_navigator.channelSwitcherLabel",defaultMessage:"Channel Switcher"}),"aria-haspopup":"dialog","data-testid":"SidebarChannelNavigatorButton",id:"SidebarChannelNavigatorButton"},O().createElement("i",{className:"icon icon-magnify"}),O().createElement(ce.FormattedMessage,{id:"sidebar_left.channel_navigator.jumpTo",defaultMessage:"Find channel"}),O().createElement("div",{className:"SidebarChannelNavigator_shortcutText"},"".concat(is.cX()?"âŒ˜":"Ctrl+","K"))))}}vs(ys,"propTypes",{showUnreadsCategory:B().bool.isRequired,isQuickSwitcherOpen:B().bool.isRequired,actions:B().shape({openModal:B().func.isRequired,closeModal:B().func.isRequired}).isRequired});const Ms=(0,ce.injectIntl)(ys),_s=(0,a.connect)((function(e){return{showUnreadsCategory:(0,b.pE)(e),isQuickSwitcherOpen:(0,la.o)(e,Y.IQ.QUICK_SWITCH)}}),(function(e){return{actions:(0,G.bindActionCreators)({openModal:ea.q,closeModal:ea.O},e)}}))(Ms);var Ts=n(62563),Ss=n(62844),ws=(n(6889),n(22005)),Is=n(77234),As=n(61452),Rs=n(35631),Ns=n(79342),Ps=n(16602),Os=n(8907),Ls=n(22789),Ds=n(19202);function ks(e){const t=(0,ce.useIntl)(),n=(0,P.useCallback)((()=>{e.actions.deleteCategory(e.category.id)}),[e.actions.deleteCategory,e.category]);return O().createElement(Xa.zW,{compassDesign:!0,ariaLabel:t.formatMessage({id:"delete_category_modal.deleteCategory",defaultMessage:"Delete this category?"}),onExited:e.onExited,modalHeaderText:O().createElement(ce.FormattedMessage,{id:"delete_category_modal.deleteCategory",defaultMessage:"Delete this category?"}),handleCancel:e.onExited,handleConfirm:n,confirmButtonText:O().createElement(ce.FormattedMessage,{id:"delete_category_modal.delete",defaultMessage:"Delete"}),confirmButtonClassName:"delete"},O().createElement("span",{className:"delete-category__helpText"},O().createElement(ce.FormattedMessage,{id:"delete_category_modal.helpText",defaultMessage:"Channels in <b>{category_name}</b> will move back to the Channels and Direct messages categories. You're not removed from any channels.",values:{category_name:e.category.display_name,b:e=>O().createElement("b",null,e)}})))}ks.propTypes={onExited:B().func.isRequired,actions:B().shape({deleteCategory:B().func.isRequired}).isRequired},(0,ce.defineMessages)({cancel:{id:"generic_modal.cancel",defaultMessage:"Cancel"},confirm:{id:"generic_modal.confirm",defaultMessage:"Confirm"},paginationCount:{id:"footer_pagination.count",defaultMessage:"Showing {startCount, number}-{endCount, number} of {total, number}"},paginationNext:{id:"footer_pagination.next",defaultMessage:"Next"},paginationPrev:{id:"footer_pagination.prev",defaultMessage:"Previous"}});const Fs=(0,a.connect)(null,(function(e){return{actions:(0,G.bindActionCreators)({deleteCategory:na.K7},e)}}))(ks);var xs=n(12555),Us=n(19174),Bs=n(51877),Hs=n(77813);const qs=e=>{let{category:t}=e;const n=(0,a.useDispatch)(),r=(0,a.useSelector)(b.pE),i=(0,P.useMemo)(oa.vk,[t]),o=(0,a.useSelector)((e=>i(e,t))),{formatMessage:l}=(0,ce.useIntl)();let c=null;if(t.type!==Os.e.DIRECT_MESSAGES){function C(){n((0,na.qh)(t.id,!t.muted))}c=O().createElement(Na.q7,{id:"mute-".concat(t.id),onClick:C,leadingElement:O().createElement(ze.BellOutlineIcon,{size:18}),labels:t.muted?O().createElement(ce.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.unmuteCategory",defaultMessage:"Unmute Category"}):O().createElement(ce.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.muteCategory",defaultMessage:"Mute Category"})})}let d=null,u=null;if(t.type===Os.e.CUSTOM){function v(){n((0,ea.q)({modalId:Y.IQ.DELETE_CATEGORY,dialogType:Fs,dialogProps:{category:t}}))}function y(){n((0,ea.q)({modalId:Y.IQ.EDIT_CATEGORY,dialogType:xs.default,dialogProps:{categoryId:t.id,initialCategoryName:t.display_name}}))}d=O().createElement(Na.q7,{id:"delete-".concat(t.id),isDestructive:!0,"aria-haspopup":!0,onClick:v,leadingElement:O().createElement(ze.TrashCanOutlineIcon,{size:18}),labels:O().createElement(ce.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.deleteCategory",defaultMessage:"Delete Category"})}),u=O().createElement(Na.q7,{id:"rename-".concat(t.id),onClick:y,"aria-haspopup":!0,leadingElement:O().createElement(ze.PencilOutlineIcon,{size:18}),labels:O().createElement(ce.FormattedMessage,{id:"sidebar_left.sidebar_category_menu.renameCategory",defaultMessage:"Rename Category"})})}function m(e){n((0,na.rV)(t.id,e))}let h=O().createElement(ce.FormattedMessage,{id:"sidebar.sortedManually",defaultMessage:"Manually"}),p=O().createElement(ze.FormatListBulletedIcon,{size:18});t.sorting===Ps.b.Alphabetical?(h=O().createElement(ce.FormattedMessage,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),p=O().createElement(ze.SortAlphabeticalAscendingIcon,{size:18})):t.sorting===Ps.b.Recency&&(h=O().createElement(ce.FormattedMessage,{id:"user.settings.sidebar.recent",defaultMessage:"Recent Activity"}),p=O().createElement(ze.ClockOutlineIcon,{size:18}));const g=O().createElement(Na.g8,{id:"sortChannels-".concat(t.id),leadingElement:p,labels:O().createElement(ce.FormattedMessage,{id:"sidebar.sort",defaultMessage:"Sort"}),trailingElements:O().createElement(O().Fragment,null,h,O().createElement(ze.ChevronRightIcon,{size:16})),menuId:"sortChannels-".concat(t.id,"-menu"),menuAriaLabel:l({id:"sidebar_left.sidebar_category_menu.sort.dropdownAriaLabel",defaultMessage:"Sort submenu"})},O().createElement(Na.q7,{id:"sortAplhabetical-".concat(t.id),labels:O().createElement(ce.FormattedMessage,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),onClick:()=>m(Ps.b.Alphabetical),trailingElements:t.sorting===Ps.b.Alphabetical?O().createElement(ze.CheckIcon,{size:16}):null}),O().createElement(Na.q7,{id:"sortByMostRecent-".concat(t.id),labels:O().createElement(ce.FormattedMessage,{id:"sidebar.sortedByRecencyLabel",defaultMessage:"Recent Activity"}),onClick:()=>m(Ps.b.Recency),trailingElements:t.sorting===Ps.b.Recency?O().createElement(ze.CheckIcon,{size:16}):null}),O().createElement(Na.q7,{id:"sortManual-".concat(t.id),labels:O().createElement(ce.FormattedMessage,{id:"sidebar.sortedManually",defaultMessage:"Manually"}),onClick:()=>m(Ps.b.Manual),trailingElements:t.sorting===Ps.b.Manual?O().createElement(ze.CheckIcon,{size:16}):null})),f=(0,P.useCallback)((()=>{n((0,s.Zi)(o))}),[n,o]),E=!1===r?O().createElement(Bs.A,{id:t.id,handleViewCategory:f,numChannels:o.length}):null;return O().createElement(Hs.A,{id:t.id,name:t.display_name},E,E&&O().createElement(Na.wv,null),c,u,d,O().createElement(Na.wv,null),g,O().createElement(Na.wv,null),O().createElement(Us.A,{id:t.id}))},js=(0,P.memo)(qs),Vs=e=>{let{category:t,handleOpenDirectMessagesModal:n}=e;const[s,r]=(0,P.useState)(!1),{formatMessage:i}=(0,ce.useIntl)(),o=(0,a.useDispatch)(),c=(0,a.useSelector)(b.pR),d=(0,a.useSelector)(l.WR);function u(e){o((0,na.rV)(t.id,e))}let m=O().createElement(ze.ClockOutlineIcon,{size:18}),h=O().createElement(ce.FormattedMessage,{id:"user.settings.sidebar.recent",defaultMessage:"Recent Activity"});t.sorting===Ps.b.Alphabetical&&(h=O().createElement(ce.FormattedMessage,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),m=O().createElement(ze.SortAlphabeticalAscendingIcon,{size:18}));const p=O().createElement(Na.g8,{id:"sortDirectMessages-".concat(t.id),leadingElement:m,labels:O().createElement(ce.FormattedMessage,{id:"sidebar.sort",defaultMessage:"Sort"}),trailingElements:O().createElement(O().Fragment,null,h,O().createElement(ze.ChevronRightIcon,{size:16})),menuId:"sortDirectMessages-".concat(t.id,"-menu")},O().createElement(Na.q7,{id:"sortAlphabetical-".concat(t.id),labels:O().createElement(ce.FormattedMessage,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),onClick:()=>u(Ps.b.Alphabetical),trailingElements:t.sorting===Ps.b.Alphabetical?O().createElement(ze.CheckIcon,{size:16}):null}),O().createElement(Na.q7,{id:"sortByMostRecent-".concat(t.id),labels:O().createElement(ce.FormattedMessage,{id:"sidebar.sortedByRecencyLabel",defaultMessage:"Recent Activity"}),onClick:()=>u(Ps.b.Recency),trailingElements:t.sorting===Ps.b.Recency?O().createElement(ze.CheckIcon,{size:16}):null}));let g=O().createElement("span",null,c);1e4===c&&(g=O().createElement(ce.FormattedMessage,{id:"channel_notifications.levels.all",defaultMessage:"All"}));const f=O().createElement(Na.g8,{id:"showMessagesCount-".concat(t.id),leadingElement:O().createElement(ze.AccountMultipleOutlineIcon,{size:18}),labels:O().createElement(ce.FormattedMessage,{id:"sidebar.show",defaultMessage:"Show"}),trailingElements:O().createElement(O().Fragment,null,g,O().createElement(ze.ChevronRightIcon,{size:16})),menuId:"showMessagesCount-".concat(t.id,"-menu")},Y.Ay.DM_AND_GM_SHOW_COUNTS.map((e=>O().createElement(Na.q7,{id:"showDmCount-".concat(t.id,"-").concat(e),key:"showDmCount-".concat(t.id,"-").concat(e),labels:O().createElement("span",null,e),onClick:()=>{return t=e,void o((0,Rs.SF)(d,[{user_id:d,category:Y.Ay.Preferences.CATEGORY_SIDEBAR_SETTINGS,name:he.pm.LIMIT_VISIBLE_DMS_GMS,value:t.toString()}]));var t},trailingElements:c===e?O().createElement(ze.CheckIcon,{size:16}):null})))),E=O().createElement(Na.q7,{id:"openDirectMessage-".concat(t.id),onClick:n,leadingElement:O().createElement(ze.AccountPlusOutlineIcon,{size:18}),labels:O().createElement(ce.FormattedMessage,{id:"sidebar.openDirectMessage",defaultMessage:"Open a direct message"})});return O().createElement("div",{className:q()("SidebarMenu","MenuWrapper",{menuOpen:s},{"MenuWrapper--open":s})},O().createElement(Na.mc,{menuButton:{id:"SidebarCategorySortingMenu-Button-".concat(t.id),"aria-label":i({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"},{name:t.display_name}),class:"SidebarMenu_menuButton sortingMenu",children:O().createElement(ze.DotsVerticalIcon,{size:16})},menuButtonTooltip:{text:i({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"},{name:t.display_name}),class:"hidden-xs"},menu:{id:"SidebarCategorySortingMenu-MenuList-".concat(t.id),"aria-label":i({id:"sidebar_left.sidebar_category_menu.dropdownAriaLabel",defaultMessage:"Edit category menu"}),onToggle:function(e){r(e)}}},p,f,O().createElement(Na.wv,null),E))},Gs=(0,P.memo)(Vs);function zs(e){return e.views.addChannelCtaDropdown.isOpen}var Ws=n(52052),Ks=n(63234),Ys=n(17983),Js=n(99068);const Qs=()=>{const e=(0,a.useDispatch)(),t=(0,a.useSelector)(o.Sy),n=(0,ce.useIntl)(),s=(0,a.useSelector)((e=>(0,b.Jz)(e,Y.pm.TOUCHED,Y.JS.ADD_CHANNELS_CTA))),r=(0,a.useSelector)((e=>(0,sa.xY)(e,aa.A.CREATE_PUBLIC_CHANNEL))),i=(0,a.useSelector)((e=>(0,sa.xY)(e,aa.A.CREATE_PRIVATE_CHANNEL)))||r,l=(0,a.useSelector)((e=>(0,sa.xY)(e,aa.A.JOIN_PUBLIC_CHANNELS))),c=(0,a.useSelector)(zs),d=(0,a.useSelector)(f.WR),u=(0,P.useCallback)((t=>{e(function(e){return{type:Y.Q3.ADD_CHANNEL_CTA_DROPDOWN_TOGGLE,open:e}}(t))}),[]);let m="SidebarChannelNavigator__addChannelsCtaLhsButton";if(s||(m+=" SidebarChannelNavigator__addChannelsCtaLhsButton--untouched"),!i&&!l||!t)return null;const h=()=>{e((0,ea.q)({modalId:Y.IQ.MORE_CHANNELS,dialogType:Ws.default}))},p=()=>{e((0,ea.q)({modalId:Y.IQ.NEW_CHANNEL_MODAL,dialogType:Ks.default}))},g=e=>O().createElement("button",{className:m,id:"addChannelsCta","aria-label":n.formatMessage({id:"sidebar_left.add_channel_dropdown.dropdownAriaLabel",defaultMessage:"Add Channel Dropdown"}),onClick:()=>null==e?void 0:e()},O().createElement("div",{"aria-label":n.formatMessage({id:"sidebar_left.sidebar_channel_navigator.addChannelsCta",defaultMessage:"Add channels"})},O().createElement("i",{className:"icon-plus-box"}),O().createElement("span",null,n.formatMessage({id:"sidebar_left.addChannelsCta",defaultMessage:"Add Channels"})))),E=()=>{s||e((0,Rs.SF)(d,[{category:Y.pm.TOUCHED,user_id:d,name:Y.JS.ADD_CHANNELS_CTA,value:"true"}]))};return i?O().createElement(Js.A,{className:"AddChannelsCtaDropdown",onToggle:e=>{u(e),E()},open:c},g(),O().createElement(Ys.A,{id:"AddChannelCtaDropdown",ariaLabel:n.formatMessage({id:"sidebar_left.add_channel_cta_dropdown.dropdownAriaLabel",defaultMessage:"Add Channels Dropdown"})},(()=>{let e,t;return l&&(e=O().createElement(Ys.A.ItemAction,{id:"showMoreChannels",onClick:h,icon:O().createElement("i",{className:"icon-globe"}),text:n.formatMessage({id:"sidebar_left.add_channel_dropdown.browseChannels",defaultMessage:"Browse channels"})})),i&&(t=O().createElement(Ys.A.ItemAction,{id:"showNewChannel",onClick:p,icon:O().createElement("i",{className:"icon-plus"}),text:n.formatMessage({id:"sidebar_left.add_channel_dropdown.createNewChannel",defaultMessage:"Create new channel"})})),O().createElement(O().Fragment,null,O().createElement(Ys.A.Group,null,t,e))})())):g((()=>{h(),E()}))},Zs=e=>{const t=(0,ce.useIntl)(),n=(0,a.useSelector)(o.Sy);return n?O().createElement(st.A,{teamId:n,permissions:[he.xB.ADD_USER_TO_TEAM,he.xB.INVITE_GUEST]},O().createElement(it.A,{ariaLabel:t.formatMessage({id:"sidebar_left.inviteMembers",defaultMessage:"Invite Members"}),id:"inviteMembersButton",className:"intro-links color--link cursor--pointer".concat(e.className?" ".concat(e.className):""),modalId:Y.IQ.INVITATION,dialogType:ut.default,dialogProps:{focusOriginElement:"inviteMembersButton"}},O().createElement("div",{className:"SidebarChannelNavigator__inviteMembersLhsButton","aria-label":t.formatMessage({id:"sidebar_left.sidebar_channel_navigator.inviteUsers",defaultMessage:"Invite Members"})},O().createElement("i",{className:"icon-plus-box","aria-hidden":"true"}),O().createElement(ce.FormattedMessage,{id:"sidebar_left.inviteMembers",defaultMessage:"Invite Members"})))):null};Zs.propTypes={className:B().string};const Xs=Zs;var $s=n(66039),er=n(69440);function tr(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class nr extends O().PureComponent{constructor(e){super(e),tr(this,"handleA11yActivateEvent",(()=>{var e;null===(e=this.categoryTitleRef.current)||void 0===e||e.addEventListener("keydown",this.handleA11yKeyDown),this.a11yKeyDownRegistered=!0})),tr(this,"handleA11yDeactivateEvent",(()=>{var e;null===(e=this.categoryTitleRef.current)||void 0===e||e.removeEventListener("keydown",this.handleA11yKeyDown),this.a11yKeyDownRegistered=!1})),tr(this,"handleA11yKeyDown",(e=>{(0,Xt.e)(e,Y.Ay.KeyCodes.ENTER)&&(e.preventDefault(),this.handleCollapse())})),tr(this,"renderChannel",((e,t)=>{const{setChannelRef:n,category:a,draggingState:s}=this.props;return O().createElement(er.A,{key:e,channelIndex:t,channelId:e,isDraggable:!0,setChannelRef:n,isCategoryCollapsed:a.collapsed,isCategoryDragged:s.type===Y.I8.CATEGORY&&s.id===a.id,isAutoSortedCategory:a.sorting===Ps.b.Alphabetical||a.sorting===Ps.b.Recency})})),tr(this,"handleCollapse",(()=>{const{category:e}=this.props;this.props.actions.setCategoryCollapsed(e.id,!e.collapsed)})),tr(this,"removeAnimation",(()=>{this.newDropBoxRef.current&&this.newDropBoxRef.current.classList.remove("animating")})),tr(this,"handleOpenDirectMessagesModal",(e=>{e.preventDefault(),this.props.handleOpenMoreDirectChannelsModal(e.nativeEvent)})),tr(this,"isDropDisabled",(()=>{const{draggingState:e,category:t}=this.props;return t.type===Os.e.DIRECT_MESSAGES?e.type===Y.I8.CHANNEL:t.type===Os.e.CHANNELS&&e.type===Y.I8.DM})),tr(this,"renderNewDropBox",(e=>{const{draggingState:t,category:n,isNewCategory:a,channelIds:s}=this.props;return!a||null!=s&&s.length?null:O().createElement(O().Fragment,null,O().createElement(ws.Draggable,{draggableId:"NEW_CHANNEL_SPACER__".concat(n.id),isDragDisabled:!0,index:0},(e=>O().createElement("li",Object.assign({ref:e.innerRef,draggable:"false",className:"SidebarChannel noFloat newChannelSpacer"},e.draggableProps,{tabIndex:-1})))),O().createElement("div",{className:"SidebarCategory_newDropBox"},O().createElement("div",{ref:this.newDropBoxRef,className:q()("SidebarCategory_newDropBox-content",{collapsed:n.collapsed||t.type===Y.I8.CATEGORY&&t.id===n.id,isDraggingOver:e}),onTransitionEnd:this.removeAnimation},O().createElement("i",{className:"icon-hand-right"}),O().createElement("span",{className:"SidebarCategory_newDropBox-label"},O().createElement(ce.FormattedMessage,{id:"sidebar_left.sidebar_category.newDropBoxLabel",defaultMessage:"Drag channels here..."})))))})),tr(this,"showPlaceholder",(()=>{const{channelIds:e,draggingState:t,category:n,isNewCategory:a}=this.props;return n.sorting!==Ps.b.Alphabetical&&n.sorting!==Ps.b.Recency&&!a||!!e.find((e=>e===t.id))})),this.categoryTitleRef=O().createRef(),this.newDropBoxRef=O().createRef(),this.state={isMenuOpen:!1},this.a11yKeyDownRegistered=!1}componentDidUpdate(e){this.props.category.collapsed!==e.category.collapsed&&this.newDropBoxRef.current&&this.newDropBoxRef.current.classList.add("animating")}componentDidMount(){var e,t;null===(e=this.categoryTitleRef.current)||void 0===e||e.addEventListener(Y.pn.ACTIVATE,this.handleA11yActivateEvent),null===(t=this.categoryTitleRef.current)||void 0===t||t.addEventListener(Y.pn.DEACTIVATE,this.handleA11yDeactivateEvent)}componentWillUnmount(){var e,t;null===(e=this.categoryTitleRef.current)||void 0===e||e.removeEventListener(Y.pn.ACTIVATE,this.handleA11yActivateEvent),null===(t=this.categoryTitleRef.current)||void 0===t||t.removeEventListener(Y.pn.DEACTIVATE,this.handleA11yDeactivateEvent),this.a11yKeyDownRegistered&&this.handleA11yDeactivateEvent()}render(){const{category:e,categoryIndex:t,channelIds:n,isNewCategory:a}=this.props;if(!e)return null;if(e.type===Os.e.FAVORITES&&(null==n||!n.length))return null;const s=n.map(this.renderChannel);let r,i,o=!0;if(a)i=O().createElement("div",{className:"SidebarCategory_newLabel"},O().createElement(ce.FormattedMessage,{id:"sidebar_left.sidebar_category.newLabel",defaultMessage:"new"})),r=O().createElement(js,{category:e});else if(e.type===Os.e.DIRECT_MESSAGES){const t=(0,Ls.V)({id:"sidebar.createDirectMessage",defaultMessage:"Create new direct message"});r=O().createElement(O().Fragment,null,O().createElement(Gs,{category:e,handleOpenDirectMessagesModal:this.handleOpenDirectMessagesModal}),O().createElement(ms.A,{title:O().createElement(O().Fragment,null,t,O().createElement(Ds.h,{shortcut:Ds.A.navDMMenu,hideDescription:!0,isInsideTooltip:!0}))},O().createElement("button",{id:"newDirectMessageButton",className:"SidebarChannelGroupHeader_addButton",onClick:this.handleOpenDirectMessagesModal,"aria-label":t},O().createElement("i",{className:"icon-plus"})))),n&&n.length||(o=!1)}else r=O().createElement(js,{category:e});let l=e.display_name;if(e.type!==Os.e.CUSTOM){const t=ar[e.type];l=(0,Ls.V)({id:t.id,defaultMessage:t.defaultMessage})}return O().createElement(ws.Draggable,{draggableId:e.id,index:t,disableInteractiveElementBlocking:!0},((t,n)=>{let a=null;"direct_messages"!==e.type||e.collapsed||(a=O().createElement(Xs,{className:"followingSibling"}));let c=null;return"channels"!==e.type||e.collapsed||(c=O().createElement(Qs,null)),O().createElement("div",Object.assign({className:q()("SidebarChannelGroup a11y__section",{dropDisabled:this.isDropDisabled(),menuIsOpen:this.state.isMenuOpen,capture:this.props.draggingState.state===Y.W7.CAPTURE,isCollapsed:e.collapsed}),ref:t.innerRef},t.draggableProps),O().createElement(ws.Droppable,{droppableId:e.id,type:"SIDEBAR_CHANNEL",isDropDisabled:this.isDropDisabled()},((a,c)=>O().createElement("div",Object.assign({},a.droppableProps,{ref:a.innerRef,className:q()({draggingOver:c.isDraggingOver})}),O().createElement($s.w,{ref:this.categoryTitleRef,displayName:l,dragHandleProps:t.dragHandleProps,isCollapsed:e.collapsed,isCollapsible:o,isDragging:n.isDragging,isDraggingOver:c.isDraggingOver,muted:e.muted,onClick:this.handleCollapse},i,null,r),O().createElement("div",{className:q()("SidebarChannelGroup_content")},O().createElement("ul",{className:"NavGroupContent"},this.renderNewDropBox(c.isDraggingOver),s,this.showPlaceholder()?a.placeholder:null))))),a,c)}))}}const ar=(0,ce.defineMessages)({channels:{id:"sidebar.types.channels",defaultMessage:"CHANNELS"},direct_messages:{id:"sidebar.types.direct_messages",defaultMessage:"DIRECT MESSAGES"},favorites:{id:"sidebar.types.favorites",defaultMessage:"FAVORITES"}}),sr=(0,a.connect)((function(){const e=(0,oa._)();return(t,n)=>({channelIds:e(t,n.category),draggingState:(0,oa.NX)(t),currentUserId:(0,l.WR)(t),isAdmin:(0,Ns.qc)((0,l.HW)(t).roles)})}),(function(e){return{actions:(0,G.bindActionCreators)({setCategoryCollapsed:na.AD,setCategorySorting:na.rV,savePreferences:Rs.SF},e)}}))(nr);function rr(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ir=(0,x.S)("DraftsLink",(0,P.lazy)((()=>n.e(2539).then(n.bind(n,22539))))),or=(0,x.S)("GlobalThreadsLink",(0,P.lazy)((()=>n.e(7351).then(n.bind(n,31551))))),lr=(0,x.S)("UnreadChannelIndicator",(0,P.lazy)((()=>n.e(4986).then(n.bind(n,4986))))),cr=(0,x.S)("UnreadChannels",(0,P.lazy)((()=>n.e(4526).then(n.bind(n,34526)))));class dr extends O().PureComponent{constructor(e){var t;super(e),t=this,rr(this,"getDisplayedChannelIds",(()=>this.props.displayedChannels.map((e=>e.id)))),rr(this,"getDisplayedStaticPageIds",(()=>this.props.staticPages.map((e=>e.id)))),rr(this,"setChannelRef",((e,t)=>{t?this.channelRefs.set(e,t):this.channelRefs.delete(e)})),rr(this,"getFirstUnreadChannelFromChannelIdArray",(e=>e.find((e=>e!==this.props.currentChannelId&&this.props.unreadChannelIds.includes(e))))),rr(this,"handleScrollAnimationUpdate",(e=>{var t,n;const a=e.getCurrentValue();null===(t=(n=this.scrollbar.current).scrollTo)||void 0===t||t.call(n,{top:a})})),rr(this,"scrollToFirstUnreadChannel",(()=>{this.scrollToChannel(this.getFirstUnreadChannel(),!0)})),rr(this,"scrollToLastUnreadChannel",(()=>{this.scrollToChannel(this.getLastUnreadChannel(),!0)})),rr(this,"scrollToChannel",(function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return;const a=t.channelRefs.get(e);if(!a)return;const s=a.offsetTop,r=s+a.offsetHeight,i=t.scrollbar.current.scrollTop,o=t.scrollbar.current.clientHeight;if(s<i+32){const a=n||!t.state.showTopUnread?10:55;let r;const i=t.getDisplayedChannelIds();r=i.length>0&&i[0]===e?0:s-a-32,t.scrollToPosition(r)}else if(r>i+o){const e=r-o+(n||!t.state.showBottomUnread?10:55);t.scrollToPosition(e)}})),rr(this,"scrollToPosition",(e=>{this.scrollAnimation.setCurrentValue(this.scrollbar.current.scrollTop).setAtRest(),this.scrollAnimation.setEndValue(e)})),rr(this,"updateUnreadIndicators",(()=>{if(this.props.draggingState.state)return void this.setState({showTopUnread:!1,showBottomUnread:!1});let e=!1,t=!1;const n=this.getFirstUnreadChannel(),a=this.getLastUnreadChannel();if(n){const t=this.channelRefs.get(n);t&&t.offsetTop+t.offsetHeight-10-32<this.scrollbar.current.scrollTop&&(e=!0)}if(a){const e=this.channelRefs.get(a);e&&e.offsetTop+10>this.scrollbar.current.scrollTop+this.scrollbar.current.clientHeight&&(t=!0)}e===this.state.showTopUnread&&t===this.state.showBottomUnread||this.setState({showTopUnread:e,showBottomUnread:t})})),rr(this,"getFirstUnreadChannel",(()=>this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds()))),rr(this,"getLastUnreadChannel",(()=>this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds().reverse()))),rr(this,"navigateById",(e=>{-1===this.props.staticPages.findIndex((t=>t.id===e))?this.props.actions.switchToChannelById(e):this.props.actions.switchToLhsStaticPage(e)})),rr(this,"navigateChannelShortcut",(e=>{if(!e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||!(0,Xt.e)(e,Y.YM.KeyCodes.UP)&&!(0,Xt.e)(e,Y.YM.KeyCodes.DOWN))(0,Xt.r)(e)&&e.shiftKey&&(0,Xt.e)(e,Y.YM.KeyCodes.K)&&this.props.handleOpenMoreDirectChannelsModal(e);else{e.preventDefault();const t=this.getDisplayedStaticPageIds(),n=[...t,...this.getDisplayedChannelIds()],a=this.props.currentChannelId||this.props.currentStaticPageId,s=n.indexOf(a);let r;r=(0,Xt.e)(e,Y.YM.KeyCodes.DOWN)?s+1:s-1;const i=n[(0,$.zi)(r,n.length)];this.navigateById(i),r>=t.length&&this.scrollToChannel(i)}})),rr(this,"navigateUnreadChannelShortcut",(e=>{if(e.altKey&&e.shiftKey&&!e.ctrlKey&&!e.metaKey&&((0,Xt.e)(e,Y.YM.KeyCodes.UP)||(0,Xt.e)(e,Y.YM.KeyCodes.DOWN))){e.preventDefault();const t=this.getDisplayedChannelIds(),n=[...this.props.unreadChannelIds];this.props.collapsedThreads&&(t.unshift(""),this.props.hasUnreadThreads&&n.unshift(""));let a=0;a=(0,Xt.e)(e,Y.YM.KeyCodes.UP)?-1:1;const s=(0,X.y9)(this.props.currentChannelId,t,n,a);if(-1!==s){const e=t[s];this.navigateById(e),this.scrollToChannel(e)}}})),rr(this,"renderCategory",((e,t)=>O().createElement(sr,{key:e.id,category:e,categoryIndex:t,setChannelRef:this.setChannelRef,handleOpenMoreDirectChannelsModal:this.props.handleOpenMoreDirectChannelsModal,isNewCategory:this.props.newCategoryIds.includes(e.id)}))),rr(this,"onScroll",_e()((()=>{this.updateUnreadIndicators()}),100)),rr(this,"onTransitionEnd",_e()((()=>{this.updateUnreadIndicators()}),100)),rr(this,"onBeforeCapture",(e=>{this.channelRefs.forEach((e=>e.classList.remove("animating")));const t=[...document.querySelectorAll('[data-rbd-droppable-id*="droppable-categories"]')];t[0].style.height="".concat(t[0].scrollHeight,"px"),this.props.multiSelectedChannelIds.find((t=>e.draggableId===t))||this.props.actions.clearChannelSelection();const n={state:Y.W7.CAPTURE,id:e.draggableId};if(this.props.categories.some((t=>t.id===e.draggableId)))n.type=Y.I8.CATEGORY;else{const t=this.props.displayedChannels.filter((t=>-1!==this.props.multiSelectedChannelIds.indexOf(t.id)||t.id===e.draggableId));t.every((e=>e.type===he.Bz.DM_CHANNEL||e.type===he.Bz.GM_CHANNEL))?n.type=Y.I8.DM:t.every((e=>e.type!==he.Bz.DM_CHANNEL&&e.type!==he.Bz.GM_CHANNEL))?n.type=Y.I8.CHANNEL:n.type=Y.I8.MIXED_CHANNELS}this.props.actions.setDraggingState(n)})),rr(this,"onBeforeDragStart",(()=>{this.props.actions.setDraggingState({state:Y.W7.BEFORE})})),rr(this,"onDragStart",(e=>{this.props.onDragStart(e),this.props.actions.setDraggingState({state:Y.W7.DURING}),[...document.querySelectorAll('[data-rbd-droppable-id*="droppable-categories"]')][0].style.height=""})),rr(this,"onDragEnd",(e=>{this.props.onDragEnd(e),"DROP"===e.reason&&e.destination&&("SIDEBAR_CHANNEL"===e.type?this.props.actions.moveChannelsInSidebar(e.destination.droppableId,e.destination.index,e.draggableId):"SIDEBAR_CATEGORY"===e.type&&this.props.actions.moveCategory(this.props.currentTeam.id,e.draggableId,e.destination.index)),this.props.actions.stopDragging()})),this.channelRefs=new Map,this.state={showTopUnread:!1,showBottomUnread:!1},this.scrollbar=O().createRef(),this.animate=new Is.SpringSystem,this.scrollAnimation=this.animate.createSpring(),this.scrollAnimation.setOvershootClampingEnabled(!0),this.scrollAnimation.addListener({onSpringUpdate:this.handleScrollAnimationUpdate})}componentDidMount(){document.addEventListener("keydown",this.navigateChannelShortcut),document.addEventListener("keydown",this.navigateUnreadChannelShortcut)}componentWillUnmount(){document.removeEventListener("keydown",this.navigateChannelShortcut),document.removeEventListener("keydown",this.navigateUnreadChannelShortcut)}componentDidUpdate(e){this.props.currentChannelId&&e.currentChannelId&&(this.props.currentTeam!==e.currentTeam&&this.scrollbar.current.scrollTo({top:0}),this.props.currentChannelId,e.currentChannelId,this.props.currentChannelId!==e.currentChannelId&&this.props.actions.close(),this.updateUnreadIndicators())}render(){const{categories:e}=this.props;let t;if(this.props.isUnreadFilterEnabled)t=O().createElement(cr,{setChannelRef:this.setChannelRef});else{let n;this.props.showUnreadsCategory&&(n=O().createElement(cr,{setChannelRef:this.setChannelRef}));const a=e.map(this.renderCategory);t=O().createElement(O().Fragment,null,n,O().createElement(ws.DragDropContext,{onDragEnd:this.onDragEnd,onBeforeDragStart:this.onBeforeDragStart,onBeforeCapture:this.onBeforeCapture,onDragStart:this.onDragStart},O().createElement(ws.Droppable,{droppableId:"droppable-categories",type:"SIDEBAR_CATEGORY"},(e=>O().createElement("div",Object.assign({id:"sidebar-droppable-categories",ref:e.innerRef},e.droppableProps),a,e.placeholder)))))}const n=O().createElement(ce.FormattedMessage,{id:"sidebar.unreads",defaultMessage:"More unreads"}),a=O().createElement(ce.FormattedMessage,{id:"sidebar.unreads",defaultMessage:"More unreads"}),s=this.props.intl.formatMessage({id:"accessibility.sections.lhsList",defaultMessage:"channel sidebar region"});return O().createElement(O().Fragment,null,O().createElement(or,null),O().createElement(ir,null),O().createElement("div",{id:"sidebar-left",role:"application","aria-label":s,className:q()("SidebarNavContainer a11y__region",{disabled:this.props.isUnreadFilterEnabled}),"data-a11y-disable-nav":Boolean(this.props.draggingState.type),"data-a11y-sort-order":"7",onTransitionEnd:this.onTransitionEnd},O().createElement(lr,{name:"Top",show:this.state.showTopUnread,onClick:this.scrollToFirstUnreadChannel,extraClass:"nav-pills__unread-indicator-top",content:n}),O().createElement(lr,{name:"Bottom",show:this.state.showBottomUnread,onClick:this.scrollToLastUnreadChannel,extraClass:"nav-pills__unread-indicator-bottom",content:a}),O().createElement(As.A,{ref:this.scrollbar,onScroll:this.onScroll},t)))}}rr(dr,"propTypes",{currentChannelId:B().string.isRequired,categories:B().array.isRequired,unreadChannelIds:B().arrayOf(B().string).isRequired,isUnreadFilterEnabled:B().bool.isRequired,displayedChannels:B().array.isRequired,newCategoryIds:B().arrayOf(B().string).isRequired,multiSelectedChannelIds:B().arrayOf(B().string).isRequired,showUnreadsCategory:B().bool.isRequired,collapsedThreads:B().bool.isRequired,hasUnreadThreads:B().bool.isRequired,currentStaticPageId:B().string.isRequired,staticPages:B().array.isRequired,handleOpenMoreDirectChannelsModal:B().func.isRequired,onDragStart:B().func.isRequired,onDragEnd:B().func.isRequired,actions:B().shape({moveChannelsInSidebar:B().func.isRequired,moveCategory:B().func.isRequired,switchToChannelById:B().func.isRequired,switchToLhsStaticPage:B().func.isRequired,close:B().func.isRequired,setDraggingState:B().func.isRequired,stopDragging:B().func.isRequired,clearChannelSelection:B().func.isRequired}).isRequired});const ur=(0,ce.injectIntl)(dr),mr=(0,a.connect)((function(e){const t=(0,o.H7)(e),n=(0,b.WW)(e);let a=!1;var s;return n&&(a=Boolean(null===(s=(0,Ts.kL)(e))||void 0===s?void 0:s.total_unread_threads)),{currentTeam:t,currentChannelId:(0,r.eH)(e),categories:(0,oa.WJ)(e),isUnreadFilterEnabled:(0,oa.ZM)(e),unreadChannelIds:(0,r.tr)(e),displayedChannels:(0,oa.sC)(e),draggingState:(0,oa.NX)(e),newCategoryIds:e.views.channelSidebar.newCategoryIds,multiSelectedChannelIds:e.views.channelSidebar.multiSelectedChannelIds,showUnreadsCategory:(0,b.pE)(e),collapsedThreads:n,hasUnreadThreads:a,currentStaticPageId:(0,W.SM)(e),staticPages:(0,W.j4)(e)}}),(function(e){return{actions:(0,G.bindActionCreators)({close:Ss.VN,switchToChannelById:c.Tw,moveChannelsInSidebar:ra.nh,moveCategory:na.Ax,setDraggingState:ra.Jb,stopDragging:ra.U5,clearChannelSelection:ra.lE,switchToLhsStaticPage:Ss.S_},e)}}))(ur);function hr(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const pr=(0,x.S)("MobileSidebarHeader",(0,P.lazy)((()=>n.e(5808).then(n.bind(n,25808))))),gr=(0,x.S)("MoreDirectChannels",(0,P.lazy)((()=>n.e(6532).then(n.bind(n,96532))))),fr=(0,x.S)("BrowseChannels",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,52052))))),br=(0,x.S)("EditCategoryModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,12555))))),Er=(0,x.S)("CreateUserGroupsModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,36143))))),Cr=(0,x.S)("InvitationModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,49888))))),vr=(0,x.S)("KeyboardShortcutsModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,92904))))),yr=(0,x.S)("NewChannelModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,63234))))),Mr=(0,x.S)("UserSettingsModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,59529)))));class _r extends O().PureComponent{constructor(e){super(e),hr(this,"handleClickClearChannelSelection",(e=>{e.defaultPrevented||this.props.actions.clearChannelSelection()})),hr(this,"handleKeyDownEvent",(e=>{(0,Xt.e)(e,Y.Ay.KeyCodes.ESCAPE)?this.props.actions.clearChannelSelection():(0,Xt.r)(e,!0)&&((0,Xt.e)(e,Y.Ay.KeyCodes.FORWARD_SLASH)?(e.preventDefault(),this.props.isKeyBoardShortcutModalOpen?this.props.actions.closeModal(Y.IQ.KEYBOARD_SHORTCUTS_MODAL):this.props.actions.openModal({modalId:Y.IQ.KEYBOARD_SHORTCUTS_MODAL,dialogType:vr})):(0,Xt.e)(e,Y.Ay.KeyCodes.A)&&e.shiftKey&&(e.preventDefault(),this.props.actions.openModal({modalId:Y.IQ.USER_SETTINGS,dialogType:Mr,dialogProps:{isContentProductSettings:!0,focusOriginElement:"sidebar.tsx"}})))})),hr(this,"showMoreDirectChannelsModal",(()=>{this.setState({showDirectChannelsModal:!0})})),hr(this,"hideMoreDirectChannelsModal",(()=>{this.setState({showDirectChannelsModal:!1})})),hr(this,"showCreateCategoryModal",(()=>{this.props.actions.openModal({modalId:Y.IQ.EDIT_CATEGORY,dialogType:br,dialogProps:{}})})),hr(this,"showMoreChannelsModal",(()=>{this.props.actions.openModal({modalId:Y.IQ.MORE_CHANNELS,dialogType:fr})})),hr(this,"invitePeopleModal",(()=>{this.props.actions.openModal({modalId:Y.IQ.INVITATION,dialogType:Cr,dialogProps:{focusOriginElement:"browseOrAddChannelMenuButton"}})})),hr(this,"showNewChannelModal",(()=>{this.props.actions.openModal({modalId:Y.IQ.NEW_CHANNEL_MODAL,dialogType:yr}),this.closeEditRHS()})),hr(this,"showCreateUserGroupModal",(()=>{this.props.actions.openModal({modalId:Y.IQ.USER_GROUPS_CREATE,dialogType:Er})})),hr(this,"handleOpenMoreDirectChannelsModal",(e=>{null==e||e.preventDefault(),this.state.showDirectChannelsModal?this.hideMoreDirectChannelsModal():(this.showMoreDirectChannelsModal(),this.closeEditRHS())})),hr(this,"onDragStart",(()=>{this.setState({isDragging:!0})})),hr(this,"onDragEnd",(()=>{this.setState({isDragging:!1})})),hr(this,"renderModals",(()=>{let e;return this.state.showDirectChannelsModal&&(e=O().createElement(gr,{onModalDismissed:this.hideMoreDirectChannelsModal,isExistingChannel:!1,focusOriginElement:"newDirectMessageButton"})),O().createElement(O().Fragment,null,e)})),hr(this,"closeEditRHS",(()=>{this.props.rhsOpen&&this.props.rhsState===Y._n.EDIT_HISTORY&&this.props.actions.closeRightHandSide()})),this.state={showDirectChannelsModal:!1,isDragging:!1}}componentDidMount(){this.props.teamId&&this.props.actions.fetchMyCategories(this.props.teamId),window.addEventListener("click",this.handleClickClearChannelSelection),window.addEventListener("keydown",this.handleKeyDownEvent)}componentDidUpdate(e){this.props.teamId&&e.teamId!==this.props.teamId&&this.props.actions.fetchMyCategories(this.props.teamId)}componentWillUnmount(){window.removeEventListener("click",this.handleClickClearChannelSelection),window.removeEventListener("keydown",this.handleKeyDownEvent)}render(){if(!this.props.teamId)return O().createElement("div",null);const e=(0,$.Vw)({id:"accessibility.sections.lhsNavigator",defaultMessage:"channel navigator region"});return O().createElement(Sa,{id:"SidebarContainer",className:q()({"move--right":this.props.isOpen&&this.props.isMobileView,dragging:this.state.isDragging})},this.props.isMobileView?O().createElement(pr,null):O().createElement(Za,{showNewChannelModal:this.showNewChannelModal,showMoreChannelsModal:this.showMoreChannelsModal,showCreateUserGroupModal:this.showCreateUserGroupModal,invitePeopleModal:this.invitePeopleModal,showCreateCategoryModal:this.showCreateCategoryModal,canCreateChannel:this.props.canCreatePrivateChannel||this.props.canCreatePublicChannel,canJoinPublicChannel:this.props.canJoinPublicChannel,handleOpenDirectMessagesModal:this.handleOpenMoreDirectChannelsModal,unreadFilterEnabled:this.props.unreadFilterEnabled,canCreateCustomGroups:this.props.canCreateCustomGroups}),O().createElement("div",{id:"lhsNavigator",role:"application","aria-label":e,className:"a11y__region","data-a11y-sort-order":"6"},O().createElement(_s,null)),O().createElement("div",{className:"sidebar--left__icons"},O().createElement(sn.default,{pluggableName:"LeftSidebarHeader"})),O().createElement(mr,{handleOpenMoreDirectChannelsModal:this.handleOpenMoreDirectChannelsModal,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd}),O().createElement(ya,null),this.renderModals())}}hr(_r,"propTypes",{teamId:B().string.isRequired,canCreatePublicChannel:B().bool.isRequired,canCreatePrivateChannel:B().bool.isRequired,canJoinPublicChannel:B().bool.isRequired,isOpen:B().bool.isRequired,actions:B().shape({fetchMyCategories:B().func.isRequired,openModal:B().func.isRequired,closeModal:B().func.isRequired,clearChannelSelection:B().func.isRequired,closeRightHandSide:B().func.isRequired}).isRequired,unreadFilterEnabled:B().bool.isRequired,isMobileView:B().bool.isRequired,isKeyBoardShortcutModalOpen:B().bool.isRequired,canCreateCustomGroups:B().bool.isRequired,rhsOpen:B().bool});const Tr=(0,a.connect)((function(e){const t=(0,o.H7)(e),n=(0,oa.ZM)(e);let a=!1,s=!1,r=!1;t&&(a=(0,sa.xY)(e,aa.A.CREATE_PUBLIC_CHANNEL),s=(0,sa.xY)(e,aa.A.CREATE_PRIVATE_CHANNEL),r=(0,sa.xY)(e,aa.A.JOIN_PUBLIC_CHANNELS));const i=(0,b.h7)(e)&&(0,sa.y4)(e,{permission:aa.A.CREATE_CUSTOM_GROUP});return{teamId:t?t.id:"",canCreatePrivateChannel:s,canCreatePublicChannel:a,canJoinPublicChannel:r,isOpen:(0,W.Cu)(e),unreadFilterEnabled:n,isMobileView:(0,V.w3)(e),isKeyBoardShortcutModalOpen:(0,la.o)(e,Y.IQ.KEYBOARD_SHORTCUTS_MODAL),canCreateCustomGroups:i,rhsState:(0,d.bM)(e),rhsOpen:(0,d.A)(e)}}),(function(e){return{actions:(0,G.bindActionCreators)({clearChannelSelection:ra.lE,fetchMyCategories:na.pQ,openModal:ea.q,closeModal:ea.O,closeRightHandSide:ia.bP},e)}}))(_r);var Sr=n(34574);const wr=()=>{const e=(0,a.useDispatch)(),t=(0,a.useSelector)(b.WW),n=(0,P.useRef)(!1);return(0,P.useEffect)((()=>{n.current?e((0,Sr.Eq)()):n.current=!0}),[t]),null};var Ir=n(39487);const Ar=n.p+"files/28d8f4f81fc6706686ca.png",Rr=n.p+"files/5309202966a267198738.png",Nr=n.p+"files/82dfba56173cc2e1b36f.png",Pr=n.p+"files/90fbd54f0b5f262a0383.png",Or=n.p+"files/3a6c51a6f8c3219854fc.png",Lr=n.p+"files/17376a171c0086fc1f09.png",Dr=n.p+"files/764d5570aa441ce59d3b.png",kr=n.p+"files/bbedcb731056777d6679.png",Fr=n.p+"files/333f99d8ccdd1789a1b8.png",xr=n.p+"files/9ed3993286d64fe6fd30.png",Ur=n.p+"files/f6ea1b2c4b12cde69e70.png",Br=n.p+"files/61f5ddebe2887a7e7603.png",Hr=n.p+"files/617256cfc427f96e818a.png",qr=n.p+"files/58d99dcffc0dd01d6e89.png",jr=n.p+"files/06000ee4d7811ed4f402.png";var Vr=n(51881);function Gr(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zr=function(e){return e.Mention="Mention",e.Unread="Unread",e.None="None",e}(zr||{});class Wr extends O().PureComponent{constructor(){super(...arguments),Gr(this,"updateDesktopApp",(()=>{const{unreadStatus:e}=this.props,{isUnread:t,unreadMentionCount:n}=(0,r.pP)(e);Vr.h.updateUnreadsAndMentions(t,n)})),Gr(this,"updateTitle",(()=>{const{siteName:e,currentChannel:t,currentTeam:n,currentTeammate:a,unreadStatus:s,inGlobalThreads:i,inDrafts:o,inScheduledPosts:l}=this.props,{formatMessage:c}=this.props.intl,d=e||"",{isUnread:u,unreadMentionCount:m}=(0,r.pP)(s),h=m>0?"(".concat(m,") "):"",p=!this.isDynamicFaviconSupported&&u?"* ":"";if(t&&n&&t.id){let e=t.display_name;t.type===Y.YM.DM_CHANNEL&&null!=a&&(e=a.display_name),document.title="".concat(h).concat(p).concat(e," - ").concat(n.display_name," ").concat(d)}else document.title=n&&i?c({id:"globalThreads.title",defaultMessage:"{prefix}Threads - {displayName} {siteName}"},{prefix:"".concat(h).concat(p),displayName:n.display_name,siteName:d}):n&&o?c({id:"drafts.title",defaultMessage:"{prefix}Drafts - {displayName} {siteName}"},{prefix:"".concat(h).concat(p),displayName:n.display_name,siteName:d}):n&&l?c({id:"scheduledPosts.title",defaultMessage:"{prefix}Scheduled - {displayName} {siteName}"},{prefix:"".concat(h).concat(p),displayName:n.display_name,siteName:d}):c({id:"sidebar.team_select",defaultMessage:"{siteName} - Join a team"},{siteName:d||"Mattermost"})})),Gr(this,"updateFavicon",(e=>{if(!is.gm()&&!is.H8())return;if(!document.querySelector('link[rel="icon"]'))return;const t=document.querySelector('link[rel="icon"][sizes="16x16"]'),n=document.querySelector('link[rel="icon"][sizes="24x24"]'),a=document.querySelector('link[rel="icon"][sizes="32x32"]'),s=document.querySelector('link[rel="icon"][sizes="64x64"]'),r=document.querySelector('link[rel="icon"][sizes="96x96"]'),i=e=>(0,Ir.GX)(e);switch(e){case zr.Mention:t.href=i(Lr),n.href=i(Dr),a.href=i(kr),s.href=i(Fr),r.href=i(xr);break;case zr.Unread:t.href=i(Ur),n.href=i(Br),a.href=i(Hr),s.href=i(qr),r.href=i(jr);break;default:t.href=i(Ar),n.href=i(Rr),a.href=i(Nr),s.href=i(Pr),r.href=i(Or)}}))}componentDidUpdate(e){this.updateTitle();const t=this.getBadgeStatus(e.unreadStatus),n=this.getBadgeStatus(this.props.unreadStatus);t!==n&&this.updateFavicon(n),this.updateDesktopApp()}get isDynamicFaviconSupported(){return is.H8()||is.gm()}getBadgeStatus(e){return"number"==typeof e?zr.Mention:e?zr.Unread:zr.None}render(){return null}}Gr(Wr,"propTypes",{siteName:B().string,inGlobalThreads:B().bool.isRequired,inDrafts:B().bool.isRequired,inScheduledPosts:B().bool.isRequired});const Kr=(0,ce.injectIntl)(Wr),Yr=(0,L.withRouter)((0,a.connect)((function(e,t){let{location:{pathname:n}}=t;const a=(0,i.zj)(e),s=(0,r.Lw)(e),l=s&&s.teammate_id?s:null;return{currentChannel:s,currentTeam:(0,o.H7)(e),currentTeammate:l,siteName:a.SiteName,unreadStatus:(0,r.m5)(e),inGlobalThreads:null!=(0,L.matchPath)(n,{path:"/:team/threads/:threadIdentifier?"}),inDrafts:null!=(0,L.matchPath)(n,{path:"/:team/drafts"}),inScheduledPosts:null!=(0,L.matchPath)(n,{path:"/:team/scheduled_posts"})}}),(function(e){return{actions:(0,G.bindActionCreators)({},e)}}))(Kr)),Jr=(0,x.S)("ProductNoticesModal",(0,P.lazy)((()=>n.e(452).then(n.bind(n,20452))))),Qr=(0,x.S)("ResetStatusModal",(0,P.lazy)((()=>Promise.resolve().then(n.bind(n,58737))))),Zr=(0,x.S)("MobileSidebarRight",(0,P.lazy)((()=>n.e(4302).then(n.bind(n,4302))))),Xr=["app__body","channel-view"];function $r(e){const t=(0,a.useSelector)(V.w3),n=(0,a.useSelector)(f.F4),s=(0,a.useDispatch)();return(0,P.useEffect)((()=>{var e;const t=(0,is.VN)()||(0,is.UP)(),{navigator:n}=window,a=(null==n||null===(e=n.userAgentData)||void 0===e?void 0:e.platform)||(null==n?void 0:n.platform)||"unknown";return document.body.classList.add(...function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[...Xr];return"Win32"===e||"Win64"===e?n.push("os--windows"):"MacIntel"!==e&&"MacPPC"!==e||n.push("os--mac"),t&&n.push("browser--ie"),n}(a,t)),()=>{document.body.classList.remove(...Xr),s((0,j.uF)())}}),[]),(0,P.useEffect)((()=>{let e;return n&&(e=setInterval((()=>{s((0,E.I8)())}),Y.YM.STATUS_INTERVAL)),()=>{clearInterval(e)}}),[n]),O().createElement(O().Fragment,null,O().createElement(wr,null),O().createElement(ta,null),O().createElement(Tr,null),O().createElement("div",{id:"channel_view",className:"channel-view","data-testid":"channel_view"},O().createElement(Yr,null),O().createElement(Jr,null),O().createElement("div",{className:q()("container-fluid channel-view-inner")},e.shouldRenderCenterChannel?O().createElement($n,null):O().createElement(me.A,{centered:!0}),O().createElement(sn.default,{pluggableName:"Root"}),O().createElement(Qr,null))),t&&O().createElement(Zr,null))}$r.propTypes={shouldRenderCenterChannel:B().bool.isRequired};var ei=n(854);const ti=(0,x.S)("BackstageController",(0,P.lazy)((()=>n.e(6347).then(n.bind(n,80342))))),ni=(0,x.n)();var ai=A()(ni).withConfig({displayName:"_StyledPluggable"})({gridArea:"center"});function si(e){var t;const n=(0,a.useDispatch)(),s=(0,L.useHistory)(),{team:r}=(0,L.useParams)(),[i,o]=(0,P.useState)(!1),[c,d]=(0,P.useState)(ri(e.teamsList,r)),u=(0,a.useSelector)(k.U),m=(0,P.useRef)(Date.now()),h=(0,P.useRef)(Date.now());async function p(t,n){d(null);const{data:a,error:r}=await e.joinTeam(t,n);r?s.push("/error?type=team_not_found"):a&&d(a)}(function(){var e,t;const n=(0,a.useSelector)(l.HW),s=null!==(e=null==n?void 0:n.id)&&void 0!==e?e:"",r=null!==(t=null==n?void 0:n.roles)&&void 0!==t?t:"";(0,P.useEffect)((()=>{s&&J.mT.setUserId(s),r&&J.mT.setUserRoles(r)}),[s,r])})(),(0,P.useEffect)((()=>{ei.A.stop("team_controller"),Vr.h.reactAppInitialized(),e.fetchAllMyChannelMembers(),async function(){await e.fetchAllMyTeamsChannels(),o(!0)}()}),[]),(0,P.useEffect)((()=>{if(e.disableWakeUpReconnectHandler)return()=>{};const t=setInterval((()=>{const e=Date.now();e-h.current>6e4&&(console.log("computer woke up - reconnecting"),(0,F.M6)()),h.current=e}),3e4);return()=>{clearInterval(t)}}),[e.disableWakeUpReconnectHandler]),(0,P.useEffect)((()=>{function t(){window.isActive=!0,e.markAsReadOnFocus(),e.disableRefetchingOnBrowserFocus||Date.now()-m.current>12e4&&e.currentTeamId&&e.fetchChannelsAndMembers(e.currentTeamId)}function n(){window.isActive=!1,m.current=Date.now(),e.unsetActiveChannelOnServer()}function a(e){if(e.shiftKey&&(0,Xt.r)(e)&&(0,Xt.e)(e,Y.Ay.KeyCodes.L)){const e=document.querySelector("#sidebar-right.is-open.expanded #reply_textbox");if(e)e.focus();else{const e=document.getElementById("post_textbox");e&&e.focus()}}}return window.addEventListener("focus",t),window.addEventListener("blur",n),window.addEventListener("keydown",a),()=>{window.removeEventListener("focus",t),window.removeEventListener("blur",n),window.removeEventListener("keydown",a)}}),[e.currentTeamId]),(0,P.useEffect)((()=>{u&&e.currentTeamId&&n((0,D.C)(e.currentTeamId))}),[u,n,e.currentTeamId]),(0,P.useEffect)((()=>{const e=(0,is.ux)();return e&&N().enable(),window.isActive=!0,v.A.setTeamIdJoinedOnLoad(null),()=>{window.isActive=!1,e&&N().disable()}}),[]);const g=e.teamsList.map((e=>e.id)).sort().join("+");if((0,P.useEffect)((()=>{if(r){if(Y.Ay.RESERVED_TEAM_NAMES.includes(r))return;const t=ri(e.teamsList,r);t?async function(t){const{data:n,error:a}=await e.initializeTeam(t);a?s.push("/error?type=team_not_found"):n&&d(n)}(t):c&&c.name!==r?p(r,!1):c||p(r,!0)}}),[r,g]),e.mfaRequired)return s.push("/mfa/setup"),null;if(null===c)return null;const f=(null==c?void 0:c.name.toLowerCase())===(null==r?void 0:r.toLowerCase());return O().createElement(L.Switch,null,O().createElement(L.Route,{path:"/:team(".concat(zn.LD,")/integrations"),component:ti}),O().createElement(L.Route,{path:"/:team(".concat(zn.LD,")/emoji"),component:ti}),null===(t=e.plugins)||void 0===t?void 0:t.map((e=>O().createElement(L.Route,{key:e.id,path:"/:team(".concat(zn.LD,")/")+e.route,render:()=>O().createElement(ai,{pluggableName:"NeedsTeamComponent",pluggableId:e.id})}))),O().createElement($r,{shouldRenderCenterChannel:i&&f}))}function ri(e,t){var n;if(!t)return null;return(null!==(n=e.find((e=>e.name===t)))&&void 0!==n?n:null)||null}const ii=(0,P.memo)(si),oi={fetchChannelsAndMembers:s.DC,fetchAllMyTeamsChannels:s.al,fetchAllMyChannelMembers:s.AK,markAsReadOnFocus:c.jK,initializeTeam:S,joinTeam:function(e,t){return async(n,a)=>{const r=a(),i=(0,l.HW)(r);try{const r=await n((0,g.Uj)(e));if((0,y.o)(r)){const e=r.data;if(i&&e&&0===e.delete_at){const r=await n((0,C.$w)(e.id,i.id));if((0,y.o)(r)){t&&v.A.setTeamIdJoinedOnLoad(e.id),await n(S(e));try{await n((0,s.DC)(e.id))}catch(e){return(0,p.UP)(e,n,a),n((0,m.vV)(e)),{error:e}}return{data:e}}throw r.error}throw new Error("Team not found or deleted")}throw r.error}catch(e){return(0,p.UP)(e,n,a),n((0,m.vV)(e)),{error:e}}}},unsetActiveChannelOnServer:s.Zw},li=(0,a.connect)((function(e,t){const n=(0,i.Ay)(e),a=(0,i.zj)(e),s=(0,l.HW)(e),c=e.plugins.components.NeedsTeamComponent,m="true"===a.DisableRefetchingOnBrowserFocus,h="true"===a.DisableWakeUpReconnectHandler;return{currentTeamId:(0,o.Sy)(e),currentChannelId:(0,r.eH)(e),teamsList:(0,o.vt)(e),plugins:c,selectedThreadId:(0,u.EB)(e),selectedPostId:(0,d.zb)(e),mfaRequired:(0,w.T)(s,n,a,t.match.url),disableRefetchingOnBrowserFocus:m,disableWakeUpReconnectHandler:h}}),oi),ci=li(ii)},8283:(e,t,n)=>{n.d(t,{A:()=>I});var a=n(23453),s=n(5908),r=n(87373),i=n(23739),o=n(79751),l=n(62688),c=n.n(l),d=(n(17046),n(43813),n(4290),n(97023)),u=n.n(d),m=n(14778),h=n(48774),p=n(69669),g=n(17461),f=n(49136),b=n(1277),E=n(24163),C=n(17983),v=n(99068),y=n(83873),M=n(78451),_=n(85873);function T(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class S extends u().PureComponent{constructor(){super(...arguments),T(this,"state",{showConfirmModal:!1,item:{member_count:0}}),T(this,"loadItems",(async(e,t)=>{const{data:n}=await this.props.actions.getGroupsAssociatedToTeam(this.props.team.id,t,e,b.$,!0);return{items:n.groups,totalCount:n.totalGroupCount}})),T(this,"handleDeleteCanceled",(()=>{this.setState({showConfirmModal:!1})})),T(this,"handleDeleteConfirmed",(()=>{this.setState({showConfirmModal:!1});const{item:e,listModal:t}=this.state;this.props.actions.unlinkGroupSyncable(e.id,this.props.team.id,h.CL.Team).then((async()=>{if(t){t.setState({loading:!0});const{items:e,totalCount:n}=await t.props.loadItems(t.state.page,t.state.searchTerm);t.setState({loading:!1,items:e,totalCount:n})}}))})),T(this,"onClickRemoveGroup",((e,t)=>{this.setState({showConfirmModal:!0,item:e,listModal:t})})),T(this,"onClickConfirmRemoveGroup",((e,t)=>this.props.actions.unlinkGroupSyncable(e.id,this.props.team.id,h.CL.Team).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:n}=await t.props.loadItems(t.state.page,t.state.searchTerm);t.setState({loading:!1,items:e,totalCount:n})})))),T(this,"onHide",(()=>{this.props.actions.closeModal(M.IQ.MANAGE_TEAM_GROUPS)})),T(this,"titleButtonOnClick",(()=>{this.onHide(),this.props.actions.openModal({modalId:M.IQ.ADD_GROUPS_TO_TEAM,dialogType:p.A})})),T(this,"setTeamMemberStatus",(async(e,t,n)=>{this.props.actions.patchGroupSyncable(e.id,this.props.team.id,h.CL.Team,{scheme_admin:n}).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:n}=await t.props.loadItems(t.state.page,t.state.searchTerm);this.props.actions.getMyTeamMembers(),t.setState({loading:!1,items:e,totalCount:n})}))})),T(this,"renderRow",((e,t)=>{let n;return n=e.scheme_admin?u().createElement(m.FormattedMessage,{id:"team_members_dropdown.teamAdmins",defaultMessage:"Team Admins"}):u().createElement(m.FormattedMessage,{id:"team_members_dropdown.teamMembers",defaultMessage:"Team Members"}),u().createElement("div",{key:e.id,className:"more-modal__row"},u().createElement("img",{className:"more-modal__image",src:y,alt:"group picture",width:"32",height:"32"}),u().createElement("div",{className:"more-modal__details"},u().createElement("div",{className:"more-modal__name","data-testid":"group-name"},e.display_name," ",u().createElement(f.A,null)," ","-"," ",u().createElement(f.A,null),u().createElement("span",{className:"more-modal__name_count"},u().createElement(m.FormattedMessage,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),u().createElement("div",{className:"more-modal__actions"},u().createElement(v.A,null,u().createElement("button",{id:"teamGroupsDropdown_".concat(e.display_name),className:"dropdown-toggle theme color--link style--none",type:"button","aria-expanded":"true","data-testid":"menu-button"},u().createElement("span",null,n," "),u().createElement(E.A,null)),u().createElement(C.A,{openLeft:!0,ariaLabel:_.Vw({id:"team_members_dropdown.menuAriaLabel",defaultMessage:"Change the role of a team member"})},u().createElement(C.A.ItemAction,{show:!e.scheme_admin,onClick:()=>this.setTeamMemberStatus(e,t,!0),text:_.Vw({id:"team_members_dropdown.makeTeamAdmins",defaultMessage:"Make Team Admins"})}),u().createElement(C.A.ItemAction,{show:Boolean(e.scheme_admin),onClick:()=>this.setTeamMemberStatus(e,t,!1),text:_.Vw({id:"team_members_dropdown.makeTeamMembers",defaultMessage:"Make Team Members"})}),u().createElement(C.A.ItemAction,{id:"remove-group",onClick:()=>this.onClickRemoveGroup(e,t),text:_.Vw({id:"group_list_modal.removeGroupButton",defaultMessage:"Remove Group"})})))))}))}render(){const{formatMessage:e}=this.props.intl,t=this.state.item.member_count;return u().createElement(u().Fragment,null,u().createElement(b.A,{show:!this.state.showConfirmModal,titleText:e({id:"team_groups",defaultMessage:"{team} Groups"},{team:this.props.team.display_name}),searchPlaceholderText:e({id:"manage_team_groups_modal.search_placeholder",defaultMessage:"Search groups"}),renderRow:this.renderRow,loadItems:this.loadItems,onHide:this.onHide,titleBarButtonText:e({id:"group_list_modal.addGroupButton",defaultMessage:"Add Groups"}),titleBarButtonOnClick:this.titleButtonOnClick,"data-testid":"list-modal"}),u().createElement(g.A,{show:this.state.showConfirmModal,title:e({id:"remove_group_confirm_title",defaultMessage:"Remove Group and {memberCount, number} {memberCount, plural, one {Member} other {Members}}"},{memberCount:t}),message:e({id:"remove_group_confirm_message",defaultMessage:"{memberCount, number} {memberCount, plural, one {member} other {members}} associated to this group will be removed from the team. Are you sure you wish to remove this group and {memberCount} {memberCount, plural, one {member} other {members}}?"},{memberCount:t}),confirmButtonText:e({id:"remove_group_confirm_button",defaultMessage:"Yes, Remove Group and {memberCount, plural, one {Member} other {Members}}"},{memberCount:t}),onConfirm:this.handleDeleteConfirmed,onCancel:this.handleDeleteCanceled,id:"confirm-modal"}))}}T(S,"propTypes",{actions:c().shape({getGroupsAssociatedToTeam:c().func.isRequired,closeModal:c().func.isRequired,openModal:c().func.isRequired,unlinkGroupSyncable:c().func.isRequired,patchGroupSyncable:c().func.isRequired,getMyTeamMembers:c().func.isRequired}).isRequired});const w=(0,m.injectIntl)(S),I=(0,a.connect)(((e,t)=>({team:e.entities.teams.teams[t.teamID]})),(e=>({actions:(0,s.bindActionCreators)({getGroupsAssociatedToTeam:r.Lp,closeModal:o.O,openModal:o.q,unlinkGroupSyncable:r.IC,patchGroupSyncable:r.r2,getMyTeamMembers:i.tt},e)})))(w)},87364:(e,t,n)=>{n.d(t,{A:()=>W});var a=n(23453),s=n(5908),r=n(14776),i=n(79751),o=n(98496),l=n(78451),c=n(62688),d=n.n(c),u=(n(4290),n(97023)),m=n.n(u),h=n(14778),p=n(14696),g=n(16983),f=n(49888),b=(n(3188),n(30973),n(23739)),E=n(17085),C=n(40057),v=n(80635),y=n(7430),M=n(59935),_=n(65357),T=n(89247),S=(n(43813),n(17046),n(24876)),w=n(30413),I=n(77440),A=n(46859),R=(n(57406),n(55448),n(79342)),N=n(17461),P=n(70669),O=n(24163),L=n(83007);function D(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class k extends m().PureComponent{constructor(e){super(e),D(this,"handleMakeMember",(async()=>{const e=this.props.currentUser;if(this.props.user.id===e.id&&e.roles.includes("system_admin"))this.handleDemote(this.props.user,"team_user");else{const{error:t}=await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id,this.props.user.id,!0,!1);t?this.setState({serverError:t.message}):(this.props.actions.getUser(this.props.user.id),this.props.actions.getTeamMember(this.props.teamMember.team_id,this.props.user.id),this.props.user.id===e.id&&(await this.props.actions.getMyTeamMembers(),this.props.actions.getMyTeamUnreads(this.props.collapsedThreads)))}})),D(this,"handleRemoveFromTeam",(async()=>{const{error:e}=await this.props.actions.removeUserFromTeamAndGetStats(this.props.teamMember.team_id,this.props.user.id);e&&this.setState({serverError:e.message})})),D(this,"handleMakeAdmin",(async()=>{const e=this.props.currentUser;if(this.props.user.id===e.id&&e.roles.includes("system_admin"))this.handleDemote(this.props.user,"team_user team_admin");else{const{error:e}=await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id,this.props.user.id,!0,!0);e?this.setState({serverError:e.message}):(this.props.actions.getUser(this.props.user.id),this.props.actions.getTeamMember(this.props.teamMember.team_id,this.props.user.id))}})),D(this,"handleDemote",((e,t)=>{this.setState({serverError:this.state.serverError,showDemoteModal:!0,user:e,role:t})})),D(this,"handleDemoteCancel",(()=>{this.setState({serverError:null,showDemoteModal:!1,user:null,role:null})})),D(this,"handleDemoteSubmit",(async()=>{const{error:e}=await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id,this.props.user.id,!0,!1);e?this.setState({serverError:e.message}):(this.props.actions.getUser(this.props.user.id),(0,L.J)().push(this.props.teamUrl))})),this.state={serverError:null,showDemoteModal:!1,user:null,role:null}}render(){let e=null;this.state.serverError&&(e=m().createElement("div",{className:"has-error"},m().createElement("label",{className:"has-error control-label"},this.state.serverError)));const{currentTeam:t,teamMember:n,user:a,intl:s}=this.props;let r=null;r=(0,R.P)(a.roles)?m().createElement(h.FormattedMessage,{id:"team_members_dropdown.guest",defaultMessage:"Guest"}):a.roles.length>0&&(0,R.FV)(a.roles)?m().createElement(h.FormattedMessage,{id:"team_members_dropdown.systemAdmin",defaultMessage:"System Admin"}):n.roles.length>0&&(0,R.qc)(n.roles)||n.scheme_admin?m().createElement(h.FormattedMessage,{id:"team_members_dropdown.teamAdmin",defaultMessage:"Team Admin"}):m().createElement(h.FormattedMessage,{id:"team_members_dropdown.member",defaultMessage:"Member"});const i=this.props.currentUser;let o=!(0,R.P)(a.roles)&&((0,R.qc)(n.roles)||n.scheme_admin)&&!(0,R.FV)(a.roles),l=!((0,R.P)(a.roles)||(0,R.qc)(n.roles)||(0,R.FV)(a.roles)||n.scheme_admin);a.delete_at>0&&(r=m().createElement(h.FormattedMessage,{id:"team_members_dropdown.inactive",defaultMessage:"Inactive"}),o=!1,l=!1);const c=a.id!==i.id&&(!(null!=t&&t.group_constrained)||a.is_bot);let d=null;if(a.id===i.id){const t=m().createElement(h.FormattedMessage,{id:"team_members_dropdown.confirmDemoteRoleTitle",defaultMessage:"Confirm Demotion from System Admin Role"}),n=m().createElement("div",null,m().createElement(h.FormattedMessage,{id:"team_members_dropdown.confirmDemoteDescription",defaultMessage:"If you demote yourself from the System Admin role and there is not another user with System Admin privileges, you'll need to re-assign a System Admin by accessing the Mattermost server through a terminal and running the following command."}),m().createElement("br",null),m().createElement("br",null),m().createElement(h.FormattedMessage,{id:"team_members_dropdown.confirmDemotionCmd",defaultMessage:"platform roles system_admin {username}",values:{username:i.username}}),e),a=m().createElement(h.FormattedMessage,{id:"team_members_dropdown.confirmDemotion",defaultMessage:"Confirm Demotion"});d=m().createElement(N.A,{show:this.state.showDemoteModal,title:t,message:n,confirmButtonText:a,onConfirm:this.handleDemoteSubmit,onCancel:this.handleDemoteCancel})}if(!c&&!l&&!o)return m().createElement("div",null,r);const{index:u,totalUsers:p}=this.props;let g=!1;p>3&&p-u<=3&&(g=!0);const f=m().createElement(P.q7,{id:"removeFromTeam",onClick:this.handleRemoveFromTeam,labels:m().createElement(h.FormattedMessage,{id:"team_members_dropdown.leave_team",defaultMessage:"Remove from Team"})}),b=m().createElement(P.q7,{onClick:this.handleMakeAdmin,labels:m().createElement(h.FormattedMessage,{id:"team_members_dropdown.makeAdmin",defaultMessage:"Make Team Admin"})}),E=m().createElement(P.q7,{onClick:this.handleMakeMember,labels:m().createElement(h.FormattedMessage,{id:"team_members_dropdown.makeMember",defaultMessage:"Make Team Member"})});return m().createElement(m().Fragment,null,m().createElement(P.mc,{menuButton:{id:"teamMembersDropdown_".concat(a.username),class:"dropdown-toggle theme color--link style--none",children:m().createElement(m().Fragment,null,m().createElement("span",null,r," "),m().createElement(O.A,null))},menu:{id:"teamMembersDropdown_".concat(a.username,"_menu"),"aria-label":s.formatMessage({id:"team_members_dropdown.menuAriaLabel",defaultMessage:"Change the role of a team member"})},anchorOrigin:{vertical:g?"top":"bottom",horizontal:"right"},transformOrigin:{vertical:g?"bottom":"top",horizontal:"right"}},c?f:null,l?b:null,o?E:null),d,e)}}D(k,"propTypes",{teamUrl:d().string.isRequired,index:d().number.isRequired,totalUsers:d().number.isRequired,actions:d().shape({getMyTeamMembers:d().func.isRequired,getMyTeamUnreads:d().func.isRequired,getUser:d().func.isRequired,getTeamMember:d().func.isRequired,getTeamStats:d().func.isRequired,getChannelStats:d().func.isRequired,updateTeamMemberSchemeRoles:d().func.isRequired,updateUserActive:d().func.isRequired,removeUserFromTeamAndGetStats:d().func.isRequired}).isRequired});const F=(0,h.injectIntl)(k),x=(0,a.connect)((function(e){return{currentUser:(0,y.HW)(e),teamUrl:(0,r._p)(e),currentTeam:(0,r.H7)(e),collapsedThreads:(0,I.WW)(e)}}),(function(e){return{actions:(0,s.bindActionCreators)({getMyTeamMembers:b.tt,getMyTeamUnreads:b.UR,getUser:E.wz,getTeamMember:b.e6,getTeamStats:b.ls,getChannelStats:w.Fe,updateUserActive:E.tS,updateTeamMemberSchemeRoles:b.bd,removeUserFromTeamAndGetStats:A.RF},e)}}))(F);var U=n(4715);function B(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class H extends m().PureComponent{constructor(e){super(e),B(this,"loadComplete",(()=>{this.setState({loading:!1})})),B(this,"nextPage",(async e=>{this.setState({loading:!0}),await Promise.all([this.props.actions.loadProfilesAndTeamMembers(e,50,this.props.currentTeamId,{active:!0}),this.props.actions.getTeamMembers(this.props.currentTeamId,e,l.Ay.DEFAULT_MAX_USERS_PER_TEAM,{sort:C.P9.SORT_USERNAME_OPTION,exclude_deleted_users:!0})]),this.loadComplete()})),B(this,"search",(e=>{this.props.actions.setModalSearchTerm(e)})),this.searchTimeoutId=0,this.state={loading:!0}}async componentDidMount(){await Promise.all([this.props.actions.loadProfilesAndTeamMembers(0,l.Ay.PROFILE_CHUNK_SIZE,this.props.currentTeamId,{active:!0}),this.props.actions.getTeamMembers(this.props.currentTeamId,0,l.Ay.DEFAULT_MAX_USERS_PER_TEAM,{sort:C.P9.SORT_USERNAME_OPTION,exclude_deleted_users:!0}),this.props.actions.getTeamStats(this.props.currentTeamId)]),this.loadComplete()}componentWillUnmount(){this.props.actions.setModalSearchTerm("")}componentDidUpdate(e){if(e.searchTerm!==this.props.searchTerm){clearTimeout(this.searchTimeoutId);const e=this.props.searchTerm;if(""===e)return this.loadComplete(),void(this.searchTimeoutId=0);const t=window.setTimeout((async()=>{const{loadStatusesForProfilesList:n,loadTeamMembersForProfilesList:a,searchProfiles:s}=this.props.actions,{data:r}=await s(e,{team_id:this.props.currentTeamId});t===this.searchTimeoutId&&(this.setState({loading:!0}),n(r),a(r,this.props.currentTeamId,!0).then((e=>{let{data:t}=e;t&&this.loadComplete()})))}),l.Ay.SEARCH_TIMEOUT_MILLISECONDS);this.searchTimeoutId=t}}render(){let e;this.props.canManageTeamMembers&&(e=[x]);const t=this.props.teamMembers,n=this.props.users,a={};let s;if(this.state.loading)s=null;else{s=[];for(let e=0;e<n.length;e++){const r=n[e];t[r.id]&&0===r.delete_at&&(s.push(r),a[r.id]={teamMember:t[r.id]})}}return m().createElement(S.A,{users:s,usersPerPage:50,total:this.props.totalTeamMembers,nextPage:this.nextPage,search:this.search,actions:e,actionUserProps:a,focusOnMount:!U.Fr()})}}B(H,"propTypes",{searchTerm:d().string.isRequired,users:d().array.isRequired,currentTeamId:d().string.isRequired,totalTeamMembers:d().number.isRequired,canManageTeamMembers:d().bool,actions:d().shape({getTeamMembers:d().func.isRequired,searchProfiles:d().func.isRequired,getTeamStats:d().func.isRequired,loadProfilesAndTeamMembers:d().func.isRequired,loadStatusesForProfilesList:d().func.isRequired,loadTeamMembersForProfilesList:d().func.isRequired,setModalSearchTerm:d().func.isRequired}).isRequired});const q=(0,a.connect)((function(e,t){const n=(0,v.mg)(e,t.teamId,C.xB.MANAGE_TEAM_ROLES),a=e.views.search.modalSearch;let s;s=a?(0,y.QJ)(e,a):(0,y.G1)(e);const i=(0,r.MF)(e)||{active_member_count:0};return{searchTerm:a,users:s,teamMembers:(0,r.XK)(e)||{},currentTeamId:e.entities.teams.currentTeamId,totalTeamMembers:i.active_member_count,canManageTeamMembers:n}}),(function(e){return{actions:(0,s.bindActionCreators)({searchProfiles:E.U,getTeamStats:b.ls,getTeamMembers:b.fP,loadProfilesAndTeamMembers:_.U3,loadStatusesForProfilesList:M.Y5,loadTeamMembersForProfilesList:_.iO,setModalSearchTerm:T.qv},e)}}))(H);var j=n(26808),V=n(30138);function G(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class z extends m().PureComponent{constructor(e){super(e),G(this,"handleHide",(()=>{this.setState({show:!1})})),G(this,"handleInvitePeople",(()=>{const{actions:e}=this.props;e.openModal({modalId:l.IQ.INVITATION,dialogType:f.default}),this.handleHide()})),G(this,"handleExit",(()=>{this.props.focusOriginElement&&(0,V.p)(this.props.focusOriginElement,!0),this.props.onExited()})),this.state={show:!0}}componentDidMount(){this.props.onLoad&&this.props.onLoad()}render(){var e,t;let n="";return this.props.currentTeam&&(n=this.props.currentTeam.display_name),m().createElement(p.zW,{id:"teamMembersModal",className:"more-modal",compassDesign:!0,show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,modalHeaderTextId:"teamMemberModalLabel",modalHeaderText:m().createElement(h.FormattedMessage,{id:"team_member_modal.members",defaultMessage:"{team} Members",values:{team:n}}),ariaLabelledby:"teamMemberModalLabel",headerButton:m().createElement(j.A,{teamId:null===(e=this.props.currentTeam)||void 0===e?void 0:e.id,permissions:[g.A.ADD_USER_TO_TEAM,g.A.INVITE_GUEST]},m().createElement("button",{id:"invitePeople",type:"button",className:"btn btn-primary btn-sm invite-people-btn",onClick:this.handleInvitePeople},m().createElement(h.FormattedMessage,{id:"team_member_modal.invitePeople",defaultMessage:"Invite People"}))),enforceFocus:!1,modalLocation:"top",bodyPadding:!1},m().createElement(q,{teamId:null===(t=this.props.currentTeam)||void 0===t?void 0:t.id}))}}G(z,"propTypes",{onExited:d().func.isRequired,onLoad:d().func,focusOriginElement:d().string,actions:d().shape({openModal:d().func.isRequired}).isRequired});const W=(0,a.connect)((function(e){const t=l.IQ.TEAM_MEMBERS;return{currentTeam:(0,r.H7)(e),show:(0,o.o)(e,t)}}),(function(e){return{actions:(0,s.bindActionCreators)({openModal:i.q},e)}}))(z)},8610:(e,t,n)=>{n.d(t,{A:()=>le});var a=n(23453),s=n(40057),r=n(80635),i=n(14776),o=n(98496),l=n(78451),c=n(62688),d=n.n(c),u=(n(43813),n(17046),n(97023)),m=n.n(u),h=n(83675),p=n(51565),g=n.n(p),f=n(14778),b=n(5908),E=n(23739),C=(n(57406),n(55448),n(76685),n(49698)),v=n(66215),y=(n(4290),n(66963));function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const S={DropdownIndicator:null},w={control:e=>_(_({},e),{},{background:"var(--center-channel-color-rgb)"}),input:e=>_(_({},e),{},{color:"rgba(var(--center-channel-color-rgb), 0.64)"}),multiValue:e=>_(_({},e),{},{borderRadius:"10px",background:"rgba(var(--center-channel-color-rgb), 0.08)",display:"flex",alignItems:"center"}),multiValueLabel:e=>_(_({},e),{},{padding:"4px 6px 4px 10px",color:"var(--center-channel-color)",fontFamily:"Open Sans",fontSize:"10px",fontWeight:600,lineHeight:"12px",letterSpacing:"0.2px"}),multiValueRemove:e=>_(_({},e),{},{borderRadius:"50%",background:"rgba(var(--center-channel-color-rgb), 0.32)",fontFamily:"compass-icons",fontSize:"12px",fontWeight:400,color:"white",width:"10px",height:"10px",padding:0,marginRight:"4px",":hover":{background:"rgba(var(--center-channel-color-rgb), 0.32)",color:"white"}})},I=e=>{let{placeholder:t,value:n,handleNewSelection:a,onChange:s,id:r,isClearable:i,description:o}=e;const[l,c]=m().useState(""),d=(0,u.useCallback)((()=>{null!=n&&n.includes(l.trim())||0===l.length||(a(l),c(""))}),[a,l,n]),h=(0,u.useCallback)((e=>{if(l)switch(e.key){case" ":case",":case"Enter":d(),e.preventDefault()}}),[l,d]),p=(0,u.useMemo)((()=>n.map((e=>({label:e,value:e})))),[n]);return m().createElement(m().Fragment,null,m().createElement(y.A,{id:r,className:"select-text-input",styles:w,components:S,isClearable:i,onChange:(0,u.useCallback)((e=>s(e)),[s]),inputValue:l,isMulti:!0,menuIsOpen:!1,onInputChange:c,onKeyDown:h,placeholder:t,value:p,onBlur:d}),o?m().createElement("p",{className:"select-text-description"},o):void 0)};var A=n(66549);const R=e=>{let{allowedDomains:t,setAllowedDomains:n,setHasChanges:a,setSaveChangesPanelState:s}=e;const[r,i]=(0,u.useState)(t.length>0),{formatMessage:o}=(0,f.useIntl)(),l=(0,u.useCallback)((e=>{i(e),e||n([])}),[n]),c=(0,u.useCallback)((e=>{a(!0),s("editing"),n([...t,e])}),[t,n,a,s]),d=(0,u.useCallback)((e=>{a(!0),s("editing"),n((null==e?void 0:e.map((e=>e.value)))||[])}),[n,a,s]);return m().createElement(m().Fragment,null,m().createElement(A.A,{inputFieldTitle:m().createElement(f.FormattedMessage,{id:"general_tab.allowedDomains",defaultMessage:"Allow only users with a specific email domain to join this team"}),"data-testid":"allowedDomainsCheckbox",className:"access-allowed-domains-section",title:o({id:"general_tab.AllowedDomainsTitle",defaultMessage:"Users with a specific email domain"}),description:o({id:"general_tab.AllowedDomainsInfo",defaultMessage:'When enabled, users can only join the team if their email matches a specific domain (e.g. "mattermost.org")'}),descriptionAboveContent:!0,inputFieldData:{name:"showAllowedDomains"},inputFieldValue:r,handleChange:l}),r&&m().createElement(I,{id:"allowedDomains",placeholder:o({id:"general_tab.AllowedDomainsExample",defaultMessage:"corp.mattermost.com, mattermost.com"}),"aria-label":o({id:"general_tab.allowedDomains.ariaLabel",defaultMessage:"Allowed Domains"}),value:t,onChange:d,handleNewSelection:c,isClearable:!1,description:o({id:"general_tab.AllowedDomainsTip",defaultMessage:"Seperate multiple domains with a space, comma, tab or enter."})}))};R.propTypes={allowedDomains:d().arrayOf(d().string).isRequired,setAllowedDomains:d().func.isRequired,setHasChanges:d().func.isRequired,setSaveChangesPanelState:d().func.isRequired};const N=R;var P=n(85406),O=n(98566),L=n(8589);const D=(0,f.defineMessages)({OpenInviteDescriptionError:{id:"team_settings.openInviteDescription.error",defaultMessage:"There was an error generating the invite code, please try again"}}),k=e=>{var t;let{regenerateTeamInviteId:n}=e;const o=(0,a.useSelector)((e=>(0,i.H7)(e))),l=(0,a.useSelector)((e=>(0,r.mg)(e,(null==o?void 0:o.id)||"",s.xB.INVITE_USER))),[c,d]=(0,u.useState)(null!==(t=null==o?void 0:o.invite_id)&&void 0!==t?t:""),[h,p]=(0,u.useState)(),{formatMessage:g}=(0,f.useIntl)();(0,u.useEffect)((()=>{d((null==o?void 0:o.invite_id)||"")}),[null==o?void 0:o.invite_id]);const b=(0,u.useCallback)((async()=>{const{data:e,error:t}=await n((null==o?void 0:o.id)||"");null!=e&&e.invite_id?d(e.invite_id):t&&p(D.OpenInviteDescriptionError)}),[n,null==o?void 0:o.id]);if(!l)return null;const E=m().createElement("div",{"data-testid":"teamInviteContainer",id:"teamInviteContainer"},m().createElement(O.A,{id:"teamInviteId",type:"text",value:c,maxLength:32}),m().createElement("button",{"data-testid":"regenerateButton",id:"regenerateButton",className:"btn btn-tertiary",onClick:b},m().createElement(P.RefreshIcon,null),g({id:"general_tab.regenerate",defaultMessage:"Regenerate"})));return m().createElement(L.A,{className:"access-invite-section",title:g({id:"general_tab.codeTitle",defaultMessage:"Invite Code"}),description:g({id:"general_tab.codeLongDesc",defaultMessage:"The Invite Code is part of the unique team invitation link which is sent to members youâ€™re inviting to this team. Regenerating the code creates a new invitation link and invalidates the previous link."}),content:E,error:h,descriptionAboveContent:!0})};k.propTypes={regenerateTeamInviteId:d().func.isRequired};const F=k;var x=n(17518);const U=e=>{let{isGroupConstrained:t,allowOpenInvite:n,setAllowOpenInvite:a}=e;const{formatMessage:s}=(0,f.useIntl)();if(t){const e=m().createElement("p",{id:"groupConstrainedContent"},s({id:"team_settings.openInviteDescription.groupConstrained",defaultMessage:"Members of this team are added and removed by linked groups. <link>Learn More</link>"},{link:e=>m().createElement(x.A,{href:"https://mattermost.com/pl/default-ldap-group-constrained-team-channel.html",location:"open_invite"},e)}));return m().createElement(L.A,{className:"access-invite-domains-section",title:s({id:"general_tab.openInviteText",defaultMessage:"Users on this server"}),description:s({id:"general_tab.openInviteDesc",defaultMessage:"When enabled, a link to this team will be included on the landing page allowing anyone with an account to join this team. Changing this setting will create a new invitation link and invalidate the previous link."}),descriptionAboveContent:!0,content:e})}return m().createElement(A.A,{className:"access-invite-domains-section",inputFieldTitle:m().createElement(f.FormattedMessage,{id:"general_tab.openInviteTitle",defaultMessage:"Allow any user with an account on this server to join this team"}),inputFieldData:{name:"allowOpenInvite"},inputFieldValue:n,handleChange:a,title:s({id:"general_tab.openInviteText",defaultMessage:"Users on this server"}),description:s({id:"general_tab.openInviteDesc",defaultMessage:"When enabled, a link to this team will be included on the landing page allowing anyone with an account to join this team. Changing this setting will create a new invitation link and invalidate the previous link."}),descriptionAboveContent:!0})};U.propTypes={allowOpenInvite:d().bool.isRequired,isGroupConstrained:d().bool,setAllowOpenInvite:d().func.isRequired};const B=U,H=e=>e&&0!==e.length?(e.includes(",")?e.split(","):[e]).map((e=>e.trim())):[],q=(0,a.connect)(null,(function(e){return{actions:(0,b.bindActionCreators)({patchTeam:E.Oy,regenerateTeamInviteId:E.US},e)}}))((e=>{var t;let{closeModal:n,collapseModal:a,hasChangeTabError:s,hasChanges:r,setHasChangeTabError:i,setHasChanges:o,team:l,actions:c}=e;const[d,h]=(0,u.useState)((()=>H(l.allowed_domains))),[p,g]=(0,u.useState)(null!==(t=l.allow_open_invite)&&void 0!==t&&t),[b,E]=(0,u.useState)(),{formatMessage:y}=(0,f.useIntl)(),M=(0,u.useCallback)((async()=>{const{error:e}=await c.patchTeam({id:l.id,allowed_domains:1===d.length?d[0]:d.join(", ")});return!e}),[c,d,l]),_=(0,u.useCallback)((async()=>{if(p===l.allow_open_invite)return!0;const e={id:l.id,allow_open_invite:p},{error:t}=await c.patchTeam(e);return!t}),[c,p,l]),T=(0,u.useCallback)((e=>{o(!0),E("editing"),g(e)}),[o]),S=(0,u.useCallback)((()=>{E("editing"),o(!1),i(!1)}),[i,o]),w=(0,u.useCallback)((()=>{var e;h(H(l.allowed_domains)),g(null!==(e=l.allow_open_invite)&&void 0!==e&&e),S()}),[S,l.allow_open_invite,l.allowed_domains]),I=(0,u.useCallback)((()=>{r?i(!0):a()}),[a,r,i]),A=(0,u.useCallback)((async()=>{const e=await M(),t=await _();e&&t?(E("saved"),i(!1)):E("error")}),[M,_,i]);return m().createElement(C.A,{content:m().createElement(m().Fragment,null,m().createElement("div",{className:"modal-header"},m().createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal",onClick:n},m().createElement("span",{"aria-hidden":"true"},"Ã—")),m().createElement("h4",{className:"modal-title"},m().createElement("div",{className:"modal-back"},m().createElement("i",{className:"fa fa-angle-left","aria-label":y({id:"generic_icons.collapse",defaultMessage:"Collapes Icon"}),onClick:I})),m().createElement("span",null,y({id:"team_settings_modal.title",defaultMessage:"Team Settings"})))),m().createElement("div",{className:"modal-access-tab-content user-settings",id:"accessSettings","aria-labelledby":"accessButton",role:"tabpanel"},l.group_constrained?void 0:m().createElement(N,{allowedDomains:d,setAllowedDomains:h,setHasChanges:o,setSaveChangesPanelState:E}),m().createElement("div",{className:"divider-light"}),m().createElement(B,{isGroupConstrained:l.group_constrained,allowOpenInvite:p,setAllowOpenInvite:T}),m().createElement("div",{className:"divider-light"}),l.group_constrained?void 0:m().createElement(F,{regenerateTeamInviteId:c.regenerateTeamInviteId}),r?m().createElement(v.A,{handleCancel:w,handleSubmit:A,handleClose:S,tabChangeError:s,state:b}):void 0))})}));n(83931);var j=n(26614);const V=e=>{let{handleDescriptionChanges:t,clientError:n,description:a}=e;const{formatMessage:s}=(0,f.useIntl)(),r=(0,u.useCallback)((e=>{t(e.target.value)}),[t]),i=m().createElement(O.A,{id:"teamDescription","data-testid":"teamDescriptionInput",containerClassName:"description-section-input",type:"textarea",maxLength:l.Ay.MAX_TEAMDESCRIPTION_LENGTH,onChange:r,value:a,label:s({id:"general_tab.teamDescription",defaultMessage:"Description"})});return m().createElement(L.A,{description:s({id:"general_tab.teamDescriptionInfo",defaultMessage:"Team description provides additional information to help users select the right team. Maximum of 50 characters."}),content:i,className:"description-setting-item",error:n})},G=e=>{let{clientError:t,handleNameChanges:n,name:a}=e;const{formatMessage:s}=(0,f.useIntl)(),r=(0,u.useCallback)((e=>n(e.target.value)),[n]),i=m().createElement(O.A,{id:"teamName","data-testid":"teamNameInput",type:"text",maxLength:l.Ay.MAX_TEAMNAME_LENGTH,onChange:r,value:a,label:s({id:"general_tab.teamName",defaultMessage:"Team Name"})});return m().createElement(L.A,{title:s({id:"general_tab.teamInfo",defaultMessage:"Team info"}),description:s({id:"general_tab.teamNameInfo",defaultMessage:"This name will appear on your sign-in screen and at the top of the left sidebar."}),content:i,error:t})};n(60473),n(36169);var z=n(12026),W=n(68124),K=n(85873);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function J(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Q=e=>{let{team:t,file:n,teamName:a,disabled:s,onFileChange:r,onRemove:i,clientError:o}=e;const c=(0,u.useRef)(null),[d,h]=(0,u.useState)(""),[p,g]=(0,u.useState)(),{formatMessage:b}=(0,f.useIntl)(),E=(0,K.lt)(t),C=(0,u.useCallback)((()=>{c.current&&(c.current.value="",c.current.click())}),[]);(0,u.useEffect)((()=>{n&&(e=>{if(e){const t=URL.createObjectURL(e),n=new FileReader;n.onload=e=>{const n=W.hM(e.target.result),a=W.R6(n);h(t),g(a)},n.readAsArrayBuffer(e)}})(n)}),[n]);const v=m().createElement(m().Fragment,null,m().createElement("div",{className:"team-picture-section"},(()=>{if(n){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({backgroundImage:"url("+d+")",backgroundSize:"cover",backgroundRepeat:"round"},p);return m().createElement("div",{id:"teamIconImage",style:e,className:"team-img-preview",onClick:C})}return E?m().createElement("img",{id:"teamIconImage",className:"team-img-preview",src:E,onClick:C}):m().createElement("div",{className:"team-picture-section__team-icon"},m().createElement("span",{id:"teamIconInitial",onClick:C,className:"team-picture-section__team-name"},a.charAt(0).toUpperCase()+a.charAt(1)))})(),m().createElement(m().Fragment,null,m().createElement("input",{"data-testid":"uploadPicture",ref:c,className:"hidden",accept:l.Ay.ACCEPT_STATIC_IMAGE,disabled:s,type:"file",onChange:r,"aria-hidden":!0,tabIndex:-1}),m().createElement("span",{disabled:s,onClick:C},m().createElement(z.A,null)))),n||E?m().createElement("button",{onClick:i,"data-testid":"removeImageButton",className:"style--none picture-setting-item__remove-button"},m().createElement(P.TrashCanOutlineIcon,null),b({id:"setting_picture.remove_image",defaultMessage:"Remove image"})):null);return m().createElement(L.A,{title:b({id:"setting_picture.title",defaultMessage:"Team Icon"}),description:E?void 0:b({id:"setting_picture.help.profile",defaultMessage:"Upload a picture in BMP, JPG, JPEG, or PNG format. Maximum file size: {max}"},{max:"50MB"}),content:v,className:"picture-setting-item",error:o})};Q.propTypes={teamName:d().string.isRequired,disabled:d().bool.isRequired,onFileChange:d().func.isRequired,onRemove:d().func.isRequired};const Z=Q,X=["image/jpeg","image/png","image/bmp"],$=(0,f.defineMessages)({Required:{id:"general_tab.required",defaultMessage:"This field is required"},TeamNameRestrictions:{id:"general_tab.teamNameRestrictions",defaultMessage:"Team Name must be {min} or more characters up to a maximum of {max}. You can add a longer team description.",values:{min:l.Ay.MIN_TEAMNAME_LENGTH,max:l.Ay.MAX_TEAMNAME_LENGTH}},TeamIconInvalidFileType:{id:"general_tab.teamIconInvalidFileType",defaultMessage:"Only BMP, JPG or PNG images may be used for team icons"},TeamIconTooLarge:{id:"general_tab.teamIconTooLarge",defaultMessage:"Unable to upload team icon. File is too large."},TeamIconError:{id:"general_tab.teamIconError",defaultMessage:"An error occurred while selecting the image."}}),ee=(0,a.connect)((function(e){var t;const n=(0,j.zj)(e);return{maxFileSize:parseInt(null!==(t=n.MaxFileSize)&&void 0!==t?t:"",10)}}),(function(e){return{actions:(0,b.bindActionCreators)({getTeam:E.Uo,patchTeam:E.Oy,removeTeamIcon:E.zz,setTeamIcon:E.PY},e)}}))((e=>{var t;let{team:n,hasChanges:a,maxFileSize:s,closeModal:r,collapseModal:i,hasChangeTabError:o,setHasChangeTabError:c,setHasChanges:d,actions:h}=e;const[p,g]=(0,u.useState)(n.display_name),[b,E]=(0,u.useState)(n.description),[y,M]=(0,u.useState)(),[_,T]=(0,u.useState)(!1),[S,w]=(0,u.useState)(),[I,A]=(0,u.useState)(),[R,N]=(0,u.useState)(),{formatMessage:P}=(0,f.useIntl)(),O=(0,u.useCallback)((async()=>{if(p.trim()===n.display_name&&b===n.description)return!0;if(!p)return A($.Required),!1;if(p.length<l.Ay.MIN_TEAMNAME_LENGTH)return A($.TeamNameRestrictions),!1;A(void 0);const{error:e}=await h.patchTeam({id:n.id,display_name:p,description:b});return!e}),[h,b,p,n.description,n.display_name,n.id]),L=(0,u.useCallback)((async()=>{if(!y)return!0;T(!0),w(void 0);const{error:e}=await h.setTeamIcon(n.id,y);return T(!1),!e}),[h,n,y]),D=(0,u.useCallback)((async()=>{const e=await O();await L()&&e?(N("saved"),c(!1)):N("error")}),[O,L,c]),k=(0,u.useCallback)((()=>{N("editing"),d(!1),c(!1)}),[c,d]),F=(0,u.useCallback)((()=>{var e;g(null!==(e=n.display_name)&&void 0!==e?e:n.name),E(n.description),M(void 0),w(void 0),A(void 0),k()}),[k,n.description,n.display_name,n.name]),x=(0,u.useCallback)((async()=>{T(!0),w(void 0),M(void 0),k();const{error:e}=await h.removeTeamIcon(n.id);T(!1),e&&(N("error"),d(!0),c(!0))}),[h,k,c,d,n.id]),U=(0,u.useCallback)((e=>{if(e&&e.target&&e.target.files&&e.target.files[0]){const t=e.target.files[0];X.includes(t.type)?t.size>s?w($.TeamIconTooLarge):(M(t),w(void 0),N("editing"),d(!0)):w($.TeamIconInvalidFileType)}else M(void 0),w($.TeamIconError)}),[s,d]),B=(0,u.useCallback)((e=>{d(!0),N("editing"),g(e)}),[d]),H=(0,u.useCallback)((e=>{d(!0),N("editing"),E(e)}),[d]),q=(0,u.useCallback)((()=>{a?c(!0):i()}),[i,a,c]),j=m().createElement(m().Fragment,null,m().createElement("div",{className:"modal-header"},m().createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal",onClick:r},m().createElement("span",{"aria-hidden":"true"},"Ã—")),m().createElement("h4",{className:"modal-title"},m().createElement("div",{className:"modal-back"},m().createElement("i",{className:"fa fa-angle-left","aria-label":P({id:"generic_icons.collapse",defaultMessage:"Collapes Icon"}),onClick:q})),m().createElement("span",null,P({id:"team_settings_modal.title",defaultMessage:"Team Settings"})))),m().createElement("div",{className:"modal-info-tab-content user-settings",id:"infoSettings","aria-labelledby":"infoButton",role:"tabpanel"},m().createElement("div",{className:"name-description-container"},m().createElement(G,{name:p,clientError:I,handleNameChanges:B}),m().createElement(V,{description:b,handleDescriptionChanges:H})),m().createElement(Z,{team:n,file:y,disabled:_,onFileChange:U,onRemove:x,teamName:null!==(t=n.display_name)&&void 0!==t?t:n.name,clientError:S}),a?m().createElement(v.A,{handleCancel:F,handleSubmit:D,handleClose:k,tabChangeError:o,state:R}):void 0));return m().createElement(C.A,{content:j})})),te=e=>{let t,{activeTab:n="",closeModal:a,collapseModal:s,team:r,hasChanges:i,hasChangeTabError:o,setHasChanges:l,setHasChangeTabError:c}=e;if(!r)return null;switch(n){case"info":t=m().createElement(ee,{team:r,hasChanges:i,setHasChanges:l,hasChangeTabError:o,setHasChangeTabError:c,closeModal:a,collapseModal:s});break;case"access":t=m().createElement(q,{team:r,hasChanges:i,setHasChanges:l,hasChangeTabError:o,setHasChangeTabError:c,closeModal:a,collapseModal:s});break;default:t=m().createElement("div",null)}return t};te.propTypes={activeTab:d().string.isRequired,hasChanges:d().bool.isRequired,hasChangeTabError:d().bool.isRequired,setHasChanges:d().func.isRequired,setHasChangeTabError:d().func.isRequired,closeModal:d().func.isRequired,collapseModal:d().func.isRequired};const ne=te,ae=(0,a.connect)((function(e){return{team:(0,i.H7)(e)}}))(ne);var se=n(30138);const re=m().lazy((()=>n.e(9163).then(n.bind(n,61544)))),ie=e=>{let{onExited:t,canInviteUsers:n,focusOriginElement:a}=e;const[s,r]=(0,u.useState)("info"),[i,o]=(0,u.useState)(!0),[l,c]=(0,u.useState)(!1),[d,p]=(0,u.useState)(!1),b=(0,u.useRef)(null),{formatMessage:E}=(0,f.useIntl)(),C=(0,u.useCallback)((e=>{l?p(!0):(r(e),c(!1),p(!1))}),[l]),v=(0,u.useCallback)((()=>o(!1)),[]),y=(0,u.useCallback)((()=>{a&&(0,se.p)(a,!0),r("info"),c(!1),p(!1),t()}),[t,a]),M=(0,u.useCallback)((()=>{const e=g().findDOMNode(b.current);null==e||e.closest(".modal-dialog").classList.remove("display--content"),r("")}),[]),_=[{name:"info",uiName:E({id:"team_settings_modal.infoTab",defaultMessage:"Info"}),icon:"icon icon-information-outline",iconTitle:E({id:"generic_icons.info",defaultMessage:"Info Icon"})}];return n&&_.push({name:"access",uiName:E({id:"team_settings_modal.accessTab",defaultMessage:"Access"}),icon:"icon icon-account-multiple-outline",iconTitle:E({id:"generic_icons.member",defaultMessage:"Member Icon"})}),m().createElement(h.Modal,{dialogClassName:"a11y__modal settings-modal",show:i,onHide:v,onExited:y,role:"none","aria-labelledby":"teamSettingsModalLabel",id:"teamSettingsModal"},m().createElement(h.Modal.Header,{id:"teamSettingsModalLabel",closeButton:!0},m().createElement(h.Modal.Title,{componentClass:"h2",className:"modal-header__title"},E({id:"team_settings_modal.title",defaultMessage:"Team Settings"}))),m().createElement(h.Modal.Body,{ref:b},m().createElement("div",{className:"settings-table"},m().createElement("div",{className:"settings-links"},m().createElement(m().Suspense,{fallback:null},m().createElement(re,{tabs:_,activeTab:s,updateTab:C}))),m().createElement("div",{className:"settings-content minimize-settings"},m().createElement(ae,{activeTab:s,hasChanges:l,setHasChanges:c,hasChangeTabError:d,setHasChangeTabError:p,closeModal:v,collapseModal:M})))))};ie.propTypes={onExited:d().func.isRequired,canInviteUsers:d().bool.isRequired,focusOriginElement:d().string};const oe=ie,le=(0,a.connect)((function(e){const t=(0,i.Sy)(e),n=(0,r.mg)(e,t,s.xB.INVITE_USER),a=l.IQ.TEAM_SETTINGS;return{show:(0,o.o)(e,a),canInviteUsers:n}}))(oe)},12026:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(97023),s=n.n(a),r=n(14778);function i(){const{formatMessage:e}=(0,r.useIntl)();return s().createElement("i",{className:"icon-pencil-outline","aria-hidden":"true",title:e({id:"generic_icons.edit",defaultMessage:"Edit Icon"})})}},66215:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(62688),s=n.n(a),r=n(71633),i=n.n(r),o=n(97023),l=n.n(o),c=n(14778),d=n(85406);function u(e){let{handleSubmit:t,handleCancel:n,handleClose:a,tabChangeError:s=!1,state:r="editing",customErrorMessage:u,saveButtonText:m,cancelButtonText:h}=e;const p=i()("SaveChangesPanel",{error:s||"error"===r},{saved:"saved"===r}),g=i()("SaveChangesPanel__message",{error:s||"error"===r},{saved:"saved"===r}),f=i()("btn btn-tertiary btn-sm SaveChangesPanel__cancel-btn",{error:s||"error"===r},{saved:"saved"===r}),b=i()("btn btn-primary btn-sm SaveChangesPanel__save-btn",{error:s||"error"===r},{saved:"saved"===r});return(0,o.useEffect)((()=>{let e;return"saved"===r&&(e=setTimeout((()=>{a()}),1200)),()=>clearTimeout(e)}),[a,r]),l().createElement("div",{className:p},l().createElement("p",{className:g},l().createElement(d.AlertCircleOutlineIcon,{size:18,color:"currentcolor"}),u&&(s||"error"===r)?u:s||"editing"===r?l().createElement(c.FormattedMessage,{id:"saveChangesPanel.message",defaultMessage:"You have unsaved changes"}):"error"===r?l().createElement(c.FormattedMessage,{id:"saveChangesPanel.error",defaultMessage:"There was an error saving your settings"}):l().createElement(c.FormattedMessage,{id:"saveChangesPanel.saved",defaultMessage:"Settings saved"})),(()=>{if("saved"===r)return l().createElement("div",{className:"SaveChangesPanel__btn-ctr"},l().createElement("button",{id:"panelCloseButton","data-testid":"panelCloseButton",type:"button",className:"btn btn-icon btn-sm",onClick:a},l().createElement("i",{className:"icon icon-close"})));const e=s||"error"===r;return l().createElement("div",{className:"SaveChangesPanel__btn-ctr"},l().createElement("button",{"data-testid":"SaveChangesPanel__cancel-btn",className:f,onClick:n},h||l().createElement(c.FormattedMessage,{id:"saveChangesPanel.cancel",defaultMessage:"Undo"})),l().createElement("button",{"data-testid":"SaveChangesPanel__save-btn",className:b,onClick:t,disabled:e},m||l().createElement(c.FormattedMessage,{id:"saveChangesPanel.save",defaultMessage:"Save"})))})())}u.propTypes={handleSubmit:s().func.isRequired,handleCancel:s().func.isRequired,handleClose:s().func.isRequired,tabChangeError:s().bool,customErrorMessage:s().string,saveButtonText:s().node,cancelButtonText:s().node};const m=u},92159:(e,t,n)=>{n.d(t,{H:()=>s,K:()=>r});const a={},s=(e,t)=>e.entities.channelBookmarks.byChannelId[t]||a,r=(e,t,n)=>s(e,t)[n]},49176:(e,t,n)=>{n.d(t,{Cu:()=>r,SM:()=>i,j4:()=>l});var a=n(8361),s=n(77440);function r(e){return e.views.lhs.isOpen}function i(e){return e.views.lhs.currentStaticPageId}const o=(0,n(67173).wV)(),l=(0,a.Mz)("getVisibleSidebarStaticPages",s.WW,o,((e,t)=>{const n=[];return e&&n.push({id:"threads",isVisible:!0}),n.push({id:"drafts",isVisible:t>0}),n.filter((e=>e.isVisible))}))}}]);
//# sourceMappingURL=2669.ebda6e01aa7519b6bc79.js.map