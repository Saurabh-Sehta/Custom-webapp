"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[6222],{62114:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(62688),s=n.n(a),i=(n(17046),n(97023)),o=n.n(i),l=n(14778),r=n(23453),c=n(14696),d=n(30596),p=n(40057),h=n(21650);const u=e=>{let{pulsatingDotPlacement:t="left",pulsatingDotTranslate:n}=e;const a=(0,r.useDispatch)(),s=(0,r.useSelector)(h.F9),u=o().createElement(l.FormattedMessage,{id:"newChannelWithBoard.tutorialTip.title",defaultMessage:"Access linked boards from the App Bar"}),m=o().createElement(l.FormattedMessage,{id:"newChannelWithBoard.tutorialTip.description",defaultMessage:"The board you just created can be quickly accessed by clicking on the Boards icon in the App bar. You can view the boards that are linked to this channel in the right-hand sidebar and open one in full view."}),[g,E]=(0,i.useState)(s),b=(0,i.useCallback)((e=>{e.stopPropagation(),E(!1),a((0,d.z)({[p.pm.NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED]:!0}))}),[]),C=(0,i.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),g?(a((0,d.z)({[p.pm.NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED]:!0})),E(!1)):E(!0)}),[]),f=(0,c.LX)(["app-bar-icon-focalboard"],[],{y:-2,height:4,x:0,width:0});return s?o().createElement(c.Yd,{show:!0,screen:m,title:u,overlayPunchOut:f,placement:"right-start",pulsatingDotPlacement:t,step:1,singleTip:!0,showOptOut:!1,interactivePunchOut:!0,handleDismiss:b,handleOpen:C,handlePrevious:b,offset:[-30,5],pulsatingDotTranslate:n}):null};u.propTypes={pulsatingDotTranslate:s().shape({x:s().number.isRequired,y:s().number.isRequired})};const m=u},96121:(e,t,n)=>{n.d(t,{A:()=>p});var a=n(62688),s=n.n(a),i=n(97023),o=n.n(i),l=n(62114),r=n(87131),c=n(78451);const d=e=>{const{ariaLabelOverride:t,buttonClass:n,buttonId:a,children:s,onClick:i,tooltip:d,tooltipShortcut:p,isRhsOpen:h,pluginId:u}=e,m=u===c.g_.focalboard,g=null!=t?t:d;return o().createElement(o().Fragment,null,o().createElement(r.A,{title:h?"":d,shortcut:p},o().createElement("button",{id:a,"aria-label":g,className:n||"channel-header__icon",onClick:i},s)),m&&o().createElement(l.A,{pulsatingDotPlacement:"start",pulsatingDotTranslate:{x:0,y:-22}}))};d.propTypes={ariaLabelOverride:s().string,buttonClass:s().string,buttonId:s().string.isRequired,children:s().node.isRequired,onClick:s().func.isRequired,tooltip:s().string.isRequired,isRhsOpen:s().bool,pluginId:s().string};const p=d},86222:(e,t,n)=>{n.r(t),n.d(t,{default:()=>je});var a=n(23453),s=n(81911),i=n(5908),o=n(30413),l=n(29370),r=n(56707),c=n(40057),d=n(65952),p=n(26614),h=n(73996),u=n(14776),m=n(7430),g=n(16230),E=n(2386),b=n(75270),C=n(64890),f=n(68124),_=(n(4290),n(71633)),v=n.n(_),N=n(97023),M=n.n(N),A=n(14778),y=n(67277),w=n(2866),P=n(77828),H=n(87131),T=(n(17046),n(35134)),O=n.n(T),R=n(34545),x=n.n(R),I=n(17983),S=n(99068),L=n(78451);const k=(0,a.connect)((function(e){return{currentChannel:(0,d.Lw)(e),pluginCallComponents:e.plugins.components.CallButton,channelMember:(0,d.tW)(e),sidebarOpen:e.views.rhs.isSidebarOpen}}))((function(e){let{pluginCallComponents:t,currentChannel:n,channelMember:a,sidebarOpen:s}=e;const[i,o]=(0,N.useState)(!1),[l,r]=(0,N.useState)(!0),c=(0,N.useRef)(s),{formatMessage:d}=(0,A.useIntl)();if((0,N.useEffect)((()=>{c.current&&!s&&(r(!1),setTimeout((()=>{r(!0)}),L.YM.CHANNEL_HEADER_BUTTON_DISABLE_TIMEOUT)),c.current=s}),[s]),0===t.length)return null;const p={container:{marginTop:16,height:32}};if(1===t.length){const e=t[0],s=()=>{var t;return null===(t=e.action)||void 0===t?void 0:t.call(e,n,a)};return M().createElement("div",{style:p.container,className:"flex-child",onClick:l?s:void 0,onTouchEnd:l?s:void 0},e.button)}const h=t.map((e=>M().createElement("li",{className:"MenuItem",key:e.id,onClick:t=>{var s;t.preventDefault(),null===(s=e.action)||void 0===s||s.call(e,n,a)}},e.dropdownButton)));return M().createElement("div",{style:p.container,className:"flex-child"},M().createElement(S.A,{onToggle:e=>o(e)},M().createElement("button",{className:v()("style--none call-button dropdown",{active:i})},M().createElement(x(),{color:"inherit","aria-label":d({id:"generic_icons.call",defaultMessage:"Call icon"}).toLowerCase()}),M().createElement("span",{className:"call-button-label"},"Call"),M().createElement(O(),{color:"inherit","aria-label":d({id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"}).toLowerCase()})),M().createElement(I.A,{id:"callOptions",ariaLabel:d({id:"call_button.menuAriaLabel",defaultMessage:"Call type selector"}),customStyles:{top:"auto",left:"auto",right:0}},h)))}));var F=n(43595),B=n(77440),D=n(31423),j=n(21650),U=n(62688),G=n.n(U),W=(n(43813),n(83675)),q=n(6098),Y=n(17651),z=n(96121);function V(e){const{formatMessage:t}=(0,A.useIntl)();return M().createElement("span",e,M().createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 18 18",version:"1.1",role:"img","aria-label":t({id:"generic_icons.plugins",defaultMessage:"Plugins"})},M().createElement("path",{d:"M14.58 9.14399L17.136 6.60599C17.304 6.42599 17.388 6.20999 17.388 5.95799C17.388 5.70599 17.298 5.49599 17.118 5.32799C16.95 5.14799 16.74 5.05799 16.488 5.05799C16.236 5.05799 16.026 5.14799 15.858 5.32799L13.302 7.86599L10.134 4.69799L12.672 2.14199C12.852 1.97399 12.942 1.76399 12.942 1.51199C12.942 1.25999 12.852 1.04999 12.672 0.881987C12.504 0.701987 12.294 0.611987 12.042 0.611987C11.79 0.611987 11.574 0.695987 11.394 0.863987L8.856 3.41999L6.318 0.863987C6.138 0.695987 5.922 0.611987 5.67 0.611987C5.418 0.611987 5.208 0.695987 5.04 0.863987V0.881987C4.86 1.04999 4.77 1.25999 4.77 1.51199C4.77 1.76399 4.86 1.97399 5.04 2.14199L5.67 2.78999L2.808 5.65199C2.016 6.44399 1.458 7.36799 1.134 8.42399C0.81 9.45599 0.744 10.512 0.936 11.592C1.128 12.66 1.56 13.632 2.232 14.508L0.27 16.47C0.09 16.638 0 16.848 0 17.1C0 17.352 0.09 17.562 0.27 17.73C0.45 17.898 0.66 17.982 0.9 17.982C1.152 17.994 1.362 17.91 1.53 17.73L3.492 15.768C4.368 16.44 5.34 16.872 6.408 17.064C7.488 17.256 8.544 17.19 9.576 16.866C10.632 16.542 11.556 15.984 12.348 15.192L15.21 12.33L15.858 12.96C16.026 13.14 16.236 13.23 16.488 13.23C16.74 13.23 16.95 13.14 17.118 12.96H17.136C17.304 12.792 17.388 12.582 17.388 12.33C17.388 12.078 17.304 11.862 17.136 11.682L14.58 9.14399ZM11.088 13.914C10.452 14.55 9.702 14.976 8.838 15.192C8.01 15.408 7.176 15.408 6.336 15.192C5.472 14.976 4.722 14.55 4.086 13.914C3.45 13.278 3.024 12.528 2.808 11.664C2.592 10.824 2.592 9.98999 2.808 9.16199C3.024 8.29799 3.45 7.54799 4.086 6.91199L6.948 4.04999L13.95 11.052L11.088 13.914Z"})))}var Q=n(27840);function X(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class K extends M().PureComponent{constructor(){super(...arguments),X(this,"handleRootClose",(()=>{this.props.onClose()}))}render(){const{open:e,rootCloseEvent:t,children:n}=this.props;return M().createElement(q.YE,{disabled:!e,onRootClose:this.handleRootClose,event:t},M().createElement("ul",{role:"menu",className:"dropdown-menu channel-header_plugin-dropdown"},n))}}X(K,"propTypes",{open:G().bool,children:G().node,onClose:G().func.isRequired,rootCloseEvent:G().oneOf(["click","mousedown"]),bsRole:G().string.isRequired});class J extends M().PureComponent{constructor(){super(...arguments),X(this,"handleClick",(e=>{this.props.onClick&&this.props.onClick(e)}))}render(){const{children:e}=this.props;let t="";return this.props.dropdownOpen&&(t=" channel-header__icon--active"),M().createElement("button",{id:"pluginChannelHeaderButtonDropdown",className:"channel-header__icon channel-header__icon--wide "+t,type:"button",onClick:this.handleClick},e)}}X(J,"propTypes",{children:G().node,dropdownOpen:G().bool,onClick:G().func,bsRole:G().string.isRequired});class Z extends M().PureComponent{constructor(e){super(e),X(this,"disableButtonsClosingRHS",!1),X(this,"toggleDropdown",(e=>{this.setState({dropdownOpen:e})})),X(this,"onClose",(()=>{this.toggleDropdown(!1)})),X(this,"fireAction",(e=>{this.disableButtonsClosingRHS||e(this.props.channel,this.props.channelMember)})),X(this,"fireActionAndClose",(e=>{e(this.props.channel,this.props.channelMember),this.onClose()})),X(this,"createComponentButton",(e=>{var t,n;function a(e,t){return"string"==typeof t?t:t&&"object"==typeof t&&"type"in t&&t.type===A.FormattedMessage?e.formatMessage({id:t.props.id,defaultMessage:t.props.defaultMessage},t.props.value):""}let s;e.tooltipText?s=a(this.props.intl,e.tooltipText):e.dropdownText&&(s=a(this.props.intl,e.dropdownText));const i=null!==(t=null!==(n=e.tooltipText)&&void 0!==n?n:e.dropdownText)&&void 0!==t?t:"";return M().createElement(z.A,{key:"channelHeaderButton"+e.id,buttonClass:"channel-header__icon",onClick:()=>this.fireAction(e.action),buttonId:e.id+"ChannelHeaderButton",tooltip:i,ariaLabelOverride:s,pluginId:e.pluginId},e.icon)})),X(this,"onBindingClick",(async e=>{if(this.disableButtonsClosingRHS)return;const{channel:t,intl:n}=this.props,a=(0,Q.aC)(e.app_id,e.location,this.props.channel.id,this.props.channel.team_id),s=await this.props.actions.handleBindingClick(e,a,n);if(s.error){const e=s.error,a=e.text||n.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});return void this.props.actions.postEphemeralCallResponseForChannel(e,a,t.id)}const i=s.data;switch(i.type){case Y.G4.OK:i.text&&this.props.actions.postEphemeralCallResponseForChannel(i,i.text,t.id);break;case Y.G4.NAVIGATE:break;case Y.G4.FORM:i.form&&this.props.actions.openAppsModal(i.form,a);break;default:{const e=this.props.intl.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:i.type});this.props.actions.postEphemeralCallResponseForChannel(i,e,t.id)}}})),X(this,"createAppBindingButton",(e=>M().createElement(z.A,{key:"channelHeaderButton_".concat(e.app_id,"_").concat(e.location),buttonClass:"channel-header__icon style--none",onClick:()=>this.onBindingClick(e),buttonId:"".concat(e.app_id,"_").concat(e.location),tooltip:e.label},M().createElement("img",{src:e.icon,width:"24",height:"24"})))),X(this,"createDropdown",((e,t)=>{const n=e.filter((e=>e.action)).map((e=>M().createElement("li",{key:"channelHeaderPlug"+e.id},M().createElement("a",{href:"#",className:"d-flex align-items-center",onClick:()=>this.fireActionAndClose(e.action)},M().createElement("span",{className:"d-flex align-items-center overflow--ellipsis"},e.icon),M().createElement("span",null,e.dropdownText)))));let a=n;return this.props.appsEnabled&&(a=n.concat(t.map((e=>M().createElement("li",{key:"channelHeaderPlug"+e.app_id+e.location},M().createElement("a",{href:"#",className:"d-flex align-items-center",onClick:()=>this.fireActionAndClose((()=>this.onBindingClick(e)))},M().createElement("span",{className:"d-flex align-items-center overflow--ellipsis icon"},M().createElement("img",{src:e.icon})),M().createElement("span",null,e.label))))))),M().createElement("div",{className:"flex-child"},M().createElement(W.Dropdown,{id:"channelHeaderPlugDropdown",onToggle:this.toggleDropdown,open:this.state.dropdownOpen},M().createElement(J,{bsRole:"toggle",dropdownOpen:this.state.dropdownOpen},M().createElement(H.A,{title:M().createElement(A.FormattedMessage,{id:"generic_icons.plugins",defaultMessage:"Plugins"})},M().createElement(M().Fragment,null,M().createElement(V,{id:"pluginChannelHeaderIcon",className:"icon icon--standard icon__pluginChannelHeader","aria-hidden":"true"}),M().createElement("span",{id:"pluginCount",className:"icon__text"},a.length)))),M().createElement(K,{bsRole:"menu",open:this.state.dropdownOpen,onClose:this.onClose},a)))})),this.state={dropdownOpen:!1}}componentDidUpdate(e){e.sidebarOpen&&!this.props.sidebarOpen&&(this.disableButtonsClosingRHS=!0,setTimeout((()=>{this.disableButtonsClosingRHS=!1}),L.YM.CHANNEL_HEADER_BUTTON_DISABLE_TIMEOUT))}render(){const e=this.props.components||[],t=this.props.appsEnabled&&this.props.appBindings||[];if(this.props.shouldShowAppBar||0===e.length&&0===t.length)return null;if(e.length+t.length<=15){let n=e.filter((e=>e.icon&&e.action)).map(this.createComponentButton);return this.props.appsEnabled&&(n=n.concat(t.map(this.createAppBindingButton))),n}return this.createDropdown(e,t)}}X(Z,"propTypes",{components:G().array,appBindings:G().array,appsEnabled:G().bool.isRequired,sidebarOpen:G().bool.isRequired,shouldShowAppBar:G().bool.isRequired,actions:G().shape({}).isRequired}),X(Z,"defaultProps",{components:[],appBindings:[]});const $=(0,A.injectIntl)(Z),ee=(0,a.connect)((function(e){const t=(0,F.cO)(e);return{components:(0,j.IH)(e),appBindings:(0,F.eK)(e),appsEnabled:t,appBarEnabled:(0,F.SN)(e),theme:(0,B.O4)(e),sidebarOpen:e.views.rhs.isSidebarOpen,shouldShowAppBar:(0,j.hN)(e)}}),(function(e){return{actions:(0,i.bindActionCreators)({handleBindingClick:D.I$,postEphemeralCallResponseForChannel:D.hV,openAppsModal:D.el},e)}}))($);var te=n(85873),ne=(n(76685),n(79751)),ae=n(64182),se=n(57486),ie=n(62975),oe=(n(29206),n(3188),n(6552),n(18955)),le=n(38889),re=n(94621),ce=n(18515);function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){he(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function he(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ue={singleline:!0},me={singleline:!1},ge={mentionHighlight:!1,atMentions:!0},Ee={hideUtilities:!0},be={duration:{open:L.pl.FADE_IN_DURATION,close:L.pl.FADE_OUT_DURATION},initial:L.mj.START};function Ce(e){const t=(0,a.useSelector)(u._p),n=(0,N.useRef)(null),s=(w=null==n?void 0:n.current,P=e.text,!!w&&(!!P.match(/\n{2,}/g)||(w.scrollWidth!==w.clientWidth||w.scrollHeight!==w.clientHeight)&&(w.scrollWidth>w.clientWidth||w.scrollHeight>w.clientHeight))),i=(0,N.useMemo)((()=>({inHeader:pe(pe(pe({},ue),ge),{},{channelNamesMap:e.channelMentionsNameMap}),inPopover:pe(pe(pe({},me),ge),{},{channelNamesMap:e.channelMentionsNameMap})})),[e.channelMentionsNameMap]),[o,l]=(0,N.useState)(!1),{refs:{setReference:r,setFloating:c},floatingStyles:d,context:p}=(0,oe.we)({open:!!s&&o,onOpenChange:l,whileElementsMounted:le.ll,middleware:[(0,re.cY)(-28)]}),{isMounted:h,styles:m}=(0,oe.DL)(p,be),g=(0,oe.Mk)(p,{enabled:s,handleClose:(0,oe.iB)({requireIntent:!1,blockPointerEvents:!0})}),E=(0,oe.iQ)(p),b=(0,oe.s9)(p),C=(0,oe.kp)(p),f=(0,oe.It)(p,{role:"tooltip"}),{getReferenceProps:_,getFloatingProps:v}=(0,oe.bv)([g,E,C,b,f]),A=(0,oe.SV)([n,r]),y=function(e){return e?e.clientWidth+18:"inherit"}(null==n?void 0:n.current);var w,P;function H(e){(0,te.oO)(e,t)}return M().createElement(M().Fragment,null,M().createElement("div",Object.assign({ref:A,className:"header-description__text"},_(),{onClick:H}),M().createElement(ce.A,{message:e.text,options:i.inHeader,imageProps:Ee})),h&&M().createElement(oe.XF,{id:L.Bj},M().createElement(oe.zR,{className:"channel-header-text-popover-floating-overlay",lockScroll:!0},M().createElement("div",Object.assign({ref:c,className:"channel-header-text-popover",style:pe(pe({maxWidth:y},d),m),onClick:H},v()),M().createElement(ce.A,{message:e.text,options:i.inPopover,imageProps:Ee})))))}function fe(e){var t,n,a,s,i,o;const l=0!==e.channel.delete_at,r=e.channel.type===L.YM.DM_CHANNEL,d=e.channel.type===L.YM.GM_CHANNEL,p=r&&null!==(t=null===(n=e.dmUser)||void 0===n?void 0:n.is_bot)&&void 0!==t&&t,h=e.channel.type===L.YM.PRIVATE_CHANNEL,u=p?null!==(a=null===(s=e.dmUser)||void 0===s?void 0:s.bot_description)&&void 0!==a?a:"":null!==(i=null===(o=e.channel)||void 0===o?void 0:o.header)&&void 0!==i?i:"";var m,g;return u.trim().length>0?M().createElement(Ce,{text:u,channelMentionsNameMap:(0,ie.QE)(null===(m=e.channel)||void 0===m||null===(g=m.props)||void 0===g?void 0:g.channel_mentions)?e.channel.props.channel_mentions:void 0}):l||p?null:r||d?M().createElement(_e,{channel:e.channel}):M().createElement(se.A,{channelId:e.channel.id,teamId:e.teamId,permissions:[h?c.xB.MANAGE_PRIVATE_CHANNEL_PROPERTIES:c.xB.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},M().createElement(_e,{channel:e.channel}))}function _e(e){let{channel:t}=e;const n=(0,a.useDispatch)();return M().createElement("button",{className:"header-placeholder style--none",onClick:function(){n((0,ne.q)({modalId:L.IQ.EDIT_CHANNEL_HEADER,dialogType:ae.A,dialogProps:{channel:t}}))}},M().createElement(A.FormattedMessage,{id:"channel_header.headerText.addNewButton",defaultMessage:"Add a channel header"}),M().createElement("i",{className:"icon icon-pencil-outline edit-icon","aria-hidden":!0}))}var ve=n(40693),Ne=n(61767),Me=n(59050),Ae=n(17862),ye=n(19542),we=n(42945);const Pe=()=>{var e;const t=(0,A.useIntl)(),n=(0,a.useDispatch)(),s=(0,a.useSelector)(d.TJ),i=(0,a.useSelector)(d.Lw),l=(null!==(e=null==i?void 0:i.delete_at)&&void 0!==e?e:0)>0,r=(0,N.useRef)(null),c=(0,N.useCallback)((e=>{e.stopPropagation(),i&&(n(s?(0,o.XJ)(i.id):(0,o.yc)(i.id)),requestAnimationFrame((()=>{r.current&&document.dispatchEvent(new CustomEvent(L.pn.FOCUS,{detail:{target:r.current,keyboardOnly:!1}}))})))}),[s,i,n]);if(!i||l)return null;let p=t.formatMessage({id:"channelHeader.addToFavorites",defaultMessage:"Add to Favorites"});s&&(p=t.formatMessage({id:"channelHeader.removeFromFavorites",defaultMessage:"Remove from Favorites"})),p=p.toLowerCase();const h=M().createElement(M().Fragment,null,!s&&M().createElement(A.FormattedMessage,{id:"channelHeader.addToFavorites",defaultMessage:"Add to Favorites"}),s&&M().createElement(A.FormattedMessage,{id:"channelHeader.removeFromFavorites",defaultMessage:"Remove from Favorites"}));return M().createElement(H.A,{title:h},M().createElement("button",{id:"toggleFavorite",onClick:c,className:v()("channel-header__favorites btn btn-icon btn-xs",{active:s,inactive:!s}),"aria-label":p,ref:r},M().createElement("i",{className:v()("icon",{"icon-star":s,"icon-star-outline":!s})})))},He=(0,N.memo)(Pe);var Te=n(6281),Oe=n(96182);const Re=e=>{let{dmUser:t,gmMembers:n,remoteNames:s}=e;const i=(0,a.useSelector)(d.Lw);if(!i)return null;const o=i.type===L.YM.DM_CHANNEL,l=i.type===L.YM.GM_CHANNEL;let r,c;0!==i.delete_at&&(r=M().createElement(Ae.A,{className:"icon icon__archive icon channel-header-archived-icon svg-text-color"})),i.shared&&(c=M().createElement(Me.A,{className:"shared-channel-icon",withTooltip:!0,remoteNames:s}));let p=i.display_name;return o?p=M().createElement(we.A,{dmUser:t}):l&&(p=M().createElement(Te.A,{gmMembers:n})),o&&null!=t&&t.is_bot?M().createElement("div",{id:"channelHeaderDropdownButton",className:"channel-header__bot"},M().createElement(He,null),M().createElement(Ne.A,{src:ve.mT.getProfilePictureUrl(t.id,t.last_picture_update),size:"sm"}),M().createElement("strong",{id:"channelHeaderTitle",className:"heading"},M().createElement("span",null,r,p)),M().createElement(ye.A,null)):M().createElement("div",{className:"channel-header__top"},M().createElement(He,null),o&&t&&M().createElement(Ne.A,{src:ve.mT.getProfilePictureUrl(t.id,t.last_picture_update),size:"sm",status:i.status}),M().createElement(Oe.A,{dmUser:t,gmMembers:n,sharedIcon:c,archivedIcon:r}))};Re.propTypes={gmMembers:G().array,remoteNames:G().arrayOf(G().string)};const xe=(0,N.memo)(Re);var Ie=n(44785);const Se=n.n(Ie)().i.withConfig({displayName:"Icon"})(["font-size:18px;line-height:18px;display:inline-flex;align-items:center;justify-content:center;"]),Le=e=>{let{channel:t}=e;const n=(0,a.useDispatch)(),s=(0,A.useIntl)(),i=(0,a.useSelector)(b.bM),o=(0,a.useSelector)(b.A),l=i===L._n.CHANNEL_INFO||i===L._n.CHANNEL_MEMBERS||i===L._n.CHANNEL_FILES||i===L._n.PIN,r=o&&l,c=(0,N.useCallback)((()=>{if(r){const e=l?(0,E.bP)():(0,E.Vl)(t.id);n(e)}else n((0,E.Vl)(t.id))}),[r,t.id,l,n]);let d;d=r?s.formatMessage({id:"channel_header.closeChannelInfo",defaultMessage:"Close info"}):s.formatMessage({id:"channel_header.openChannelInfo",defaultMessage:"View Info"});let p="channel-header__icon";return r&&(p+=" channel-header__icon--active-inverted"),M().createElement(z.A,{buttonClass:p,buttonId:"channel-info-btn",onClick:c,tooltip:d},M().createElement(Se,{className:"icon-information-outline"}))};function ke(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Fe extends M().PureComponent{constructor(e){super(e),ke(this,"unmute",(()=>{const{actions:e,channel:t,channelMember:n,currentUser:a}=this.props;if(!n||!a||!t)return;const s={mark_unread:L.DB.ALL};e.updateChannelNotifyProps(a.id,t.id,s)})),ke(this,"showPinnedPosts",(e=>{e.preventDefault(),this.props.rhsState===L._n.PIN?this.props.actions.closeRightHandSide():this.props.actions.showPinnedPosts()})),ke(this,"showChannelFiles",(()=>{this.props.rhsState===L._n.CHANNEL_FILES?this.props.actions.closeRightHandSide():this.props.channel&&this.props.actions.showChannelFiles(this.props.channel.id)})),ke(this,"toggleChannelMembersRHS",(()=>{this.props.rhsState===L._n.CHANNEL_MEMBERS?this.props.actions.closeRightHandSide():this.props.channel&&this.props.actions.showChannelMembers(this.props.channel.id)})),ke(this,"renderCustomStatus",(()=>{var e;const{customStatus:t,isCustomStatusEnabled:n,isCustomStatusExpired:a}=this.props,s=!a&&((null==t?void 0:t.text)||(null==t?void 0:t.emoji));return n&&s?M().createElement("div",{className:"custom-emoji__wrapper"},M().createElement(y.A,{userID:null===(e=this.props.dmUser)||void 0===e?void 0:e.id,showTooltip:!0,emojiStyle:{verticalAlign:"top",margin:"0 4px 1px"}}),M().createElement(w.A,{text:null==t?void 0:t.text,className:"custom-emoji__text"})):null})),this.toggleFavoriteRef=M().createRef()}componentDidMount(){var e;this.props.actions.getCustomEmojisInText(this.props.channel?this.props.channel.header:""),null!==(e=this.props.channel)&&void 0!==e&&e.shared&&this.props.actions.fetchChannelRemotes(this.props.channel.id)}componentDidUpdate(e){var t;const n=this.props.channel?this.props.channel.header:"";var a,s;n!==(e.channel?e.channel.header:"")&&this.props.actions.getCustomEmojisInText(n),null!==(t=this.props.channel)&&void 0!==t&&t.shared&&(this.props.channel.id!==(null===(a=e.channel)||void 0===a?void 0:a.id)?this.props.actions.fetchChannelRemotes(this.props.channel.id):this.props.channel.shared!==(null===(s=e.channel)||void 0===s?void 0:s.shared)&&this.props.actions.fetchChannelRemotes(this.props.channel.id,!0))}render(){const{teamId:e,currentUser:t,gmMembers:n,channel:a,channelMember:s,isChannelMuted:i,dmUser:o,rhsState:l,hasGuests:r,hideGuestTags:c}=this.props;if(!a)return null;const d=this.props.intl.formatMessage({id:"accessibility.sections.channelHeader",defaultMessage:"channel header region"});let p="";if(r&&!c&&(p=M().createElement("span",{className:"has-guest-header"},M().createElement("span",{tabIndex:0},M().createElement(A.FormattedMessage,{id:"channel_header.channelHasGuests",defaultMessage:"Channel has guests"})))),(0,te.RI)(a)||(0,te.RI)(s)||(0,te.RI)(t)||!o&&a.type===L.YM.DM_CHANNEL)return M().createElement("div",{className:"channel-header"});const h=a.type===L.YM.DM_CHANNEL;let u;a.type===L.YM.GM_CHANNEL&&r&&!c&&(p=M().createElement("span",{className:"has-guest-header"},M().createElement(A.FormattedMessage,{id:"channel_header.groupMessageHasGuests",defaultMessage:"This group message has guests"}))),!h||null!=o&&o.delete_at||null!=o&&o.is_bot||(u=M().createElement("span",{className:"header-status__text"},this.renderCustomStatus()),this.props.isLastActiveEnabled&&this.props.lastActivityTimestamp&&this.props.timestampUnits&&(u=M().createElement("span",{className:"header-status__text"},M().createElement("span",{className:"last-active__text"},M().createElement(A.FormattedMessage,{id:"channel_header.lastActive",defaultMessage:"Active {timestamp}",values:{timestamp:M().createElement(P.Ay,{value:this.props.lastActivityTimestamp,units:this.props.timestampUnits,useTime:!1,style:"short"})}})),this.renderCustomStatus())));const m=v()("channel-header__icon channel-header__icon--left btn btn-icon btn-xs ",{"channel-header__icon--active":l===L._n.CHANNEL_FILES}),g=M().createElement("i",{className:"icon icon-file-text-outline"}),E=v()("channel-header__icon channel-header__icon--wide channel-header__icon--left btn btn-icon btn-xs",{"channel-header__icon--active":l===L._n.PIN}),b=this.props.pinnedPostsCount?M().createElement(M().Fragment,null,M().createElement("i",{"aria-hidden":"true",className:"icon icon-pin-outline channel-header__pin"}),M().createElement("span",{id:"channelPinnedPostCountText",className:"icon__text"},this.props.pinnedPostsCount)):M().createElement("i",{"aria-hidden":"true",className:"icon icon-pin-outline channel-header__pin"}),C=this.props.pinnedPostsCount?M().createElement(z.A,{buttonClass:E,buttonId:"channelHeaderPinButton",onClick:this.showPinnedPosts,tooltip:this.props.intl.formatMessage({id:"channel_header.pinnedPosts",defaultMessage:"Pinned messages"})},b):null;let f,_=null;if(!h){const e=v()("member-rhs__trigger channel-header__icon channel-header__icon--wide channel-header__icon--left btn btn-icon btn-xs",{"channel-header__icon--active":l===L._n.CHANNEL_MEMBERS}),t=this.props.memberCount?M().createElement(M().Fragment,null,M().createElement("i",{"aria-hidden":"true",className:"icon icon-account-outline channel-header__members"}),M().createElement("span",{id:"channelMemberCountText",className:"icon__text"},this.props.memberCount)):M().createElement(M().Fragment,null,M().createElement("i",{"aria-hidden":"true",className:"icon icon-account-outline channel-header__members"}),M().createElement("span",{id:"channelMemberCountText",className:"icon__text"},"-"));_=M().createElement(z.A,{tooltip:this.props.intl.formatMessage({id:"channel_header.channelMembers",defaultMessage:"Members"}),buttonClass:e,buttonId:"member_rhs",onClick:this.toggleChannelMembersRHS},t)}return i&&(f=M().createElement(H.A,{title:M().createElement(A.FormattedMessage,{id:"channelHeader.unmute",defaultMessage:"Unmute"})},M().createElement("button",{id:"toggleMute",onClick:this.unmute,className:"channel-header__mute inactive btn btn-icon btn-xs","aria-label":this.props.intl.formatMessage({id:"channelHeader.unmute",defaultMessage:"Unmute"})},M().createElement("i",{className:"icon icon-bell-off-outline","aria-hidden":!0})))),M().createElement("div",{id:"channel-header","aria-label":d,role:"banner",tabIndex:-1,"data-channelid":"".concat(a.id),className:"channel-header alt a11y__region","data-a11y-sort-order":"8"},M().createElement("div",{className:"flex-parent"},M().createElement("div",{className:"flex-child"},M().createElement("div",{id:"channelHeaderInfo",className:"channel-header__info"},M().createElement("div",{className:"channel-header__title dropdown"},M().createElement(xe,{dmUser:o,gmMembers:n,remoteNames:this.props.remoteNames}),M().createElement("div",{className:"channel-header__icons"},f,_,C,this.props.isFileAttachmentsEnabled&&M().createElement(z.A,{buttonClass:m,buttonId:"channelHeaderFilesButton",onClick:this.showChannelFiles,tooltip:this.props.intl.formatMessage({id:"channel_header.channelFiles",defaultMessage:"Channel files"})},g)),M().createElement("div",{id:"channelHeaderDescription",className:"channel-header__description"},u,p,M().createElement(fe,{teamId:e,channel:a,dmUser:o}))))),(!a.shared||this.props.sharedChannelsPluginsEnabled)&&M().createElement(M().Fragment,null,M().createElement(ee,{channel:a,channelMember:s}),M().createElement(k,null)),M().createElement(Le,{channel:a})))}}const Be=(0,A.injectIntl)(Fe),De=(0,a.connect)((function(){const e=(0,m.dH)(),t=(0,C.Oc)();let n=[];return function(a){const s=(0,d.Lw)(a),i=(0,m.HW)(a),o=(0,p.zj)(a),l="true"===(0,p.Y6)(a,"EnableSharedChannelsPlugins");let r,E,_,v,N=[];if(s&&s.type===c.Bz.DM_CHANNEL){const e=(0,g.r4)(i.id,s.name);r=(0,m.wz)(a,e),_=r&&t(a,r.id),v=r&&(0,m.v4)(a,r.id)}else s&&s.type===c.Bz.GM_CHANNEL&&(E=e(a,s.id));null!=s&&s.shared&&(N=(0,h.lk)(a,s.id));const M=(0,d.Wh)(a);let A=!1;return r&&(A=(0,m.FF)(a,r.id),n=(0,m.tP)(a,r.id)),{teamId:(0,u.Sy)(a),channel:s,channelMember:(0,d.tW)(a),memberCount:(null==M?void 0:M.member_count)||0,currentUser:i,dmUser:r,gmMembers:E,remoteNames:N,rhsState:(0,b.bM)(a),isChannelMuted:(0,d.cP)(a),hasGuests:!!M&&M.guest_count>0,pinnedPostsCount:(null==M?void 0:M.pinnedpost_count)||0,customStatus:_,isCustomStatusEnabled:(0,C.xI)(a),isCustomStatusExpired:(0,C.TX)(a,_),lastActivityTimestamp:v,isFileAttachmentsEnabled:(0,f._G)(o),isLastActiveEnabled:A,timestampUnits:n,hideGuestTags:"true"===o.HideGuestTags,sharedChannelsPluginsEnabled:l}}}),(e=>({actions:(0,i.bindActionCreators)({showPinnedPosts:E.H3,showChannelFiles:E.QK,closeRightHandSide:E.bP,getCustomEmojisInText:l.rg,updateChannelNotifyProps:o.cz,showChannelMembers:E.sQ,fetchChannelRemotes:r.No},e)}))),je=(0,s.withRouter)(De(Be))}}]);
//# sourceMappingURL=6222.70b6d569bc58003e5a69.js.map