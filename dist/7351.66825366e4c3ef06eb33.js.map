{"version":3,"file":"7351.66825366e4c3ef06eb33.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/tours/crt_tour/collapsed_reply_threads_modal.tsx","webpack://mattermost-webapp/./src/components/tours/crt_tour/crt_welcome_tutorial_tip.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads_link/threads_icon.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads_link/global_threads_link.tsx","webpack://mattermost-webapp/./src/components/threading/hooks.ts","webpack://mattermost-webapp/./src/components/tours/crt_tour/crt_tour_tip.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/fa_next_icon.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useEffect} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\n\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {closeModal} from 'actions/views/modals';\r\n\r\nimport NextIcon from 'components/widgets/icons/fa_next_icon';\r\n\r\nimport crtInProductImg from 'images/crt-in-product.gif';\r\nimport {Constants, ModalIdentifiers, Preferences} from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\n\r\nimport './collapsed_reply_threads_modal.scss';\r\nimport {AutoTourStatus, TTNameMapToATStatusKey, TutorialTourName} from '../constant';\r\n\r\ntype Props = {\r\n    onExited: () => void;\r\n}\r\n\r\nfunction CollapsedReplyThreadsModal(props: Props) {\r\n    const dispatch = useDispatch();\r\n    const currentUserId = useSelector(getCurrentUserId);\r\n    const handleKeyDown = useCallback((e: KeyboardEvent) => {\r\n        if (Keyboard.isKeyPressed(e, Constants.KeyCodes.ENTER)) {\r\n            onNext();\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        document.addEventListener('keydown', handleKeyDown);\r\n        return () => document.removeEventListener('keydown', handleKeyDown);\r\n    }, [handleKeyDown]);\r\n\r\n    const onHide = useCallback((skipTour: boolean) => {\r\n        dispatch(closeModal(ModalIdentifiers.COLLAPSED_REPLY_THREADS_MODAL));\r\n        if (skipTour) {\r\n            const preferences = [{\r\n                user_id: currentUserId,\r\n                category: Preferences.CRT_TUTORIAL_TRIGGERED,\r\n                name: currentUserId,\r\n                value: (Constants.CrtTutorialTriggerSteps.FINISHED).toString(),\r\n            }];\r\n            dispatch(savePreferences(currentUserId, preferences));\r\n        }\r\n    }, [currentUserId]);\r\n\r\n    const onNext = useCallback(() => {\r\n        const preferences = [{\r\n            user_id: currentUserId,\r\n            category: Preferences.CRT_TUTORIAL_TRIGGERED,\r\n            name: currentUserId,\r\n            value: (Constants.CrtTutorialTriggerSteps.STARTED).toString(),\r\n        }, {\r\n            user_id: currentUserId,\r\n            category: TutorialTourName.CRT_TUTORIAL_STEP,\r\n            name: TTNameMapToATStatusKey[TutorialTourName.CRT_TUTORIAL_STEP],\r\n            value: AutoTourStatus.ENABLED.toString(),\r\n        }];\r\n        dispatch(savePreferences(currentUserId, preferences));\r\n        onHide(false);\r\n    }, [currentUserId]);\r\n\r\n    return (\r\n        <GenericModal\r\n            compassDesign={true}\r\n            className='CollapsedReplyThreadsModal productNotices'\r\n            id={ModalIdentifiers.COLLAPSED_REPLY_THREADS_MODAL}\r\n            onExited={props.onExited}\r\n            handleConfirm={onNext}\r\n            autoCloseOnConfirmButton={true}\r\n            handleCancel={() => onHide(true)}\r\n            modalHeaderText={(\r\n                <FormattedMessage\r\n                    id='collapsed_reply_threads_modal.title'\r\n                    defaultMessage={'A new way to view and follow threads'}\r\n                />\r\n            )}\r\n            confirmButtonText={(\r\n                <>\r\n                    <FormattedMessage\r\n                        id={'collapsed_reply_threads_modal.take_the_tour'}\r\n                        defaultMessage='Take the Tour'\r\n                    />\r\n                    <NextIcon/>\r\n                </>\r\n            )}\r\n            cancelButtonText={\r\n                <FormattedMessage\r\n                    id={'collapsed_reply_threads_modal.skip_tour'}\r\n                    defaultMessage='Skip Tour'\r\n                />\r\n            }\r\n        >\r\n            <div>\r\n                <p className='productNotices__helpText'>\r\n                    <FormattedMessage\r\n                        id={'collapsedReplyThreadsModal.helpText'}\r\n                        defaultMessage={'Threads have been revamped to help you create organized conversation around specific messages. Now, channels will appear less cluttered as replies are collapsed under the original message, and all the conversations you\\'re following are available in your <b>Threads</b> view. Take the tour to see what\\'s new.'}\r\n                        values={{\r\n                            b: (chunks: string) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                </p>\r\n                <img\r\n                    src={crtInProductImg}\r\n                    className='CollapsedReplyThreadsModal__img'\r\n                />\r\n            </div>\r\n        </GenericModal>\r\n    );\r\n}\r\n\r\nexport default CollapsedReplyThreadsModal;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport {useMeasurePunchouts} from '@mattermost/components';\r\n\r\nimport CRTTourTip from './crt_tour_tip';\r\n\r\nconst CRTWelcomeTutorialTip = () => {\r\n    const {formatMessage} = useIntl();\r\n    const title = (\r\n        <FormattedMessage\r\n            id='tutorial_threads.welcome.title'\r\n            defaultMessage={'Welcome to the Threads view!'}\r\n        />\r\n    );\r\n\r\n    const screen = (\r\n        <p>\r\n            {formatMessage(\r\n                {\r\n                    id: 'tutorial_threads.welcome.description',\r\n                    defaultMessage:\r\n                        'All the conversations that you’re participating in or following will show here. If you have unread messages or mentions within your threads, you’ll see that here too.',\r\n\r\n                })\r\n            }\r\n        </p>\r\n    );\r\n\r\n    const overlayPunchOut = useMeasurePunchouts(['sidebar-threads-button'], []);\r\n\r\n    return (\r\n        <CRTTourTip\r\n            title={title}\r\n            screen={screen}\r\n            overlayPunchOut={overlayPunchOut}\r\n            placement='right-start'\r\n            pulsatingDotPlacement='right'\r\n        />\r\n    );\r\n};\r\n\r\nexport default CRTWelcomeTutorialTip;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {HTMLAttributes} from 'react';\r\n\r\nconst ThreadsIcon = (attrs: HTMLAttributes<SVGElement>) => {\r\n    return (\r\n        <svg\r\n            width='18'\r\n            height='18'\r\n            viewBox='0 0 14 13'\r\n            fill='none'\r\n            xmlns='http://www.w3.org/2000/svg'\r\n            {...attrs}\r\n        >\r\n            <path\r\n                d='M11.7952 0.00524884C12.1312 0.00524884 12.4144 0.125249 12.6448 0.365248C12.8848 0.595648 13.0048 0.878848 13.0048 1.21485V8.41485C13.0048 8.75085 12.8848 9.03405 12.6448 9.26445C12.4144 9.49485 12.1312 9.61005 11.7952 9.61005H3.4L0.9952 12.0148V1.21485C0.9952 0.878848 1.1104 0.595648 1.3408 0.365248C1.5808 0.125249 1.8688 0.00524884 2.2048 0.00524884H11.7952ZM2.2048 1.21485V9.10605L2.896 8.41485H11.7952V1.21485H2.2048ZM3.4 3.01485H10.6V4.21005H3.4V3.01485ZM3.4 5.40525H8.8V6.61485H3.4V5.40525Z'\r\n            />\r\n        </svg>\r\n    );\r\n};\r\n\r\nexport default ThreadsIcon;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useCallback, useEffect} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\nimport {Link, useRouteMatch, useLocation, matchPath} from 'react-router-dom';\r\n\r\nimport {PulsatingDot} from '@mattermost/components';\r\n\r\nimport {getThreadCounts} from 'mattermost-redux/actions/threads';\r\nimport {getInt, isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {\r\n    getThreadCountsInCurrentTeam, getThreadsInCurrentTeam,\r\n} from 'mattermost-redux/selectors/entities/threads';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\nimport {isAnyModalOpen} from 'selectors/views/modals';\r\n\r\nimport ChannelMentionBadge from 'components/sidebar/sidebar_channel/channel_mention_badge';\r\nimport CollapsedReplyThreadsModal\r\n    from 'components/tours/crt_tour/collapsed_reply_threads_modal';\r\nimport CRTWelcomeTutorialTip\r\n    from 'components/tours/crt_tour/crt_welcome_tutorial_tip';\r\n\r\nimport Constants, {\r\n    CrtTutorialSteps,\r\n    CrtTutorialTriggerSteps,\r\n    ModalIdentifiers,\r\n    Preferences,\r\n    RHSStates,\r\n} from 'utils/constants';\r\nimport {Mark} from 'utils/performance_telemetry';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ThreadsIcon from './threads_icon';\r\n\r\nimport {useThreadRouting} from '../hooks';\r\n\r\nimport './global_threads_link.scss';\r\n\r\nconst GlobalThreadsLink = () => {\r\n    const {formatMessage} = useIntl();\r\n    const dispatch = useDispatch();\r\n    const isFeatureEnabled = useSelector(isCollapsedThreadsEnabled);\r\n\r\n    const {url} = useRouteMatch();\r\n    const {pathname} = useLocation();\r\n    const inGlobalThreads = matchPath(pathname, {path: '/:team/threads/:threadIdentifier?'}) != null;\r\n    const {currentTeamId, currentUserId} = useThreadRouting();\r\n\r\n    const counts = useSelector(getThreadCountsInCurrentTeam);\r\n    const someUnreadThreads = counts?.total_unread_threads;\r\n    const appHaveOpenModal = useSelector(isAnyModalOpen);\r\n    const tipStep = useSelector((state: GlobalState) => getInt(state, Preferences.CRT_TUTORIAL_STEP, currentUserId, CrtTutorialSteps.WELCOME_POPOVER));\r\n    const crtTutorialTrigger = useSelector((state: GlobalState) => getInt(state, Preferences.CRT_TUTORIAL_TRIGGERED, currentUserId, Constants.CrtTutorialTriggerSteps.START));\r\n    const threads = useSelector(getThreadsInCurrentTeam);\r\n    const showTutorialTip = crtTutorialTrigger === CrtTutorialTriggerSteps.STARTED && tipStep === CrtTutorialSteps.WELCOME_POPOVER && threads.length >= 1;\r\n    const rhsOpen = useSelector(getIsRhsOpen);\r\n    const rhsState = useSelector(getRhsState);\r\n    const showTutorialTrigger = isFeatureEnabled && crtTutorialTrigger === Constants.CrtTutorialTriggerSteps.START && !appHaveOpenModal && Boolean(counts) && counts.total >= 1;\r\n    const openThreads = useCallback((e) => {\r\n        e.stopPropagation();\r\n\r\n        performance.mark(Mark.GlobalThreadsLinkClicked);\r\n\r\n        if (showTutorialTrigger) {\r\n            dispatch(openModal({modalId: ModalIdentifiers.COLLAPSED_REPLY_THREADS_MODAL, dialogType: CollapsedReplyThreadsModal, dialogProps: {}}));\r\n        }\r\n\r\n        if (rhsOpen && rhsState === RHSStates.EDIT_HISTORY) {\r\n            dispatch(closeRightHandSide());\r\n        }\r\n    }, [showTutorialTrigger, counts, threads, rhsOpen, rhsState]);\r\n\r\n    useEffect(() => {\r\n        // load counts if necessary\r\n        if (isFeatureEnabled) {\r\n            dispatch(getThreadCounts(currentUserId, currentTeamId));\r\n        }\r\n    }, [currentUserId, currentTeamId, isFeatureEnabled]);\r\n\r\n    if (!isFeatureEnabled) {\r\n        // hide link if feature disabled\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <ul className='SidebarGlobalThreads NavGroupContent nav nav-pills__container'>\r\n            <li\r\n                id={'sidebar-threads-button'}\r\n                className={classNames('SidebarChannel', {\r\n                    active: inGlobalThreads,\r\n                    unread: someUnreadThreads,\r\n                })}\r\n                tabIndex={-1}\r\n            >\r\n                <Link\r\n                    onClick={openThreads}\r\n                    to={`${url}/threads`}\r\n                    id='sidebarItem_threads'\r\n                    draggable='false'\r\n                    className={classNames('SidebarLink sidebar-item', {\r\n                        'unread-title': Boolean(someUnreadThreads),\r\n                    })}\r\n                    tabIndex={0}\r\n                >\r\n                    <span className='icon'>\r\n                        <ThreadsIcon/>\r\n                    </span>\r\n                    <div className='SidebarChannelLinkLabel_wrapper'>\r\n                        <span className='SidebarChannelLinkLabel sidebar-item__name'>\r\n                            {formatMessage({id: 'globalThreads.sidebarLink', defaultMessage: 'Threads'})}\r\n                        </span>\r\n                    </div>\r\n                    {counts?.total_unread_mentions > 0 && (\r\n                        <ChannelMentionBadge\r\n                            unreadMentions={counts.total_unread_mentions}\r\n                            hasUrgent={Boolean(counts?.total_unread_urgent_mentions)}\r\n                        />\r\n                    )}\r\n                    {showTutorialTrigger && <PulsatingDot/>}\r\n                </Link>\r\n                {showTutorialTip && <CRTWelcomeTutorialTip/>}\r\n            </li>\r\n        </ul>\r\n    );\r\n};\r\n\r\nexport default GlobalThreadsLink;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useMemo, useCallback} from 'react';\r\nimport {useSelector, shallowEqual} from 'react-redux';\r\nimport {useParams, useHistory} from 'react-router-dom';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\n/**\r\n * GlobalThreads-specific hook for nav/routing, selection, and common data needed for actions.\r\n */\r\nexport function useThreadRouting() {\r\n    const matchParams = useParams<{team: string; threadIdentifier?: UserThread['id']}>();\r\n    const params = useMemo(() => matchParams, [matchParams.threadIdentifier, matchParams.team]);\r\n    const history = useHistory();\r\n\r\n    const currentTeamId = useSelector(getCurrentTeamId, shallowEqual);\r\n    const currentUserId = useSelector(getCurrentUserId, shallowEqual);\r\n\r\n    const select = useCallback((threadId?: UserThread['id']) => {\r\n        return history.push(`/${params.team}/threads${threadId ? '/' + threadId : ''}`);\r\n    }, [params.team]);\r\n\r\n    const clear = useCallback(() => history.replace(`/${params.team}/threads`), [params.team]);\r\n\r\n    const goToInChannel = useCallback((threadId?: UserThread['id'], teamName: Team['name'] = params.team) => {\r\n        return history.push(`/${teamName}/pl/${threadId ?? params.threadIdentifier}`);\r\n    }, [params.threadIdentifier, params.team]);\r\n\r\n    return {\r\n        params,\r\n        history,\r\n        currentTeamId,\r\n        currentUserId,\r\n        clear,\r\n        select,\r\n        goToInChannel,\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport {ChannelsTourTip, TutorialTourName} from 'components/tours';\r\nimport type {ChannelsTourTipProps} from 'components/tours';\r\n\r\nconst CRTTourTip = (props: Omit<ChannelsTourTipProps, 'tourCategory'>) => {\r\n    return (\r\n        <ChannelsTourTip\r\n            {...props}\r\n            tourCategory={TutorialTourName.CRT_TUTORIAL_STEP}\r\n        />\r\n    );\r\n};\r\n\r\nexport default CRTTourTip;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\ntype Props = {\r\n    additionalClassName?: string;\r\n}\r\n\r\nconst NextIcon = ({additionalClassName}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <i\r\n            className={classNames('icon icon-chevron-right', additionalClassName)}\r\n            title={formatMessage({\r\n                id: 'generic_icons.next',\r\n                defaultMessage: 'Next Icon',\r\n            })}\r\n        />\r\n    );\r\n};\r\n\r\nexport default React.memo(NextIcon);\r\n"],"names":["CollapsedReplyThreadsModal","props","dispatch","useDispatch","currentUserId","useSelector","getCurrentUserId","handleKeyDown","useCallback","e","Keyboard","Constants","KeyCodes","ENTER","onNext","useEffect","document","addEventListener","removeEventListener","onHide","skipTour","closeModal","ModalIdentifiers","COLLAPSED_REPLY_THREADS_MODAL","preferences","user_id","category","Preferences","CRT_TUTORIAL_TRIGGERED","name","value","CrtTutorialTriggerSteps","FINISHED","toString","savePreferences","STARTED","TutorialTourName","CRT_TUTORIAL_STEP","TTNameMapToATStatusKey","AutoTourStatus","ENABLED","React","GenericModal","compassDesign","className","id","onExited","handleConfirm","autoCloseOnConfirmButton","handleCancel","modalHeaderText","FormattedMessage","defaultMessage","confirmButtonText","NextIcon","cancelButtonText","values","b","chunks","src","crtInProductImg","propTypes","_pt","isRequired","CRTWelcomeTutorialTip","formatMessage","useIntl","title","screen","overlayPunchOut","useMeasurePunchouts","CRTTourTip","placement","pulsatingDotPlacement","attrs","Object","assign","width","height","viewBox","fill","xmlns","d","GlobalThreadsLink","isFeatureEnabled","isCollapsedThreadsEnabled","url","useRouteMatch","pathname","useLocation","inGlobalThreads","matchPath","path","currentTeamId","useThreadRouting","counts","getThreadCountsInCurrentTeam","someUnreadThreads","total_unread_threads","appHaveOpenModal","isAnyModalOpen","tipStep","state","getInt","CrtTutorialSteps","WELCOME_POPOVER","crtTutorialTrigger","START","threads","getThreadsInCurrentTeam","showTutorialTip","length","rhsOpen","getIsRhsOpen","rhsState","getRhsState","showTutorialTrigger","Boolean","total","openThreads","stopPropagation","performance","mark","Mark","GlobalThreadsLinkClicked","openModal","modalId","dialogType","dialogProps","RHSStates","EDIT_HISTORY","closeRightHandSide","getThreadCounts","classNames","active","unread","tabIndex","Link","onClick","to","concat","draggable","ThreadsIcon","total_unread_mentions","ChannelMentionBadge","unreadMentions","hasUrgent","total_unread_urgent_mentions","PulsatingDot","matchParams","useParams","params","useMemo","threadIdentifier","team","history","useHistory","getCurrentTeamId","shallowEqual","select","threadId","push","clear","replace","goToInChannel","teamName","arguments","undefined","ChannelsTourTip","tourCategory","_ref","additionalClassName"],"sourceRoot":""}