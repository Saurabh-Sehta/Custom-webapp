{"version":3,"file":"9176.c53598c593640183c419.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/gif_picker/selectors.ts","webpack://mattermost-webapp/./src/components/gif_picker/components/gif_picker_items.tsx","webpack://mattermost-webapp/./src/components/gif_picker/components/gif_picker_search.tsx","webpack://mattermost-webapp/./src/components/gif_picker/gif_picker.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {GiphyFetch} from '@giphy/js-fetch-api';\r\n\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nexport const getGiphyFetchInstance: (state: GlobalState) => GiphyFetch | null = createSelector(\r\n    'getGiphyFetchInstance',\r\n    (state) => getConfig(state).GiphySdkKey,\r\n    (giphySdkKey) => {\r\n        if (giphySdkKey) {\r\n            const giphyFetch = new GiphyFetch(giphySdkKey);\r\n            return giphyFetch;\r\n        }\r\n\r\n        return null;\r\n    },\r\n);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {GifsResult} from '@giphy/js-fetch-api';\r\nimport type {EmojiVariationsListProps} from '@giphy/react-components';\r\nimport {Grid} from '@giphy/react-components';\r\nimport React, {memo, useCallback} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport NoResultsIndicator from 'components/no_results_indicator';\r\nimport {NoResultsVariant} from 'components/no_results_indicator/types';\r\n\r\nimport {getGiphyFetchInstance} from '../selectors';\r\n\r\nconst GUTTER_BETWEEN_GIFS = 8;\r\nconst NUM_OF_GIFS_COLUMNS = 2;\r\n\r\ninterface Props {\r\n    width: number;\r\n    filter: string;\r\n    onClick: EmojiVariationsListProps['onGifClick'];\r\n}\r\n\r\nfunction GifPickerItems(props: Props) {\r\n    const giphyFetch = useSelector(getGiphyFetchInstance);\r\n\r\n    const fetchGifs = useCallback(async (offset: number) => {\r\n        if (!giphyFetch) {\r\n            return {} as GifsResult;\r\n        }\r\n\r\n        // We dont have to throttled the fetching as the library does it for us\r\n        if (props.filter.length > 0) {\r\n            const filteredResult = await giphyFetch.search(props.filter, {offset, limit: 10});\r\n            return filteredResult;\r\n        }\r\n\r\n        const trendingResult = await giphyFetch.trending({offset, limit: 10});\r\n        return trendingResult;\r\n    }, [props.filter, giphyFetch]);\r\n\r\n    return (\r\n        <div className='emoji-picker__items gif-picker__items'>\r\n            <Grid\r\n                key={props.filter.length === 0 ? 'trending' : props.filter}\r\n                columns={NUM_OF_GIFS_COLUMNS}\r\n                gutter={GUTTER_BETWEEN_GIFS}\r\n                hideAttribution={true}\r\n                width={props.width}\r\n                noResultsMessage={\r\n                    <NoResultsIndicator\r\n                        variant={NoResultsVariant.Search}\r\n                        titleValues={{channelName: `${props.filter}`}}\r\n                    />\r\n                }\r\n                fetchGifs={fetchGifs}\r\n                onGifClick={props.onClick}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default memo(GifPickerItems);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChangeEvent} from 'react';\r\nimport React, {memo, useCallback, useMemo} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\nimport tinycolor from 'tinycolor2';\r\n\r\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport giphyBlackImage from 'images/gif_picker/powered-by-giphy-black.png';\r\nimport giphyWhiteImage from 'images/gif_picker/powered-by-giphy-white.png';\r\n\r\ninterface Props {\r\n    value: string;\r\n    onChange: (value: string) => void;\r\n}\r\n\r\nfunction GifPickerSearch(props: Props) {\r\n    const theme = useSelector(getTheme);\r\n\r\n    const {formatMessage} = useIntl();\r\n\r\n    const handleChange = useCallback((event: ChangeEvent<HTMLInputElement>) => {\r\n        event.preventDefault();\r\n\r\n        // remove trailing and leading colons\r\n        const value = event.target?.value?.replace(/^:|:$/g, '') ?? '';\r\n        props.onChange(value);\r\n    }, [props.onChange]);\r\n\r\n    const shouldUseWhiteLogo = useMemo(() => {\r\n        const WHITE_COLOR = '#FFFFFF';\r\n        const BLACK_COLOR = '#000000';\r\n\r\n        const mostReadableColor = tinycolor.mostReadable(theme.centerChannelBg, [WHITE_COLOR, BLACK_COLOR], {includeFallbackColors: false});\r\n\r\n        if (mostReadableColor.isLight()) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }, [theme.centerChannelBg]);\r\n\r\n    return (\r\n        <div className='emoji-picker__search-container'>\r\n            <div className='emoji-picker__text-container gif-picker__text-container'>\r\n                <span className='icon-magnify icon emoji-picker__search-icon'/>\r\n                <input\r\n                    id='emojiPickerSearch'\r\n                    className='emoji-picker__search'\r\n                    aria-label={formatMessage({id: 'gif_picker.input.label', defaultMessage: 'Search for GIFs'})}\r\n                    placeholder={formatMessage({id: 'gif_picker.input.placeholder', defaultMessage: 'Search GIPHY'})}\r\n                    type='text'\r\n                    autoFocus={true}\r\n                    autoComplete='off'\r\n                    onChange={handleChange}\r\n                    value={props.value}\r\n                />\r\n            </div>\r\n            <div className='gif-attribution'>\r\n                <img\r\n                    src={shouldUseWhiteLogo ? giphyWhiteImage : giphyBlackImage}\r\n                    alt={formatMessage({id: 'gif_picker.attribution.alt', defaultMessage: 'Powered by GIPHY'})}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default memo(GifPickerSearch);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {IGif} from '@giphy/js-types';\r\nimport type {SyntheticEvent} from 'react';\r\nimport React, {useCallback, useMemo} from 'react';\r\n\r\nimport GifPickerItems from './components/gif_picker_items';\r\nimport GifPickerSearch from './components/gif_picker_search';\r\n\r\nconst GIF_DEFAULT_WIDTH = 350;\r\nconst GIF_MARGIN_ENDS = 12;\r\n\r\ntype Props = {\r\n    filter: string;\r\n    onGifClick?: (gif: string) => void;\r\n    handleFilterChange: (filter: string) => void;\r\n    getRootPickerNode: () => HTMLDivElement | null;\r\n}\r\n\r\nconst GifPicker = (props: Props) => {\r\n    const handleItemClick = useCallback((gif: IGif, event: SyntheticEvent<HTMLElement, Event>) => {\r\n        if (props.onGifClick) {\r\n            event.preventDefault();\r\n\r\n            const imageWithMarkdown = `![${gif.title}](${gif.images.fixed_height.url})`;\r\n            props.onGifClick(imageWithMarkdown);\r\n        }\r\n    }, [props.onGifClick]);\r\n\r\n    const pickerWidth = useMemo(() => {\r\n        const pickerWidth = props.getRootPickerNode?.()?.getBoundingClientRect()?.width ?? GIF_DEFAULT_WIDTH;\r\n        return (pickerWidth - (2 * GIF_MARGIN_ENDS));\r\n    }, [props.getRootPickerNode]);\r\n\r\n    return (\r\n        <>\r\n            <GifPickerSearch\r\n                value={props.filter}\r\n                onChange={props.handleFilterChange}\r\n            />\r\n            <GifPickerItems\r\n                width={pickerWidth}\r\n                filter={props.filter}\r\n                onClick={handleItemClick}\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default GifPicker;\r\n"],"names":["getGiphyFetchInstance","createSelector","state","getConfig","GiphySdkKey","giphySdkKey","GiphyFetch","GifPickerItems","props","giphyFetch","useSelector","fetchGifs","useCallback","async","filter","length","search","offset","limit","trending","React","className","Grid","key","columns","gutter","hideAttribution","width","noResultsMessage","NoResultsIndicator","variant","NoResultsVariant","Search","titleValues","channelName","concat","onGifClick","onClick","propTypes","_pt","isRequired","memo","GifPickerSearch","theme","getTheme","formatMessage","useIntl","handleChange","event","_event$target$value$r","_event$target","_event$target$value","preventDefault","value","target","replace","onChange","shouldUseWhiteLogo","useMemo","tinycolor","mostReadable","centerChannelBg","includeFallbackColors","isLight","id","defaultMessage","placeholder","type","autoFocus","autoComplete","src","giphyWhiteImage","giphyBlackImage","alt","GifPicker","handleItemClick","gif","imageWithMarkdown","title","images","fixed_height","url","pickerWidth","_props$getRootPickerN","_props$getRootPickerN2","_props$getRootPickerN3","_props$getRootPickerN4","getRootPickerNode","call","getBoundingClientRect","handleFilterChange"],"sourceRoot":""}